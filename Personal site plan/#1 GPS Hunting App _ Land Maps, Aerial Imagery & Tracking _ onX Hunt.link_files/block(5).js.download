/*! For license information please see block.js.LICENSE.txt */
(()=>{var t,e,i={91928:t=>{"use strict";var e={single_source_shortest_paths:function(t,i,r){var n={},a={};a[i]=0;var o,s,l,c,h,u,d,p=e.PriorityQueue.make();for(p.push(i,0);!p.empty();)for(l in s=(o=p.pop()).value,c=o.cost,h=t[s]||{})h.hasOwnProperty(l)&&(u=c+h[l],d=a[l],(void 0===a[l]||d>u)&&(a[l]=u,p.push(l,u),n[l]=s));if(void 0!==r&&void 0===a[r]){var m=["Could not find a path from ",i," to ",r,"."].join("");throw new Error(m)}return n},extract_shortest_path_from_predecessor_list:function(t,e){for(var i=[],r=e;r;)i.push(r),t[r],r=t[r];return i.reverse(),i},find_path:function(t,i,r){var n=e.single_source_shortest_paths(t,i,r);return e.extract_shortest_path_from_predecessor_list(n,r)},PriorityQueue:{make:function(t){var i,r=e.PriorityQueue,n={};for(i in t=t||{},r)r.hasOwnProperty(i)&&(n[i]=r[i]);return n.queue=[],n.sorter=t.sorter||r.default_sorter,n},default_sorter:function(t,e){return t.cost-e.cost},push:function(t,e){var i={value:t,cost:e};this.queue.push(i),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return 0===this.queue.length}}};t.exports=e},24300:function(t){
/*! @license DOMPurify 2.4.7 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.7/LICENSE */
t.exports=function(){"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,i){return e=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},e(t,i)}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function r(t,n,a){return r=i()?Reflect.construct:function(t,i,r){var n=[null];n.push.apply(n,i);var a=new(Function.bind.apply(t,n));return r&&e(a,r.prototype),a},r.apply(null,arguments)}function n(t){return a(t)||o(t)||s(t)||c()}function a(t){if(Array.isArray(t))return l(t)}function o(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function s(t,e){if(t){if("string"==typeof t)return l(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?l(t,e):void 0}}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,r=new Array(e);i<e;i++)r[i]=t[i];return r}function c(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var h=Object.hasOwnProperty,u=Object.setPrototypeOf,d=Object.isFrozen,p=Object.getPrototypeOf,m=Object.getOwnPropertyDescriptor,f=Object.freeze,g=Object.seal,y=Object.create,_="undefined"!=typeof Reflect&&Reflect,v=_.apply,b=_.construct;v||(v=function(t,e,i){return t.apply(e,i)}),f||(f=function(t){return t}),g||(g=function(t){return t}),b||(b=function(t,e){return r(t,n(e))});var x=P(Array.prototype.forEach),w=P(Array.prototype.pop),S=P(Array.prototype.push),k=P(String.prototype.toLowerCase),C=P(String.prototype.toString),A=P(String.prototype.match),T=P(String.prototype.replace),E=P(String.prototype.indexOf),M=P(String.prototype.trim),I=P(RegExp.prototype.test),z=L(TypeError);function P(t){return function(e){for(var i=arguments.length,r=new Array(i>1?i-1:0),n=1;n<i;n++)r[n-1]=arguments[n];return v(t,e,r)}}function L(t){return function(){for(var e=arguments.length,i=new Array(e),r=0;r<e;r++)i[r]=arguments[r];return b(t,i)}}function D(t,e,i){var r;i=null!==(r=i)&&void 0!==r?r:k,u&&u(t,null);for(var n=e.length;n--;){var a=e[n];if("string"==typeof a){var o=i(a);o!==a&&(d(e)||(e[n]=o),a=o)}t[a]=!0}return t}function R(t){var e,i=y(null);for(e in t)!0===v(h,t,[e])&&(i[e]=t[e]);return i}function B(t,e){for(;null!==t;){var i=m(t,e);if(i){if(i.get)return P(i.get);if("function"==typeof i.value)return P(i.value)}t=p(t)}function r(t){return console.warn("fallback value for",t),null}return r}var F=f(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),O=f(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),$=f(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),V=f(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),N=f(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),j=f(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),U=f(["#text"]),Z=f(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),H=f(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),q=f(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),G=f(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),W=g(/\{\{[\w\W]*|[\w\W]*\}\}/gm),X=g(/<%[\w\W]*|[\w\W]*%>/gm),K=g(/\${[\w\W]*}/gm),J=g(/^data-[\-\w.\u00B7-\uFFFF]/),Y=g(/^aria-[\-\w]+$/),Q=g(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),tt=g(/^(?:\w+script|data):/i),et=g(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),it=g(/^html$/i),rt=function(){return"undefined"==typeof window?null:window},nt=function(e,i){if("object"!==t(e)||"function"!=typeof e.createPolicy)return null;var r=null,n="data-tt-policy-suffix";i.currentScript&&i.currentScript.hasAttribute(n)&&(r=i.currentScript.getAttribute(n));var a="dompurify"+(r?"#"+r:"");try{return e.createPolicy(a,{createHTML:function(t){return t},createScriptURL:function(t){return t}})}catch(t){return console.warn("TrustedTypes policy "+a+" could not be created."),null}};function at(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:rt(),i=function(t){return at(t)};if(i.version="2.4.7",i.removed=[],!e||!e.document||9!==e.document.nodeType)return i.isSupported=!1,i;var r=e.document,a=e.document,o=e.DocumentFragment,s=e.HTMLTemplateElement,l=e.Node,c=e.Element,h=e.NodeFilter,u=e.NamedNodeMap,d=void 0===u?e.NamedNodeMap||e.MozNamedAttrMap:u,p=e.HTMLFormElement,m=e.DOMParser,g=e.trustedTypes,y=c.prototype,_=B(y,"cloneNode"),v=B(y,"nextSibling"),b=B(y,"childNodes"),P=B(y,"parentNode");if("function"==typeof s){var L=a.createElement("template");L.content&&L.content.ownerDocument&&(a=L.content.ownerDocument)}var ot=nt(g,r),st=ot?ot.createHTML(""):"",lt=a,ct=lt.implementation,ht=lt.createNodeIterator,ut=lt.createDocumentFragment,dt=lt.getElementsByTagName,pt=r.importNode,mt={};try{mt=R(a).documentMode?a.documentMode:{}}catch(t){}var ft={};i.isSupported="function"==typeof P&&ct&&void 0!==ct.createHTMLDocument&&9!==mt;var gt,yt,_t=W,vt=X,bt=K,xt=J,wt=Y,St=tt,kt=et,Ct=Q,At=null,Tt=D({},[].concat(n(F),n(O),n($),n(N),n(U))),Et=null,Mt=D({},[].concat(n(Z),n(H),n(q),n(G))),It=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),zt=null,Pt=null,Lt=!0,Dt=!0,Rt=!1,Bt=!0,Ft=!1,Ot=!1,$t=!1,Vt=!1,Nt=!1,jt=!1,Ut=!1,Zt=!0,Ht=!1,qt="user-content-",Gt=!0,Wt=!1,Xt={},Kt=null,Jt=D({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),Yt=null,Qt=D({},["audio","video","img","source","image","track"]),te=null,ee=D({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),ie="http://www.w3.org/1998/Math/MathML",re="http://www.w3.org/2000/svg",ne="http://www.w3.org/1999/xhtml",ae=ne,oe=!1,se=null,le=D({},[ie,re,ne],C),ce=["application/xhtml+xml","text/html"],he="text/html",ue=null,de=a.createElement("form"),pe=function(t){return t instanceof RegExp||t instanceof Function},me=function(e){ue&&ue===e||(e&&"object"===t(e)||(e={}),e=R(e),gt=gt=-1===ce.indexOf(e.PARSER_MEDIA_TYPE)?he:e.PARSER_MEDIA_TYPE,yt="application/xhtml+xml"===gt?C:k,At="ALLOWED_TAGS"in e?D({},e.ALLOWED_TAGS,yt):Tt,Et="ALLOWED_ATTR"in e?D({},e.ALLOWED_ATTR,yt):Mt,se="ALLOWED_NAMESPACES"in e?D({},e.ALLOWED_NAMESPACES,C):le,te="ADD_URI_SAFE_ATTR"in e?D(R(ee),e.ADD_URI_SAFE_ATTR,yt):ee,Yt="ADD_DATA_URI_TAGS"in e?D(R(Qt),e.ADD_DATA_URI_TAGS,yt):Qt,Kt="FORBID_CONTENTS"in e?D({},e.FORBID_CONTENTS,yt):Jt,zt="FORBID_TAGS"in e?D({},e.FORBID_TAGS,yt):{},Pt="FORBID_ATTR"in e?D({},e.FORBID_ATTR,yt):{},Xt="USE_PROFILES"in e&&e.USE_PROFILES,Lt=!1!==e.ALLOW_ARIA_ATTR,Dt=!1!==e.ALLOW_DATA_ATTR,Rt=e.ALLOW_UNKNOWN_PROTOCOLS||!1,Bt=!1!==e.ALLOW_SELF_CLOSE_IN_ATTR,Ft=e.SAFE_FOR_TEMPLATES||!1,Ot=e.WHOLE_DOCUMENT||!1,Nt=e.RETURN_DOM||!1,jt=e.RETURN_DOM_FRAGMENT||!1,Ut=e.RETURN_TRUSTED_TYPE||!1,Vt=e.FORCE_BODY||!1,Zt=!1!==e.SANITIZE_DOM,Ht=e.SANITIZE_NAMED_PROPS||!1,Gt=!1!==e.KEEP_CONTENT,Wt=e.IN_PLACE||!1,Ct=e.ALLOWED_URI_REGEXP||Ct,ae=e.NAMESPACE||ne,It=e.CUSTOM_ELEMENT_HANDLING||{},e.CUSTOM_ELEMENT_HANDLING&&pe(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(It.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&pe(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(It.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(It.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Ft&&(Dt=!1),jt&&(Nt=!0),Xt&&(At=D({},n(U)),Et=[],!0===Xt.html&&(D(At,F),D(Et,Z)),!0===Xt.svg&&(D(At,O),D(Et,H),D(Et,G)),!0===Xt.svgFilters&&(D(At,$),D(Et,H),D(Et,G)),!0===Xt.mathMl&&(D(At,N),D(Et,q),D(Et,G))),e.ADD_TAGS&&(At===Tt&&(At=R(At)),D(At,e.ADD_TAGS,yt)),e.ADD_ATTR&&(Et===Mt&&(Et=R(Et)),D(Et,e.ADD_ATTR,yt)),e.ADD_URI_SAFE_ATTR&&D(te,e.ADD_URI_SAFE_ATTR,yt),e.FORBID_CONTENTS&&(Kt===Jt&&(Kt=R(Kt)),D(Kt,e.FORBID_CONTENTS,yt)),Gt&&(At["#text"]=!0),Ot&&D(At,["html","head","body"]),At.table&&(D(At,["tbody"]),delete zt.tbody),f&&f(e),ue=e)},fe=D({},["mi","mo","mn","ms","mtext"]),ge=D({},["foreignobject","desc","title","annotation-xml"]),ye=D({},["title","style","font","a","script"]),_e=D({},O);D(_e,$),D(_e,V);var ve=D({},N);D(ve,j);var be=function(t){var e=P(t);e&&e.tagName||(e={namespaceURI:ae,tagName:"template"});var i=k(t.tagName),r=k(e.tagName);return!!se[t.namespaceURI]&&(t.namespaceURI===re?e.namespaceURI===ne?"svg"===i:e.namespaceURI===ie?"svg"===i&&("annotation-xml"===r||fe[r]):Boolean(_e[i]):t.namespaceURI===ie?e.namespaceURI===ne?"math"===i:e.namespaceURI===re?"math"===i&&ge[r]:Boolean(ve[i]):t.namespaceURI===ne?!(e.namespaceURI===re&&!ge[r])&&!(e.namespaceURI===ie&&!fe[r])&&!ve[i]&&(ye[i]||!_e[i]):!("application/xhtml+xml"!==gt||!se[t.namespaceURI]))},xe=function(t){S(i.removed,{element:t});try{t.parentNode.removeChild(t)}catch(e){try{t.outerHTML=st}catch(e){t.remove()}}},we=function(t,e){try{S(i.removed,{attribute:e.getAttributeNode(t),from:e})}catch(t){S(i.removed,{attribute:null,from:e})}if(e.removeAttribute(t),"is"===t&&!Et[t])if(Nt||jt)try{xe(e)}catch(t){}else try{e.setAttribute(t,"")}catch(t){}},Se=function(t){var e,i;if(Vt)t="<remove></remove>"+t;else{var r=A(t,/^[\r\n\t ]+/);i=r&&r[0]}"application/xhtml+xml"===gt&&ae===ne&&(t='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+t+"</body></html>");var n=ot?ot.createHTML(t):t;if(ae===ne)try{e=(new m).parseFromString(n,gt)}catch(t){}if(!e||!e.documentElement){e=ct.createDocument(ae,"template",null);try{e.documentElement.innerHTML=oe?st:n}catch(t){}}var o=e.body||e.documentElement;return t&&i&&o.insertBefore(a.createTextNode(i),o.childNodes[0]||null),ae===ne?dt.call(e,Ot?"html":"body")[0]:Ot?e.documentElement:o},ke=function(t){return ht.call(t.ownerDocument||t,t,h.SHOW_ELEMENT|h.SHOW_COMMENT|h.SHOW_TEXT,null,!1)},Ce=function(t){return t instanceof p&&("string"!=typeof t.nodeName||"string"!=typeof t.textContent||"function"!=typeof t.removeChild||!(t.attributes instanceof d)||"function"!=typeof t.removeAttribute||"function"!=typeof t.setAttribute||"string"!=typeof t.namespaceURI||"function"!=typeof t.insertBefore||"function"!=typeof t.hasChildNodes)},Ae=function(e){return"object"===t(l)?e instanceof l:e&&"object"===t(e)&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName},Te=function(t,e,r){ft[t]&&x(ft[t],(function(t){t.call(i,e,r,ue)}))},Ee=function(t){var e;if(Te("beforeSanitizeElements",t,null),Ce(t))return xe(t),!0;if(I(/[\u0080-\uFFFF]/,t.nodeName))return xe(t),!0;var r=yt(t.nodeName);if(Te("uponSanitizeElement",t,{tagName:r,allowedTags:At}),t.hasChildNodes()&&!Ae(t.firstElementChild)&&(!Ae(t.content)||!Ae(t.content.firstElementChild))&&I(/<[/\w]/g,t.innerHTML)&&I(/<[/\w]/g,t.textContent))return xe(t),!0;if("select"===r&&I(/<template/i,t.innerHTML))return xe(t),!0;if(!At[r]||zt[r]){if(!zt[r]&&Ie(r)){if(It.tagNameCheck instanceof RegExp&&I(It.tagNameCheck,r))return!1;if(It.tagNameCheck instanceof Function&&It.tagNameCheck(r))return!1}if(Gt&&!Kt[r]){var n=P(t)||t.parentNode,a=b(t)||t.childNodes;if(a&&n)for(var o=a.length-1;o>=0;--o)n.insertBefore(_(a[o],!0),v(t))}return xe(t),!0}return t instanceof c&&!be(t)?(xe(t),!0):"noscript"!==r&&"noembed"!==r&&"noframes"!==r||!I(/<\/no(script|embed|frames)/i,t.innerHTML)?(Ft&&3===t.nodeType&&(e=t.textContent,e=T(e,_t," "),e=T(e,vt," "),e=T(e,bt," "),t.textContent!==e&&(S(i.removed,{element:t.cloneNode()}),t.textContent=e)),Te("afterSanitizeElements",t,null),!1):(xe(t),!0)},Me=function(t,e,i){if(Zt&&("id"===e||"name"===e)&&(i in a||i in de))return!1;if(Dt&&!Pt[e]&&I(xt,e));else if(Lt&&I(wt,e));else if(!Et[e]||Pt[e]){if(!(Ie(t)&&(It.tagNameCheck instanceof RegExp&&I(It.tagNameCheck,t)||It.tagNameCheck instanceof Function&&It.tagNameCheck(t))&&(It.attributeNameCheck instanceof RegExp&&I(It.attributeNameCheck,e)||It.attributeNameCheck instanceof Function&&It.attributeNameCheck(e))||"is"===e&&It.allowCustomizedBuiltInElements&&(It.tagNameCheck instanceof RegExp&&I(It.tagNameCheck,i)||It.tagNameCheck instanceof Function&&It.tagNameCheck(i))))return!1}else if(te[e]);else if(I(Ct,T(i,kt,"")));else if("src"!==e&&"xlink:href"!==e&&"href"!==e||"script"===t||0!==E(i,"data:")||!Yt[t])if(Rt&&!I(St,T(i,kt,"")));else if(i)return!1;return!0},Ie=function(t){return t.indexOf("-")>0},ze=function(e){var r,n,a,o;Te("beforeSanitizeAttributes",e,null);var s=e.attributes;if(s){var l={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Et};for(o=s.length;o--;){var c=r=s[o],h=c.name,u=c.namespaceURI;if(n="value"===h?r.value:M(r.value),a=yt(h),l.attrName=a,l.attrValue=n,l.keepAttr=!0,l.forceKeepAttr=void 0,Te("uponSanitizeAttribute",e,l),n=l.attrValue,!l.forceKeepAttr&&(we(h,e),l.keepAttr))if(Bt||!I(/\/>/i,n)){Ft&&(n=T(n,_t," "),n=T(n,vt," "),n=T(n,bt," "));var d=yt(e.nodeName);if(Me(d,a,n)){if(!Ht||"id"!==a&&"name"!==a||(we(h,e),n=qt+n),ot&&"object"===t(g)&&"function"==typeof g.getAttributeType)if(u);else switch(g.getAttributeType(d,a)){case"TrustedHTML":n=ot.createHTML(n);break;case"TrustedScriptURL":n=ot.createScriptURL(n)}try{u?e.setAttributeNS(u,h,n):e.setAttribute(h,n),w(i.removed)}catch(t){}}}else we(h,e)}Te("afterSanitizeAttributes",e,null)}},Pe=function t(e){var i,r=ke(e);for(Te("beforeSanitizeShadowDOM",e,null);i=r.nextNode();)Te("uponSanitizeShadowNode",i,null),Ee(i)||(i.content instanceof o&&t(i.content),ze(i));Te("afterSanitizeShadowDOM",e,null)};return i.sanitize=function(n){var a,s,c,h,u,d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((oe=!n)&&(n="\x3c!--\x3e"),"string"!=typeof n&&!Ae(n)){if("function"!=typeof n.toString)throw z("toString is not a function");if("string"!=typeof(n=n.toString()))throw z("dirty is not a string, aborting")}if(!i.isSupported){if("object"===t(e.toStaticHTML)||"function"==typeof e.toStaticHTML){if("string"==typeof n)return e.toStaticHTML(n);if(Ae(n))return e.toStaticHTML(n.outerHTML)}return n}if($t||me(d),i.removed=[],"string"==typeof n&&(Wt=!1),Wt){if(n.nodeName){var p=yt(n.nodeName);if(!At[p]||zt[p])throw z("root node is forbidden and cannot be sanitized in-place")}}else if(n instanceof l)1===(s=(a=Se("\x3c!----\x3e")).ownerDocument.importNode(n,!0)).nodeType&&"BODY"===s.nodeName||"HTML"===s.nodeName?a=s:a.appendChild(s);else{if(!Nt&&!Ft&&!Ot&&-1===n.indexOf("<"))return ot&&Ut?ot.createHTML(n):n;if(!(a=Se(n)))return Nt?null:Ut?st:""}a&&Vt&&xe(a.firstChild);for(var m=ke(Wt?n:a);c=m.nextNode();)3===c.nodeType&&c===h||Ee(c)||(c.content instanceof o&&Pe(c.content),ze(c),h=c);if(h=null,Wt)return n;if(Nt){if(jt)for(u=ut.call(a.ownerDocument);a.firstChild;)u.appendChild(a.firstChild);else u=a;return(Et.shadowroot||Et.shadowrootmod)&&(u=pt.call(r,u,!0)),u}var f=Ot?a.outerHTML:a.innerHTML;return Ot&&At["!doctype"]&&a.ownerDocument&&a.ownerDocument.doctype&&a.ownerDocument.doctype.name&&I(it,a.ownerDocument.doctype.name)&&(f="<!DOCTYPE "+a.ownerDocument.doctype.name+">\n"+f),Ft&&(f=T(f,_t," "),f=T(f,vt," "),f=T(f,bt," ")),ot&&Ut?ot.createHTML(f):f},i.setConfig=function(t){me(t),$t=!0},i.clearConfig=function(){ue=null,$t=!1},i.isValidAttribute=function(t,e,i){ue||me({});var r=yt(t),n=yt(e);return Me(r,n,i)},i.addHook=function(t,e){"function"==typeof e&&(ft[t]=ft[t]||[],S(ft[t],e))},i.removeHook=function(t){if(ft[t])return w(ft[t])},i.removeHooks=function(t){ft[t]&&(ft[t]=[])},i.removeAllHooks=function(){ft={}},i}return at()}()},61156:t=>{"use strict";t.exports=function(t){for(var e=[],i=t.length,r=0;r<i;r++){var n=t.charCodeAt(r);if(n>=55296&&n<=56319&&i>r+1){var a=t.charCodeAt(r+1);a>=56320&&a<=57343&&(n=1024*(n-55296)+a-56320+65536,r+=1)}n<128?e.push(n):n<2048?(e.push(n>>6|192),e.push(63&n|128)):n<55296||n>=57344&&n<65536?(e.push(n>>12|224),e.push(n>>6&63|128),e.push(63&n|128)):n>=65536&&n<=1114111?(e.push(n>>18|240),e.push(n>>12&63|128),e.push(n>>6&63|128),e.push(63&n|128)):e.push(239,191,189)}return new Uint8Array(e).buffer}},84792:(t,e,i)=>{"use strict";var r=i(49819),n={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},a={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},o={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},s={};function l(t){return r.isMemo(t)?o:s[t.$$typeof]||n}s[r.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},s[r.Memo]=o;var c=Object.defineProperty,h=Object.getOwnPropertyNames,u=Object.getOwnPropertySymbols,d=Object.getOwnPropertyDescriptor,p=Object.getPrototypeOf,m=Object.prototype;t.exports=function t(e,i,r){if("string"!=typeof i){if(m){var n=p(i);n&&n!==m&&t(e,n,r)}var o=h(i);u&&(o=o.concat(u(i)));for(var s=l(e),f=l(i),g=0;g<o.length;++g){var y=o[g];if(!(a[y]||r&&r[y]||f&&f[y]||s&&s[y])){var _=d(i,y);try{c(e,y,_)}catch(t){}}}}return e}},16560:(t,e)=>{"use strict";
/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var i="function"==typeof Symbol&&Symbol.for,r=i?Symbol.for("react.element"):60103,n=i?Symbol.for("react.portal"):60106,a=i?Symbol.for("react.fragment"):60107,o=i?Symbol.for("react.strict_mode"):60108,s=i?Symbol.for("react.profiler"):60114,l=i?Symbol.for("react.provider"):60109,c=i?Symbol.for("react.context"):60110,h=i?Symbol.for("react.async_mode"):60111,u=i?Symbol.for("react.concurrent_mode"):60111,d=i?Symbol.for("react.forward_ref"):60112,p=i?Symbol.for("react.suspense"):60113,m=i?Symbol.for("react.suspense_list"):60120,f=i?Symbol.for("react.memo"):60115,g=i?Symbol.for("react.lazy"):60116,y=i?Symbol.for("react.block"):60121,_=i?Symbol.for("react.fundamental"):60117,v=i?Symbol.for("react.responder"):60118,b=i?Symbol.for("react.scope"):60119;function x(t){if("object"==typeof t&&null!==t){var e=t.$$typeof;switch(e){case r:switch(t=t.type){case h:case u:case a:case s:case o:case p:return t;default:switch(t=t&&t.$$typeof){case c:case d:case g:case f:case l:return t;default:return e}}case n:return e}}}function w(t){return x(t)===u}e.AsyncMode=h,e.ConcurrentMode=u,e.ContextConsumer=c,e.ContextProvider=l,e.Element=r,e.ForwardRef=d,e.Fragment=a,e.Lazy=g,e.Memo=f,e.Portal=n,e.Profiler=s,e.StrictMode=o,e.Suspense=p,e.isAsyncMode=function(t){return w(t)||x(t)===h},e.isConcurrentMode=w,e.isContextConsumer=function(t){return x(t)===c},e.isContextProvider=function(t){return x(t)===l},e.isElement=function(t){return"object"==typeof t&&null!==t&&t.$$typeof===r},e.isForwardRef=function(t){return x(t)===d},e.isFragment=function(t){return x(t)===a},e.isLazy=function(t){return x(t)===g},e.isMemo=function(t){return x(t)===f},e.isPortal=function(t){return x(t)===n},e.isProfiler=function(t){return x(t)===s},e.isStrictMode=function(t){return x(t)===o},e.isSuspense=function(t){return x(t)===p},e.isValidElementType=function(t){return"string"==typeof t||"function"==typeof t||t===a||t===u||t===s||t===o||t===p||t===m||"object"==typeof t&&null!==t&&(t.$$typeof===g||t.$$typeof===f||t.$$typeof===l||t.$$typeof===c||t.$$typeof===d||t.$$typeof===_||t.$$typeof===v||t.$$typeof===b||t.$$typeof===y)},e.typeOf=x},49819:(t,e,i)=>{"use strict";t.exports=i(16560)},10916:(t,e,i)=>{const r=i(93764),n=i(10688),a=i(87071),o=i(66756);function s(t,e,i,a,o){const s=[].slice.call(arguments,1),l=s.length,c="function"==typeof s[l-1];if(!c&&!r())throw new Error("Callback required as last argument");if(!c){if(l<1)throw new Error("Too few arguments provided");return 1===l?(i=e,e=a=void 0):2!==l||e.getContext||(a=i,i=e,e=void 0),new Promise((function(r,o){try{const o=n.create(i,a);r(t(o,e,a))}catch(t){o(t)}}))}if(l<2)throw new Error("Too few arguments provided");2===l?(o=i,i=e,e=a=void 0):3===l&&(e.getContext&&void 0===o?(o=a,a=void 0):(o=a,a=i,i=e,e=void 0));try{const r=n.create(i,a);o(null,t(r,e,a))}catch(t){o(t)}}n.create,s.bind(null,a.render),s.bind(null,a.renderToDataURL),e.toString=s.bind(null,(function(t,e,i){return o.render(t,i)}))},93764:t=>{t.exports=function(){return"function"==typeof Promise&&Promise.prototype&&Promise.prototype.then}},48120:(t,e,i)=>{const r=i(89436).getSymbolSize;e.getRowColCoords=function(t){if(1===t)return[];const e=Math.floor(t/7)+2,i=r(t),n=145===i?26:2*Math.ceil((i-13)/(2*e-2)),a=[i-7];for(let t=1;t<e-1;t++)a[t]=a[t-1]-n;return a.push(6),a.reverse()},e.getPositions=function(t){const i=[],r=e.getRowColCoords(t),n=r.length;for(let t=0;t<n;t++)for(let e=0;e<n;e++)0===t&&0===e||0===t&&e===n-1||t===n-1&&0===e||i.push([r[t],r[e]]);return i}},18512:(t,e,i)=>{const r=i(61768),n=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function a(t){this.mode=r.ALPHANUMERIC,this.data=t}a.getBitsLength=function(t){return 11*Math.floor(t/2)+t%2*6},a.prototype.getLength=function(){return this.data.length},a.prototype.getBitsLength=function(){return a.getBitsLength(this.data.length)},a.prototype.write=function(t){let e;for(e=0;e+2<=this.data.length;e+=2){let i=45*n.indexOf(this.data[e]);i+=n.indexOf(this.data[e+1]),t.put(i,11)}this.data.length%2&&t.put(n.indexOf(this.data[e]),6)},t.exports=a},63880:t=>{function e(){this.buffer=[],this.length=0}e.prototype={get:function(t){const e=Math.floor(t/8);return 1==(this.buffer[e]>>>7-t%8&1)},put:function(t,e){for(let i=0;i<e;i++)this.putBit(1==(t>>>e-i-1&1))},getLengthInBits:function(){return this.length},putBit:function(t){const e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),t&&(this.buffer[e]|=128>>>this.length%8),this.length++}},t.exports=e},67075:t=>{function e(t){if(!t||t<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=t,this.data=new Uint8Array(t*t),this.reservedBit=new Uint8Array(t*t)}e.prototype.set=function(t,e,i,r){const n=t*this.size+e;this.data[n]=i,r&&(this.reservedBit[n]=!0)},e.prototype.get=function(t,e){return this.data[t*this.size+e]},e.prototype.xor=function(t,e,i){this.data[t*this.size+e]^=i},e.prototype.isReserved=function(t,e){return this.reservedBit[t*this.size+e]},t.exports=e},12032:(t,e,i)=>{const r=i(61156),n=i(61768);function a(t){this.mode=n.BYTE,"string"==typeof t&&(t=r(t)),this.data=new Uint8Array(t)}a.getBitsLength=function(t){return 8*t},a.prototype.getLength=function(){return this.data.length},a.prototype.getBitsLength=function(){return a.getBitsLength(this.data.length)},a.prototype.write=function(t){for(let e=0,i=this.data.length;e<i;e++)t.put(this.data[e],8)},t.exports=a},16496:(t,e,i)=>{const r=i(53616),n=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],a=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];e.getBlocksCount=function(t,e){switch(e){case r.L:return n[4*(t-1)+0];case r.M:return n[4*(t-1)+1];case r.Q:return n[4*(t-1)+2];case r.H:return n[4*(t-1)+3];default:return}},e.getTotalCodewordsCount=function(t,e){switch(e){case r.L:return a[4*(t-1)+0];case r.M:return a[4*(t-1)+1];case r.Q:return a[4*(t-1)+2];case r.H:return a[4*(t-1)+3];default:return}}},53616:(t,e)=>{e.L={bit:1},e.M={bit:0},e.Q={bit:3},e.H={bit:2},e.isValid=function(t){return t&&void 0!==t.bit&&t.bit>=0&&t.bit<4},e.from=function(t,i){if(e.isValid(t))return t;try{return function(t){if("string"!=typeof t)throw new Error("Param is not a string");switch(t.toLowerCase()){case"l":case"low":return e.L;case"m":case"medium":return e.M;case"q":case"quartile":return e.Q;case"h":case"high":return e.H;default:throw new Error("Unknown EC Level: "+t)}}(t)}catch(t){return i}}},6027:(t,e,i)=>{const r=i(89436).getSymbolSize;e.getPositions=function(t){const e=r(t);return[[0,0],[e-7,0],[0,e-7]]}},30936:(t,e,i)=>{const r=i(89436),n=r.getBCHDigit(1335);e.getEncodedBits=function(t,e){const i=t.bit<<3|e;let a=i<<10;for(;r.getBCHDigit(a)-n>=0;)a^=1335<<r.getBCHDigit(a)-n;return 21522^(i<<10|a)}},85076:(t,e)=>{const i=new Uint8Array(512),r=new Uint8Array(256);!function(){let t=1;for(let e=0;e<255;e++)i[e]=t,r[t]=e,t<<=1,256&t&&(t^=285);for(let t=255;t<512;t++)i[t]=i[t-255]}(),e.log=function(t){if(t<1)throw new Error("log("+t+")");return r[t]},e.exp=function(t){return i[t]},e.mul=function(t,e){return 0===t||0===e?0:i[r[t]+r[e]]}},91744:(t,e,i)=>{const r=i(61768),n=i(89436);function a(t){this.mode=r.KANJI,this.data=t}a.getBitsLength=function(t){return 13*t},a.prototype.getLength=function(){return this.data.length},a.prototype.getBitsLength=function(){return a.getBitsLength(this.data.length)},a.prototype.write=function(t){let e;for(e=0;e<this.data.length;e++){let i=n.toSJIS(this.data[e]);if(i>=33088&&i<=40956)i-=33088;else{if(!(i>=57408&&i<=60351))throw new Error("Invalid SJIS character: "+this.data[e]+"\nMake sure your charset is UTF-8");i-=49472}i=192*(i>>>8&255)+(255&i),t.put(i,13)}},t.exports=a},73408:(t,e)=>{e.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const i=3,r=3,n=40,a=10;function o(t,i,r){switch(t){case e.Patterns.PATTERN000:return(i+r)%2==0;case e.Patterns.PATTERN001:return i%2==0;case e.Patterns.PATTERN010:return r%3==0;case e.Patterns.PATTERN011:return(i+r)%3==0;case e.Patterns.PATTERN100:return(Math.floor(i/2)+Math.floor(r/3))%2==0;case e.Patterns.PATTERN101:return i*r%2+i*r%3==0;case e.Patterns.PATTERN110:return(i*r%2+i*r%3)%2==0;case e.Patterns.PATTERN111:return(i*r%3+(i+r)%2)%2==0;default:throw new Error("bad maskPattern:"+t)}}e.isValid=function(t){return null!=t&&""!==t&&!isNaN(t)&&t>=0&&t<=7},e.from=function(t){return e.isValid(t)?parseInt(t,10):void 0},e.getPenaltyN1=function(t){const e=t.size;let r=0,n=0,a=0,o=null,s=null;for(let l=0;l<e;l++){n=a=0,o=s=null;for(let c=0;c<e;c++){let e=t.get(l,c);e===o?n++:(n>=5&&(r+=i+(n-5)),o=e,n=1),e=t.get(c,l),e===s?a++:(a>=5&&(r+=i+(a-5)),s=e,a=1)}n>=5&&(r+=i+(n-5)),a>=5&&(r+=i+(a-5))}return r},e.getPenaltyN2=function(t){const e=t.size;let i=0;for(let r=0;r<e-1;r++)for(let n=0;n<e-1;n++){const e=t.get(r,n)+t.get(r,n+1)+t.get(r+1,n)+t.get(r+1,n+1);4!==e&&0!==e||i++}return i*r},e.getPenaltyN3=function(t){const e=t.size;let i=0,r=0,a=0;for(let n=0;n<e;n++){r=a=0;for(let o=0;o<e;o++)r=r<<1&2047|t.get(n,o),o>=10&&(1488===r||93===r)&&i++,a=a<<1&2047|t.get(o,n),o>=10&&(1488===a||93===a)&&i++}return i*n},e.getPenaltyN4=function(t){let e=0;const i=t.data.length;for(let r=0;r<i;r++)e+=t.data[r];return Math.abs(Math.ceil(100*e/i/5)-10)*a},e.applyMask=function(t,e){const i=e.size;for(let r=0;r<i;r++)for(let n=0;n<i;n++)e.isReserved(n,r)||e.xor(n,r,o(t,n,r))},e.getBestMask=function(t,i){const r=Object.keys(e.Patterns).length;let n=0,a=1/0;for(let o=0;o<r;o++){i(o),e.applyMask(o,t);const r=e.getPenaltyN1(t)+e.getPenaltyN2(t)+e.getPenaltyN3(t)+e.getPenaltyN4(t);e.applyMask(o,t),r<a&&(a=r,n=o)}return n}},61768:(t,e,i)=>{const r=i(63273),n=i(71664);e.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},e.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},e.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},e.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},e.MIXED={bit:-1},e.getCharCountIndicator=function(t,e){if(!t.ccBits)throw new Error("Invalid mode: "+t);if(!r.isValid(e))throw new Error("Invalid version: "+e);return e>=1&&e<10?t.ccBits[0]:e<27?t.ccBits[1]:t.ccBits[2]},e.getBestModeForData=function(t){return n.testNumeric(t)?e.NUMERIC:n.testAlphanumeric(t)?e.ALPHANUMERIC:n.testKanji(t)?e.KANJI:e.BYTE},e.toString=function(t){if(t&&t.id)return t.id;throw new Error("Invalid mode")},e.isValid=function(t){return t&&t.bit&&t.ccBits},e.from=function(t,i){if(e.isValid(t))return t;try{return function(t){if("string"!=typeof t)throw new Error("Param is not a string");switch(t.toLowerCase()){case"numeric":return e.NUMERIC;case"alphanumeric":return e.ALPHANUMERIC;case"kanji":return e.KANJI;case"byte":return e.BYTE;default:throw new Error("Unknown mode: "+t)}}(t)}catch(t){return i}}},1512:(t,e,i)=>{const r=i(61768);function n(t){this.mode=r.NUMERIC,this.data=t.toString()}n.getBitsLength=function(t){return 10*Math.floor(t/3)+(t%3?t%3*3+1:0)},n.prototype.getLength=function(){return this.data.length},n.prototype.getBitsLength=function(){return n.getBitsLength(this.data.length)},n.prototype.write=function(t){let e,i,r;for(e=0;e+3<=this.data.length;e+=3)i=this.data.substr(e,3),r=parseInt(i,10),t.put(r,10);const n=this.data.length-e;n>0&&(i=this.data.substr(e),r=parseInt(i,10),t.put(r,3*n+1))},t.exports=n},44688:(t,e,i)=>{const r=i(85076);e.mul=function(t,e){const i=new Uint8Array(t.length+e.length-1);for(let n=0;n<t.length;n++)for(let a=0;a<e.length;a++)i[n+a]^=r.mul(t[n],e[a]);return i},e.mod=function(t,e){let i=new Uint8Array(t);for(;i.length-e.length>=0;){const t=i[0];for(let n=0;n<e.length;n++)i[n]^=r.mul(e[n],t);let n=0;for(;n<i.length&&0===i[n];)n++;i=i.slice(n)}return i},e.generateECPolynomial=function(t){let i=new Uint8Array([1]);for(let n=0;n<t;n++)i=e.mul(i,new Uint8Array([1,r.exp(n)]));return i}},10688:(t,e,i)=>{const r=i(89436),n=i(53616),a=i(63880),o=i(67075),s=i(48120),l=i(6027),c=i(73408),h=i(16496),u=i(4988),d=i(34024),p=i(30936),m=i(61768),f=i(10048);function g(t,e,i){const r=t.size,n=p.getEncodedBits(e,i);let a,o;for(a=0;a<15;a++)o=1==(n>>a&1),a<6?t.set(a,8,o,!0):a<8?t.set(a+1,8,o,!0):t.set(r-15+a,8,o,!0),a<8?t.set(8,r-a-1,o,!0):a<9?t.set(8,15-a-1+1,o,!0):t.set(8,15-a-1,o,!0);t.set(r-8,8,1,!0)}function y(t,e,i){const n=new a;i.forEach((function(e){n.put(e.mode.bit,4),n.put(e.getLength(),m.getCharCountIndicator(e.mode,t)),e.write(n)}));const o=8*(r.getSymbolTotalCodewords(t)-h.getTotalCodewordsCount(t,e));for(n.getLengthInBits()+4<=o&&n.put(0,4);n.getLengthInBits()%8!=0;)n.putBit(0);const s=(o-n.getLengthInBits())/8;for(let t=0;t<s;t++)n.put(t%2?17:236,8);return function(t,e,i){const n=r.getSymbolTotalCodewords(e),a=h.getTotalCodewordsCount(e,i),o=n-a,s=h.getBlocksCount(e,i),l=n%s,c=s-l,d=Math.floor(n/s),p=Math.floor(o/s),m=p+1,f=d-p,g=new u(f);let y=0;const _=new Array(s),v=new Array(s);let b=0;const x=new Uint8Array(t.buffer);for(let t=0;t<s;t++){const e=t<c?p:m;_[t]=x.slice(y,y+e),v[t]=g.encode(_[t]),y+=e,b=Math.max(b,e)}const w=new Uint8Array(n);let S,k,C=0;for(S=0;S<b;S++)for(k=0;k<s;k++)S<_[k].length&&(w[C++]=_[k][S]);for(S=0;S<f;S++)for(k=0;k<s;k++)w[C++]=v[k][S];return w}(n,t,e)}function _(t,e,i,n){let a;if(Array.isArray(t))a=f.fromArray(t);else{if("string"!=typeof t)throw new Error("Invalid data");{let r=e;if(!r){const e=f.rawSplit(t);r=d.getBestVersionForData(e,i)}a=f.fromString(t,r||40)}}const h=d.getBestVersionForData(a,i);if(!h)throw new Error("The amount of data is too big to be stored in a QR Code");if(e){if(e<h)throw new Error("\nThe chosen QR Code version cannot contain this amount of data.\nMinimum version required to store current data is: "+h+".\n")}else e=h;const u=y(e,i,a),p=r.getSymbolSize(e),m=new o(p);return function(t,e){const i=t.size,r=l.getPositions(e);for(let e=0;e<r.length;e++){const n=r[e][0],a=r[e][1];for(let e=-1;e<=7;e++)if(!(n+e<=-1||i<=n+e))for(let r=-1;r<=7;r++)a+r<=-1||i<=a+r||(e>=0&&e<=6&&(0===r||6===r)||r>=0&&r<=6&&(0===e||6===e)||e>=2&&e<=4&&r>=2&&r<=4?t.set(n+e,a+r,!0,!0):t.set(n+e,a+r,!1,!0))}}(m,e),function(t){const e=t.size;for(let i=8;i<e-8;i++){const e=i%2==0;t.set(i,6,e,!0),t.set(6,i,e,!0)}}(m),function(t,e){const i=s.getPositions(e);for(let e=0;e<i.length;e++){const r=i[e][0],n=i[e][1];for(let e=-2;e<=2;e++)for(let i=-2;i<=2;i++)-2===e||2===e||-2===i||2===i||0===e&&0===i?t.set(r+e,n+i,!0,!0):t.set(r+e,n+i,!1,!0)}}(m,e),g(m,i,0),e>=7&&function(t,e){const i=t.size,r=d.getEncodedBits(e);let n,a,o;for(let e=0;e<18;e++)n=Math.floor(e/3),a=e%3+i-8-3,o=1==(r>>e&1),t.set(n,a,o,!0),t.set(a,n,o,!0)}(m,e),function(t,e){const i=t.size;let r=-1,n=i-1,a=7,o=0;for(let s=i-1;s>0;s-=2)for(6===s&&s--;;){for(let i=0;i<2;i++)if(!t.isReserved(n,s-i)){let r=!1;o<e.length&&(r=1==(e[o]>>>a&1)),t.set(n,s-i,r),a--,-1===a&&(o++,a=7)}if(n+=r,n<0||i<=n){n-=r,r=-r;break}}}(m,u),isNaN(n)&&(n=c.getBestMask(m,g.bind(null,m,i))),c.applyMask(n,m),g(m,i,n),{modules:m,version:e,errorCorrectionLevel:i,maskPattern:n,segments:a}}e.create=function(t,e){if(void 0===t||""===t)throw new Error("No input text");let i,a,o=n.M;return void 0!==e&&(o=n.from(e.errorCorrectionLevel,n.M),i=d.from(e.version),a=c.from(e.maskPattern),e.toSJISFunc&&r.setToSJISFunction(e.toSJISFunc)),_(t,i,o,a)}},4988:(t,e,i)=>{const r=i(44688);function n(t){this.genPoly=void 0,this.degree=t,this.degree&&this.initialize(this.degree)}n.prototype.initialize=function(t){this.degree=t,this.genPoly=r.generateECPolynomial(this.degree)},n.prototype.encode=function(t){if(!this.genPoly)throw new Error("Encoder not initialized");const e=new Uint8Array(t.length+this.degree);e.set(t);const i=r.mod(e,this.genPoly),n=this.degree-i.length;if(n>0){const t=new Uint8Array(this.degree);return t.set(i,n),t}return i},t.exports=n},71664:(t,e)=>{const i="[0-9]+";let r="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";r=r.replace(/u/g,"\\u");const n="(?:(?![A-Z0-9 $%*+\\-./:]|"+r+")(?:.|[\r\n]))+";e.KANJI=new RegExp(r,"g"),e.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),e.BYTE=new RegExp(n,"g"),e.NUMERIC=new RegExp(i,"g"),e.ALPHANUMERIC=new RegExp("[A-Z $%*+\\-./:]+","g");const a=new RegExp("^"+r+"$"),o=new RegExp("^"+i+"$"),s=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");e.testKanji=function(t){return a.test(t)},e.testNumeric=function(t){return o.test(t)},e.testAlphanumeric=function(t){return s.test(t)}},10048:(t,e,i)=>{const r=i(61768),n=i(1512),a=i(18512),o=i(12032),s=i(91744),l=i(71664),c=i(89436),h=i(91928);function u(t){return unescape(encodeURIComponent(t)).length}function d(t,e,i){const r=[];let n;for(;null!==(n=t.exec(i));)r.push({data:n[0],index:n.index,mode:e,length:n[0].length});return r}function p(t){const e=d(l.NUMERIC,r.NUMERIC,t),i=d(l.ALPHANUMERIC,r.ALPHANUMERIC,t);let n,a;c.isKanjiModeEnabled()?(n=d(l.BYTE,r.BYTE,t),a=d(l.KANJI,r.KANJI,t)):(n=d(l.BYTE_KANJI,r.BYTE,t),a=[]);return e.concat(i,n,a).sort((function(t,e){return t.index-e.index})).map((function(t){return{data:t.data,mode:t.mode,length:t.length}}))}function m(t,e){switch(e){case r.NUMERIC:return n.getBitsLength(t);case r.ALPHANUMERIC:return a.getBitsLength(t);case r.KANJI:return s.getBitsLength(t);case r.BYTE:return o.getBitsLength(t)}}function f(t,e){let i;const l=r.getBestModeForData(t);if(i=r.from(e,l),i!==r.BYTE&&i.bit<l.bit)throw new Error('"'+t+'" cannot be encoded with mode '+r.toString(i)+".\n Suggested mode is: "+r.toString(l));switch(i!==r.KANJI||c.isKanjiModeEnabled()||(i=r.BYTE),i){case r.NUMERIC:return new n(t);case r.ALPHANUMERIC:return new a(t);case r.KANJI:return new s(t);case r.BYTE:return new o(t)}}e.fromArray=function(t){return t.reduce((function(t,e){return"string"==typeof e?t.push(f(e,null)):e.data&&t.push(f(e.data,e.mode)),t}),[])},e.fromString=function(t,i){const n=function(t){const e=[];for(let i=0;i<t.length;i++){const n=t[i];switch(n.mode){case r.NUMERIC:e.push([n,{data:n.data,mode:r.ALPHANUMERIC,length:n.length},{data:n.data,mode:r.BYTE,length:n.length}]);break;case r.ALPHANUMERIC:e.push([n,{data:n.data,mode:r.BYTE,length:n.length}]);break;case r.KANJI:e.push([n,{data:n.data,mode:r.BYTE,length:u(n.data)}]);break;case r.BYTE:e.push([{data:n.data,mode:r.BYTE,length:u(n.data)}])}}return e}(p(t,c.isKanjiModeEnabled())),a=function(t,e){const i={},n={start:{}};let a=["start"];for(let o=0;o<t.length;o++){const s=t[o],l=[];for(let t=0;t<s.length;t++){const c=s[t],h=""+o+t;l.push(h),i[h]={node:c,lastCount:0},n[h]={};for(let t=0;t<a.length;t++){const o=a[t];i[o]&&i[o].node.mode===c.mode?(n[o][h]=m(i[o].lastCount+c.length,c.mode)-m(i[o].lastCount,c.mode),i[o].lastCount+=c.length):(i[o]&&(i[o].lastCount=c.length),n[o][h]=m(c.length,c.mode)+4+r.getCharCountIndicator(c.mode,e))}}a=l}for(let t=0;t<a.length;t++)n[a[t]].end=0;return{map:n,table:i}}(n,i),o=h.find_path(a.map,"start","end"),s=[];for(let t=1;t<o.length-1;t++)s.push(a.table[o[t]].node);return e.fromArray(function(t){return t.reduce((function(t,e){const i=t.length-1>=0?t[t.length-1]:null;return i&&i.mode===e.mode?(t[t.length-1].data+=e.data,t):(t.push(e),t)}),[])}(s))},e.rawSplit=function(t){return e.fromArray(p(t,c.isKanjiModeEnabled()))}},89436:(t,e)=>{let i;const r=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];e.getSymbolSize=function(t){if(!t)throw new Error('"version" cannot be null or undefined');if(t<1||t>40)throw new Error('"version" should be in range from 1 to 40');return 4*t+17},e.getSymbolTotalCodewords=function(t){return r[t]},e.getBCHDigit=function(t){let e=0;for(;0!==t;)e++,t>>>=1;return e},e.setToSJISFunction=function(t){if("function"!=typeof t)throw new Error('"toSJISFunc" is not a valid function.');i=t},e.isKanjiModeEnabled=function(){return void 0!==i},e.toSJIS=function(t){return i(t)}},63273:(t,e)=>{e.isValid=function(t){return!isNaN(t)&&t>=1&&t<=40}},34024:(t,e,i)=>{const r=i(89436),n=i(16496),a=i(53616),o=i(61768),s=i(63273),l=r.getBCHDigit(7973);function c(t,e){return o.getCharCountIndicator(t,e)+4}function h(t,e){let i=0;return t.forEach((function(t){const r=c(t.mode,e);i+=r+t.getBitsLength()})),i}e.from=function(t,e){return s.isValid(t)?parseInt(t,10):e},e.getCapacity=function(t,e,i){if(!s.isValid(t))throw new Error("Invalid QR Code version");void 0===i&&(i=o.BYTE);const a=8*(r.getSymbolTotalCodewords(t)-n.getTotalCodewordsCount(t,e));if(i===o.MIXED)return a;const l=a-c(i,t);switch(i){case o.NUMERIC:return Math.floor(l/10*3);case o.ALPHANUMERIC:return Math.floor(l/11*2);case o.KANJI:return Math.floor(l/13);case o.BYTE:default:return Math.floor(l/8)}},e.getBestVersionForData=function(t,i){let r;const n=a.from(i,a.M);if(Array.isArray(t)){if(t.length>1)return function(t,i){for(let r=1;r<=40;r++)if(h(t,r)<=e.getCapacity(r,i,o.MIXED))return r}(t,n);if(0===t.length)return 1;r=t[0]}else r=t;return function(t,i,r){for(let n=1;n<=40;n++)if(i<=e.getCapacity(n,r,t))return n}(r.mode,r.getLength(),n)},e.getEncodedBits=function(t){if(!s.isValid(t)||t<7)throw new Error("Invalid QR Code version");let e=t<<12;for(;r.getBCHDigit(e)-l>=0;)e^=7973<<r.getBCHDigit(e)-l;return t<<12|e}},87071:(t,e,i)=>{const r=i(28648);e.render=function(t,e,i){let n=i,a=e;void 0!==n||e&&e.getContext||(n=e,e=void 0),e||(a=function(){try{return document.createElement("canvas")}catch(t){throw new Error("You need to specify a canvas element")}}()),n=r.getOptions(n);const o=r.getImageWidth(t.modules.size,n),s=a.getContext("2d"),l=s.createImageData(o,o);return r.qrToImageData(l.data,t,n),function(t,e,i){t.clearRect(0,0,e.width,e.height),e.style||(e.style={}),e.height=i,e.width=i,e.style.height=i+"px",e.style.width=i+"px"}(s,a,o),s.putImageData(l,0,0),a},e.renderToDataURL=function(t,i,r){let n=r;void 0!==n||i&&i.getContext||(n=i,i=void 0),n||(n={});const a=e.render(t,i,n),o=n.type||"image/png",s=n.rendererOpts||{};return a.toDataURL(o,s.quality)}},66756:(t,e,i)=>{const r=i(28648);function n(t,e){const i=t.a/255,r=e+'="'+t.hex+'"';return i<1?r+" "+e+'-opacity="'+i.toFixed(2).slice(1)+'"':r}function a(t,e,i){let r=t+e;return void 0!==i&&(r+=" "+i),r}e.render=function(t,e,i){const o=r.getOptions(e),s=t.modules.size,l=t.modules.data,c=s+2*o.margin,h=o.color.light.a?"<path "+n(o.color.light,"fill")+' d="M0 0h'+c+"v"+c+'H0z"/>':"",u="<path "+n(o.color.dark,"stroke")+' d="'+function(t,e,i){let r="",n=0,o=!1,s=0;for(let l=0;l<t.length;l++){const c=Math.floor(l%e),h=Math.floor(l/e);c||o||(o=!0),t[l]?(s++,l>0&&c>0&&t[l-1]||(r+=o?a("M",c+i,.5+h+i):a("m",n,0),n=0,o=!1),c+1<e&&t[l+1]||(r+=a("h",s),s=0)):n++}return r}(l,s,o.margin)+'"/>',d='viewBox="0 0 '+c+" "+c+'"',p='<svg xmlns="http://www.w3.org/2000/svg" '+(o.width?'width="'+o.width+'" height="'+o.width+'" ':"")+d+' shape-rendering="crispEdges">'+h+u+"</svg>\n";return"function"==typeof i&&i(null,p),p}},28648:(t,e)=>{function i(t){if("number"==typeof t&&(t=t.toString()),"string"!=typeof t)throw new Error("Color should be defined as hex string");let e=t.slice().replace("#","").split("");if(e.length<3||5===e.length||e.length>8)throw new Error("Invalid hex color: "+t);3!==e.length&&4!==e.length||(e=Array.prototype.concat.apply([],e.map((function(t){return[t,t]})))),6===e.length&&e.push("F","F");const i=parseInt(e.join(""),16);return{r:i>>24&255,g:i>>16&255,b:i>>8&255,a:255&i,hex:"#"+e.slice(0,6).join("")}}e.getOptions=function(t){t||(t={}),t.color||(t.color={});const e=void 0===t.margin||null===t.margin||t.margin<0?4:t.margin,r=t.width&&t.width>=21?t.width:void 0,n=t.scale||4;return{width:r,scale:r?4:n,margin:e,color:{dark:i(t.color.dark||"#000000ff"),light:i(t.color.light||"#ffffffff")},type:t.type,rendererOpts:t.rendererOpts||{}}},e.getScale=function(t,e){return e.width&&e.width>=t+2*e.margin?e.width/(t+2*e.margin):e.scale},e.getImageWidth=function(t,i){const r=e.getScale(t,i);return Math.floor((t+2*i.margin)*r)},e.qrToImageData=function(t,i,r){const n=i.modules.size,a=i.modules.data,o=e.getScale(n,r),s=Math.floor((n+2*r.margin)*o),l=r.margin*o,c=[r.color.light,r.color.dark];for(let e=0;e<s;e++)for(let i=0;i<s;i++){let h=4*(e*s+i),u=r.color.light;if(e>=l&&i>=l&&e<s-l&&i<s-l){u=c[a[Math.floor((e-l)/o)*n+Math.floor((i-l)/o)]?1:0]}t[h++]=u.r,t[h++]=u.g,t[h++]=u.b,t[h]=u.a}}},28352:(t,e,i)=>{"use strict";var r=i(81034);e.C=r.createRoot,r.hydrateRoot},59764:(t,e)=>{"use strict";var i,r=Symbol.for("react.element"),n=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),c=Symbol.for("react.context"),h=Symbol.for("react.server_context"),u=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),p=Symbol.for("react.suspense_list"),m=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),g=Symbol.for("react.offscreen");
/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */function y(t){if("object"==typeof t&&null!==t){var e=t.$$typeof;switch(e){case r:switch(t=t.type){case a:case s:case o:case d:case p:return t;default:switch(t=t&&t.$$typeof){case h:case c:case u:case f:case m:case l:return t;default:return e}}case n:return e}}}i=Symbol.for("react.module.reference"),e.isValidElementType=function(t){return"string"==typeof t||"function"==typeof t||t===a||t===s||t===o||t===d||t===p||t===g||"object"==typeof t&&null!==t&&(t.$$typeof===f||t.$$typeof===m||t.$$typeof===l||t.$$typeof===c||t.$$typeof===u||t.$$typeof===i||void 0!==t.getModuleId)},e.typeOf=y},62168:(t,e,i)=>{"use strict";t.exports=i(59764)},21072:t=>{t.exports=function(t,e,i,r){var n=i?i.call(r,t,e):void 0;if(void 0!==n)return!!n;if(t===e)return!0;if("object"!=typeof t||!t||"object"!=typeof e||!e)return!1;var a=Object.keys(t),o=Object.keys(e);if(a.length!==o.length)return!1;for(var s=Object.prototype.hasOwnProperty.bind(e),l=0;l<a.length;l++){var c=a[l];if(!s(c))return!1;var h=t[c],u=e[c];if(!1===(n=i?i.call(r,h,u,c):void 0)||void 0===n&&h!==u)return!1}return!0}},81034:t=>{"use strict";t.exports=window.ReactDOM},49416:function(t){t.exports=function(){"use strict";var t,e,i;function r(r,n){if(t)if(e){var a="var sharedChunk = {}; ("+t+")(sharedChunk); ("+e+")(sharedChunk);",o={};t(o),i=n(o),"undefined"!=typeof window&&(i.workerUrl=window.URL.createObjectURL(new Blob([a],{type:"text/javascript"})))}else e=n;else t=n}return r(["exports"],(function(t){function e(t,e,i,r){return new(i||(i=Promise))((function(n,a){function o(t){try{l(r.next(t))}catch(t){a(t)}}function s(t){try{l(r.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,s)}l((r=r.apply(t,e||[])).next())}))}function i(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}"function"==typeof SuppressedError&&SuppressedError;var r=n;function n(t,e){this.x=t,this.y=e}n.prototype={clone:function(){return new n(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,i=t.y-this.y;return e*e+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=e,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),i=Math.sin(t),r=i*this.x+e*this.y;return this.x=e*this.x-i*this.y,this.y=r,this},_rotateAround:function(t,e){var i=Math.cos(t),r=Math.sin(t),n=e.y+r*(this.x-e.x)+i*(this.y-e.y);return this.x=e.x+i*(this.x-e.x)-r*(this.y-e.y),this.y=n,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},n.convert=function(t){return t instanceof n?t:Array.isArray(t)?new n(t[0],t[1]):t};var a=i(r),o=s;function s(t,e,i,r){this.cx=3*t,this.bx=3*(i-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(r-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=e,this.p2x=i,this.p2y=r}s.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,e){if(void 0===e&&(e=1e-6),t<0)return 0;if(t>1)return 1;for(var i=t,r=0;r<8;r++){var n=this.sampleCurveX(i)-t;if(Math.abs(n)<e)return i;var a=this.sampleCurveDerivativeX(i);if(Math.abs(a)<1e-6)break;i-=n/a}var o=0,s=1;for(i=t,r=0;r<20&&(n=this.sampleCurveX(i),!(Math.abs(n-t)<e));r++)t>n?o=i:s=i,i=.5*(s-o)+o;return i},solve:function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))}};var l=i(o);let c,h;function u(){return null==c&&(c="undefined"!=typeof OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof createImageBitmap),c}function d(){if(null==h&&(h=!1,u())){const t=5,e=new OffscreenCanvas(t,t).getContext("2d",{willReadFrequently:!0});if(e){for(let i=0;i<t*t;i++){const r=4*i;e.fillStyle=`rgb(${r},${r+1},${r+2})`,e.fillRect(i%t,Math.floor(i/t),1,1)}const i=e.getImageData(0,0,t,t).data;for(let e=0;e<t*t*4;e++)if(e%4!=3&&i[e]!==e){h=!0;break}}}return h||!1}function p(t,e,i,r){const n=new l(t,e,i,r);return function(t){return n.solve(t)}}const m=p(.25,.1,.25,1);function f(t,e,i){return Math.min(i,Math.max(e,t))}function g(t,e,i){const r=i-e,n=((t-e)%r+r)%r+e;return n===e?i:n}function y(t,...e){for(const i of e)for(const e in i)t[e]=i[e];return t}let _=1;function v(t,e,i){const r={};for(const n in t)r[n]=e.call(i||this,t[n],n,t);return r}function b(t,e,i){const r={};for(const n in t)e.call(i||this,t[n],n,t)&&(r[n]=t[n]);return r}function x(t){return Array.isArray(t)?t.map(x):"object"==typeof t&&t?v(t,x):t}const w={};function S(t){w[t]||("undefined"!=typeof console&&console.warn(t),w[t]=!0)}function k(t,e,i){return(i.y-t.y)*(e.x-t.x)>(e.y-t.y)*(i.x-t.x)}function C(t){let e=0;for(let i,r,n=0,a=t.length,o=a-1;n<a;o=n++)i=t[n],r=t[o],e+=(r.x-i.x)*(i.y+r.y);return e}function A(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}let T=null;function E(t){return"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap}const M="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function I(t,i,r,n,a){return e(this,void 0,void 0,(function*(){if("undefined"==typeof VideoFrame)throw new Error("VideoFrame not supported");const e=new VideoFrame(t,{timestamp:0});try{const o=null==e?void 0:e.format;if(!o||!o.startsWith("BGR")&&!o.startsWith("RGB"))throw new Error(`Unrecognized format ${o}`);const s=o.startsWith("BGR"),l=new Uint8ClampedArray(n*a*4);if(yield e.copyTo(l,function(t,e,i,r,n){const a=4*Math.max(-e,0),o=(Math.max(0,i)-i)*r*4+a,s=4*r,l=Math.max(0,e),c=Math.max(0,i);return{rect:{x:l,y:c,width:Math.min(t.width,e+r)-l,height:Math.min(t.height,i+n)-c},layout:[{offset:o,stride:s}]}}(t,i,r,n,a)),s)for(let t=0;t<l.length;t+=4){const e=l[t];l[t]=l[t+2],l[t+2]=e}return l}finally{e.close()}}))}let z,P,L,D;const R={now:"undefined"!=typeof performance&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(t){const e=requestAnimationFrame(t);return{cancel:()=>cancelAnimationFrame(e)}},getImageData(t,e=0){return this.getImageCanvasContext(t).getImageData(-e,-e,t.width+2*e,t.height+2*e)},getImageCanvasContext(t){const e=window.document.createElement("canvas"),i=e.getContext("2d",{willReadFrequently:!0});if(!i)throw new Error("failed to create canvas 2d context");return e.width=t.width,e.height=t.height,i.drawImage(t,0,0,t.width,t.height),i},resolveURL:t=>(L||(L=document.createElement("a")),L.href=t,L.href),hardwareConcurrency:"undefined"!=typeof navigator&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(null==D&&(D=matchMedia("(prefers-reduced-motion: reduce)")),D.matches)}},B={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};class F extends Error{constructor(t,e,i,r){super(`AJAXError: ${e} (${t}): ${i}`),this.status=t,this.statusText=e,this.url=i,this.body=r}}const O=A()?()=>self.worker&&self.worker.referrer:()=>("blob:"===window.location.protocol?window.parent:window).location.href,$=t=>B.REGISTERED_PROTOCOLS[t.substring(0,t.indexOf("://"))];function V(t,e){const i=new AbortController,r=new Request(t.url,{method:t.method||"GET",body:t.body,credentials:t.credentials,headers:t.headers,cache:t.cache,referrer:O(),signal:i.signal});let n=!1,a=!1;return"json"===t.type&&r.headers.set("Accept","application/json"),a||fetch(r).then((i=>i.ok?(i=>{("arrayBuffer"===t.type||"image"===t.type?i.arrayBuffer():"json"===t.type?i.json():i.text()).then((t=>{a||(n=!0,e(null,t,i.headers.get("Cache-Control"),i.headers.get("Expires")))})).catch((t=>{a||e(new Error(t.message))}))})(i):i.blob().then((r=>e(new F(i.status,i.statusText,t.url,r)))))).catch((t=>{20!==t.code&&e(new Error(t.message))})),{cancel:()=>{a=!0,n||i.abort()}}}const N=function(t,e){if(/:\/\//.test(t.url)&&!/^https?:|^file:/.test(t.url)){if(A()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,e);if(!A())return($(t.url)||V)(t,e)}if(!(/^file:/.test(i=t.url)||/^file:/.test(O())&&!/^\w+:/.test(i))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return V(t,e);if(A()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,e,void 0,!0)}var i;return function(t,e){const i=new XMLHttpRequest;i.open(t.method||"GET",t.url,!0),"arrayBuffer"!==t.type&&"image"!==t.type||(i.responseType="arraybuffer");for(const e in t.headers)i.setRequestHeader(e,t.headers[e]);return"json"===t.type&&(i.responseType="text",i.setRequestHeader("Accept","application/json")),i.withCredentials="include"===t.credentials,i.onerror=()=>{e(new Error(i.statusText))},i.onload=()=>{if((i.status>=200&&i.status<300||0===i.status)&&null!==i.response){let r=i.response;if("json"===t.type)try{r=JSON.parse(i.response)}catch(t){return e(t)}e(null,r,i.getResponseHeader("Cache-Control"),i.getResponseHeader("Expires"))}else{const r=new Blob([i.response],{type:i.getResponseHeader("Content-Type")});e(new F(i.status,i.statusText,t.url,r))}},i.send(t.body),{cancel:()=>i.abort()}}(t,e)},j=function(t,e){return N(y(t,{type:"arrayBuffer"}),e)};function U(t){if(!t||t.indexOf("://")<=0||0===t.indexOf("data:image/")||0===t.indexOf("blob:"))return!0;const e=new URL(t),i=window.location;return e.protocol===i.protocol&&e.host===i.host}function Z(t,e,i){i[t]&&-1!==i[t].indexOf(e)||(i[t]=i[t]||[],i[t].push(e))}function H(t,e,i){if(i&&i[t]){const r=i[t].indexOf(e);-1!==r&&i[t].splice(r,1)}}class q{constructor(t,e={}){y(this,e),this.type=t}}class G extends q{constructor(t,e={}){super("error",y({error:t},e))}}class W{on(t,e){return this._listeners=this._listeners||{},Z(t,e,this._listeners),this}off(t,e){return H(t,e,this._listeners),H(t,e,this._oneTimeListeners),this}once(t,e){return e?(this._oneTimeListeners=this._oneTimeListeners||{},Z(t,e,this._oneTimeListeners),this):new Promise((e=>this.once(t,e)))}fire(t,e){"string"==typeof t&&(t=new q(t,e||{}));const i=t.type;if(this.listens(i)){t.target=this;const e=this._listeners&&this._listeners[i]?this._listeners[i].slice():[];for(const i of e)i.call(this,t);const r=this._oneTimeListeners&&this._oneTimeListeners[i]?this._oneTimeListeners[i].slice():[];for(const e of r)H(i,e,this._oneTimeListeners),e.call(this,t);const n=this._eventedParent;n&&(y(t,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),n.fire(t))}else t instanceof G&&console.error(t.error);return this}listens(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)}setEventedParent(t,e){return this._eventedParent=t,this._eventedParentData=e,this}}var X={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const K=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function J(t,e){const i={};for(const e in t)"ref"!==e&&(i[e]=t[e]);return K.forEach((t=>{t in e&&(i[t]=e[t])})),i}function Y(t,e){if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(!Y(t[i],e[i]))return!1;return!0}if("object"==typeof t&&null!==t&&null!==e){if("object"!=typeof e)return!1;if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const i in t)if(!Y(t[i],e[i]))return!1;return!0}return t===e}const Q={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function tt(t,e,i){i.push({command:Q.addSource,args:[t,e[t]]})}function et(t,e,i){e.push({command:Q.removeSource,args:[t]}),i[t]=!0}function it(t,e,i,r){et(t,i,r),tt(t,e,i)}function rt(t,e,i){let r;for(r in t[i])if(Object.prototype.hasOwnProperty.call(t[i],r)&&"data"!==r&&!Y(t[i][r],e[i][r]))return!1;for(r in e[i])if(Object.prototype.hasOwnProperty.call(e[i],r)&&"data"!==r&&!Y(t[i][r],e[i][r]))return!1;return!0}function nt(t,e,i,r,n,a){let o;for(o in e=e||{},t=t||{})Object.prototype.hasOwnProperty.call(t,o)&&(Y(t[o],e[o])||i.push({command:a,args:[r,o,e[o],n]}));for(o in e)Object.prototype.hasOwnProperty.call(e,o)&&!Object.prototype.hasOwnProperty.call(t,o)&&(Y(t[o],e[o])||i.push({command:a,args:[r,o,e[o],n]}))}function at(t){return t.id}function ot(t,e){return t[e.id]=e,t}class st{constructor(t,e,i,r){this.message=(t?`${t}: `:"")+i,r&&(this.identifier=r),null!=e&&e.__line__&&(this.line=e.__line__)}}function lt(t,...e){for(const i of e)for(const e in i)t[e]=i[e];return t}class ct extends Error{constructor(t,e){super(e),this.message=e,this.key=t}}class ht{constructor(t,e=[]){this.parent=t,this.bindings={};for(const[t,i]of e)this.bindings[t]=i}concat(t){return new ht(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const ut={kind:"null"},dt={kind:"number"},pt={kind:"string"},mt={kind:"boolean"},ft={kind:"color"},gt={kind:"object"},yt={kind:"value"},_t={kind:"collator"},vt={kind:"formatted"},bt={kind:"padding"},xt={kind:"resolvedImage"},wt={kind:"variableAnchorOffsetCollection"};function St(t,e){return{kind:"array",itemType:t,N:e}}function kt(t){if("array"===t.kind){const e=kt(t.itemType);return"number"==typeof t.N?`array<${e}, ${t.N}>`:"value"===t.itemType.kind?"array":`array<${e}>`}return t.kind}const Ct=[ut,dt,pt,mt,ft,vt,gt,St(yt),bt,xt,wt];function At(t,e){if("error"===e.kind)return null;if("array"===t.kind){if("array"===e.kind&&(0===e.N&&"value"===e.itemType.kind||!At(t.itemType,e.itemType))&&("number"!=typeof t.N||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if("value"===t.kind)for(const t of Ct)if(!At(t,e))return null}return`Expected ${kt(t)} but found ${kt(e)} instead.`}function Tt(t,e){return e.some((e=>e.kind===t.kind))}function Et(t,e){return e.some((e=>"null"===e?null===t:"array"===e?Array.isArray(t):"object"===e?t&&!Array.isArray(t)&&"object"==typeof t:e===typeof t))}function Mt(t,e){return"array"===t.kind&&"array"===e.kind?t.itemType.kind===e.itemType.kind&&"number"==typeof t.N:t.kind===e.kind}const It=.96422,zt=.82521,Pt=4/29,Lt=6/29,Dt=3*Lt*Lt,Rt=Lt*Lt*Lt,Bt=Math.PI/180,Ft=180/Math.PI;function Ot(t){return(t%=360)<0&&(t+=360),t}function $t([t,e,i,r]){let n,a;const o=Nt((.2225045*(t=Vt(t))+.7168786*(e=Vt(e))+.0606169*(i=Vt(i)))/1);t===e&&e===i?n=a=o:(n=Nt((.4360747*t+.3850649*e+.1430804*i)/It),a=Nt((.0139322*t+.0971045*e+.7141733*i)/zt));const s=116*o-16;return[s<0?0:s,500*(n-o),200*(o-a),r]}function Vt(t){return t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Nt(t){return t>Rt?Math.pow(t,1/3):t/Dt+Pt}function jt([t,e,i,r]){let n=(t+16)/116,a=isNaN(e)?n:n+e/500,o=isNaN(i)?n:n-i/200;return n=1*Zt(n),a=It*Zt(a),o=zt*Zt(o),[Ut(3.1338561*a-1.6168667*n-.4906146*o),Ut(-.9787684*a+1.9161415*n+.033454*o),Ut(.0719453*a-.2289914*n+1.4052427*o),r]}function Ut(t){return(t=t<=.00304?12.92*t:1.055*Math.pow(t,1/2.4)-.055)<0?0:t>1?1:t}function Zt(t){return t>Lt?t*t*t:Dt*(t-Pt)}function Ht(t){return parseInt(t.padEnd(2,t),16)/255}function qt(t,e){return Gt(e?t/100:t,0,1)}function Gt(t,e,i){return Math.min(Math.max(e,t),i)}function Wt(t){return!t.some(Number.isNaN)}const Xt={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class Kt{constructor(t,e,i,r=1,n=!0){this.r=t,this.g=e,this.b=i,this.a=r,n||(this.r*=r,this.g*=r,this.b*=r,r||this.overwriteGetter("rgb",[t,e,i,r]))}static parse(t){if(t instanceof Kt)return t;if("string"!=typeof t)return;const e=function(t){if("transparent"===(t=t.toLowerCase().trim()))return[0,0,0,0];const e=Xt[t];if(e){const[t,i,r]=e;return[t/255,i/255,r/255,1]}if(t.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(t)){const e=t.length<6?1:2;let i=1;return[Ht(t.slice(i,i+=e)),Ht(t.slice(i,i+=e)),Ht(t.slice(i,i+=e)),Ht(t.slice(i,i+e)||"ff")]}if(t.startsWith("rgb")){const e=t.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(e){const[t,i,r,n,a,o,s,l,c,h,u,d]=e,p=[n||" ",s||" ",h].join("");if("  "===p||"  /"===p||",,"===p||",,,"===p){const t=[r,o,c].join(""),e="%%%"===t?100:""===t?255:0;if(e){const t=[Gt(+i/e,0,1),Gt(+a/e,0,1),Gt(+l/e,0,1),u?qt(+u,d):1];if(Wt(t))return t}}return}}const i=t.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(i){const[t,e,r,n,a,o,s,l,c]=i,h=[r||" ",a||" ",s].join("");if("  "===h||"  /"===h||",,"===h||",,,"===h){const t=[+e,Gt(+n,0,100),Gt(+o,0,100),l?qt(+l,c):1];if(Wt(t))return function([t,e,i,r]){function n(r){const n=(r+t/30)%12,a=e*Math.min(i,1-i);return i-a*Math.max(-1,Math.min(n-3,9-n,1))}return t=Ot(t),e/=100,i/=100,[n(0),n(8),n(4),r]}(t)}}}(t);return e?new Kt(...e,!1):void 0}get rgb(){const{r:t,g:e,b:i,a:r}=this,n=r||1/0;return this.overwriteGetter("rgb",[t/n,e/n,i/n,r])}get hcl(){return this.overwriteGetter("hcl",function(t){const[e,i,r,n]=$t(t),a=Math.sqrt(i*i+r*r);return[Math.round(1e4*a)?Ot(Math.atan2(r,i)*Ft):NaN,a,e,n]}(this.rgb))}get lab(){return this.overwriteGetter("lab",$t(this.rgb))}overwriteGetter(t,e){return Object.defineProperty(this,t,{value:e}),e}toString(){const[t,e,i,r]=this.rgb;return`rgba(${[t,e,i].map((t=>Math.round(255*t))).join(",")},${r})`}}Kt.black=new Kt(0,0,0,1),Kt.white=new Kt(1,1,1,1),Kt.transparent=new Kt(0,0,0,0),Kt.red=new Kt(1,0,0,1);class Jt{constructor(t,e,i){this.sensitivity=t?e?"variant":"case":e?"accent":"base",this.locale=i,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,e){return this.collator.compare(t,e)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Yt{constructor(t,e,i,r,n){this.text=t,this.image=e,this.scale=i,this.fontStack=r,this.textColor=n}}class Qt{constructor(t){this.sections=t}static fromString(t){return new Qt([new Yt(t,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some((t=>0!==t.text.length||t.image&&0!==t.image.name.length))}static factory(t){return t instanceof Qt?t:Qt.fromString(t)}toString(){return 0===this.sections.length?"":this.sections.map((t=>t.text)).join("")}}class te{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof te)return t;if("number"==typeof t)return new te([t,t,t,t]);if(Array.isArray(t)&&!(t.length<1||t.length>4)){for(const e of t)if("number"!=typeof e)return;switch(t.length){case 1:t=[t[0],t[0],t[0],t[0]];break;case 2:t=[t[0],t[1],t[0],t[1]];break;case 3:t=[t[0],t[1],t[2],t[1]]}return new te(t)}}toString(){return JSON.stringify(this.values)}}const ee=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class ie{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof ie)return t;if(Array.isArray(t)&&!(t.length<1)&&t.length%2==0){for(let e=0;e<t.length;e+=2){const i=t[e],r=t[e+1];if("string"!=typeof i||!ee.has(i))return;if(!Array.isArray(r)||2!==r.length||"number"!=typeof r[0]||"number"!=typeof r[1])return}return new ie(t)}}toString(){return JSON.stringify(this.values)}}class re{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new re({name:t,available:!1}):null}}function ne(t,e,i,r){return"number"==typeof t&&t>=0&&t<=255&&"number"==typeof e&&e>=0&&e<=255&&"number"==typeof i&&i>=0&&i<=255?void 0===r||"number"==typeof r&&r>=0&&r<=1?null:`Invalid rgba value [${[t,e,i,r].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof r?[t,e,i,r]:[t,e,i]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function ae(t){if(null===t||"string"==typeof t||"boolean"==typeof t||"number"==typeof t||t instanceof Kt||t instanceof Jt||t instanceof Qt||t instanceof te||t instanceof ie||t instanceof re)return!0;if(Array.isArray(t)){for(const e of t)if(!ae(e))return!1;return!0}if("object"==typeof t){for(const e in t)if(!ae(t[e]))return!1;return!0}return!1}function oe(t){if(null===t)return ut;if("string"==typeof t)return pt;if("boolean"==typeof t)return mt;if("number"==typeof t)return dt;if(t instanceof Kt)return ft;if(t instanceof Jt)return _t;if(t instanceof Qt)return vt;if(t instanceof te)return bt;if(t instanceof ie)return wt;if(t instanceof re)return xt;if(Array.isArray(t)){const e=t.length;let i;for(const e of t){const t=oe(e);if(i){if(i===t)continue;i=yt;break}i=t}return St(i||yt,e)}return gt}function se(t){const e=typeof t;return null===t?"":"string"===e||"number"===e||"boolean"===e?String(t):t instanceof Kt||t instanceof Qt||t instanceof te||t instanceof ie||t instanceof re?t.toString():JSON.stringify(t)}class le{constructor(t,e){this.type=t,this.value=e}static parse(t,e){if(2!==t.length)return e.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!ae(t[1]))return e.error("invalid value");const i=t[1];let r=oe(i);const n=e.expectedType;return"array"!==r.kind||0!==r.N||!n||"array"!==n.kind||"number"==typeof n.N&&0!==n.N||(r=n),new le(r,i)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class ce{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}}const he={string:pt,number:dt,boolean:mt,object:gt};class ue{constructor(t,e){this.type=t,this.args=e}static parse(t,e){if(t.length<2)return e.error("Expected at least one argument.");let i,r=1;const n=t[0];if("array"===n){let n,a;if(t.length>2){const i=t[1];if("string"!=typeof i||!(i in he)||"object"===i)return e.error('The item type argument of "array" must be one of string, number, boolean',1);n=he[i],r++}else n=yt;if(t.length>3){if(null!==t[2]&&("number"!=typeof t[2]||t[2]<0||t[2]!==Math.floor(t[2])))return e.error('The length argument to "array" must be a positive integer literal',2);a=t[2],r++}i=St(n,a)}else{if(!he[n])throw new Error(`Types doesn't contain name = ${n}`);i=he[n]}const a=[];for(;r<t.length;r++){const i=e.parse(t[r],r,yt);if(!i)return null;a.push(i)}return new ue(i,a)}evaluate(t){for(let e=0;e<this.args.length;e++){const i=this.args[e].evaluate(t);if(!At(this.type,oe(i)))return i;if(e===this.args.length-1)throw new ce(`Expected value to be of type ${kt(this.type)}, but found ${kt(oe(i))} instead.`)}throw new Error}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}}const de={"to-boolean":mt,"to-color":ft,"to-number":dt,"to-string":pt};class pe{constructor(t,e){this.type=t,this.args=e}static parse(t,e){if(t.length<2)return e.error("Expected at least one argument.");const i=t[0];if(!de[i])throw new Error(`Can't parse ${i} as it is not part of the known types`);if(("to-boolean"===i||"to-string"===i)&&2!==t.length)return e.error("Expected one argument.");const r=de[i],n=[];for(let i=1;i<t.length;i++){const r=e.parse(t[i],i,yt);if(!r)return null;n.push(r)}return new pe(r,n)}evaluate(t){switch(this.type.kind){case"boolean":return Boolean(this.args[0].evaluate(t));case"color":{let e,i;for(const r of this.args){if(e=r.evaluate(t),i=null,e instanceof Kt)return e;if("string"==typeof e){const i=t.parseColor(e);if(i)return i}else if(Array.isArray(e)&&(i=e.length<3||e.length>4?`Invalid rbga value ${JSON.stringify(e)}: expected an array containing either three or four numeric values.`:ne(e[0],e[1],e[2],e[3]),!i))return new Kt(e[0]/255,e[1]/255,e[2]/255,e[3])}throw new ce(i||`Could not parse color from value '${"string"==typeof e?e:JSON.stringify(e)}'`)}case"padding":{let e;for(const i of this.args){e=i.evaluate(t);const r=te.parse(e);if(r)return r}throw new ce(`Could not parse padding from value '${"string"==typeof e?e:JSON.stringify(e)}'`)}case"variableAnchorOffsetCollection":{let e;for(const i of this.args){e=i.evaluate(t);const r=ie.parse(e);if(r)return r}throw new ce(`Could not parse variableAnchorOffsetCollection from value '${"string"==typeof e?e:JSON.stringify(e)}'`)}case"number":{let e=null;for(const i of this.args){if(e=i.evaluate(t),null===e)return 0;const r=Number(e);if(!isNaN(r))return r}throw new ce(`Could not convert ${JSON.stringify(e)} to number.`)}case"formatted":return Qt.fromString(se(this.args[0].evaluate(t)));case"resolvedImage":return re.fromString(se(this.args[0].evaluate(t)));default:return se(this.args[0].evaluate(t))}}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}}const me=["Unknown","Point","LineString","Polygon"];class fe{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?me[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(t){let e=this._parseColorCache[t];return e||(e=this._parseColorCache[t]=Kt.parse(t)),e}}class ge{constructor(t,e,i=[],r,n=new ht,a=[]){this.registry=t,this.path=i,this.key=i.map((t=>`[${t}]`)).join(""),this.scope=n,this.errors=a,this.expectedType=r,this._isConstant=e}parse(t,e,i,r,n={}){return e?this.concat(e,i,r)._parse(t,n):this._parse(t,n)}_parse(t,e){function i(t,e,i){return"assert"===i?new ue(e,[t]):"coerce"===i?new pe(e,[t]):t}if(null!==t&&"string"!=typeof t&&"boolean"!=typeof t&&"number"!=typeof t||(t=["literal",t]),Array.isArray(t)){if(0===t.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const r=t[0];if("string"!=typeof r)return this.error(`Expression name must be a string, but found ${typeof r} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const n=this.registry[r];if(n){let r=n.parse(t,this);if(!r)return null;if(this.expectedType){const t=this.expectedType,n=r.type;if("string"!==t.kind&&"number"!==t.kind&&"boolean"!==t.kind&&"object"!==t.kind&&"array"!==t.kind||"value"!==n.kind)if("color"!==t.kind&&"formatted"!==t.kind&&"resolvedImage"!==t.kind||"value"!==n.kind&&"string"!==n.kind)if("padding"!==t.kind||"value"!==n.kind&&"number"!==n.kind&&"array"!==n.kind)if("variableAnchorOffsetCollection"!==t.kind||"value"!==n.kind&&"array"!==n.kind){if(this.checkSubtype(t,n))return null}else r=i(r,t,e.typeAnnotation||"coerce");else r=i(r,t,e.typeAnnotation||"coerce");else r=i(r,t,e.typeAnnotation||"coerce");else r=i(r,t,e.typeAnnotation||"assert")}if(!(r instanceof le)&&"resolvedImage"!==r.type.kind&&this._isConstant(r)){const e=new fe;try{r=new le(r.type,r.evaluate(e))}catch(t){return this.error(t.message),null}}return r}return this.error(`Unknown expression "${r}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(void 0===t?"'undefined' value invalid. Use null instead.":"object"==typeof t?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,e,i){const r="number"==typeof t?this.path.concat(t):this.path,n=i?this.scope.concat(i):this.scope;return new ge(this.registry,this._isConstant,r,e||null,n,this.errors)}error(t,...e){const i=`${this.key}${e.map((t=>`[${t}]`)).join("")}`;this.errors.push(new ct(i,t))}checkSubtype(t,e){const i=At(t,e);return i&&this.error(i),i}}class ye{constructor(t,e,i){this.type=_t,this.locale=i,this.caseSensitive=t,this.diacriticSensitive=e}static parse(t,e){if(2!==t.length)return e.error("Expected one argument.");const i=t[1];if("object"!=typeof i||Array.isArray(i))return e.error("Collator options argument must be an object.");const r=e.parse(void 0!==i["case-sensitive"]&&i["case-sensitive"],1,mt);if(!r)return null;const n=e.parse(void 0!==i["diacritic-sensitive"]&&i["diacritic-sensitive"],1,mt);if(!n)return null;let a=null;return i.locale&&(a=e.parse(i.locale,1,pt),!a)?null:new ye(r,n,a)}evaluate(t){return new Jt(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}}const _e=8192;function ve(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.max(t[2],e[0]),t[3]=Math.max(t[3],e[1])}function be(t,e){return!(t[0]<=e[0]||t[2]>=e[2]||t[1]<=e[1]||t[3]>=e[3])}function xe(t,e){const i=(180+t[0])/360,r=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t[1]*Math.PI/360)))/360,n=Math.pow(2,e.z);return[Math.round(i*n*_e),Math.round(r*n*_e)]}function we(t,e,i){const r=t[0]-e[0],n=t[1]-e[1],a=t[0]-i[0],o=t[1]-i[1];return r*o-a*n==0&&r*a<=0&&n*o<=0}function Se(t,e){let i=!1;for(let o=0,s=e.length;o<s;o++){const s=e[o];for(let e=0,o=s.length;e<o-1;e++){if(we(t,s[e],s[e+1]))return!1;(n=s[e])[1]>(r=t)[1]!=(a=s[e+1])[1]>r[1]&&r[0]<(a[0]-n[0])*(r[1]-n[1])/(a[1]-n[1])+n[0]&&(i=!i)}}var r,n,a;return i}function ke(t,e){for(let i=0;i<e.length;i++)if(Se(t,e[i]))return!0;return!1}function Ce(t,e,i,r){const n=r[0]-i[0],a=r[1]-i[1],o=(t[0]-i[0])*a-n*(t[1]-i[1]),s=(e[0]-i[0])*a-n*(e[1]-i[1]);return o>0&&s<0||o<0&&s>0}function Ae(t,e,i){for(const c of i)for(let i=0;i<c.length-1;++i)if(0!=(s=[(o=c[i+1])[0]-(a=c[i])[0],o[1]-a[1]])[0]*(l=[(n=e)[0]-(r=t)[0],n[1]-r[1]])[1]-s[1]*l[0]&&Ce(r,n,a,o)&&Ce(a,o,r,n))return!0;var r,n,a,o,s,l;return!1}function Te(t,e){for(let i=0;i<t.length;++i)if(!Se(t[i],e))return!1;for(let i=0;i<t.length-1;++i)if(Ae(t[i],t[i+1],e))return!1;return!0}function Ee(t,e){for(let i=0;i<e.length;i++)if(Te(t,e[i]))return!0;return!1}function Me(t,e,i){const r=[];for(let n=0;n<t.length;n++){const a=[];for(let r=0;r<t[n].length;r++){const o=xe(t[n][r],i);ve(e,o),a.push(o)}r.push(a)}return r}function Ie(t,e,i){const r=[];for(let n=0;n<t.length;n++){const a=Me(t[n],e,i);r.push(a)}return r}function ze(t,e,i,r){if(t[0]<i[0]||t[0]>i[2]){const e=.5*r;let n=t[0]-i[0]>e?-r:i[0]-t[0]>e?r:0;0===n&&(n=t[0]-i[2]>e?-r:i[2]-t[0]>e?r:0),t[0]+=n}ve(e,t)}function Pe(t,e,i,r){const n=Math.pow(2,r.z)*_e,a=[r.x*_e,r.y*_e],o=[];for(const r of t)for(const t of r){const r=[t.x+a[0],t.y+a[1]];ze(r,e,i,n),o.push(r)}return o}function Le(t,e,i,r){const n=Math.pow(2,r.z)*_e,a=[r.x*_e,r.y*_e],o=[];for(const i of t){const t=[];for(const r of i){const i=[r.x+a[0],r.y+a[1]];ve(e,i),t.push(i)}o.push(t)}if(e[2]-e[0]<=n/2){(s=e)[0]=s[1]=1/0,s[2]=s[3]=-1/0;for(const t of o)for(const r of t)ze(r,e,i,n)}var s;return o}class De{constructor(t,e){this.type=mt,this.geojson=t,this.geometries=e}static parse(t,e){if(2!==t.length)return e.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(ae(t[1])){const e=t[1];if("FeatureCollection"===e.type)for(let t=0;t<e.features.length;++t){const i=e.features[t].geometry.type;if("Polygon"===i||"MultiPolygon"===i)return new De(e,e.features[t].geometry)}else if("Feature"===e.type){const t=e.geometry.type;if("Polygon"===t||"MultiPolygon"===t)return new De(e,e.geometry)}else if("Polygon"===e.type||"MultiPolygon"===e.type)return new De(e,e)}return e.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(null!=t.geometry()&&null!=t.canonicalID()){if("Point"===t.geometryType())return function(t,e){const i=[1/0,1/0,-1/0,-1/0],r=[1/0,1/0,-1/0,-1/0],n=t.canonicalID();if("Polygon"===e.type){const a=Me(e.coordinates,r,n),o=Pe(t.geometry(),i,r,n);if(!be(i,r))return!1;for(const t of o)if(!Se(t,a))return!1}if("MultiPolygon"===e.type){const a=Ie(e.coordinates,r,n),o=Pe(t.geometry(),i,r,n);if(!be(i,r))return!1;for(const t of o)if(!ke(t,a))return!1}return!0}(t,this.geometries);if("LineString"===t.geometryType())return function(t,e){const i=[1/0,1/0,-1/0,-1/0],r=[1/0,1/0,-1/0,-1/0],n=t.canonicalID();if("Polygon"===e.type){const a=Me(e.coordinates,r,n),o=Le(t.geometry(),i,r,n);if(!be(i,r))return!1;for(const t of o)if(!Te(t,a))return!1}if("MultiPolygon"===e.type){const a=Ie(e.coordinates,r,n),o=Le(t.geometry(),i,r,n);if(!be(i,r))return!1;for(const t of o)if(!Ee(t,a))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class Re{constructor(t,e){this.type=e.type,this.name=t,this.boundExpression=e}static parse(t,e){if(2!==t.length||"string"!=typeof t[1])return e.error("'var' expression requires exactly one string literal argument.");const i=t[1];return e.scope.has(i)?new Re(i,e.scope.get(i)):e.error(`Unknown variable "${i}". Make sure "${i}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}}class Be{constructor(t,e,i,r){this.name=t,this.type=e,this._evaluate=i,this.args=r}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}static parse(t,e){const i=t[0],r=Be.definitions[i];if(!r)return e.error(`Unknown expression "${i}". If you wanted a literal array, use ["literal", [...]].`,0);const n=Array.isArray(r)?r[0]:r.type,a=Array.isArray(r)?[[r[1],r[2]]]:r.overloads,o=a.filter((([e])=>!Array.isArray(e)||e.length===t.length-1));let s=null;for(const[r,a]of o){s=new ge(e.registry,Fe,e.path,null,e.scope);const o=[];let l=!1;for(let e=1;e<t.length;e++){const i=t[e],n=Array.isArray(r)?r[e-1]:r.type,a=s.parse(i,1+o.length,n);if(!a){l=!0;break}o.push(a)}if(!l)if(Array.isArray(r)&&r.length!==o.length)s.error(`Expected ${r.length} arguments, but found ${o.length} instead.`);else{for(let t=0;t<o.length;t++){const e=Array.isArray(r)?r[t]:r.type,i=o[t];s.concat(t+1).checkSubtype(e,i.type)}if(0===s.errors.length)return new Be(i,n,a,o)}}if(1===o.length)e.errors.push(...s.errors);else{const i=(o.length?o:a).map((([t])=>{return e=t,Array.isArray(e)?`(${e.map(kt).join(", ")})`:`(${kt(e.type)}...)`;var e})).join(" | "),r=[];for(let i=1;i<t.length;i++){const n=e.parse(t[i],1+r.length);if(!n)return null;r.push(kt(n.type))}e.error(`Expected arguments of type ${i}, but found (${r.join(", ")}) instead.`)}return null}static register(t,e){Be.definitions=e;for(const i in e)t[i]=Be}}function Fe(t){if(t instanceof Re)return Fe(t.boundExpression);if(t instanceof Be&&"error"===t.name)return!1;if(t instanceof ye)return!1;if(t instanceof De)return!1;const e=t instanceof pe||t instanceof ue;let i=!0;return t.eachChild((t=>{i=e?i&&Fe(t):i&&t instanceof le})),!!i&&Oe(t)&&Ve(t,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function Oe(t){if(t instanceof Be){if("get"===t.name&&1===t.args.length)return!1;if("feature-state"===t.name)return!1;if("has"===t.name&&1===t.args.length)return!1;if("properties"===t.name||"geometry-type"===t.name||"id"===t.name)return!1;if(/^filter-/.test(t.name))return!1}if(t instanceof De)return!1;let e=!0;return t.eachChild((t=>{e&&!Oe(t)&&(e=!1)})),e}function $e(t){if(t instanceof Be&&"feature-state"===t.name)return!1;let e=!0;return t.eachChild((t=>{e&&!$e(t)&&(e=!1)})),e}function Ve(t,e){if(t instanceof Be&&e.indexOf(t.name)>=0)return!1;let i=!0;return t.eachChild((t=>{i&&!Ve(t,e)&&(i=!1)})),i}function Ne(t,e){const i=t.length-1;let r,n,a=0,o=i,s=0;for(;a<=o;)if(s=Math.floor((a+o)/2),r=t[s],n=t[s+1],r<=e){if(s===i||e<n)return s;a=s+1}else{if(!(r>e))throw new ce("Input is not a number.");o=s-1}return 0}class je{constructor(t,e,i){this.type=t,this.input=e,this.labels=[],this.outputs=[];for(const[t,e]of i)this.labels.push(t),this.outputs.push(e)}static parse(t,e){if(t.length-1<4)return e.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");const i=e.parse(t[1],1,dt);if(!i)return null;const r=[];let n=null;e.expectedType&&"value"!==e.expectedType.kind&&(n=e.expectedType);for(let i=1;i<t.length;i+=2){const a=1===i?-1/0:t[i],o=t[i+1],s=i,l=i+1;if("number"!=typeof a)return e.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',s);if(r.length&&r[r.length-1][0]>=a)return e.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',s);const c=e.parse(o,l,n);if(!c)return null;n=n||c.type,r.push([a,c])}return new je(n,i,r)}evaluate(t){const e=this.labels,i=this.outputs;if(1===e.length)return i[0].evaluate(t);const r=this.input.evaluate(t);if(r<=e[0])return i[0].evaluate(t);const n=e.length;return r>=e[n-1]?i[n-1].evaluate(t):i[Ne(e,r)].evaluate(t)}eachChild(t){t(this.input);for(const e of this.outputs)t(e)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))}}function Ue(t,e,i){return t+i*(e-t)}function Ze(t,e,i){return t.map(((t,r)=>Ue(t,e[r],i)))}const He={number:Ue,color:function(t,e,i,r="rgb"){switch(r){case"rgb":{const[r,n,a,o]=Ze(t.rgb,e.rgb,i);return new Kt(r,n,a,o,!1)}case"hcl":{const[r,n,a,o]=t.hcl,[s,l,c,h]=e.hcl;let u,d;if(isNaN(r)||isNaN(s))isNaN(r)?isNaN(s)?u=NaN:(u=s,1!==a&&0!==a||(d=l)):(u=r,1!==c&&0!==c||(d=n));else{let t=s-r;s>r&&t>180?t-=360:s<r&&r-s>180&&(t+=360),u=r+i*t}const[p,m,f,g]=function([t,e,i,r]){return t=isNaN(t)?0:t*Bt,jt([i,Math.cos(t)*e,Math.sin(t)*e,r])}([u,null!=d?d:Ue(n,l,i),Ue(a,c,i),Ue(o,h,i)]);return new Kt(p,m,f,g,!1)}case"lab":{const[r,n,a,o]=jt(Ze(t.lab,e.lab,i));return new Kt(r,n,a,o,!1)}}},array:Ze,padding:function(t,e,i){return new te(Ze(t.values,e.values,i))},variableAnchorOffsetCollection:function(t,e,i){const r=t.values,n=e.values;if(r.length!==n.length)throw new ce(`Cannot interpolate values of different length. from: ${t.toString()}, to: ${e.toString()}`);const a=[];for(let t=0;t<r.length;t+=2){if(r[t]!==n[t])throw new ce(`Cannot interpolate values containing mismatched anchors. from[${t}]: ${r[t]}, to[${t}]: ${n[t]}`);a.push(r[t]);const[e,o]=r[t+1],[s,l]=n[t+1];a.push([Ue(e,s,i),Ue(o,l,i)])}return new ie(a)}};class qe{constructor(t,e,i,r,n){this.type=t,this.operator=e,this.interpolation=i,this.input=r,this.labels=[],this.outputs=[];for(const[t,e]of n)this.labels.push(t),this.outputs.push(e)}static interpolationFactor(t,e,i,r){let n=0;if("exponential"===t.name)n=Ge(e,t.base,i,r);else if("linear"===t.name)n=Ge(e,1,i,r);else if("cubic-bezier"===t.name){const a=t.controlPoints;n=new l(a[0],a[1],a[2],a[3]).solve(Ge(e,1,i,r))}return n}static parse(t,e){let[i,r,n,...a]=t;if(!Array.isArray(r)||0===r.length)return e.error("Expected an interpolation type expression.",1);if("linear"===r[0])r={name:"linear"};else if("exponential"===r[0]){const t=r[1];if("number"!=typeof t)return e.error("Exponential interpolation requires a numeric base.",1,1);r={name:"exponential",base:t}}else{if("cubic-bezier"!==r[0])return e.error(`Unknown interpolation type ${String(r[0])}`,1,0);{const t=r.slice(1);if(4!==t.length||t.some((t=>"number"!=typeof t||t<0||t>1)))return e.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);r={name:"cubic-bezier",controlPoints:t}}}if(t.length-1<4)return e.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");if(n=e.parse(n,2,dt),!n)return null;const o=[];let s=null;"interpolate-hcl"===i||"interpolate-lab"===i?s=ft:e.expectedType&&"value"!==e.expectedType.kind&&(s=e.expectedType);for(let t=0;t<a.length;t+=2){const i=a[t],r=a[t+1],n=t+3,l=t+4;if("number"!=typeof i)return e.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',n);if(o.length&&o[o.length-1][0]>=i)return e.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',n);const c=e.parse(r,l,s);if(!c)return null;s=s||c.type,o.push([i,c])}return Mt(s,dt)||Mt(s,ft)||Mt(s,bt)||Mt(s,wt)||Mt(s,St(dt))?new qe(s,i,r,n,o):e.error(`Type ${kt(s)} is not interpolatable.`)}evaluate(t){const e=this.labels,i=this.outputs;if(1===e.length)return i[0].evaluate(t);const r=this.input.evaluate(t);if(r<=e[0])return i[0].evaluate(t);const n=e.length;if(r>=e[n-1])return i[n-1].evaluate(t);const a=Ne(e,r),o=qe.interpolationFactor(this.interpolation,r,e[a],e[a+1]),s=i[a].evaluate(t),l=i[a+1].evaluate(t);switch(this.operator){case"interpolate":return He[this.type.kind](s,l,o);case"interpolate-hcl":return He.color(s,l,o,"hcl");case"interpolate-lab":return He.color(s,l,o,"lab")}}eachChild(t){t(this.input);for(const e of this.outputs)t(e)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))}}function Ge(t,e,i,r){const n=r-i,a=t-i;return 0===n?0:1===e?a/n:(Math.pow(e,a)-1)/(Math.pow(e,n)-1)}class We{constructor(t,e){this.type=t,this.args=e}static parse(t,e){if(t.length<2)return e.error("Expectected at least one argument.");let i=null;const r=e.expectedType;r&&"value"!==r.kind&&(i=r);const n=[];for(const r of t.slice(1)){const t=e.parse(r,1+n.length,i,void 0,{typeAnnotation:"omit"});if(!t)return null;i=i||t.type,n.push(t)}if(!i)throw new Error("No output type");const a=r&&n.some((t=>At(r,t.type)));return new We(a?yt:i,n)}evaluate(t){let e,i=null,r=0;for(const n of this.args)if(r++,i=n.evaluate(t),i&&i instanceof re&&!i.available&&(e||(e=i.name),i=null,r===this.args.length&&(i=e)),null!==i)break;return i}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}}class Xe{constructor(t,e){this.type=e.type,this.bindings=[].concat(t),this.result=e}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const e of this.bindings)t(e[1]);t(this.result)}static parse(t,e){if(t.length<4)return e.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const i=[];for(let r=1;r<t.length-1;r+=2){const n=t[r];if("string"!=typeof n)return e.error(`Expected string, but found ${typeof n} instead.`,r);if(/[^a-zA-Z0-9_]/.test(n))return e.error("Variable names must contain only alphanumeric characters or '_'.",r);const a=e.parse(t[r+1],r+1);if(!a)return null;i.push([n,a])}const r=e.parse(t[t.length-1],t.length-1,e.expectedType,i);return r?new Xe(i,r):null}outputDefined(){return this.result.outputDefined()}}class Ke{constructor(t,e,i){this.type=t,this.index=e,this.input=i}static parse(t,e){if(3!==t.length)return e.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const i=e.parse(t[1],1,dt),r=e.parse(t[2],2,St(e.expectedType||yt));return i&&r?new Ke(r.type.itemType,i,r):null}evaluate(t){const e=this.index.evaluate(t),i=this.input.evaluate(t);if(e<0)throw new ce(`Array index out of bounds: ${e} < 0.`);if(e>=i.length)throw new ce(`Array index out of bounds: ${e} > ${i.length-1}.`);if(e!==Math.floor(e))throw new ce(`Array index must be an integer, but found ${e} instead.`);return i[e]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}}class Je{constructor(t,e){this.type=mt,this.needle=t,this.haystack=e}static parse(t,e){if(3!==t.length)return e.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const i=e.parse(t[1],1,yt),r=e.parse(t[2],2,yt);return i&&r?Tt(i.type,[mt,pt,dt,ut,yt])?new Je(i,r):e.error(`Expected first argument to be of type boolean, string, number or null, but found ${kt(i.type)} instead`):null}evaluate(t){const e=this.needle.evaluate(t),i=this.haystack.evaluate(t);if(!i)return!1;if(!Et(e,["boolean","string","number","null"]))throw new ce(`Expected first argument to be of type boolean, string, number or null, but found ${kt(oe(e))} instead.`);if(!Et(i,["string","array"]))throw new ce(`Expected second argument to be of type array or string, but found ${kt(oe(i))} instead.`);return i.indexOf(e)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}}class Ye{constructor(t,e,i){this.type=dt,this.needle=t,this.haystack=e,this.fromIndex=i}static parse(t,e){if(t.length<=2||t.length>=5)return e.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const i=e.parse(t[1],1,yt),r=e.parse(t[2],2,yt);if(!i||!r)return null;if(!Tt(i.type,[mt,pt,dt,ut,yt]))return e.error(`Expected first argument to be of type boolean, string, number or null, but found ${kt(i.type)} instead`);if(4===t.length){const n=e.parse(t[3],3,dt);return n?new Ye(i,r,n):null}return new Ye(i,r)}evaluate(t){const e=this.needle.evaluate(t),i=this.haystack.evaluate(t);if(!Et(e,["boolean","string","number","null"]))throw new ce(`Expected first argument to be of type boolean, string, number or null, but found ${kt(oe(e))} instead.`);if(!Et(i,["string","array"]))throw new ce(`Expected second argument to be of type array or string, but found ${kt(oe(i))} instead.`);if(this.fromIndex){const r=this.fromIndex.evaluate(t);return i.indexOf(e,r)}return i.indexOf(e)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}}class Qe{constructor(t,e,i,r,n,a){this.inputType=t,this.type=e,this.input=i,this.cases=r,this.outputs=n,this.otherwise=a}static parse(t,e){if(t.length<5)return e.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return e.error("Expected an even number of arguments.");let i,r;e.expectedType&&"value"!==e.expectedType.kind&&(r=e.expectedType);const n={},a=[];for(let o=2;o<t.length-1;o+=2){let s=t[o];const l=t[o+1];Array.isArray(s)||(s=[s]);const c=e.concat(o);if(0===s.length)return c.error("Expected at least one branch label.");for(const t of s){if("number"!=typeof t&&"string"!=typeof t)return c.error("Branch labels must be numbers or strings.");if("number"==typeof t&&Math.abs(t)>Number.MAX_SAFE_INTEGER)return c.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof t&&Math.floor(t)!==t)return c.error("Numeric branch labels must be integer values.");if(i){if(c.checkSubtype(i,oe(t)))return null}else i=oe(t);if(void 0!==n[String(t)])return c.error("Branch labels must be unique.");n[String(t)]=a.length}const h=e.parse(l,o,r);if(!h)return null;r=r||h.type,a.push(h)}const o=e.parse(t[1],1,yt);if(!o)return null;const s=e.parse(t[t.length-1],t.length-1,r);return s?"value"!==o.type.kind&&e.concat(1).checkSubtype(i,o.type)?null:new Qe(i,r,o,n,a,s):null}evaluate(t){const e=this.input.evaluate(t);return(oe(e)===this.inputType&&this.outputs[this.cases[e]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))&&this.otherwise.outputDefined()}}class ti{constructor(t,e,i){this.type=t,this.branches=e,this.otherwise=i}static parse(t,e){if(t.length<4)return e.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return e.error("Expected an odd number of arguments.");let i;e.expectedType&&"value"!==e.expectedType.kind&&(i=e.expectedType);const r=[];for(let n=1;n<t.length-1;n+=2){const a=e.parse(t[n],n,mt);if(!a)return null;const o=e.parse(t[n+1],n+1,i);if(!o)return null;r.push([a,o]),i=i||o.type}const n=e.parse(t[t.length-1],t.length-1,i);if(!n)return null;if(!i)throw new Error("Can't infer output type");return new ti(i,r,n)}evaluate(t){for(const[e,i]of this.branches)if(e.evaluate(t))return i.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[e,i]of this.branches)t(e),t(i);t(this.otherwise)}outputDefined(){return this.branches.every((([t,e])=>e.outputDefined()))&&this.otherwise.outputDefined()}}class ei{constructor(t,e,i,r){this.type=t,this.input=e,this.beginIndex=i,this.endIndex=r}static parse(t,e){if(t.length<=2||t.length>=5)return e.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const i=e.parse(t[1],1,yt),r=e.parse(t[2],2,dt);if(!i||!r)return null;if(!Tt(i.type,[St(yt),pt,yt]))return e.error(`Expected first argument to be of type array or string, but found ${kt(i.type)} instead`);if(4===t.length){const n=e.parse(t[3],3,dt);return n?new ei(i.type,i,r,n):null}return new ei(i.type,i,r)}evaluate(t){const e=this.input.evaluate(t),i=this.beginIndex.evaluate(t);if(!Et(e,["string","array"]))throw new ce(`Expected first argument to be of type array or string, but found ${kt(oe(e))} instead.`);if(this.endIndex){const r=this.endIndex.evaluate(t);return e.slice(i,r)}return e.slice(i)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}}function ii(t,e){return"=="===t||"!="===t?"boolean"===e.kind||"string"===e.kind||"number"===e.kind||"null"===e.kind||"value"===e.kind:"string"===e.kind||"number"===e.kind||"value"===e.kind}function ri(t,e,i,r){return 0===r.compare(e,i)}function ni(t,e,i){const r="=="!==t&&"!="!==t;return class n{constructor(t,e,i){this.type=mt,this.lhs=t,this.rhs=e,this.collator=i,this.hasUntypedArgument="value"===t.type.kind||"value"===e.type.kind}static parse(t,e){if(3!==t.length&&4!==t.length)return e.error("Expected two or three arguments.");const i=t[0];let a=e.parse(t[1],1,yt);if(!a)return null;if(!ii(i,a.type))return e.concat(1).error(`"${i}" comparisons are not supported for type '${kt(a.type)}'.`);let o=e.parse(t[2],2,yt);if(!o)return null;if(!ii(i,o.type))return e.concat(2).error(`"${i}" comparisons are not supported for type '${kt(o.type)}'.`);if(a.type.kind!==o.type.kind&&"value"!==a.type.kind&&"value"!==o.type.kind)return e.error(`Cannot compare types '${kt(a.type)}' and '${kt(o.type)}'.`);r&&("value"===a.type.kind&&"value"!==o.type.kind?a=new ue(o.type,[a]):"value"!==a.type.kind&&"value"===o.type.kind&&(o=new ue(a.type,[o])));let s=null;if(4===t.length){if("string"!==a.type.kind&&"string"!==o.type.kind&&"value"!==a.type.kind&&"value"!==o.type.kind)return e.error("Cannot use collator to compare non-string types.");if(s=e.parse(t[3],3,_t),!s)return null}return new n(a,o,s)}evaluate(n){const a=this.lhs.evaluate(n),o=this.rhs.evaluate(n);if(r&&this.hasUntypedArgument){const e=oe(a),i=oe(o);if(e.kind!==i.kind||"string"!==e.kind&&"number"!==e.kind)throw new ce(`Expected arguments for "${t}" to be (string, string) or (number, number), but found (${e.kind}, ${i.kind}) instead.`)}if(this.collator&&!r&&this.hasUntypedArgument){const t=oe(a),i=oe(o);if("string"!==t.kind||"string"!==i.kind)return e(n,a,o)}return this.collator?i(n,a,o,this.collator.evaluate(n)):e(n,a,o)}eachChild(t){t(this.lhs),t(this.rhs),this.collator&&t(this.collator)}outputDefined(){return!0}}}const ai=ni("==",(function(t,e,i){return e===i}),ri),oi=ni("!=",(function(t,e,i){return e!==i}),(function(t,e,i,r){return!ri(0,e,i,r)})),si=ni("<",(function(t,e,i){return e<i}),(function(t,e,i,r){return r.compare(e,i)<0})),li=ni(">",(function(t,e,i){return e>i}),(function(t,e,i,r){return r.compare(e,i)>0})),ci=ni("<=",(function(t,e,i){return e<=i}),(function(t,e,i,r){return r.compare(e,i)<=0})),hi=ni(">=",(function(t,e,i){return e>=i}),(function(t,e,i,r){return r.compare(e,i)>=0}));class ui{constructor(t,e,i,r,n){this.type=pt,this.number=t,this.locale=e,this.currency=i,this.minFractionDigits=r,this.maxFractionDigits=n}static parse(t,e){if(3!==t.length)return e.error("Expected two arguments.");const i=e.parse(t[1],1,dt);if(!i)return null;const r=t[2];if("object"!=typeof r||Array.isArray(r))return e.error("NumberFormat options argument must be an object.");let n=null;if(r.locale&&(n=e.parse(r.locale,1,pt),!n))return null;let a=null;if(r.currency&&(a=e.parse(r.currency,1,pt),!a))return null;let o=null;if(r["min-fraction-digits"]&&(o=e.parse(r["min-fraction-digits"],1,dt),!o))return null;let s=null;return r["max-fraction-digits"]&&(s=e.parse(r["max-fraction-digits"],1,dt),!s)?null:new ui(i,n,a,o,s)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}}class di{constructor(t){this.type=vt,this.sections=t}static parse(t,e){if(t.length<2)return e.error("Expected at least one argument.");const i=t[1];if(!Array.isArray(i)&&"object"==typeof i)return e.error("First argument must be an image or text section.");const r=[];let n=!1;for(let i=1;i<=t.length-1;++i){const a=t[i];if(n&&"object"==typeof a&&!Array.isArray(a)){n=!1;let t=null;if(a["font-scale"]&&(t=e.parse(a["font-scale"],1,dt),!t))return null;let i=null;if(a["text-font"]&&(i=e.parse(a["text-font"],1,St(pt)),!i))return null;let o=null;if(a["text-color"]&&(o=e.parse(a["text-color"],1,ft),!o))return null;const s=r[r.length-1];s.scale=t,s.font=i,s.textColor=o}else{const a=e.parse(t[i],1,yt);if(!a)return null;const o=a.type.kind;if("string"!==o&&"value"!==o&&"null"!==o&&"resolvedImage"!==o)return e.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");n=!0,r.push({content:a,scale:null,font:null,textColor:null})}}return new di(r)}evaluate(t){return new Qt(this.sections.map((e=>{const i=e.content.evaluate(t);return oe(i)===xt?new Yt("",i,null,null,null):new Yt(se(i),null,e.scale?e.scale.evaluate(t):null,e.font?e.font.evaluate(t).join(","):null,e.textColor?e.textColor.evaluate(t):null)})))}eachChild(t){for(const e of this.sections)t(e.content),e.scale&&t(e.scale),e.font&&t(e.font),e.textColor&&t(e.textColor)}outputDefined(){return!1}}class pi{constructor(t){this.type=xt,this.input=t}static parse(t,e){if(2!==t.length)return e.error("Expected two arguments.");const i=e.parse(t[1],1,pt);return i?new pi(i):e.error("No image name provided.")}evaluate(t){const e=this.input.evaluate(t),i=re.fromString(e);return i&&t.availableImages&&(i.available=t.availableImages.indexOf(e)>-1),i}eachChild(t){t(this.input)}outputDefined(){return!1}}class mi{constructor(t){this.type=dt,this.input=t}static parse(t,e){if(2!==t.length)return e.error(`Expected 1 argument, but found ${t.length-1} instead.`);const i=e.parse(t[1],1);return i?"array"!==i.type.kind&&"string"!==i.type.kind&&"value"!==i.type.kind?e.error(`Expected argument of type string or array, but found ${kt(i.type)} instead.`):new mi(i):null}evaluate(t){const e=this.input.evaluate(t);if("string"==typeof e)return e.length;if(Array.isArray(e))return e.length;throw new ce(`Expected value to be of type string or array, but found ${kt(oe(e))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}}const fi={"==":ai,"!=":oi,">":li,"<":si,">=":hi,"<=":ci,array:ue,at:Ke,boolean:ue,case:ti,coalesce:We,collator:ye,format:di,image:pi,in:Je,"index-of":Ye,interpolate:qe,"interpolate-hcl":qe,"interpolate-lab":qe,length:mi,let:Xe,literal:le,match:Qe,number:ue,"number-format":ui,object:ue,slice:ei,step:je,string:ue,"to-boolean":pe,"to-color":pe,"to-number":pe,"to-string":pe,var:Re,within:De};function gi(t,[e,i,r,n]){e=e.evaluate(t),i=i.evaluate(t),r=r.evaluate(t);const a=n?n.evaluate(t):1,o=ne(e,i,r,a);if(o)throw new ce(o);return new Kt(e/255,i/255,r/255,a,!1)}function yi(t,e){return t in e}function _i(t,e){const i=e[t];return void 0===i?null:i}function vi(t){return{type:t}}function bi(t){return{result:"success",value:t}}function xi(t){return{result:"error",value:t}}function wi(t){return"data-driven"===t["property-type"]||"cross-faded-data-driven"===t["property-type"]}function Si(t){return!!t.expression&&t.expression.parameters.indexOf("zoom")>-1}function ki(t){return!!t.expression&&t.expression.interpolated}function Ci(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":null===t?"null":typeof t}function Ai(t){return"object"==typeof t&&null!==t&&!Array.isArray(t)}function Ti(t){return t}function Ei(t,e){const i="color"===e.type,r=t.stops&&"object"==typeof t.stops[0][0],n=r||!(r||void 0!==t.property),a=t.type||(ki(e)?"exponential":"interval");if(i||"padding"===e.type){const r=i?Kt.parse:te.parse;(t=lt({},t)).stops&&(t.stops=t.stops.map((t=>[t[0],r(t[1])]))),t.default=r(t.default?t.default:e.default)}if(t.colorSpace&&"rgb"!==(o=t.colorSpace)&&"hcl"!==o&&"lab"!==o)throw new Error(`Unknown color space: "${t.colorSpace}"`);var o;let s,l,c;if("exponential"===a)s=Pi;else if("interval"===a)s=zi;else if("categorical"===a){s=Ii,l=Object.create(null);for(const e of t.stops)l[e[0]]=e[1];c=typeof t.stops[0][0]}else{if("identity"!==a)throw new Error(`Unknown function type "${a}"`);s=Li}if(r){const i={},r=[];for(let e=0;e<t.stops.length;e++){const n=t.stops[e],a=n[0].zoom;void 0===i[a]&&(i[a]={zoom:a,type:t.type,property:t.property,default:t.default,stops:[]},r.push(a)),i[a].stops.push([n[0].value,n[1]])}const n=[];for(const t of r)n.push([i[t].zoom,Ei(i[t],e)]);const a={name:"linear"};return{kind:"composite",interpolationType:a,interpolationFactor:qe.interpolationFactor.bind(void 0,a),zoomStops:n.map((t=>t[0])),evaluate:({zoom:i},r)=>Pi({stops:n,base:t.base},e,i).evaluate(i,r)}}if(n){const i="exponential"===a?{name:"exponential",base:void 0!==t.base?t.base:1}:null;return{kind:"camera",interpolationType:i,interpolationFactor:qe.interpolationFactor.bind(void 0,i),zoomStops:t.stops.map((t=>t[0])),evaluate:({zoom:i})=>s(t,e,i,l,c)}}return{kind:"source",evaluate(i,r){const n=r&&r.properties?r.properties[t.property]:void 0;return void 0===n?Mi(t.default,e.default):s(t,e,n,l,c)}}}function Mi(t,e,i){return void 0!==t?t:void 0!==e?e:void 0!==i?i:void 0}function Ii(t,e,i,r,n){return Mi(typeof i===n?r[i]:void 0,t.default,e.default)}function zi(t,e,i){if("number"!==Ci(i))return Mi(t.default,e.default);const r=t.stops.length;if(1===r)return t.stops[0][1];if(i<=t.stops[0][0])return t.stops[0][1];if(i>=t.stops[r-1][0])return t.stops[r-1][1];const n=Ne(t.stops.map((t=>t[0])),i);return t.stops[n][1]}function Pi(t,e,i){const r=void 0!==t.base?t.base:1;if("number"!==Ci(i))return Mi(t.default,e.default);const n=t.stops.length;if(1===n)return t.stops[0][1];if(i<=t.stops[0][0])return t.stops[0][1];if(i>=t.stops[n-1][0])return t.stops[n-1][1];const a=Ne(t.stops.map((t=>t[0])),i),o=function(t,e,i,r){const n=r-i,a=t-i;return 0===n?0:1===e?a/n:(Math.pow(e,a)-1)/(Math.pow(e,n)-1)}(i,r,t.stops[a][0],t.stops[a+1][0]),s=t.stops[a][1],l=t.stops[a+1][1],c=He[e.type]||Ti;return"function"==typeof s.evaluate?{evaluate(...e){const i=s.evaluate.apply(void 0,e),r=l.evaluate.apply(void 0,e);if(void 0!==i&&void 0!==r)return c(i,r,o,t.colorSpace)}}:c(s,l,o,t.colorSpace)}function Li(t,e,i){switch(e.type){case"color":i=Kt.parse(i);break;case"formatted":i=Qt.fromString(i.toString());break;case"resolvedImage":i=re.fromString(i.toString());break;case"padding":i=te.parse(i);break;default:Ci(i)===e.type||"enum"===e.type&&e.values[i]||(i=void 0)}return Mi(i,t.default,e.default)}Be.register(fi,{error:[{kind:"error"},[pt],(t,[e])=>{throw new ce(e.evaluate(t))}],typeof:[pt,[yt],(t,[e])=>kt(oe(e.evaluate(t)))],"to-rgba":[St(dt,4),[ft],(t,[e])=>{const[i,r,n,a]=e.evaluate(t).rgb;return[255*i,255*r,255*n,a]}],rgb:[ft,[dt,dt,dt],gi],rgba:[ft,[dt,dt,dt,dt],gi],has:{type:mt,overloads:[[[pt],(t,[e])=>yi(e.evaluate(t),t.properties())],[[pt,gt],(t,[e,i])=>yi(e.evaluate(t),i.evaluate(t))]]},get:{type:yt,overloads:[[[pt],(t,[e])=>_i(e.evaluate(t),t.properties())],[[pt,gt],(t,[e,i])=>_i(e.evaluate(t),i.evaluate(t))]]},"feature-state":[yt,[pt],(t,[e])=>_i(e.evaluate(t),t.featureState||{})],properties:[gt,[],t=>t.properties()],"geometry-type":[pt,[],t=>t.geometryType()],id:[yt,[],t=>t.id()],zoom:[dt,[],t=>t.globals.zoom],"heatmap-density":[dt,[],t=>t.globals.heatmapDensity||0],"line-progress":[dt,[],t=>t.globals.lineProgress||0],accumulated:[yt,[],t=>void 0===t.globals.accumulated?null:t.globals.accumulated],"+":[dt,vi(dt),(t,e)=>{let i=0;for(const r of e)i+=r.evaluate(t);return i}],"*":[dt,vi(dt),(t,e)=>{let i=1;for(const r of e)i*=r.evaluate(t);return i}],"-":{type:dt,overloads:[[[dt,dt],(t,[e,i])=>e.evaluate(t)-i.evaluate(t)],[[dt],(t,[e])=>-e.evaluate(t)]]},"/":[dt,[dt,dt],(t,[e,i])=>e.evaluate(t)/i.evaluate(t)],"%":[dt,[dt,dt],(t,[e,i])=>e.evaluate(t)%i.evaluate(t)],ln2:[dt,[],()=>Math.LN2],pi:[dt,[],()=>Math.PI],e:[dt,[],()=>Math.E],"^":[dt,[dt,dt],(t,[e,i])=>Math.pow(e.evaluate(t),i.evaluate(t))],sqrt:[dt,[dt],(t,[e])=>Math.sqrt(e.evaluate(t))],log10:[dt,[dt],(t,[e])=>Math.log(e.evaluate(t))/Math.LN10],ln:[dt,[dt],(t,[e])=>Math.log(e.evaluate(t))],log2:[dt,[dt],(t,[e])=>Math.log(e.evaluate(t))/Math.LN2],sin:[dt,[dt],(t,[e])=>Math.sin(e.evaluate(t))],cos:[dt,[dt],(t,[e])=>Math.cos(e.evaluate(t))],tan:[dt,[dt],(t,[e])=>Math.tan(e.evaluate(t))],asin:[dt,[dt],(t,[e])=>Math.asin(e.evaluate(t))],acos:[dt,[dt],(t,[e])=>Math.acos(e.evaluate(t))],atan:[dt,[dt],(t,[e])=>Math.atan(e.evaluate(t))],min:[dt,vi(dt),(t,e)=>Math.min(...e.map((e=>e.evaluate(t))))],max:[dt,vi(dt),(t,e)=>Math.max(...e.map((e=>e.evaluate(t))))],abs:[dt,[dt],(t,[e])=>Math.abs(e.evaluate(t))],round:[dt,[dt],(t,[e])=>{const i=e.evaluate(t);return i<0?-Math.round(-i):Math.round(i)}],floor:[dt,[dt],(t,[e])=>Math.floor(e.evaluate(t))],ceil:[dt,[dt],(t,[e])=>Math.ceil(e.evaluate(t))],"filter-==":[mt,[pt,yt],(t,[e,i])=>t.properties()[e.value]===i.value],"filter-id-==":[mt,[yt],(t,[e])=>t.id()===e.value],"filter-type-==":[mt,[pt],(t,[e])=>t.geometryType()===e.value],"filter-<":[mt,[pt,yt],(t,[e,i])=>{const r=t.properties()[e.value],n=i.value;return typeof r==typeof n&&r<n}],"filter-id-<":[mt,[yt],(t,[e])=>{const i=t.id(),r=e.value;return typeof i==typeof r&&i<r}],"filter->":[mt,[pt,yt],(t,[e,i])=>{const r=t.properties()[e.value],n=i.value;return typeof r==typeof n&&r>n}],"filter-id->":[mt,[yt],(t,[e])=>{const i=t.id(),r=e.value;return typeof i==typeof r&&i>r}],"filter-<=":[mt,[pt,yt],(t,[e,i])=>{const r=t.properties()[e.value],n=i.value;return typeof r==typeof n&&r<=n}],"filter-id-<=":[mt,[yt],(t,[e])=>{const i=t.id(),r=e.value;return typeof i==typeof r&&i<=r}],"filter->=":[mt,[pt,yt],(t,[e,i])=>{const r=t.properties()[e.value],n=i.value;return typeof r==typeof n&&r>=n}],"filter-id->=":[mt,[yt],(t,[e])=>{const i=t.id(),r=e.value;return typeof i==typeof r&&i>=r}],"filter-has":[mt,[yt],(t,[e])=>e.value in t.properties()],"filter-has-id":[mt,[],t=>null!==t.id()&&void 0!==t.id()],"filter-type-in":[mt,[St(pt)],(t,[e])=>e.value.indexOf(t.geometryType())>=0],"filter-id-in":[mt,[St(yt)],(t,[e])=>e.value.indexOf(t.id())>=0],"filter-in-small":[mt,[pt,St(yt)],(t,[e,i])=>i.value.indexOf(t.properties()[e.value])>=0],"filter-in-large":[mt,[pt,St(yt)],(t,[e,i])=>function(t,e,i,r){for(;i<=r;){const n=i+r>>1;if(e[n]===t)return!0;e[n]>t?r=n-1:i=n+1}return!1}(t.properties()[e.value],i.value,0,i.value.length-1)],all:{type:mt,overloads:[[[mt,mt],(t,[e,i])=>e.evaluate(t)&&i.evaluate(t)],[vi(mt),(t,e)=>{for(const i of e)if(!i.evaluate(t))return!1;return!0}]]},any:{type:mt,overloads:[[[mt,mt],(t,[e,i])=>e.evaluate(t)||i.evaluate(t)],[vi(mt),(t,e)=>{for(const i of e)if(i.evaluate(t))return!0;return!1}]]},"!":[mt,[mt],(t,[e])=>!e.evaluate(t)],"is-supported-script":[mt,[pt],(t,[e])=>{const i=t.globals&&t.globals.isSupportedScript;return!i||i(e.evaluate(t))}],upcase:[pt,[pt],(t,[e])=>e.evaluate(t).toUpperCase()],downcase:[pt,[pt],(t,[e])=>e.evaluate(t).toLowerCase()],concat:[pt,vi(yt),(t,e)=>e.map((e=>se(e.evaluate(t)))).join("")],"resolved-locale":[pt,[_t],(t,[e])=>e.evaluate(t).resolvedLocale()]});class Di{constructor(t,e){var i;this.expression=t,this._warningHistory={},this._evaluator=new fe,this._defaultValue=e?"color"===(i=e).type&&Ai(i.default)?new Kt(0,0,0,0):"color"===i.type?Kt.parse(i.default)||null:"padding"===i.type?te.parse(i.default)||null:"variableAnchorOffsetCollection"===i.type?ie.parse(i.default)||null:void 0===i.default?null:i.default:null,this._enumValues=e&&"enum"===e.type?e.values:null}evaluateWithoutErrorHandling(t,e,i,r,n,a){return this._evaluator.globals=t,this._evaluator.feature=e,this._evaluator.featureState=i,this._evaluator.canonical=r,this._evaluator.availableImages=n||null,this._evaluator.formattedSection=a,this.expression.evaluate(this._evaluator)}evaluate(t,e,i,r,n,a){this._evaluator.globals=t,this._evaluator.feature=e||null,this._evaluator.featureState=i||null,this._evaluator.canonical=r,this._evaluator.availableImages=n||null,this._evaluator.formattedSection=a||null;try{const t=this.expression.evaluate(this._evaluator);if(null==t||"number"==typeof t&&t!=t)return this._defaultValue;if(this._enumValues&&!(t in this._enumValues))throw new ce(`Expected value to be one of ${Object.keys(this._enumValues).map((t=>JSON.stringify(t))).join(", ")}, but found ${JSON.stringify(t)} instead.`);return t}catch(t){return this._warningHistory[t.message]||(this._warningHistory[t.message]=!0,"undefined"!=typeof console&&console.warn(t.message)),this._defaultValue}}}function Ri(t){return Array.isArray(t)&&t.length>0&&"string"==typeof t[0]&&t[0]in fi}function Bi(t,e){const i=new ge(fi,Fe,[],e?function(t){const e={color:ft,string:pt,number:dt,enum:pt,boolean:mt,formatted:vt,padding:bt,resolvedImage:xt,variableAnchorOffsetCollection:wt};return"array"===t.type?St(e[t.value]||yt,t.length):e[t.type]}(e):void 0),r=i.parse(t,void 0,void 0,void 0,e&&"string"===e.type?{typeAnnotation:"coerce"}:void 0);return r?bi(new Di(r,e)):xi(i.errors)}class Fi{constructor(t,e){this.kind=t,this._styleExpression=e,this.isStateDependent="constant"!==t&&!$e(e.expression)}evaluateWithoutErrorHandling(t,e,i,r,n,a){return this._styleExpression.evaluateWithoutErrorHandling(t,e,i,r,n,a)}evaluate(t,e,i,r,n,a){return this._styleExpression.evaluate(t,e,i,r,n,a)}}class Oi{constructor(t,e,i,r){this.kind=t,this.zoomStops=i,this._styleExpression=e,this.isStateDependent="camera"!==t&&!$e(e.expression),this.interpolationType=r}evaluateWithoutErrorHandling(t,e,i,r,n,a){return this._styleExpression.evaluateWithoutErrorHandling(t,e,i,r,n,a)}evaluate(t,e,i,r,n,a){return this._styleExpression.evaluate(t,e,i,r,n,a)}interpolationFactor(t,e,i){return this.interpolationType?qe.interpolationFactor(this.interpolationType,t,e,i):0}}function $i(t,e){const i=Bi(t,e);if("error"===i.result)return i;const r=i.value.expression,n=Oe(r);if(!n&&!wi(e))return xi([new ct("","data expressions not supported")]);const a=Ve(r,["zoom"]);if(!a&&!Si(e))return xi([new ct("","zoom expressions not supported")]);const o=Ni(r);return o||a?o instanceof ct?xi([o]):o instanceof qe&&!ki(e)?xi([new ct("",'"interpolate" expressions cannot be used with this property')]):bi(o?new Oi(n?"camera":"composite",i.value,o.labels,o instanceof qe?o.interpolation:void 0):new Fi(n?"constant":"source",i.value)):xi([new ct("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Vi{constructor(t,e){this._parameters=t,this._specification=e,lt(this,Ei(this._parameters,this._specification))}static deserialize(t){return new Vi(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function Ni(t){let e=null;if(t instanceof Xe)e=Ni(t.result);else if(t instanceof We){for(const i of t.args)if(e=Ni(i),e)break}else(t instanceof je||t instanceof qe)&&t.input instanceof Be&&"zoom"===t.input.name&&(e=t);return e instanceof ct||t.eachChild((t=>{const i=Ni(t);i instanceof ct?e=i:!e&&i?e=new ct("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&i&&e!==i&&(e=new ct("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),e}function ji(t){if(!0===t||!1===t)return!0;if(!Array.isArray(t)||0===t.length)return!1;switch(t[0]){case"has":return t.length>=2&&"$id"!==t[1]&&"$type"!==t[1];case"in":return t.length>=3&&("string"!=typeof t[1]||Array.isArray(t[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==t.length||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(const e of t.slice(1))if(!ji(e)&&"boolean"!=typeof e)return!1;return!0;default:return!0}}const Ui={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Zi(t){if(null==t)return{filter:()=>!0,needGeometry:!1};ji(t)||(t=Gi(t));const e=Bi(t,Ui);if("error"===e.result)throw new Error(e.value.map((t=>`${t.key}: ${t.message}`)).join(", "));return{filter:(t,i,r)=>e.value.evaluate(t,i,{},r),needGeometry:qi(t)}}function Hi(t,e){return t<e?-1:t>e?1:0}function qi(t){if(!Array.isArray(t))return!1;if("within"===t[0])return!0;for(let e=1;e<t.length;e++)if(qi(t[e]))return!0;return!1}function Gi(t){if(!t)return!0;const e=t[0];return t.length<=1?"any"!==e:"=="===e?Wi(t[1],t[2],"=="):"!="===e?Ji(Wi(t[1],t[2],"==")):"<"===e||">"===e||"<="===e||">="===e?Wi(t[1],t[2],e):"any"===e?(i=t.slice(1),["any"].concat(i.map(Gi))):"all"===e?["all"].concat(t.slice(1).map(Gi)):"none"===e?["all"].concat(t.slice(1).map(Gi).map(Ji)):"in"===e?Xi(t[1],t.slice(2)):"!in"===e?Ji(Xi(t[1],t.slice(2))):"has"===e?Ki(t[1]):"!has"===e?Ji(Ki(t[1])):"within"!==e||t;var i}function Wi(t,e,i){switch(t){case"$type":return[`filter-type-${i}`,e];case"$id":return[`filter-id-${i}`,e];default:return[`filter-${i}`,t,e]}}function Xi(t,e){if(0===e.length)return!1;switch(t){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some((t=>typeof t!=typeof e[0]))?["filter-in-large",t,["literal",e.sort(Hi)]]:["filter-in-small",t,["literal",e]]}}function Ki(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function Ji(t){return["!",t]}function Yi(t){const e=typeof t;if("number"===e||"boolean"===e||"string"===e||null==t)return JSON.stringify(t);if(Array.isArray(t)){let e="[";for(const i of t)e+=`${Yi(i)},`;return`${e}]`}const i=Object.keys(t).sort();let r="{";for(let e=0;e<i.length;e++)r+=`${JSON.stringify(i[e])}:${Yi(t[i[e]])},`;return`${r}}`}function Qi(t){let e="";for(const i of K)e+=`/${Yi(t[i])}`;return e}function tr(t){const e=t.value;return e?[new st(t.key,e,"constants have been deprecated as of v8")]:[]}function er(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function ir(t){if(Array.isArray(t))return t.map(ir);if(t instanceof Object&&!(t instanceof Number||t instanceof String||t instanceof Boolean)){const e={};for(const i in t)e[i]=ir(t[i]);return e}return er(t)}function rr(t){const e=t.key,i=t.value,r=t.valueSpec||{},n=t.objectElementValidators||{},a=t.style,o=t.styleSpec,s=t.validateSpec;let l=[];const c=Ci(i);if("object"!==c)return[new st(e,i,`object expected, ${c} found`)];for(const t in i){const c=t.split(".")[0],h=r[c]||r["*"];let u;if(n[c])u=n[c];else if(r[c])u=s;else if(n["*"])u=n["*"];else{if(!r["*"]){l.push(new st(e,i[t],`unknown property "${t}"`));continue}u=s}l=l.concat(u({key:(e?`${e}.`:e)+t,value:i[t],valueSpec:h,style:a,styleSpec:o,object:i,objectKey:t,validateSpec:s},i))}for(const t in r)n[t]||r[t].required&&void 0===r[t].default&&void 0===i[t]&&l.push(new st(e,i,`missing required property "${t}"`));return l}function nr(t){const e=t.value,i=t.valueSpec,r=t.style,n=t.styleSpec,a=t.key,o=t.arrayElementValidator||t.validateSpec;if("array"!==Ci(e))return[new st(a,e,`array expected, ${Ci(e)} found`)];if(i.length&&e.length!==i.length)return[new st(a,e,`array length ${i.length} expected, length ${e.length} found`)];if(i["min-length"]&&e.length<i["min-length"])return[new st(a,e,`array length at least ${i["min-length"]} expected, length ${e.length} found`)];let s={type:i.value,values:i.values};n.$version<7&&(s.function=i.function),"object"===Ci(i.value)&&(s=i.value);let l=[];for(let i=0;i<e.length;i++)l=l.concat(o({array:e,arrayIndex:i,value:e[i],valueSpec:s,validateSpec:t.validateSpec,style:r,styleSpec:n,key:`${a}[${i}]`}));return l}function ar(t){const e=t.key,i=t.value,r=t.valueSpec;let n=Ci(i);return"number"===n&&i!=i&&(n="NaN"),"number"!==n?[new st(e,i,`number expected, ${n} found`)]:"minimum"in r&&i<r.minimum?[new st(e,i,`${i} is less than the minimum value ${r.minimum}`)]:"maximum"in r&&i>r.maximum?[new st(e,i,`${i} is greater than the maximum value ${r.maximum}`)]:[]}function or(t){const e=t.valueSpec,i=er(t.value.type);let r,n,a,o={};const s="categorical"!==i&&void 0===t.value.property,l=!s,c="array"===Ci(t.value.stops)&&"array"===Ci(t.value.stops[0])&&"object"===Ci(t.value.stops[0][0]),h=rr({key:t.key,value:t.value,valueSpec:t.styleSpec.function,validateSpec:t.validateSpec,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:function(t){if("identity"===i)return[new st(t.key,t.value,'identity function may not have a "stops" property')];let e=[];const r=t.value;return e=e.concat(nr({key:t.key,value:r,valueSpec:t.valueSpec,validateSpec:t.validateSpec,style:t.style,styleSpec:t.styleSpec,arrayElementValidator:u})),"array"===Ci(r)&&0===r.length&&e.push(new st(t.key,r,"array must have at least one stop")),e},default:function(t){return t.validateSpec({key:t.key,value:t.value,valueSpec:e,validateSpec:t.validateSpec,style:t.style,styleSpec:t.styleSpec})}}});return"identity"===i&&s&&h.push(new st(t.key,t.value,'missing required property "property"')),"identity"===i||t.value.stops||h.push(new st(t.key,t.value,'missing required property "stops"')),"exponential"===i&&t.valueSpec.expression&&!ki(t.valueSpec)&&h.push(new st(t.key,t.value,"exponential functions not supported")),t.styleSpec.$version>=8&&(l&&!wi(t.valueSpec)?h.push(new st(t.key,t.value,"property functions not supported")):s&&!Si(t.valueSpec)&&h.push(new st(t.key,t.value,"zoom functions not supported"))),"categorical"!==i&&!c||void 0!==t.value.property||h.push(new st(t.key,t.value,'"property" property is required')),h;function u(t){let i=[];const r=t.value,s=t.key;if("array"!==Ci(r))return[new st(s,r,`array expected, ${Ci(r)} found`)];if(2!==r.length)return[new st(s,r,`array length 2 expected, length ${r.length} found`)];if(c){if("object"!==Ci(r[0]))return[new st(s,r,`object expected, ${Ci(r[0])} found`)];if(void 0===r[0].zoom)return[new st(s,r,"object stop key must have zoom")];if(void 0===r[0].value)return[new st(s,r,"object stop key must have value")];if(a&&a>er(r[0].zoom))return[new st(s,r[0].zoom,"stop zoom values must appear in ascending order")];er(r[0].zoom)!==a&&(a=er(r[0].zoom),n=void 0,o={}),i=i.concat(rr({key:`${s}[0]`,value:r[0],valueSpec:{zoom:{}},validateSpec:t.validateSpec,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{zoom:ar,value:d}}))}else i=i.concat(d({key:`${s}[0]`,value:r[0],valueSpec:{},validateSpec:t.validateSpec,style:t.style,styleSpec:t.styleSpec},r));return Ri(ir(r[1]))?i.concat([new st(`${s}[1]`,r[1],"expressions are not allowed in function stops.")]):i.concat(t.validateSpec({key:`${s}[1]`,value:r[1],valueSpec:e,validateSpec:t.validateSpec,style:t.style,styleSpec:t.styleSpec}))}function d(t,a){const s=Ci(t.value),l=er(t.value),c=null!==t.value?t.value:a;if(r){if(s!==r)return[new st(t.key,c,`${s} stop domain type must match previous stop domain type ${r}`)]}else r=s;if("number"!==s&&"string"!==s&&"boolean"!==s)return[new st(t.key,c,"stop domain value must be a number, string, or boolean")];if("number"!==s&&"categorical"!==i){let r=`number expected, ${s} found`;return wi(e)&&void 0===i&&(r+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new st(t.key,c,r)]}return"categorical"!==i||"number"!==s||isFinite(l)&&Math.floor(l)===l?"categorical"!==i&&"number"===s&&void 0!==n&&l<n?[new st(t.key,c,"stop domain values must appear in ascending order")]:(n=l,"categorical"===i&&l in o?[new st(t.key,c,"stop domain values must be unique")]:(o[l]=!0,[])):[new st(t.key,c,`integer expected, found ${l}`)]}}function sr(t){const e=("property"===t.expressionContext?$i:Bi)(ir(t.value),t.valueSpec);if("error"===e.result)return e.value.map((e=>new st(`${t.key}${e.key}`,t.value,e.message)));const i=e.value.expression||e.value._styleExpression.expression;if("property"===t.expressionContext&&"text-font"===t.propertyKey&&!i.outputDefined())return[new st(t.key,t.value,`Invalid data expression for "${t.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===t.expressionContext&&"layout"===t.propertyType&&!$e(i))return[new st(t.key,t.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===t.expressionContext&&!$e(i))return[new st(t.key,t.value,'"feature-state" data expressions are not supported with filters.')];if(t.expressionContext&&0===t.expressionContext.indexOf("cluster")){if(!Ve(i,["zoom","feature-state"]))return[new st(t.key,t.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===t.expressionContext&&!Oe(i))return[new st(t.key,t.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function lr(t){const e=t.key,i=t.value,r=t.valueSpec,n=[];return Array.isArray(r.values)?-1===r.values.indexOf(er(i))&&n.push(new st(e,i,`expected one of [${r.values.join(", ")}], ${JSON.stringify(i)} found`)):-1===Object.keys(r.values).indexOf(er(i))&&n.push(new st(e,i,`expected one of [${Object.keys(r.values).join(", ")}], ${JSON.stringify(i)} found`)),n}function cr(t){return ji(ir(t.value))?sr(lt({},t,{expressionContext:"filter",valueSpec:{value:"boolean"}})):hr(t)}function hr(t){const e=t.value,i=t.key;if("array"!==Ci(e))return[new st(i,e,`array expected, ${Ci(e)} found`)];const r=t.styleSpec;let n,a=[];if(e.length<1)return[new st(i,e,"filter array must have at least 1 element")];switch(a=a.concat(lr({key:`${i}[0]`,value:e[0],valueSpec:r.filter_operator,style:t.style,styleSpec:t.styleSpec})),er(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&"$type"===er(e[1])&&a.push(new st(i,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":3!==e.length&&a.push(new st(i,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(n=Ci(e[1]),"string"!==n&&a.push(new st(`${i}[1]`,e[1],`string expected, ${n} found`)));for(let o=2;o<e.length;o++)n=Ci(e[o]),"$type"===er(e[1])?a=a.concat(lr({key:`${i}[${o}]`,value:e[o],valueSpec:r.geometry_type,style:t.style,styleSpec:t.styleSpec})):"string"!==n&&"number"!==n&&"boolean"!==n&&a.push(new st(`${i}[${o}]`,e[o],`string, number, or boolean expected, ${n} found`));break;case"any":case"all":case"none":for(let r=1;r<e.length;r++)a=a.concat(hr({key:`${i}[${r}]`,value:e[r],style:t.style,styleSpec:t.styleSpec}));break;case"has":case"!has":n=Ci(e[1]),2!==e.length?a.push(new st(i,e,`filter array for "${e[0]}" operator must have 2 elements`)):"string"!==n&&a.push(new st(`${i}[1]`,e[1],`string expected, ${n} found`));break;case"within":n=Ci(e[1]),2!==e.length?a.push(new st(i,e,`filter array for "${e[0]}" operator must have 2 elements`)):"object"!==n&&a.push(new st(`${i}[1]`,e[1],`object expected, ${n} found`))}return a}function ur(t,e){const i=t.key,r=t.validateSpec,n=t.style,a=t.styleSpec,o=t.value,s=t.objectKey,l=a[`${e}_${t.layerType}`];if(!l)return[];const c=s.match(/^(.*)-transition$/);if("paint"===e&&c&&l[c[1]]&&l[c[1]].transition)return r({key:i,value:o,valueSpec:a.transition,style:n,styleSpec:a});const h=t.valueSpec||l[s];if(!h)return[new st(i,o,`unknown property "${s}"`)];let u;if("string"===Ci(o)&&wi(h)&&!h.tokens&&(u=/^{([^}]+)}$/.exec(o)))return[new st(i,o,`"${s}" does not support interpolation syntax\nUse an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(u[1])} }\`.`)];const d=[];return"symbol"===t.layerType&&("text-field"===s&&n&&!n.glyphs&&d.push(new st(i,o,'use of "text-field" requires a style "glyphs" property')),"text-font"===s&&Ai(ir(o))&&"identity"===er(o.type)&&d.push(new st(i,o,'"text-font" does not support identity functions'))),d.concat(r({key:t.key,value:o,valueSpec:h,style:n,styleSpec:a,expressionContext:"property",propertyType:e,propertyKey:s}))}function dr(t){return ur(t,"paint")}function pr(t){return ur(t,"layout")}function mr(t){let e=[];const i=t.value,r=t.key,n=t.style,a=t.styleSpec;i.type||i.ref||e.push(new st(r,i,'either "type" or "ref" is required'));let o=er(i.type);const s=er(i.ref);if(i.id){const a=er(i.id);for(let o=0;o<t.arrayIndex;o++){const t=n.layers[o];er(t.id)===a&&e.push(new st(r,i.id,`duplicate layer id "${i.id}", previously used at line ${t.id.__line__}`))}}if("ref"in i){let t;["type","source","source-layer","filter","layout"].forEach((t=>{t in i&&e.push(new st(r,i[t],`"${t}" is prohibited for ref layers`))})),n.layers.forEach((e=>{er(e.id)===s&&(t=e)})),t?t.ref?e.push(new st(r,i.ref,"ref cannot reference another ref layer")):o=er(t.type):e.push(new st(r,i.ref,`ref layer "${s}" not found`))}else if("background"!==o)if(i.source){const t=n.sources&&n.sources[i.source],a=t&&er(t.type);t?"vector"===a&&"raster"===o?e.push(new st(r,i.source,`layer "${i.id}" requires a raster source`)):"raster-dem"!==a&&"hillshade"===o?e.push(new st(r,i.source,`layer "${i.id}" requires a raster-dem source`)):"raster"===a&&"raster"!==o?e.push(new st(r,i.source,`layer "${i.id}" requires a vector source`)):"vector"!==a||i["source-layer"]?"raster-dem"===a&&"hillshade"!==o?e.push(new st(r,i.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==o||!i.paint||!i.paint["line-gradient"]||"geojson"===a&&t.lineMetrics||e.push(new st(r,i,`layer "${i.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new st(r,i,`layer "${i.id}" must specify a "source-layer"`)):e.push(new st(r,i.source,`source "${i.source}" not found`))}else e.push(new st(r,i,'missing required property "source"'));return e=e.concat(rr({key:r,value:i,valueSpec:a.layer,style:t.style,styleSpec:t.styleSpec,validateSpec:t.validateSpec,objectElementValidators:{"*":()=>[],type:()=>t.validateSpec({key:`${r}.type`,value:i.type,valueSpec:a.layer.type,style:t.style,styleSpec:t.styleSpec,validateSpec:t.validateSpec,object:i,objectKey:"type"}),filter:cr,layout:t=>rr({layer:i,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,validateSpec:t.validateSpec,objectElementValidators:{"*":t=>pr(lt({layerType:o},t))}}),paint:t=>rr({layer:i,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,validateSpec:t.validateSpec,objectElementValidators:{"*":t=>dr(lt({layerType:o},t))}})}})),e}function fr(t){const e=t.value,i=t.key,r=Ci(e);return"string"!==r?[new st(i,e,`string expected, ${r} found`)]:[]}const gr={promoteId:function({key:t,value:e}){if("string"===Ci(e))return fr({key:t,value:e});{const i=[];for(const r in e)i.push(...fr({key:`${t}.${r}`,value:e[r]}));return i}}};function yr(t){const e=t.value,i=t.key,r=t.styleSpec,n=t.style,a=t.validateSpec;if(!e.type)return[new st(i,e,'"type" is required')];const o=er(e.type);let s;switch(o){case"vector":case"raster":return s=rr({key:i,value:e,valueSpec:r[`source_${o.replace("-","_")}`],style:t.style,styleSpec:r,objectElementValidators:gr,validateSpec:a}),s;case"raster-dem":return s=function(t){var e;const i=null!==(e=t.sourceName)&&void 0!==e?e:"",r=t.value,n=t.styleSpec,a=n.source_raster_dem,o=t.style;let s=[];const l=Ci(r);if(void 0===r)return s;if("object"!==l)return s.push(new st("source_raster_dem",r,`object expected, ${l} found`)),s;const c="custom"===er(r.encoding),h=["redFactor","greenFactor","blueFactor","baseShift"],u=t.value.encoding?`"${t.value.encoding}"`:"Default";for(const e in r)!c&&h.includes(e)?s.push(new st(e,r[e],`In "${i}": "${e}" is only valid when "encoding" is set to "custom". ${u} encoding found`)):a[e]?s=s.concat(t.validateSpec({key:e,value:r[e],valueSpec:a[e],validateSpec:t.validateSpec,style:o,styleSpec:n})):s.push(new st(e,r[e],`unknown property "${e}"`));return s}({sourceName:i,value:e,style:t.style,styleSpec:r,validateSpec:a}),s;case"geojson":if(s=rr({key:i,value:e,valueSpec:r.source_geojson,style:n,styleSpec:r,validateSpec:a,objectElementValidators:gr}),e.cluster)for(const t in e.clusterProperties){const[r,n]=e.clusterProperties[t],o="string"==typeof r?[r,["accumulated"],["get",t]]:r;s.push(...sr({key:`${i}.${t}.map`,value:n,validateSpec:a,expressionContext:"cluster-map"})),s.push(...sr({key:`${i}.${t}.reduce`,value:o,validateSpec:a,expressionContext:"cluster-reduce"}))}return s;case"video":return rr({key:i,value:e,valueSpec:r.source_video,style:n,validateSpec:a,styleSpec:r});case"image":return rr({key:i,value:e,valueSpec:r.source_image,style:n,validateSpec:a,styleSpec:r});case"canvas":return[new st(i,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return lr({key:`${i}.type`,value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:n,validateSpec:a,styleSpec:r})}}function _r(t){const e=t.value,i=t.styleSpec,r=i.light,n=t.style;let a=[];const o=Ci(e);if(void 0===e)return a;if("object"!==o)return a=a.concat([new st("light",e,`object expected, ${o} found`)]),a;for(const o in e){const s=o.match(/^(.*)-transition$/);a=a.concat(s&&r[s[1]]&&r[s[1]].transition?t.validateSpec({key:o,value:e[o],valueSpec:i.transition,validateSpec:t.validateSpec,style:n,styleSpec:i}):r[o]?t.validateSpec({key:o,value:e[o],valueSpec:r[o],validateSpec:t.validateSpec,style:n,styleSpec:i}):[new st(o,e[o],`unknown property "${o}"`)])}return a}function vr(t){const e=t.value,i=t.styleSpec,r=i.terrain,n=t.style;let a=[];const o=Ci(e);if(void 0===e)return a;if("object"!==o)return a=a.concat([new st("terrain",e,`object expected, ${o} found`)]),a;for(const o in e)a=a.concat(r[o]?t.validateSpec({key:o,value:e[o],valueSpec:r[o],validateSpec:t.validateSpec,style:n,styleSpec:i}):[new st(o,e[o],`unknown property "${o}"`)]);return a}function br(t){let e=[];const i=t.value,r=t.key;if(Array.isArray(i)){const n=[],a=[];for(const o in i)i[o].id&&n.includes(i[o].id)&&e.push(new st(r,i,`all the sprites' ids must be unique, but ${i[o].id} is duplicated`)),n.push(i[o].id),i[o].url&&a.includes(i[o].url)&&e.push(new st(r,i,`all the sprites' URLs must be unique, but ${i[o].url} is duplicated`)),a.push(i[o].url),e=e.concat(rr({key:`${r}[${o}]`,value:i[o],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:t.validateSpec}));return e}return fr({key:r,value:i})}const xr={"*":()=>[],array:nr,boolean:function(t){const e=t.value,i=t.key,r=Ci(e);return"boolean"!==r?[new st(i,e,`boolean expected, ${r} found`)]:[]},number:ar,color:function(t){const e=t.key,i=t.value,r=Ci(i);return"string"!==r?[new st(e,i,`color expected, ${r} found`)]:Kt.parse(String(i))?[]:[new st(e,i,`color expected, "${i}" found`)]},constants:tr,enum:lr,filter:cr,function:or,layer:mr,object:rr,source:yr,light:_r,terrain:vr,string:fr,formatted:function(t){return 0===fr(t).length?[]:sr(t)},resolvedImage:function(t){return 0===fr(t).length?[]:sr(t)},padding:function(t){const e=t.key,i=t.value;if("array"===Ci(i)){if(i.length<1||i.length>4)return[new st(e,i,`padding requires 1 to 4 values; ${i.length} values found`)];const r={type:"number"};let n=[];for(let a=0;a<i.length;a++)n=n.concat(t.validateSpec({key:`${e}[${a}]`,value:i[a],validateSpec:t.validateSpec,valueSpec:r}));return n}return ar({key:e,value:i,valueSpec:{}})},variableAnchorOffsetCollection:function(t){const e=t.key,i=t.value,r=Ci(i),n=t.styleSpec;if("array"!==r||i.length<1||i.length%2!=0)return[new st(e,i,"variableAnchorOffsetCollection requires a non-empty array of even length")];let a=[];for(let r=0;r<i.length;r+=2)a=a.concat(lr({key:`${e}[${r}]`,value:i[r],valueSpec:n.layout_symbol["text-anchor"]})),a=a.concat(nr({key:`${e}[${r+1}]`,value:i[r+1],valueSpec:{length:2,value:"number"},validateSpec:t.validateSpec,style:t.style,styleSpec:n}));return a},sprite:br};function wr(t){const e=t.value,i=t.valueSpec,r=t.styleSpec;return t.validateSpec=wr,i.expression&&Ai(er(e))?or(t):i.expression&&Ri(ir(e))?sr(t):i.type&&xr[i.type]?xr[i.type](t):rr(lt({},t,{valueSpec:i.type?r[i.type]:i}))}function Sr(t){const e=t.value,i=t.key,r=fr(t);return r.length||(-1===e.indexOf("{fontstack}")&&r.push(new st(i,e,'"glyphs" url must include a "{fontstack}" token')),-1===e.indexOf("{range}")&&r.push(new st(i,e,'"glyphs" url must include a "{range}" token'))),r}function kr(t,e=X){let i=[];return i=i.concat(wr({key:"",value:t,valueSpec:e.$root,styleSpec:e,style:t,validateSpec:wr,objectElementValidators:{glyphs:Sr,"*":()=>[]}})),t.constants&&(i=i.concat(tr({key:"constants",value:t.constants,style:t,styleSpec:e,validateSpec:wr}))),Ar(i)}function Cr(t){return function(e){return t({...e,validateSpec:wr})}}function Ar(t){return[].concat(t).sort(((t,e)=>t.line-e.line))}function Tr(t){return function(...e){return Ar(t.apply(this,e))}}kr.source=Tr(Cr(yr)),kr.sprite=Tr(Cr(br)),kr.glyphs=Tr(Cr(Sr)),kr.light=Tr(Cr(_r)),kr.terrain=Tr(Cr(vr)),kr.layer=Tr(Cr(mr)),kr.filter=Tr(Cr(cr)),kr.paintProperty=Tr(Cr(dr)),kr.layoutProperty=Tr(Cr(pr));const Er=kr,Mr=Er.light,Ir=Er.paintProperty,zr=Er.layoutProperty;function Pr(t,e){let i=!1;if(e&&e.length)for(const r of e)t.fire(new G(new Error(r.message))),i=!0;return i}class Lr{constructor(t,e,i){const r=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;const n=new Int32Array(this.arrayBuffer);t=n[0],this.d=(e=n[1])+2*(i=n[2]);for(let t=0;t<this.d*this.d;t++){const e=n[3+t],i=n[3+t+1];r.push(e===i?null:n.subarray(e,i))}const a=n[3+r.length+1];this.keys=n.subarray(n[3+r.length],a),this.bboxes=n.subarray(a),this.insert=this._insertReadonly}else{this.d=e+2*i;for(let t=0;t<this.d*this.d;t++)r.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=t,this.padding=i,this.scale=e/t,this.uid=0;const n=i/e*t;this.min=-n,this.max=t+n}insert(t,e,i,r,n){this._forEachCell(e,i,r,n,this._insertCell,this.uid++,void 0,void 0),this.keys.push(t),this.bboxes.push(e),this.bboxes.push(i),this.bboxes.push(r),this.bboxes.push(n)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(t,e,i,r,n,a){this.cells[n].push(a)}query(t,e,i,r,n){const a=this.min,o=this.max;if(t<=a&&e<=a&&o<=i&&o<=r&&!n)return Array.prototype.slice.call(this.keys);{const a=[];return this._forEachCell(t,e,i,r,this._queryCell,a,{},n),a}}_queryCell(t,e,i,r,n,a,o,s){const l=this.cells[n];if(null!==l){const n=this.keys,c=this.bboxes;for(let h=0;h<l.length;h++){const u=l[h];if(void 0===o[u]){const l=4*u;(s?s(c[l+0],c[l+1],c[l+2],c[l+3]):t<=c[l+2]&&e<=c[l+3]&&i>=c[l+0]&&r>=c[l+1])?(o[u]=!0,a.push(n[u])):o[u]=!1}}}}_forEachCell(t,e,i,r,n,a,o,s){const l=this._convertToCellCoord(t),c=this._convertToCellCoord(e),h=this._convertToCellCoord(i),u=this._convertToCellCoord(r);for(let d=l;d<=h;d++)for(let l=c;l<=u;l++){const c=this.d*l+d;if((!s||s(this._convertFromCellCoord(d),this._convertFromCellCoord(l),this._convertFromCellCoord(d+1),this._convertFromCellCoord(l+1)))&&n.call(this,t,e,i,r,c,a,o,s))return}}_convertFromCellCoord(t){return(t-this.padding)/this.scale}_convertToCellCoord(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const t=this.cells,e=3+this.cells.length+1+1;let i=0;for(let t=0;t<this.cells.length;t++)i+=this.cells[t].length;const r=new Int32Array(e+i+this.keys.length+this.bboxes.length);r[0]=this.extent,r[1]=this.n,r[2]=this.padding;let n=e;for(let e=0;e<t.length;e++){const i=t[e];r[3+e]=n,r.set(i,n),n+=i.length}return r[3+t.length]=n,r.set(this.keys,n),n+=this.keys.length,r[3+t.length+1]=n,r.set(this.bboxes,n),n+=this.bboxes.length,r.buffer}static serialize(t,e){const i=t.toArrayBuffer();return e&&e.push(i),{buffer:i}}static deserialize(t){return new Lr(t.buffer)}}const Dr={};function Rr(t,e,i={}){if(Dr[t])throw new Error(`${t} is already registered.`);Object.defineProperty(e,"_classRegistryKey",{value:t,writeable:!1}),Dr[t]={klass:e,omit:i.omit||[],shallow:i.shallow||[]}}Rr("Object",Object),Rr("TransferableGridIndex",Lr),Rr("Color",Kt),Rr("Error",Error),Rr("AJAXError",F),Rr("ResolvedImage",re),Rr("StylePropertyFunction",Vi),Rr("StyleExpression",Di,{omit:["_evaluator"]}),Rr("ZoomDependentExpression",Oi),Rr("ZoomConstantExpression",Fi),Rr("CompoundExpression",Be,{omit:["_evaluate"]});for(const t in fi)fi[t]._classRegistryKey||Rr(`Expression_${t}`,fi[t]);function Br(t){return t&&"undefined"!=typeof ArrayBuffer&&(t instanceof ArrayBuffer||t.constructor&&"ArrayBuffer"===t.constructor.name)}function Fr(t,e){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||t instanceof Blob)return t;if(Br(t))return e&&e.push(t),t;if(E(t))return e&&e.push(t),t;if(ArrayBuffer.isView(t)){const i=t;return e&&e.push(i.buffer),i}if(t instanceof ImageData)return e&&e.push(t.data.buffer),t;if(Array.isArray(t)){const i=[];for(const r of t)i.push(Fr(r,e));return i}if("object"==typeof t){const i=t.constructor,r=i._classRegistryKey;if(!r)throw new Error("can't serialize object of unregistered class");if(!Dr[r])throw new Error(`${r} is not registered.`);const n=i.serialize?i.serialize(t,e):{};if(i.serialize){if(e&&n===e[e.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const i in t){if(!t.hasOwnProperty(i))continue;if(Dr[r].omit.indexOf(i)>=0)continue;const a=t[i];n[i]=Dr[r].shallow.indexOf(i)>=0?a:Fr(a,e)}t instanceof Error&&(n.message=t.message)}if(n.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==r&&(n.$name=r),n}throw new Error("can't serialize object of type "+typeof t)}function Or(t){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||t instanceof Blob||Br(t)||E(t)||ArrayBuffer.isView(t)||t instanceof ImageData)return t;if(Array.isArray(t))return t.map(Or);if("object"==typeof t){const e=t.$name||"Object";if(!Dr[e])throw new Error(`can't deserialize unregistered class ${e}`);const{klass:i}=Dr[e];if(!i)throw new Error(`can't deserialize unregistered class ${e}`);if(i.deserialize)return i.deserialize(t);const r=Object.create(i.prototype);for(const i of Object.keys(t)){if("$name"===i)continue;const n=t[i];r[i]=Dr[e].shallow.indexOf(i)>=0?n:Or(n)}return r}throw new Error("can't deserialize object of type "+typeof t)}class $r{constructor(){this.first=!0}update(t,e){const i=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=i,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=i,!0):(this.lastFloorZoom>i?(this.lastIntegerZoom=i+1,this.lastIntegerZoomTime=e):this.lastFloorZoom<i&&(this.lastIntegerZoom=i,this.lastIntegerZoomTime=e),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=i,!0))}}const Vr={"Latin-1 Supplement":t=>t>=128&&t<=255,Arabic:t=>t>=1536&&t<=1791,"Arabic Supplement":t=>t>=1872&&t<=1919,"Arabic Extended-A":t=>t>=2208&&t<=2303,"Hangul Jamo":t=>t>=4352&&t<=4607,"Unified Canadian Aboriginal Syllabics":t=>t>=5120&&t<=5759,Khmer:t=>t>=6016&&t<=6143,"Unified Canadian Aboriginal Syllabics Extended":t=>t>=6320&&t<=6399,"General Punctuation":t=>t>=8192&&t<=8303,"Letterlike Symbols":t=>t>=8448&&t<=8527,"Number Forms":t=>t>=8528&&t<=8591,"Miscellaneous Technical":t=>t>=8960&&t<=9215,"Control Pictures":t=>t>=9216&&t<=9279,"Optical Character Recognition":t=>t>=9280&&t<=9311,"Enclosed Alphanumerics":t=>t>=9312&&t<=9471,"Geometric Shapes":t=>t>=9632&&t<=9727,"Miscellaneous Symbols":t=>t>=9728&&t<=9983,"Miscellaneous Symbols and Arrows":t=>t>=11008&&t<=11263,"CJK Radicals Supplement":t=>t>=11904&&t<=12031,"Kangxi Radicals":t=>t>=12032&&t<=12255,"Ideographic Description Characters":t=>t>=12272&&t<=12287,"CJK Symbols and Punctuation":t=>t>=12288&&t<=12351,Hiragana:t=>t>=12352&&t<=12447,Katakana:t=>t>=12448&&t<=12543,Bopomofo:t=>t>=12544&&t<=12591,"Hangul Compatibility Jamo":t=>t>=12592&&t<=12687,Kanbun:t=>t>=12688&&t<=12703,"Bopomofo Extended":t=>t>=12704&&t<=12735,"CJK Strokes":t=>t>=12736&&t<=12783,"Katakana Phonetic Extensions":t=>t>=12784&&t<=12799,"Enclosed CJK Letters and Months":t=>t>=12800&&t<=13055,"CJK Compatibility":t=>t>=13056&&t<=13311,"CJK Unified Ideographs Extension A":t=>t>=13312&&t<=19903,"Yijing Hexagram Symbols":t=>t>=19904&&t<=19967,"CJK Unified Ideographs":t=>t>=19968&&t<=40959,"Yi Syllables":t=>t>=40960&&t<=42127,"Yi Radicals":t=>t>=42128&&t<=42191,"Hangul Jamo Extended-A":t=>t>=43360&&t<=43391,"Hangul Syllables":t=>t>=44032&&t<=55215,"Hangul Jamo Extended-B":t=>t>=55216&&t<=55295,"Private Use Area":t=>t>=57344&&t<=63743,"CJK Compatibility Ideographs":t=>t>=63744&&t<=64255,"Arabic Presentation Forms-A":t=>t>=64336&&t<=65023,"Vertical Forms":t=>t>=65040&&t<=65055,"CJK Compatibility Forms":t=>t>=65072&&t<=65103,"Small Form Variants":t=>t>=65104&&t<=65135,"Arabic Presentation Forms-B":t=>t>=65136&&t<=65279,"Halfwidth and Fullwidth Forms":t=>t>=65280&&t<=65519};function Nr(t){for(const e of t)if(Zr(e.charCodeAt(0)))return!0;return!1}function jr(t){for(const e of t)if(!Ur(e.charCodeAt(0)))return!1;return!0}function Ur(t){return!(Vr.Arabic(t)||Vr["Arabic Supplement"](t)||Vr["Arabic Extended-A"](t)||Vr["Arabic Presentation Forms-A"](t)||Vr["Arabic Presentation Forms-B"](t))}function Zr(t){return!(746!==t&&747!==t&&(t<4352||!(Vr["Bopomofo Extended"](t)||Vr.Bopomofo(t)||Vr["CJK Compatibility Forms"](t)&&!(t>=65097&&t<=65103)||Vr["CJK Compatibility Ideographs"](t)||Vr["CJK Compatibility"](t)||Vr["CJK Radicals Supplement"](t)||Vr["CJK Strokes"](t)||!(!Vr["CJK Symbols and Punctuation"](t)||t>=12296&&t<=12305||t>=12308&&t<=12319||12336===t)||Vr["CJK Unified Ideographs Extension A"](t)||Vr["CJK Unified Ideographs"](t)||Vr["Enclosed CJK Letters and Months"](t)||Vr["Hangul Compatibility Jamo"](t)||Vr["Hangul Jamo Extended-A"](t)||Vr["Hangul Jamo Extended-B"](t)||Vr["Hangul Jamo"](t)||Vr["Hangul Syllables"](t)||Vr.Hiragana(t)||Vr["Ideographic Description Characters"](t)||Vr.Kanbun(t)||Vr["Kangxi Radicals"](t)||Vr["Katakana Phonetic Extensions"](t)||Vr.Katakana(t)&&12540!==t||!(!Vr["Halfwidth and Fullwidth Forms"](t)||65288===t||65289===t||65293===t||t>=65306&&t<=65310||65339===t||65341===t||65343===t||t>=65371&&t<=65503||65507===t||t>=65512&&t<=65519)||!(!Vr["Small Form Variants"](t)||t>=65112&&t<=65118||t>=65123&&t<=65126)||Vr["Unified Canadian Aboriginal Syllabics"](t)||Vr["Unified Canadian Aboriginal Syllabics Extended"](t)||Vr["Vertical Forms"](t)||Vr["Yijing Hexagram Symbols"](t)||Vr["Yi Syllables"](t)||Vr["Yi Radicals"](t))))}function Hr(t){return!(Zr(t)||function(t){return!!(Vr["Latin-1 Supplement"](t)&&(167===t||169===t||174===t||177===t||188===t||189===t||190===t||215===t||247===t)||Vr["General Punctuation"](t)&&(8214===t||8224===t||8225===t||8240===t||8241===t||8251===t||8252===t||8258===t||8263===t||8264===t||8265===t||8273===t)||Vr["Letterlike Symbols"](t)||Vr["Number Forms"](t)||Vr["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||9003===t||t>=9085&&t<=9114||t>=9150&&t<=9165||9167===t||t>=9169&&t<=9179||t>=9186&&t<=9215)||Vr["Control Pictures"](t)&&9251!==t||Vr["Optical Character Recognition"](t)||Vr["Enclosed Alphanumerics"](t)||Vr["Geometric Shapes"](t)||Vr["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||Vr["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||Vr["CJK Symbols and Punctuation"](t)||Vr.Katakana(t)||Vr["Private Use Area"](t)||Vr["CJK Compatibility Forms"](t)||Vr["Small Form Variants"](t)||Vr["Halfwidth and Fullwidth Forms"](t)||8734===t||8756===t||8757===t||t>=9984&&t<=10087||t>=10102&&t<=10131||65532===t||65533===t)}(t))}function qr(t){return t>=1424&&t<=2303||Vr["Arabic Presentation Forms-A"](t)||Vr["Arabic Presentation Forms-B"](t)}function Gr(t,e){return!(!e&&qr(t)||t>=2304&&t<=3583||t>=3840&&t<=4255||Vr.Khmer(t))}function Wr(t){for(const e of t)if(qr(e.charCodeAt(0)))return!0;return!1}const Xr="deferred",Kr="loading",Jr="loaded";let Yr=null,Qr="unavailable",tn=null;const en=function(t){t&&"string"==typeof t&&t.indexOf("NetworkError")>-1&&(Qr="error"),Yr&&Yr(t)};function rn(){nn.fire(new q("pluginStateChange",{pluginStatus:Qr,pluginURL:tn}))}const nn=new W,an=function(){return Qr},on=function(){if(Qr!==Xr||!tn)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Qr=Kr,rn(),tn&&j({url:tn},(t=>{t?en(t):(Qr=Jr,rn())}))},sn={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Qr===Jr||null!=sn.applyArabicShaping,isLoading:()=>Qr===Kr,setState(t){if(!A())throw new Error("Cannot set the state of the rtl-text-plugin when not in the web-worker context");Qr=t.pluginStatus,tn=t.pluginURL},isParsed(){if(!A())throw new Error("rtl-text-plugin is only parsed on the worker-threads");return null!=sn.applyArabicShaping&&null!=sn.processBidirectionalText&&null!=sn.processStyledBidirectionalText},getPluginURL(){if(!A())throw new Error("rtl-text-plugin url can only be queried from the worker threads");return tn}};class ln{constructor(t,e){this.zoom=t,e?(this.now=e.now,this.fadeDuration=e.fadeDuration,this.zoomHistory=e.zoomHistory,this.transition=e.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new $r,this.transition={})}isSupportedScript(t){return function(t,e){for(const i of t)if(!Gr(i.charCodeAt(0),e))return!1;return!0}(t,sn.isLoaded())}crossFadingFactor(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const t=this.zoom,e=t-Math.floor(t),i=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:e+(1-e)*i}:{fromScale:.5,toScale:1,t:1-(1-i)*e}}}class cn{constructor(t,e){this.property=t,this.value=e,this.expression=function(t,e){if(Ai(t))return new Vi(t,e);if(Ri(t)){const i=$i(t,e);if("error"===i.result)throw new Error(i.value.map((t=>`${t.key}: ${t.message}`)).join(", "));return i.value}{let i=t;return"color"===e.type&&"string"==typeof t?i=Kt.parse(t):"padding"!==e.type||"number"!=typeof t&&!Array.isArray(t)?"variableAnchorOffsetCollection"===e.type&&Array.isArray(t)&&(i=ie.parse(t)):i=te.parse(t),{kind:"constant",evaluate:()=>i}}}(void 0===e?t.specification.default:e,t.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(t,e,i){return this.property.possiblyEvaluate(this,t,e,i)}}class hn{constructor(t){this.property=t,this.value=new cn(t,void 0)}transitioned(t,e){return new dn(this.property,this.value,e,y({},t.transition,this.transition),t.now)}untransitioned(){return new dn(this.property,this.value,null,{},0)}}class un{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}getValue(t){return x(this._values[t].value.value)}setValue(t,e){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new hn(this._values[t].property)),this._values[t].value=new cn(this._values[t].property,null===e?void 0:x(e))}getTransition(t){return x(this._values[t].transition)}setTransition(t,e){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new hn(this._values[t].property)),this._values[t].transition=x(e)||void 0}serialize(){const t={};for(const e of Object.keys(this._values)){const i=this.getValue(e);void 0!==i&&(t[e]=i);const r=this.getTransition(e);void 0!==r&&(t[`${e}-transition`]=r)}return t}transitioned(t,e){const i=new pn(this._properties);for(const r of Object.keys(this._values))i._values[r]=this._values[r].transitioned(t,e._values[r]);return i}untransitioned(){const t=new pn(this._properties);for(const e of Object.keys(this._values))t._values[e]=this._values[e].untransitioned();return t}}class dn{constructor(t,e,i,r,n){this.property=t,this.value=e,this.begin=n+r.delay||0,this.end=this.begin+r.duration||0,t.specification.transition&&(r.delay||r.duration)&&(this.prior=i)}possiblyEvaluate(t,e,i){const r=t.now||0,n=this.value.possiblyEvaluate(t,e,i),a=this.prior;if(a){if(r>this.end)return this.prior=null,n;if(this.value.isDataDriven())return this.prior=null,n;if(r<this.begin)return a.possiblyEvaluate(t,e,i);{const o=(r-this.begin)/(this.end-this.begin);return this.property.interpolate(a.possiblyEvaluate(t,e,i),n,function(t){if(t<=0)return 0;if(t>=1)return 1;const e=t*t,i=e*t;return 4*(t<.5?i:3*(t-e)+i-.75)}(o))}}return n}}class pn{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,e,i){const r=new gn(this._properties);for(const n of Object.keys(this._values))r._values[n]=this._values[n].possiblyEvaluate(t,e,i);return r}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class mn{constructor(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)}hasValue(t){return void 0!==this._values[t].value}getValue(t){return x(this._values[t].value)}setValue(t,e){this._values[t]=new cn(this._values[t].property,null===e?void 0:x(e))}serialize(){const t={};for(const e of Object.keys(this._values)){const i=this.getValue(e);void 0!==i&&(t[e]=i)}return t}possiblyEvaluate(t,e,i){const r=new gn(this._properties);for(const n of Object.keys(this._values))r._values[n]=this._values[n].possiblyEvaluate(t,e,i);return r}}class fn{constructor(t,e,i){this.property=t,this.value=e,this.parameters=i}isConstant(){return"constant"===this.value.kind}constantOr(t){return"constant"===this.value.kind?this.value.value:t}evaluate(t,e,i,r){return this.property.evaluate(this.value,this.parameters,t,e,i,r)}}class gn{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class yn{constructor(t){this.specification=t}possiblyEvaluate(t,e){if(t.isDataDriven())throw new Error("Value should not be data driven");return t.expression.evaluate(e)}interpolate(t,e,i){const r=He[this.specification.type];return r?r(t,e,i):t}}class _n{constructor(t,e){this.specification=t,this.overrides=e}possiblyEvaluate(t,e,i,r){return new fn(this,"constant"===t.expression.kind||"camera"===t.expression.kind?{kind:"constant",value:t.expression.evaluate(e,null,{},i,r)}:t.expression,e)}interpolate(t,e,i){if("constant"!==t.value.kind||"constant"!==e.value.kind)return t;if(void 0===t.value.value||void 0===e.value.value)return new fn(this,{kind:"constant",value:void 0},t.parameters);const r=He[this.specification.type];if(r){const n=r(t.value.value,e.value.value,i);return new fn(this,{kind:"constant",value:n},t.parameters)}return t}evaluate(t,e,i,r,n,a){return"constant"===t.kind?t.value:t.evaluate(e,i,r,n,a)}}class vn extends _n{possiblyEvaluate(t,e,i,r){if(void 0===t.value)return new fn(this,{kind:"constant",value:void 0},e);if("constant"===t.expression.kind){const n=t.expression.evaluate(e,null,{},i,r),a="resolvedImage"===t.property.specification.type&&"string"!=typeof n?n.name:n,o=this._calculate(a,a,a,e);return new fn(this,{kind:"constant",value:o},e)}if("camera"===t.expression.kind){const i=this._calculate(t.expression.evaluate({zoom:e.zoom-1}),t.expression.evaluate({zoom:e.zoom}),t.expression.evaluate({zoom:e.zoom+1}),e);return new fn(this,{kind:"constant",value:i},e)}return new fn(this,t.expression,e)}evaluate(t,e,i,r,n,a){if("source"===t.kind){const o=t.evaluate(e,i,r,n,a);return this._calculate(o,o,o,e)}return"composite"===t.kind?this._calculate(t.evaluate({zoom:Math.floor(e.zoom)-1},i,r),t.evaluate({zoom:Math.floor(e.zoom)},i,r),t.evaluate({zoom:Math.floor(e.zoom)+1},i,r),e):t.value}_calculate(t,e,i,r){return r.zoom>r.zoomHistory.lastIntegerZoom?{from:t,to:e}:{from:i,to:e}}interpolate(t){return t}}class bn{constructor(t){this.specification=t}possiblyEvaluate(t,e,i,r){if(void 0!==t.value){if("constant"===t.expression.kind){const n=t.expression.evaluate(e,null,{},i,r);return this._calculate(n,n,n,e)}return this._calculate(t.expression.evaluate(new ln(Math.floor(e.zoom-1),e)),t.expression.evaluate(new ln(Math.floor(e.zoom),e)),t.expression.evaluate(new ln(Math.floor(e.zoom+1),e)),e)}}_calculate(t,e,i,r){return r.zoom>r.zoomHistory.lastIntegerZoom?{from:t,to:e}:{from:i,to:e}}interpolate(t){return t}}class xn{constructor(t){this.specification=t}possiblyEvaluate(t,e,i,r){return!!t.expression.evaluate(e,null,{},i,r)}interpolate(){return!1}}class wn{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const e in t){const i=t[e];i.specification.overridable&&this.overridableProperties.push(e);const r=this.defaultPropertyValues[e]=new cn(i,void 0),n=this.defaultTransitionablePropertyValues[e]=new hn(i);this.defaultTransitioningPropertyValues[e]=n.untransitioned(),this.defaultPossiblyEvaluatedValues[e]=r.possiblyEvaluate({})}}}Rr("DataDrivenProperty",_n),Rr("DataConstantProperty",yn),Rr("CrossFadedDataDrivenProperty",vn),Rr("CrossFadedProperty",bn),Rr("ColorRampProperty",xn);const Sn="-transition";class kn extends W{constructor(t,e){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1},"custom"!==t.type&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,"background"!==t.type&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),e.layout&&(this._unevaluatedLayout=new mn(e.layout)),e.paint)){this._transitionablePaint=new un(e.paint);for(const e in t.paint)this.setPaintProperty(e,t.paint[e],{validate:!1});for(const e in t.layout)this.setLayoutProperty(e,t.layout[e],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new gn(e.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(t){return"visibility"===t?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,e,i={}){null!=e&&this._validate(zr,`layers.${this.id}.layout.${t}`,t,e,i)||("visibility"!==t?this._unevaluatedLayout.setValue(t,e):this.visibility=e)}getPaintProperty(t){return t.endsWith(Sn)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,e,i={}){if(null!=e&&this._validate(Ir,`layers.${this.id}.paint.${t}`,t,e,i))return!1;if(t.endsWith(Sn))return this._transitionablePaint.setTransition(t.slice(0,-11),e||void 0),!1;{const i=this._transitionablePaint._values[t],r="cross-faded-data-driven"===i.property.specification["property-type"],n=i.value.isDataDriven(),a=i.value;this._transitionablePaint.setValue(t,e),this._handleSpecialPaintPropertyUpdate(t);const o=this._transitionablePaint._values[t].value;return o.isDataDriven()||n||r||this._handleOverridablePaintPropertyUpdate(t,a,o)}}_handleSpecialPaintPropertyUpdate(t){}_handleOverridablePaintPropertyUpdate(t,e,i){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||"none"===this.visibility}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,e){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,e)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,e)}serialize(){const t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),b(t,((t,e)=>!(void 0===t||"layout"===e&&!Object.keys(t).length||"paint"===e&&!Object.keys(t).length)))}_validate(t,e,i,r,n={}){return(!n||!1!==n.validate)&&Pr(this,t.call(Er,{key:e,layerType:this.type,objectKey:i,value:r,styleSpec:X,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const t in this.paint._values){const e=this.paint.get(t);if(e instanceof fn&&wi(e.property.specification)&&("source"===e.value.kind||"composite"===e.value.kind)&&e.value.isStateDependent)return!0}return!1}}const Cn={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class An{constructor(t,e){this._structArray=t,this._pos1=e*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Tn{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,e){return t._trim(),e&&(t.isTransferred=!0,e.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const e=Object.create(this.prototype);return e.arrayBuffer=t.arrayBuffer,e.length=t.length,e.capacity=t.arrayBuffer.byteLength/e.bytesPerElement,e._refreshViews(),e}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const e=this.uint8;this._refreshViews(),e&&this.uint8.set(e)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function En(t,e=1){let i=0,r=0;return{members:t.map((t=>{const n=Cn[t.type].BYTES_PER_ELEMENT,a=i=Mn(i,Math.max(e,n)),o=t.components||1;return r=Math.max(r,n),i+=n*o,{name:t.name,type:t.type,components:o,offset:a}})),size:Mn(i,Math.max(r,e)),alignment:e}}function Mn(t,e){return Math.ceil(t/e)*e}class In extends Tn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e){const i=this.length;return this.resize(i+1),this.emplace(i,t,e)}emplace(t,e,i){const r=2*t;return this.int16[r+0]=e,this.int16[r+1]=i,t}}In.prototype.bytesPerElement=4,Rr("StructArrayLayout2i4",In);class zn extends Tn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,i){const r=this.length;return this.resize(r+1),this.emplace(r,t,e,i)}emplace(t,e,i,r){const n=3*t;return this.int16[n+0]=e,this.int16[n+1]=i,this.int16[n+2]=r,t}}zn.prototype.bytesPerElement=6,Rr("StructArrayLayout3i6",zn);class Pn extends Tn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,i,r){const n=this.length;return this.resize(n+1),this.emplace(n,t,e,i,r)}emplace(t,e,i,r,n){const a=4*t;return this.int16[a+0]=e,this.int16[a+1]=i,this.int16[a+2]=r,this.int16[a+3]=n,t}}Pn.prototype.bytesPerElement=8,Rr("StructArrayLayout4i8",Pn);class Ln extends Tn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,i,r,n,a){const o=this.length;return this.resize(o+1),this.emplace(o,t,e,i,r,n,a)}emplace(t,e,i,r,n,a,o){const s=6*t;return this.int16[s+0]=e,this.int16[s+1]=i,this.int16[s+2]=r,this.int16[s+3]=n,this.int16[s+4]=a,this.int16[s+5]=o,t}}Ln.prototype.bytesPerElement=12,Rr("StructArrayLayout2i4i12",Ln);class Dn extends Tn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,i,r,n,a){const o=this.length;return this.resize(o+1),this.emplace(o,t,e,i,r,n,a)}emplace(t,e,i,r,n,a,o){const s=4*t,l=8*t;return this.int16[s+0]=e,this.int16[s+1]=i,this.uint8[l+4]=r,this.uint8[l+5]=n,this.uint8[l+6]=a,this.uint8[l+7]=o,t}}Dn.prototype.bytesPerElement=8,Rr("StructArrayLayout2i4ub8",Dn);class Rn extends Tn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e){const i=this.length;return this.resize(i+1),this.emplace(i,t,e)}emplace(t,e,i){const r=2*t;return this.float32[r+0]=e,this.float32[r+1]=i,t}}Rn.prototype.bytesPerElement=8,Rr("StructArrayLayout2f8",Rn);class Bn extends Tn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,i,r,n,a,o,s,l,c){const h=this.length;return this.resize(h+1),this.emplace(h,t,e,i,r,n,a,o,s,l,c)}emplace(t,e,i,r,n,a,o,s,l,c,h){const u=10*t;return this.uint16[u+0]=e,this.uint16[u+1]=i,this.uint16[u+2]=r,this.uint16[u+3]=n,this.uint16[u+4]=a,this.uint16[u+5]=o,this.uint16[u+6]=s,this.uint16[u+7]=l,this.uint16[u+8]=c,this.uint16[u+9]=h,t}}Bn.prototype.bytesPerElement=20,Rr("StructArrayLayout10ui20",Bn);class Fn extends Tn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,i,r,n,a,o,s,l,c,h,u){const d=this.length;return this.resize(d+1),this.emplace(d,t,e,i,r,n,a,o,s,l,c,h,u)}emplace(t,e,i,r,n,a,o,s,l,c,h,u,d){const p=12*t;return this.int16[p+0]=e,this.int16[p+1]=i,this.int16[p+2]=r,this.int16[p+3]=n,this.uint16[p+4]=a,this.uint16[p+5]=o,this.uint16[p+6]=s,this.uint16[p+7]=l,this.int16[p+8]=c,this.int16[p+9]=h,this.int16[p+10]=u,this.int16[p+11]=d,t}}Fn.prototype.bytesPerElement=24,Rr("StructArrayLayout4i4ui4i24",Fn);class On extends Tn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,i){const r=this.length;return this.resize(r+1),this.emplace(r,t,e,i)}emplace(t,e,i,r){const n=3*t;return this.float32[n+0]=e,this.float32[n+1]=i,this.float32[n+2]=r,t}}On.prototype.bytesPerElement=12,Rr("StructArrayLayout3f12",On);class $n extends Tn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const e=this.length;return this.resize(e+1),this.emplace(e,t)}emplace(t,e){return this.uint32[1*t+0]=e,t}}$n.prototype.bytesPerElement=4,Rr("StructArrayLayout1ul4",$n);class Vn extends Tn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,i,r,n,a,o,s,l){const c=this.length;return this.resize(c+1),this.emplace(c,t,e,i,r,n,a,o,s,l)}emplace(t,e,i,r,n,a,o,s,l,c){const h=10*t,u=5*t;return this.int16[h+0]=e,this.int16[h+1]=i,this.int16[h+2]=r,this.int16[h+3]=n,this.int16[h+4]=a,this.int16[h+5]=o,this.uint32[u+3]=s,this.uint16[h+8]=l,this.uint16[h+9]=c,t}}Vn.prototype.bytesPerElement=20,Rr("StructArrayLayout6i1ul2ui20",Vn);class Nn extends Tn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,i,r,n,a){const o=this.length;return this.resize(o+1),this.emplace(o,t,e,i,r,n,a)}emplace(t,e,i,r,n,a,o){const s=6*t;return this.int16[s+0]=e,this.int16[s+1]=i,this.int16[s+2]=r,this.int16[s+3]=n,this.int16[s+4]=a,this.int16[s+5]=o,t}}Nn.prototype.bytesPerElement=12,Rr("StructArrayLayout2i2i2i12",Nn);class jn extends Tn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,i,r,n){const a=this.length;return this.resize(a+1),this.emplace(a,t,e,i,r,n)}emplace(t,e,i,r,n,a){const o=4*t,s=8*t;return this.float32[o+0]=e,this.float32[o+1]=i,this.float32[o+2]=r,this.int16[s+6]=n,this.int16[s+7]=a,t}}jn.prototype.bytesPerElement=16,Rr("StructArrayLayout2f1f2i16",jn);class Un extends Tn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,i,r){const n=this.length;return this.resize(n+1),this.emplace(n,t,e,i,r)}emplace(t,e,i,r,n){const a=12*t,o=3*t;return this.uint8[a+0]=e,this.uint8[a+1]=i,this.float32[o+1]=r,this.float32[o+2]=n,t}}Un.prototype.bytesPerElement=12,Rr("StructArrayLayout2ub2f12",Un);class Zn extends Tn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,i){const r=this.length;return this.resize(r+1),this.emplace(r,t,e,i)}emplace(t,e,i,r){const n=3*t;return this.uint16[n+0]=e,this.uint16[n+1]=i,this.uint16[n+2]=r,t}}Zn.prototype.bytesPerElement=6,Rr("StructArrayLayout3ui6",Zn);class Hn extends Tn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,i,r,n,a,o,s,l,c,h,u,d,p,m,f,g){const y=this.length;return this.resize(y+1),this.emplace(y,t,e,i,r,n,a,o,s,l,c,h,u,d,p,m,f,g)}emplace(t,e,i,r,n,a,o,s,l,c,h,u,d,p,m,f,g,y){const _=24*t,v=12*t,b=48*t;return this.int16[_+0]=e,this.int16[_+1]=i,this.uint16[_+2]=r,this.uint16[_+3]=n,this.uint32[v+2]=a,this.uint32[v+3]=o,this.uint32[v+4]=s,this.uint16[_+10]=l,this.uint16[_+11]=c,this.uint16[_+12]=h,this.float32[v+7]=u,this.float32[v+8]=d,this.uint8[b+36]=p,this.uint8[b+37]=m,this.uint8[b+38]=f,this.uint32[v+10]=g,this.int16[_+22]=y,t}}Hn.prototype.bytesPerElement=48,Rr("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Hn);class qn extends Tn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,i,r,n,a,o,s,l,c,h,u,d,p,m,f,g,y,_,v,b,x,w,S,k,C,A,T){const E=this.length;return this.resize(E+1),this.emplace(E,t,e,i,r,n,a,o,s,l,c,h,u,d,p,m,f,g,y,_,v,b,x,w,S,k,C,A,T)}emplace(t,e,i,r,n,a,o,s,l,c,h,u,d,p,m,f,g,y,_,v,b,x,w,S,k,C,A,T,E){const M=32*t,I=16*t;return this.int16[M+0]=e,this.int16[M+1]=i,this.int16[M+2]=r,this.int16[M+3]=n,this.int16[M+4]=a,this.int16[M+5]=o,this.int16[M+6]=s,this.int16[M+7]=l,this.uint16[M+8]=c,this.uint16[M+9]=h,this.uint16[M+10]=u,this.uint16[M+11]=d,this.uint16[M+12]=p,this.uint16[M+13]=m,this.uint16[M+14]=f,this.uint16[M+15]=g,this.uint16[M+16]=y,this.uint16[M+17]=_,this.uint16[M+18]=v,this.uint16[M+19]=b,this.uint16[M+20]=x,this.uint16[M+21]=w,this.uint16[M+22]=S,this.uint32[I+12]=k,this.float32[I+13]=C,this.float32[I+14]=A,this.uint16[M+30]=T,this.uint16[M+31]=E,t}}qn.prototype.bytesPerElement=64,Rr("StructArrayLayout8i15ui1ul2f2ui64",qn);class Gn extends Tn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const e=this.length;return this.resize(e+1),this.emplace(e,t)}emplace(t,e){return this.float32[1*t+0]=e,t}}Gn.prototype.bytesPerElement=4,Rr("StructArrayLayout1f4",Gn);class Wn extends Tn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,i){const r=this.length;return this.resize(r+1),this.emplace(r,t,e,i)}emplace(t,e,i,r){const n=3*t;return this.uint16[6*t+0]=e,this.float32[n+1]=i,this.float32[n+2]=r,t}}Wn.prototype.bytesPerElement=12,Rr("StructArrayLayout1ui2f12",Wn);class Xn extends Tn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,i){const r=this.length;return this.resize(r+1),this.emplace(r,t,e,i)}emplace(t,e,i,r){const n=4*t;return this.uint32[2*t+0]=e,this.uint16[n+2]=i,this.uint16[n+3]=r,t}}Xn.prototype.bytesPerElement=8,Rr("StructArrayLayout1ul2ui8",Xn);class Kn extends Tn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e){const i=this.length;return this.resize(i+1),this.emplace(i,t,e)}emplace(t,e,i){const r=2*t;return this.uint16[r+0]=e,this.uint16[r+1]=i,t}}Kn.prototype.bytesPerElement=4,Rr("StructArrayLayout2ui4",Kn);class Jn extends Tn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const e=this.length;return this.resize(e+1),this.emplace(e,t)}emplace(t,e){return this.uint16[1*t+0]=e,t}}Jn.prototype.bytesPerElement=2,Rr("StructArrayLayout1ui2",Jn);class Yn extends Tn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,i,r){const n=this.length;return this.resize(n+1),this.emplace(n,t,e,i,r)}emplace(t,e,i,r,n){const a=4*t;return this.float32[a+0]=e,this.float32[a+1]=i,this.float32[a+2]=r,this.float32[a+3]=n,t}}Yn.prototype.bytesPerElement=16,Rr("StructArrayLayout4f16",Yn);class Qn extends An{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new a(this.anchorPointX,this.anchorPointY)}}Qn.prototype.size=20;class ta extends Vn{get(t){return new Qn(this,t)}}Rr("CollisionBoxArray",ta);class ea extends An{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(t){this._structArray.uint8[this._pos1+37]=t}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(t){this._structArray.uint8[this._pos1+38]=t}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(t){this._structArray.uint32[this._pos4+10]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}ea.prototype.size=48;class ia extends Hn{get(t){return new ea(this,t)}}Rr("PlacedSymbolArray",ia);class ra extends An{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(t){this._structArray.uint32[this._pos4+12]=t}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}ra.prototype.size=64;class na extends qn{get(t){return new ra(this,t)}}Rr("SymbolInstanceArray",na);class aa extends Gn{getoffsetX(t){return this.float32[1*t+0]}}Rr("GlyphOffsetArray",aa);class oa extends zn{getx(t){return this.int16[3*t+0]}gety(t){return this.int16[3*t+1]}gettileUnitDistanceFromAnchor(t){return this.int16[3*t+2]}}Rr("SymbolLineVertexArray",oa);class sa extends An{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}sa.prototype.size=12;class la extends Wn{get(t){return new sa(this,t)}}Rr("TextAnchorOffsetArray",la);class ca extends An{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}ca.prototype.size=8;class ha extends Xn{get(t){return new ca(this,t)}}Rr("FeatureIndexArray",ha);class ua extends In{}class da extends In{}class pa extends In{}class ma extends Ln{}class fa extends Dn{}class ga extends Rn{}class ya extends Bn{}class _a extends Fn{}class va extends On{}class ba extends $n{}class xa extends Nn{}class wa extends Un{}class Sa extends Zn{}class ka extends Kn{}const Ca=En([{name:"a_pos",components:2,type:"Int16"}],4),{members:Aa}=Ca;class Ta{constructor(t=[]){this.segments=t}prepareSegment(t,e,i,r){let n=this.segments[this.segments.length-1];return t>Ta.MAX_VERTEX_ARRAY_LENGTH&&S(`Max vertices per segment is ${Ta.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}`),(!n||n.vertexLength+t>Ta.MAX_VERTEX_ARRAY_LENGTH||n.sortKey!==r)&&(n={vertexOffset:e.length,primitiveOffset:i.length,vertexLength:0,primitiveLength:0},void 0!==r&&(n.sortKey=r),this.segments.push(n)),n}get(){return this.segments}destroy(){for(const t of this.segments)for(const e in t.vaos)t.vaos[e].destroy()}static simpleSegment(t,e,i,r){return new Ta([{vertexOffset:t,primitiveOffset:e,vertexLength:i,primitiveLength:r,vaos:{},sortKey:0}])}}function Ea(t,e){return 256*(t=f(Math.floor(t),0,255))+f(Math.floor(e),0,255)}Ta.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Rr("SegmentVector",Ta);const Ma=En([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Ia={exports:{}},za={exports:function(t,e){var i,r,n,a,o,s,l,c;for(r=t.length-(i=3&t.length),n=e,o=3432918353,s=461845907,c=0;c<r;)l=255&t.charCodeAt(c)|(255&t.charCodeAt(++c))<<8|(255&t.charCodeAt(++c))<<16|(255&t.charCodeAt(++c))<<24,++c,n=27492+(65535&(a=5*(65535&(n=(n^=l=(65535&(l=(l=(65535&l)*o+(((l>>>16)*o&65535)<<16)&4294967295)<<15|l>>>17))*s+(((l>>>16)*s&65535)<<16)&4294967295)<<13|n>>>19))+((5*(n>>>16)&65535)<<16)&4294967295))+((58964+(a>>>16)&65535)<<16);switch(l=0,i){case 3:l^=(255&t.charCodeAt(c+2))<<16;case 2:l^=(255&t.charCodeAt(c+1))<<8;case 1:n^=l=(65535&(l=(l=(65535&(l^=255&t.charCodeAt(c)))*o+(((l>>>16)*o&65535)<<16)&4294967295)<<15|l>>>17))*s+(((l>>>16)*s&65535)<<16)&4294967295}return n^=t.length,n=2246822507*(65535&(n^=n>>>16))+((2246822507*(n>>>16)&65535)<<16)&4294967295,n=3266489909*(65535&(n^=n>>>13))+((3266489909*(n>>>16)&65535)<<16)&4294967295,(n^=n>>>16)>>>0}},Pa={exports:function(t,e){for(var i,r=t.length,n=e^r,a=0;r>=4;)i=1540483477*(65535&(i=255&t.charCodeAt(a)|(255&t.charCodeAt(++a))<<8|(255&t.charCodeAt(++a))<<16|(255&t.charCodeAt(++a))<<24))+((1540483477*(i>>>16)&65535)<<16),n=1540483477*(65535&n)+((1540483477*(n>>>16)&65535)<<16)^(i=1540483477*(65535&(i^=i>>>24))+((1540483477*(i>>>16)&65535)<<16)),r-=4,++a;switch(r){case 3:n^=(255&t.charCodeAt(a+2))<<16;case 2:n^=(255&t.charCodeAt(a+1))<<8;case 1:n=1540483477*(65535&(n^=255&t.charCodeAt(a)))+((1540483477*(n>>>16)&65535)<<16)}return n=1540483477*(65535&(n^=n>>>13))+((1540483477*(n>>>16)&65535)<<16),(n^=n>>>15)>>>0}},La=za.exports,Da=Pa.exports;Ia.exports=La,Ia.exports.murmur3=La,Ia.exports.murmur2=Da;var Ra=i(Ia.exports);class Ba{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,e,i,r){this.ids.push(Fa(t)),this.positions.push(e,i,r)}getPositions(t){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const e=Fa(t);let i=0,r=this.ids.length-1;for(;i<r;){const t=i+r>>1;this.ids[t]>=e?r=t:i=t+1}const n=[];for(;this.ids[i]===e;)n.push({index:this.positions[3*i],start:this.positions[3*i+1],end:this.positions[3*i+2]}),i++;return n}static serialize(t,e){const i=new Float64Array(t.ids),r=new Uint32Array(t.positions);return Oa(i,r,0,i.length-1),e&&e.push(i.buffer,r.buffer),{ids:i,positions:r}}static deserialize(t){const e=new Ba;return e.ids=t.ids,e.positions=t.positions,e.indexed=!0,e}}function Fa(t){const e=+t;return!isNaN(e)&&e<=Number.MAX_SAFE_INTEGER?e:Ra(String(t))}function Oa(t,e,i,r){for(;i<r;){const n=t[i+r>>1];let a=i-1,o=r+1;for(;;){do{a++}while(t[a]<n);do{o--}while(t[o]>n);if(a>=o)break;$a(t,a,o),$a(e,3*a,3*o),$a(e,3*a+1,3*o+1),$a(e,3*a+2,3*o+2)}o-i<r-o?(Oa(t,e,i,o),i=o+1):(Oa(t,e,o+1,r),r=o)}}function $a(t,e,i){const r=t[e];t[e]=t[i],t[i]=r}Rr("FeaturePositionMap",Ba);class Va{constructor(t,e){this.gl=t.gl,this.location=e}}class Na extends Va{constructor(t,e){super(t,e),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))}}class ja extends Va{constructor(t,e){super(t,e),this.current=[0,0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))}}class Ua extends Va{constructor(t,e){super(t,e),this.current=Kt.transparent}set(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))}}const Za=new Float32Array(16);function Ha(t){return[Ea(255*t.r,255*t.g),Ea(255*t.b,255*t.a)]}class qa{constructor(t,e,i){this.value=t,this.uniformNames=e.map((t=>`u_${t}`)),this.type=i}setUniform(t,e,i){t.set(i.constantOr(this.value))}getBinding(t,e,i){return"color"===this.type?new Ua(t,e):new Na(t,e)}}class Ga{constructor(t,e){this.uniformNames=e.map((t=>`u_${t}`)),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(t,e){this.pixelRatioFrom=e.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=e.tlbr,this.patternTo=t.tlbr}setUniform(t,e,i,r){const n="u_pattern_to"===r?this.patternTo:"u_pattern_from"===r?this.patternFrom:"u_pixel_ratio_to"===r?this.pixelRatioTo:"u_pixel_ratio_from"===r?this.pixelRatioFrom:null;n&&t.set(n)}getBinding(t,e,i){return"u_pattern"===i.substr(0,9)?new ja(t,e):new Na(t,e)}}class Wa{constructor(t,e,i,r){this.expression=t,this.type=i,this.maxValue=0,this.paintVertexAttributes=e.map((t=>({name:`a_${t}`,type:"Float32",components:"color"===i?2:1,offset:0}))),this.paintVertexArray=new r}populatePaintArray(t,e,i,r,n){const a=this.paintVertexArray.length,o=this.expression.evaluate(new ln(0),e,{},r,[],n);this.paintVertexArray.resize(t),this._setPaintValue(a,t,o)}updatePaintArray(t,e,i,r){const n=this.expression.evaluate({zoom:0},i,r);this._setPaintValue(t,e,n)}_setPaintValue(t,e,i){if("color"===this.type){const r=Ha(i);for(let i=t;i<e;i++)this.paintVertexArray.emplace(i,r[0],r[1])}else{for(let r=t;r<e;r++)this.paintVertexArray.emplace(r,i);this.maxValue=Math.max(this.maxValue,Math.abs(i))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Xa{constructor(t,e,i,r,n,a){this.expression=t,this.uniformNames=e.map((t=>`u_${t}_t`)),this.type=i,this.useIntegerZoom=r,this.zoom=n,this.maxValue=0,this.paintVertexAttributes=e.map((t=>({name:`a_${t}`,type:"Float32",components:"color"===i?4:2,offset:0}))),this.paintVertexArray=new a}populatePaintArray(t,e,i,r,n){const a=this.expression.evaluate(new ln(this.zoom),e,{},r,[],n),o=this.expression.evaluate(new ln(this.zoom+1),e,{},r,[],n),s=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(s,t,a,o)}updatePaintArray(t,e,i,r){const n=this.expression.evaluate({zoom:this.zoom},i,r),a=this.expression.evaluate({zoom:this.zoom+1},i,r);this._setPaintValue(t,e,n,a)}_setPaintValue(t,e,i,r){if("color"===this.type){const n=Ha(i),a=Ha(r);for(let i=t;i<e;i++)this.paintVertexArray.emplace(i,n[0],n[1],a[0],a[1])}else{for(let n=t;n<e;n++)this.paintVertexArray.emplace(n,i,r);this.maxValue=Math.max(this.maxValue,Math.abs(i),Math.abs(r))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,e){const i=this.useIntegerZoom?Math.floor(e.zoom):e.zoom,r=f(this.expression.interpolationFactor(i,this.zoom,this.zoom+1),0,1);t.set(r)}getBinding(t,e,i){return new Na(t,e)}}class Ka{constructor(t,e,i,r,n,a){this.expression=t,this.type=e,this.useIntegerZoom=i,this.zoom=r,this.layerId=a,this.zoomInPaintVertexArray=new n,this.zoomOutPaintVertexArray=new n}populatePaintArray(t,e,i){const r=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(r,t,e.patterns&&e.patterns[this.layerId],i)}updatePaintArray(t,e,i,r,n){this._setPaintValues(t,e,i.patterns&&i.patterns[this.layerId],n)}_setPaintValues(t,e,i,r){if(!r||!i)return;const{min:n,mid:a,max:o}=i,s=r[n],l=r[a],c=r[o];if(s&&l&&c)for(let i=t;i<e;i++)this.zoomInPaintVertexArray.emplace(i,l.tl[0],l.tl[1],l.br[0],l.br[1],s.tl[0],s.tl[1],s.br[0],s.br[1],l.pixelRatio,s.pixelRatio),this.zoomOutPaintVertexArray.emplace(i,l.tl[0],l.tl[1],l.br[0],l.br[1],c.tl[0],c.tl[1],c.br[0],c.br[1],l.pixelRatio,c.pixelRatio)}upload(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,Ma.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,Ma.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Ja{constructor(t,e,i){this.binders={},this._buffers=[];const r=[];for(const n in t.paint._values){if(!i(n))continue;const a=t.paint.get(n);if(!(a instanceof fn&&wi(a.property.specification)))continue;const o=Qa(n,t.type),s=a.value,l=a.property.specification.type,c=a.property.useIntegerZoom,h=a.property.specification["property-type"],u="cross-faded"===h||"cross-faded-data-driven"===h;if("constant"===s.kind)this.binders[n]=u?new Ga(s.value,o):new qa(s.value,o,l),r.push(`/u_${n}`);else if("source"===s.kind||u){const i=to(n,l,"source");this.binders[n]=u?new Ka(s,l,c,e,i,t.id):new Wa(s,o,l,i),r.push(`/a_${n}`)}else{const t=to(n,l,"composite");this.binders[n]=new Xa(s,o,l,c,e,t),r.push(`/z_${n}`)}}this.cacheKey=r.sort().join("")}getMaxValue(t){const e=this.binders[t];return e instanceof Wa||e instanceof Xa?e.maxValue:0}populatePaintArrays(t,e,i,r,n){for(const a in this.binders){const o=this.binders[a];(o instanceof Wa||o instanceof Xa||o instanceof Ka)&&o.populatePaintArray(t,e,i,r,n)}}setConstantPatternPositions(t,e){for(const i in this.binders){const r=this.binders[i];r instanceof Ga&&r.setConstantPatternPositions(t,e)}}updatePaintArrays(t,e,i,r,n){let a=!1;for(const o in t){const s=e.getPositions(o);for(const e of s){const s=i.feature(e.index);for(const i in this.binders){const l=this.binders[i];if((l instanceof Wa||l instanceof Xa||l instanceof Ka)&&!0===l.expression.isStateDependent){const c=r.paint.get(i);l.expression=c.value,l.updatePaintArray(e.start,e.end,s,t[o],n),a=!0}}}}return a}defines(){const t=[];for(const e in this.binders){const i=this.binders[e];(i instanceof qa||i instanceof Ga)&&t.push(...i.uniformNames.map((t=>`#define HAS_UNIFORM_${t}`)))}return t}getBinderAttributes(){const t=[];for(const e in this.binders){const i=this.binders[e];if(i instanceof Wa||i instanceof Xa)for(let e=0;e<i.paintVertexAttributes.length;e++)t.push(i.paintVertexAttributes[e].name);else if(i instanceof Ka)for(let e=0;e<Ma.members.length;e++)t.push(Ma.members[e].name)}return t}getBinderUniforms(){const t=[];for(const e in this.binders){const i=this.binders[e];if(i instanceof qa||i instanceof Ga||i instanceof Xa)for(const e of i.uniformNames)t.push(e)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t,e){const i=[];for(const r in this.binders){const n=this.binders[r];if(n instanceof qa||n instanceof Ga||n instanceof Xa)for(const a of n.uniformNames)if(e[a]){const o=n.getBinding(t,e[a],a);i.push({name:a,property:r,binding:o})}}return i}setUniforms(t,e,i,r){for(const{name:t,property:n,binding:a}of e)this.binders[n].setUniform(a,r,i.get(n),t)}updatePaintBuffers(t){this._buffers=[];for(const e in this.binders){const i=this.binders[e];if(t&&i instanceof Ka){const e=2===t.fromScale?i.zoomInPaintVertexBuffer:i.zoomOutPaintVertexBuffer;e&&this._buffers.push(e)}else(i instanceof Wa||i instanceof Xa)&&i.paintVertexBuffer&&this._buffers.push(i.paintVertexBuffer)}}upload(t){for(const e in this.binders){const i=this.binders[e];(i instanceof Wa||i instanceof Xa||i instanceof Ka)&&i.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const e=this.binders[t];(e instanceof Wa||e instanceof Xa||e instanceof Ka)&&e.destroy()}}}class Ya{constructor(t,e,i=(()=>!0)){this.programConfigurations={};for(const r of t)this.programConfigurations[r.id]=new Ja(r,e,i);this.needsUpload=!1,this._featureMap=new Ba,this._bufferOffset=0}populatePaintArrays(t,e,i,r,n,a){for(const i in this.programConfigurations)this.programConfigurations[i].populatePaintArrays(t,e,r,n,a);void 0!==e.id&&this._featureMap.add(e.id,i,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,e,i,r){for(const n of i)this.needsUpload=this.programConfigurations[n.id].updatePaintArrays(t,this._featureMap,e,n,r)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const e in this.programConfigurations)this.programConfigurations[e].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}function Qa(t,e){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[t]||[t.replace(`${e}-`,"").replace(/-/g,"_")]}function to(t,e,i){const r={color:{source:Rn,composite:Yn},number:{source:Gn,composite:Rn}},n=function(t){return{"line-pattern":{source:ya,composite:ya},"fill-pattern":{source:ya,composite:ya},"fill-extrusion-pattern":{source:ya,composite:ya}}[t]}(t);return n&&n[i]||r[e][i]}Rr("ConstantBinder",qa),Rr("CrossFadedConstantBinder",Ga),Rr("SourceExpressionBinder",Wa),Rr("CrossFadedCompositeBinder",Ka),Rr("CompositeExpressionBinder",Xa),Rr("ProgramConfiguration",Ja,{omit:["_buffers"]}),Rr("ProgramConfigurationSet",Ya);const eo=8192,io=Math.pow(2,14)-1,ro=-io-1;function no(t){const e=eo/t.extent,i=t.loadGeometry();for(let t=0;t<i.length;t++){const r=i[t];for(let t=0;t<r.length;t++){const i=r[t],n=Math.round(i.x*e),a=Math.round(i.y*e);i.x=f(n,ro,io),i.y=f(a,ro,io),(n<i.x||n>i.x+1||a<i.y||a>i.y+1)&&S("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return i}function ao(t,e){return{type:t.type,id:t.id,properties:t.properties,geometry:e?no(t):[]}}function oo(t,e,i,r,n){t.emplaceBack(2*e+(r+1)/2,2*i+(n+1)/2)}class so{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((t=>t.id)),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new da,this.indexArray=new Sa,this.segments=new Ta,this.programConfigurations=new Ya(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter((t=>t.isStateDependent())).map((t=>t.id))}populate(t,e,i){const r=this.layers[0],n=[];let a=null,o=!1;"circle"===r.type&&(a=r.layout.get("circle-sort-key"),o=!a.isConstant());for(const{feature:e,id:r,index:s,sourceLayerIndex:l}of t){const t=this.layers[0]._featureFilter.needGeometry,c=ao(e,t);if(!this.layers[0]._featureFilter.filter(new ln(this.zoom),c,i))continue;const h=o?a.evaluate(c,{},i):void 0,u={id:r,properties:e.properties,type:e.type,sourceLayerIndex:l,index:s,geometry:t?c.geometry:no(e),patterns:{},sortKey:h};n.push(u)}o&&n.sort(((t,e)=>t.sortKey-e.sortKey));for(const r of n){const{geometry:n,index:a,sourceLayerIndex:o}=r,s=t[a].feature;this.addFeature(r,n,a,i),e.featureIndex.insert(s,n,a,o,this.index)}}update(t,e,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,i)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Aa),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,e,i,r){for(const i of e)for(const e of i){const i=e.x,r=e.y;if(i<0||i>=eo||r<0||r>=eo)continue;const n=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),a=n.vertexLength;oo(this.layoutVertexArray,i,r,-1,-1),oo(this.layoutVertexArray,i,r,1,-1),oo(this.layoutVertexArray,i,r,1,1),oo(this.layoutVertexArray,i,r,-1,1),this.indexArray.emplaceBack(a,a+1,a+2),this.indexArray.emplaceBack(a,a+3,a+2),n.vertexLength+=4,n.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,i,{},r)}}function lo(t,e){for(let i=0;i<t.length;i++)if(_o(e,t[i]))return!0;for(let i=0;i<e.length;i++)if(_o(t,e[i]))return!0;return!!po(t,e)}function co(t,e,i){return!!_o(t,e)||!!fo(e,t,i)}function ho(t,e){if(1===t.length)return yo(e,t[0]);for(let i=0;i<e.length;i++){const r=e[i];for(let e=0;e<r.length;e++)if(_o(t,r[e]))return!0}for(let i=0;i<t.length;i++)if(yo(e,t[i]))return!0;for(let i=0;i<e.length;i++)if(po(t,e[i]))return!0;return!1}function uo(t,e,i){if(t.length>1){if(po(t,e))return!0;for(let r=0;r<e.length;r++)if(fo(e[r],t,i))return!0}for(let r=0;r<t.length;r++)if(fo(t[r],e,i))return!0;return!1}function po(t,e){if(0===t.length||0===e.length)return!1;for(let i=0;i<t.length-1;i++){const r=t[i],n=t[i+1];for(let t=0;t<e.length-1;t++)if(mo(r,n,e[t],e[t+1]))return!0}return!1}function mo(t,e,i,r){return k(t,i,r)!==k(e,i,r)&&k(t,e,i)!==k(t,e,r)}function fo(t,e,i){const r=i*i;if(1===e.length)return t.distSqr(e[0])<r;for(let i=1;i<e.length;i++)if(go(t,e[i-1],e[i])<r)return!0;return!1}function go(t,e,i){const r=e.distSqr(i);if(0===r)return t.distSqr(e);const n=((t.x-e.x)*(i.x-e.x)+(t.y-e.y)*(i.y-e.y))/r;return t.distSqr(n<0?e:n>1?i:i.sub(e)._mult(n)._add(e))}function yo(t,e){let i,r,n,a=!1;for(let o=0;o<t.length;o++){i=t[o];for(let t=0,o=i.length-1;t<i.length;o=t++)r=i[t],n=i[o],r.y>e.y!=n.y>e.y&&e.x<(n.x-r.x)*(e.y-r.y)/(n.y-r.y)+r.x&&(a=!a)}return a}function _o(t,e){let i=!1;for(let r=0,n=t.length-1;r<t.length;n=r++){const a=t[r],o=t[n];a.y>e.y!=o.y>e.y&&e.x<(o.x-a.x)*(e.y-a.y)/(o.y-a.y)+a.x&&(i=!i)}return i}function vo(t,e,i){const r=i[0],n=i[2];if(t.x<r.x&&e.x<r.x||t.x>n.x&&e.x>n.x||t.y<r.y&&e.y<r.y||t.y>n.y&&e.y>n.y)return!1;const a=k(t,e,i[0]);return a!==k(t,e,i[1])||a!==k(t,e,i[2])||a!==k(t,e,i[3])}function bo(t,e,i){const r=e.paint.get(t).value;return"constant"===r.kind?r.value:i.programConfigurations.get(e.id).getMaxValue(t)}function xo(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function wo(t,e,i,r,n){if(!e[0]&&!e[1])return t;const o=a.convert(e)._mult(n);"viewport"===i&&o._rotate(-r);const s=[];for(let e=0;e<t.length;e++)s.push(t[e].sub(o));return s}let So,ko;Rr("CircleBucket",so,{omit:["layers"]});var Co={get paint(){return ko=ko||new wn({"circle-radius":new _n(X.paint_circle["circle-radius"]),"circle-color":new _n(X.paint_circle["circle-color"]),"circle-blur":new _n(X.paint_circle["circle-blur"]),"circle-opacity":new _n(X.paint_circle["circle-opacity"]),"circle-translate":new yn(X.paint_circle["circle-translate"]),"circle-translate-anchor":new yn(X.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new yn(X.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new yn(X.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new _n(X.paint_circle["circle-stroke-width"]),"circle-stroke-color":new _n(X.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new _n(X.paint_circle["circle-stroke-opacity"])})},get layout(){return So=So||new wn({"circle-sort-key":new _n(X.layout_circle["circle-sort-key"])})}},Ao=1e-6,To="undefined"!=typeof Float32Array?Float32Array:Array;function Eo(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Mo(t,e,i){var r=e[0],n=e[1],a=e[2],o=e[3],s=e[4],l=e[5],c=e[6],h=e[7],u=e[8],d=e[9],p=e[10],m=e[11],f=e[12],g=e[13],y=e[14],_=e[15],v=i[0],b=i[1],x=i[2],w=i[3];return t[0]=v*r+b*s+x*u+w*f,t[1]=v*n+b*l+x*d+w*g,t[2]=v*a+b*c+x*p+w*y,t[3]=v*o+b*h+x*m+w*_,t[4]=(v=i[4])*r+(b=i[5])*s+(x=i[6])*u+(w=i[7])*f,t[5]=v*n+b*l+x*d+w*g,t[6]=v*a+b*c+x*p+w*y,t[7]=v*o+b*h+x*m+w*_,t[8]=(v=i[8])*r+(b=i[9])*s+(x=i[10])*u+(w=i[11])*f,t[9]=v*n+b*l+x*d+w*g,t[10]=v*a+b*c+x*p+w*y,t[11]=v*o+b*h+x*m+w*_,t[12]=(v=i[12])*r+(b=i[13])*s+(x=i[14])*u+(w=i[15])*f,t[13]=v*n+b*l+x*d+w*g,t[14]=v*a+b*c+x*p+w*y,t[15]=v*o+b*h+x*m+w*_,t}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var Io,zo=Mo;function Po(t,e,i){var r=e[0],n=e[1],a=e[2],o=e[3];return t[0]=i[0]*r+i[4]*n+i[8]*a+i[12]*o,t[1]=i[1]*r+i[5]*n+i[9]*a+i[13]*o,t[2]=i[2]*r+i[6]*n+i[10]*a+i[14]*o,t[3]=i[3]*r+i[7]*n+i[11]*a+i[15]*o,t}Io=new To(4),To!=Float32Array&&(Io[0]=0,Io[1]=0,Io[2]=0,Io[3]=0);class Lo extends kn{constructor(t){super(t,Co)}createBucket(t){return new so(t)}queryRadius(t){const e=t;return bo("circle-radius",this,e)+bo("circle-stroke-width",this,e)+xo(this.paint.get("circle-translate"))}queryIntersectsFeature(t,e,i,r,n,a,o,s){const l=wo(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),a.angle,o),c=this.paint.get("circle-radius").evaluate(e,i)+this.paint.get("circle-stroke-width").evaluate(e,i),h="map"===this.paint.get("circle-pitch-alignment"),u=h?l:function(t,e){return t.map((t=>Do(t,e)))}(l,s),d=h?c*o:c;for(const t of r)for(const e of t){const t=h?e:Do(e,s);let i=d;const r=Po([],[e.x,e.y,0,1],s);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?i*=r[3]/a.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(i*=a.cameraToCenterDistance/r[3]),co(u,t,i))return!0}return!1}}function Do(t,e){const i=Po([],[t.x,t.y,0,1],e);return new a(i[0]/i[3],i[1]/i[3])}class Ro extends so{}let Bo;Rr("HeatmapBucket",Ro,{omit:["layers"]});var Fo={get paint(){return Bo=Bo||new wn({"heatmap-radius":new _n(X.paint_heatmap["heatmap-radius"]),"heatmap-weight":new _n(X.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new yn(X.paint_heatmap["heatmap-intensity"]),"heatmap-color":new xn(X.paint_heatmap["heatmap-color"]),"heatmap-opacity":new yn(X.paint_heatmap["heatmap-opacity"])})}};function Oo(t,{width:e,height:i},r,n){if(n){if(n instanceof Uint8ClampedArray)n=new Uint8Array(n.buffer);else if(n.length!==e*i*r)throw new RangeError(`mismatched image size. expected: ${n.length} but got: ${e*i*r}`)}else n=new Uint8Array(e*i*r);return t.width=e,t.height=i,t.data=n,t}function $o(t,{width:e,height:i},r){if(e===t.width&&i===t.height)return;const n=Oo({},{width:e,height:i},r);Vo(t,n,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,e),height:Math.min(t.height,i)},r),t.width=e,t.height=i,t.data=n.data}function Vo(t,e,i,r,n,a){if(0===n.width||0===n.height)return e;if(n.width>t.width||n.height>t.height||i.x>t.width-n.width||i.y>t.height-n.height)throw new RangeError("out of range source coordinates for image copy");if(n.width>e.width||n.height>e.height||r.x>e.width-n.width||r.y>e.height-n.height)throw new RangeError("out of range destination coordinates for image copy");const o=t.data,s=e.data;if(o===s)throw new Error("srcData equals dstData, so image is already copied");for(let l=0;l<n.height;l++){const c=((i.y+l)*t.width+i.x)*a,h=((r.y+l)*e.width+r.x)*a;for(let t=0;t<n.width*a;t++)s[h+t]=o[c+t]}return e}class No{constructor(t,e){Oo(this,t,1,e)}resize(t){$o(this,t,1)}clone(){return new No({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,e,i,r,n){Vo(t,e,i,r,n,1)}}class jo{constructor(t,e){Oo(this,t,4,e)}resize(t){$o(this,t,4)}replace(t,e){e?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new jo({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,e,i,r,n){Vo(t,e,i,r,n,4)}}function Uo(t){const e={},i=t.resolution||256,r=t.clips?t.clips.length:1,n=t.image||new jo({width:i,height:r});if(Math.log(i)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${i}`);const a=(i,r,a)=>{e[t.evaluationKey]=a;const o=t.expression.evaluate(e);n.data[i+r+0]=Math.floor(255*o.r/o.a),n.data[i+r+1]=Math.floor(255*o.g/o.a),n.data[i+r+2]=Math.floor(255*o.b/o.a),n.data[i+r+3]=Math.floor(255*o.a)};if(t.clips)for(let e=0,n=0;e<r;++e,n+=4*i)for(let r=0,o=0;r<i;r++,o+=4){const s=r/(i-1),{start:l,end:c}=t.clips[e];a(n,o,l*(1-s)+c*s)}else for(let t=0,e=0;t<i;t++,e+=4)a(0,e,t/(i-1));return n}Rr("AlphaImage",No),Rr("RGBAImage",jo);class Zo extends kn{createBucket(t){return new Ro(t)}constructor(t){super(t,Fo),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){"heatmap-color"===t&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Uo({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}}let Ho;var qo={get paint(){return Ho=Ho||new wn({"hillshade-illumination-direction":new yn(X.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new yn(X.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new yn(X.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new yn(X.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new yn(X.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new yn(X.paint_hillshade["hillshade-accent-color"])})}};class Go extends kn{constructor(t){super(t,qo)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}}const Wo=En([{name:"a_pos",components:2,type:"Int16"}],4),{members:Xo}=Wo;var Ko={exports:{}};function Jo(t,e,i){i=i||2;var r,n,a,o,s,l,c,h=e&&e.length,u=h?e[0]*i:t.length,d=Yo(t,0,u,i,!0),p=[];if(!d||d.next===d.prev)return p;if(h&&(d=function(t,e,i,r){var n,a,o,s=[];for(n=0,a=e.length;n<a;n++)(o=Yo(t,e[n]*r,n<a-1?e[n+1]*r:t.length,r,!1))===o.next&&(o.steiner=!0),s.push(cs(o));for(s.sort(as),n=0;n<s.length;n++)i=os(s[n],i);return i}(t,e,d,i)),t.length>80*i){r=a=t[0],n=o=t[1];for(var m=i;m<u;m+=i)(s=t[m])<r&&(r=s),(l=t[m+1])<n&&(n=l),s>a&&(a=s),l>o&&(o=l);c=0!==(c=Math.max(a-r,o-n))?32767/c:0}return ts(d,p,i,r,n,c,0),p}function Yo(t,e,i,r,n){var a,o;if(n===ws(t,e,i,r)>0)for(a=e;a<i;a+=r)o=vs(a,t[a],t[a+1],o);else for(a=i-r;a>=e;a-=r)o=vs(a,t[a],t[a+1],o);return o&&ps(o,o.next)&&(bs(o),o=o.next),o}function Qo(t,e){if(!t)return t;e||(e=t);var i,r=t;do{if(i=!1,r.steiner||!ps(r,r.next)&&0!==ds(r.prev,r,r.next))r=r.next;else{if(bs(r),(r=e=r.prev)===r.next)break;i=!0}}while(i||r!==e);return e}function ts(t,e,i,r,n,a,o){if(t){!o&&a&&function(t,e,i,r){var n=t;do{0===n.z&&(n.z=ls(n.x,n.y,e,i,r)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next}while(n!==t);n.prevZ.nextZ=null,n.prevZ=null,function(t){var e,i,r,n,a,o,s,l,c=1;do{for(i=t,t=null,a=null,o=0;i;){for(o++,r=i,s=0,e=0;e<c&&(s++,r=r.nextZ);e++);for(l=c;s>0||l>0&&r;)0!==s&&(0===l||!r||i.z<=r.z)?(n=i,i=i.nextZ,s--):(n=r,r=r.nextZ,l--),a?a.nextZ=n:t=n,n.prevZ=a,a=n;i=r}a.nextZ=null,c*=2}while(o>1)}(n)}(t,r,n,a);for(var s,l,c=t;t.prev!==t.next;)if(s=t.prev,l=t.next,a?is(t,r,n,a):es(t))e.push(s.i/i|0),e.push(t.i/i|0),e.push(l.i/i|0),bs(t),t=l.next,c=l.next;else if((t=l)===c){o?1===o?ts(t=rs(Qo(t),e,i),e,i,r,n,a,2):2===o&&ns(t,e,i,r,n,a):ts(Qo(t),e,i,r,n,a,1);break}}}function es(t){var e=t.prev,i=t,r=t.next;if(ds(e,i,r)>=0)return!1;for(var n=e.x,a=i.x,o=r.x,s=e.y,l=i.y,c=r.y,h=n<a?n<o?n:o:a<o?a:o,u=s<l?s<c?s:c:l<c?l:c,d=n>a?n>o?n:o:a>o?a:o,p=s>l?s>c?s:c:l>c?l:c,m=r.next;m!==e;){if(m.x>=h&&m.x<=d&&m.y>=u&&m.y<=p&&hs(n,s,a,l,o,c,m.x,m.y)&&ds(m.prev,m,m.next)>=0)return!1;m=m.next}return!0}function is(t,e,i,r){var n=t.prev,a=t,o=t.next;if(ds(n,a,o)>=0)return!1;for(var s=n.x,l=a.x,c=o.x,h=n.y,u=a.y,d=o.y,p=s<l?s<c?s:c:l<c?l:c,m=h<u?h<d?h:d:u<d?u:d,f=s>l?s>c?s:c:l>c?l:c,g=h>u?h>d?h:d:u>d?u:d,y=ls(p,m,e,i,r),_=ls(f,g,e,i,r),v=t.prevZ,b=t.nextZ;v&&v.z>=y&&b&&b.z<=_;){if(v.x>=p&&v.x<=f&&v.y>=m&&v.y<=g&&v!==n&&v!==o&&hs(s,h,l,u,c,d,v.x,v.y)&&ds(v.prev,v,v.next)>=0)return!1;if(v=v.prevZ,b.x>=p&&b.x<=f&&b.y>=m&&b.y<=g&&b!==n&&b!==o&&hs(s,h,l,u,c,d,b.x,b.y)&&ds(b.prev,b,b.next)>=0)return!1;b=b.nextZ}for(;v&&v.z>=y;){if(v.x>=p&&v.x<=f&&v.y>=m&&v.y<=g&&v!==n&&v!==o&&hs(s,h,l,u,c,d,v.x,v.y)&&ds(v.prev,v,v.next)>=0)return!1;v=v.prevZ}for(;b&&b.z<=_;){if(b.x>=p&&b.x<=f&&b.y>=m&&b.y<=g&&b!==n&&b!==o&&hs(s,h,l,u,c,d,b.x,b.y)&&ds(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function rs(t,e,i){var r=t;do{var n=r.prev,a=r.next.next;!ps(n,a)&&ms(n,r,r.next,a)&&ys(n,a)&&ys(a,n)&&(e.push(n.i/i|0),e.push(r.i/i|0),e.push(a.i/i|0),bs(r),bs(r.next),r=t=a),r=r.next}while(r!==t);return Qo(r)}function ns(t,e,i,r,n,a){var o=t;do{for(var s=o.next.next;s!==o.prev;){if(o.i!==s.i&&us(o,s)){var l=_s(o,s);return o=Qo(o,o.next),l=Qo(l,l.next),ts(o,e,i,r,n,a,0),void ts(l,e,i,r,n,a,0)}s=s.next}o=o.next}while(o!==t)}function as(t,e){return t.x-e.x}function os(t,e){var i=function(t,e){var i,r=e,n=t.x,a=t.y,o=-1/0;do{if(a<=r.y&&a>=r.next.y&&r.next.y!==r.y){var s=r.x+(a-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=n&&s>o&&(o=s,i=r.x<r.next.x?r:r.next,s===n))return i}r=r.next}while(r!==e);if(!i)return null;var l,c=i,h=i.x,u=i.y,d=1/0;r=i;do{n>=r.x&&r.x>=h&&n!==r.x&&hs(a<u?n:o,a,h,u,a<u?o:n,a,r.x,r.y)&&(l=Math.abs(a-r.y)/(n-r.x),ys(r,t)&&(l<d||l===d&&(r.x>i.x||r.x===i.x&&ss(i,r)))&&(i=r,d=l)),r=r.next}while(r!==c);return i}(t,e);if(!i)return e;var r=_s(i,t);return Qo(r,r.next),Qo(i,i.next)}function ss(t,e){return ds(t.prev,t,e.prev)<0&&ds(e.next,t,t.next)<0}function ls(t,e,i,r,n){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-i)*n|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-r)*n|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function cs(t){var e=t,i=t;do{(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next}while(e!==t);return i}function hs(t,e,i,r,n,a,o,s){return(n-o)*(e-s)>=(t-o)*(a-s)&&(t-o)*(r-s)>=(i-o)*(e-s)&&(i-o)*(a-s)>=(n-o)*(r-s)}function us(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var i=t;do{if(i.i!==t.i&&i.next.i!==t.i&&i.i!==e.i&&i.next.i!==e.i&&ms(i,i.next,t,e))return!0;i=i.next}while(i!==t);return!1}(t,e)&&(ys(t,e)&&ys(e,t)&&function(t,e){var i=t,r=!1,n=(t.x+e.x)/2,a=(t.y+e.y)/2;do{i.y>a!=i.next.y>a&&i.next.y!==i.y&&n<(i.next.x-i.x)*(a-i.y)/(i.next.y-i.y)+i.x&&(r=!r),i=i.next}while(i!==t);return r}(t,e)&&(ds(t.prev,t,e.prev)||ds(t,e.prev,e))||ps(t,e)&&ds(t.prev,t,t.next)>0&&ds(e.prev,e,e.next)>0)}function ds(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function ps(t,e){return t.x===e.x&&t.y===e.y}function ms(t,e,i,r){var n=gs(ds(t,e,i)),a=gs(ds(t,e,r)),o=gs(ds(i,r,t)),s=gs(ds(i,r,e));return n!==a&&o!==s||!(0!==n||!fs(t,i,e))||!(0!==a||!fs(t,r,e))||!(0!==o||!fs(i,t,r))||!(0!==s||!fs(i,e,r))}function fs(t,e,i){return e.x<=Math.max(t.x,i.x)&&e.x>=Math.min(t.x,i.x)&&e.y<=Math.max(t.y,i.y)&&e.y>=Math.min(t.y,i.y)}function gs(t){return t>0?1:t<0?-1:0}function ys(t,e){return ds(t.prev,t,t.next)<0?ds(t,e,t.next)>=0&&ds(t,t.prev,e)>=0:ds(t,e,t.prev)<0||ds(t,t.next,e)<0}function _s(t,e){var i=new xs(t.i,t.x,t.y),r=new xs(e.i,e.x,e.y),n=t.next,a=e.prev;return t.next=e,e.prev=t,i.next=n,n.prev=i,r.next=i,i.prev=r,a.next=r,r.prev=a,r}function vs(t,e,i,r){var n=new xs(t,e,i);return r?(n.next=r.next,n.prev=r,r.next.prev=n,r.next=n):(n.prev=n,n.next=n),n}function bs(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function xs(t,e,i){this.i=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function ws(t,e,i,r){for(var n=0,a=e,o=i-r;a<i;a+=r)n+=(t[o]-t[a])*(t[a+1]+t[o+1]),o=a;return n}Ko.exports=Jo,Ko.exports.default=Jo,Jo.deviation=function(t,e,i,r){var n=e&&e.length,a=Math.abs(ws(t,0,n?e[0]*i:t.length,i));if(n)for(var o=0,s=e.length;o<s;o++)a-=Math.abs(ws(t,e[o]*i,o<s-1?e[o+1]*i:t.length,i));var l=0;for(o=0;o<r.length;o+=3){var c=r[o]*i,h=r[o+1]*i,u=r[o+2]*i;l+=Math.abs((t[c]-t[u])*(t[h+1]-t[c+1])-(t[c]-t[h])*(t[u+1]-t[c+1]))}return 0===a&&0===l?0:Math.abs((l-a)/a)},Jo.flatten=function(t){for(var e=t[0][0].length,i={vertices:[],holes:[],dimensions:e},r=0,n=0;n<t.length;n++){for(var a=0;a<t[n].length;a++)for(var o=0;o<e;o++)i.vertices.push(t[n][a][o]);n>0&&i.holes.push(r+=t[n-1].length)}return i};var Ss=i(Ko.exports);function ks(t,e,i,r,n){Cs(t,e,i||0,r||t.length-1,n||Ts)}function Cs(t,e,i,r,n){for(;r>i;){if(r-i>600){var a=r-i+1,o=e-i+1,s=Math.log(a),l=.5*Math.exp(2*s/3),c=.5*Math.sqrt(s*l*(a-l)/a)*(o-a/2<0?-1:1);Cs(t,e,Math.max(i,Math.floor(e-o*l/a+c)),Math.min(r,Math.floor(e+(a-o)*l/a+c)),n)}var h=t[e],u=i,d=r;for(As(t,i,e),n(t[r],h)>0&&As(t,i,r);u<d;){for(As(t,u,d),u++,d--;n(t[u],h)<0;)u++;for(;n(t[d],h)>0;)d--}0===n(t[i],h)?As(t,i,d):As(t,++d,r),d<=e&&(i=d+1),e<=d&&(r=d-1)}}function As(t,e,i){var r=t[e];t[e]=t[i],t[i]=r}function Ts(t,e){return t<e?-1:t>e?1:0}function Es(t,e){const i=t.length;if(i<=1)return[t];const r=[];let n,a;for(let e=0;e<i;e++){const i=C(t[e]);0!==i&&(t[e].area=Math.abs(i),void 0===a&&(a=i<0),a===i<0?(n&&r.push(n),n=[t[e]]):n.push(t[e]))}if(n&&r.push(n),e>1)for(let t=0;t<r.length;t++)r[t].length<=e||(ks(r[t],e,1,r[t].length-1,Ms),r[t]=r[t].slice(0,e));return r}function Ms(t,e){return e.area-t.area}function Is(t,e,i){const r=i.patternDependencies;let n=!1;for(const i of e){const e=i.paint.get(`${t}-pattern`);e.isConstant()||(n=!0);const a=e.constantOr(null);a&&(n=!0,r[a.to]=!0,r[a.from]=!0)}return n}function zs(t,e,i,r,n){const a=n.patternDependencies;for(const o of e){const e=o.paint.get(`${t}-pattern`).value;if("constant"!==e.kind){let t=e.evaluate({zoom:r-1},i,{},n.availableImages),s=e.evaluate({zoom:r},i,{},n.availableImages),l=e.evaluate({zoom:r+1},i,{},n.availableImages);t=t&&t.name?t.name:t,s=s&&s.name?s.name:s,l=l&&l.name?l.name:l,a[t]=!0,a[s]=!0,a[l]=!0,i.patterns[o.id]={min:t,mid:s,max:l}}}return i}class Ps{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((t=>t.id)),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new pa,this.indexArray=new Sa,this.indexArray2=new ka,this.programConfigurations=new Ya(t.layers,t.zoom),this.segments=new Ta,this.segments2=new Ta,this.stateDependentLayerIds=this.layers.filter((t=>t.isStateDependent())).map((t=>t.id))}populate(t,e,i){this.hasPattern=Is("fill",this.layers,e);const r=this.layers[0].layout.get("fill-sort-key"),n=!r.isConstant(),a=[];for(const{feature:o,id:s,index:l,sourceLayerIndex:c}of t){const t=this.layers[0]._featureFilter.needGeometry,h=ao(o,t);if(!this.layers[0]._featureFilter.filter(new ln(this.zoom),h,i))continue;const u=n?r.evaluate(h,{},i,e.availableImages):void 0,d={id:s,properties:o.properties,type:o.type,sourceLayerIndex:c,index:l,geometry:t?h.geometry:no(o),patterns:{},sortKey:u};a.push(d)}n&&a.sort(((t,e)=>t.sortKey-e.sortKey));for(const r of a){const{geometry:n,index:a,sourceLayerIndex:o}=r;if(this.hasPattern){const t=zs("fill",this.layers,r,this.zoom,e);this.patternFeatures.push(t)}else this.addFeature(r,n,a,i,{});e.featureIndex.insert(t[a].feature,n,a,o,this.index)}}update(t,e,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,i)}addFeatures(t,e,i){for(const t of this.patternFeatures)this.addFeature(t,t.geometry,t.index,e,i)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Xo),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,e,i,r,n){for(const t of Es(e,500)){let e=0;for(const i of t)e+=i.length;const i=this.segments.prepareSegment(e,this.layoutVertexArray,this.indexArray),r=i.vertexLength,n=[],a=[];for(const e of t){if(0===e.length)continue;e!==t[0]&&a.push(n.length/2);const i=this.segments2.prepareSegment(e.length,this.layoutVertexArray,this.indexArray2),r=i.vertexLength;this.layoutVertexArray.emplaceBack(e[0].x,e[0].y),this.indexArray2.emplaceBack(r+e.length-1,r),n.push(e[0].x),n.push(e[0].y);for(let t=1;t<e.length;t++)this.layoutVertexArray.emplaceBack(e[t].x,e[t].y),this.indexArray2.emplaceBack(r+t-1,r+t),n.push(e[t].x),n.push(e[t].y);i.vertexLength+=e.length,i.primitiveLength+=e.length}const o=Ss(n,a);for(let t=0;t<o.length;t+=3)this.indexArray.emplaceBack(r+o[t],r+o[t+1],r+o[t+2]);i.vertexLength+=e,i.primitiveLength+=o.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,i,n,r)}}let Ls,Ds;Rr("FillBucket",Ps,{omit:["layers","patternFeatures"]});var Rs={get paint(){return Ds=Ds||new wn({"fill-antialias":new yn(X.paint_fill["fill-antialias"]),"fill-opacity":new _n(X.paint_fill["fill-opacity"]),"fill-color":new _n(X.paint_fill["fill-color"]),"fill-outline-color":new _n(X.paint_fill["fill-outline-color"]),"fill-translate":new yn(X.paint_fill["fill-translate"]),"fill-translate-anchor":new yn(X.paint_fill["fill-translate-anchor"]),"fill-pattern":new vn(X.paint_fill["fill-pattern"])})},get layout(){return Ls=Ls||new wn({"fill-sort-key":new _n(X.layout_fill["fill-sort-key"])})}};class Bs extends kn{constructor(t){super(t,Rs)}recalculate(t,e){super.recalculate(t,e);const i=this.paint._values["fill-outline-color"];"constant"===i.value.kind&&void 0===i.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new Ps(t)}queryRadius(){return xo(this.paint.get("fill-translate"))}queryIntersectsFeature(t,e,i,r,n,a,o){return ho(wo(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),a.angle,o),r)}isTileClipped(){return!0}}const Fs=En([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Os=En([{name:"a_centroid",components:2,type:"Int16"}],4),{members:$s}=Fs;var Vs={},Ns=r,js=Us;function Us(t,e,i,r,n){this.properties={},this.extent=i,this.type=0,this._pbf=t,this._geometry=-1,this._keys=r,this._values=n,t.readFields(Zs,this,e)}function Zs(t,e,i){1==t?e.id=i.readVarint():2==t?function(t,e){for(var i=t.readVarint()+t.pos;t.pos<i;){var r=e._keys[t.readVarint()],n=e._values[t.readVarint()];e.properties[r]=n}}(i,e):3==t?e.type=i.readVarint():4==t&&(e._geometry=i.pos)}function Hs(t){for(var e,i,r=0,n=0,a=t.length,o=a-1;n<a;o=n++)r+=((i=t[o]).x-(e=t[n]).x)*(e.y+i.y);return r}Us.types=["Unknown","Point","LineString","Polygon"],Us.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,i=t.readVarint()+t.pos,r=1,n=0,a=0,o=0,s=[];t.pos<i;){if(n<=0){var l=t.readVarint();r=7&l,n=l>>3}if(n--,1===r||2===r)a+=t.readSVarint(),o+=t.readSVarint(),1===r&&(e&&s.push(e),e=[]),e.push(new Ns(a,o));else{if(7!==r)throw new Error("unknown command "+r);e&&e.push(e[0].clone())}}return e&&s.push(e),s},Us.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,i=1,r=0,n=0,a=0,o=1/0,s=-1/0,l=1/0,c=-1/0;t.pos<e;){if(r<=0){var h=t.readVarint();i=7&h,r=h>>3}if(r--,1===i||2===i)(n+=t.readSVarint())<o&&(o=n),n>s&&(s=n),(a+=t.readSVarint())<l&&(l=a),a>c&&(c=a);else if(7!==i)throw new Error("unknown command "+i)}return[o,l,s,c]},Us.prototype.toGeoJSON=function(t,e,i){var r,n,a=this.extent*Math.pow(2,i),o=this.extent*t,s=this.extent*e,l=this.loadGeometry(),c=Us.types[this.type];function h(t){for(var e=0;e<t.length;e++){var i=t[e];t[e]=[360*(i.x+o)/a-180,360/Math.PI*Math.atan(Math.exp((180-360*(i.y+s)/a)*Math.PI/180))-90]}}switch(this.type){case 1:var u=[];for(r=0;r<l.length;r++)u[r]=l[r][0];h(l=u);break;case 2:for(r=0;r<l.length;r++)h(l[r]);break;case 3:for(l=function(t){var e=t.length;if(e<=1)return[t];for(var i,r,n=[],a=0;a<e;a++){var o=Hs(t[a]);0!==o&&(void 0===r&&(r=o<0),r===o<0?(i&&n.push(i),i=[t[a]]):i.push(t[a]))}return i&&n.push(i),n}(l),r=0;r<l.length;r++)for(n=0;n<l[r].length;n++)h(l[r][n])}1===l.length?l=l[0]:c="Multi"+c;var d={type:"Feature",geometry:{type:c,coordinates:l},properties:this.properties};return"id"in this&&(d.id=this.id),d};var qs=js,Gs=Ws;function Ws(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(Xs,this,e),this.length=this._features.length}function Xs(t,e,i){15===t?e.version=i.readVarint():1===t?e.name=i.readString():5===t?e.extent=i.readVarint():2===t?e._features.push(i.pos):3===t?e._keys.push(i.readString()):4===t&&e._values.push(function(t){for(var e=null,i=t.readVarint()+t.pos;t.pos<i;){var r=t.readVarint()>>3;e=1===r?t.readString():2===r?t.readFloat():3===r?t.readDouble():4===r?t.readVarint64():5===r?t.readVarint():6===r?t.readSVarint():7===r?t.readBoolean():null}return e}(i))}Ws.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new qs(this._pbf,e,this.extent,this._keys,this._values)};var Ks=Gs;function Js(t,e,i){if(3===t){var r=new Ks(i,i.readVarint()+i.pos);r.length&&(e[r.name]=r)}}Vs.VectorTile=function(t,e){this.layers=t.readFields(Js,{},e)},Vs.VectorTileFeature=js,Vs.VectorTileLayer=Gs;const Ys=Vs.VectorTileFeature.types,Qs=Math.pow(2,13);function tl(t,e,i,r,n,a,o,s){t.emplaceBack(e,i,2*Math.floor(r*Qs)+o,n*Qs*2,a*Qs*2,Math.round(s))}class el{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((t=>t.id)),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new ma,this.centroidVertexArray=new ua,this.indexArray=new Sa,this.programConfigurations=new Ya(t.layers,t.zoom),this.segments=new Ta,this.stateDependentLayerIds=this.layers.filter((t=>t.isStateDependent())).map((t=>t.id))}populate(t,e,i){this.features=[],this.hasPattern=Is("fill-extrusion",this.layers,e);for(const{feature:r,id:n,index:a,sourceLayerIndex:o}of t){const t=this.layers[0]._featureFilter.needGeometry,s=ao(r,t);if(!this.layers[0]._featureFilter.filter(new ln(this.zoom),s,i))continue;const l={id:n,sourceLayerIndex:o,index:a,geometry:t?s.geometry:no(r),properties:r.properties,type:r.type,patterns:{}};this.hasPattern?this.features.push(zs("fill-extrusion",this.layers,l,this.zoom,e)):this.addFeature(l,l.geometry,a,i,{}),e.featureIndex.insert(r,l.geometry,a,o,this.index,!0)}}addFeatures(t,e,i){for(const t of this.features){const{geometry:r}=t;this.addFeature(t,r,t.index,e,i)}}update(t,e,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,i)}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.centroidVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,$s),this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,Os.members,!0),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(t,e,i,r,n){const a={x:0,y:0,vertexCount:0};for(const i of Es(e,500)){let e=0;for(const t of i)e+=t.length;let r=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const t of i){if(0===t.length)continue;if(rl(t))continue;let e=0;for(let i=0;i<t.length;i++){const n=t[i];if(i>=1){const o=t[i-1];if(!il(n,o)){r.vertexLength+4>Ta.MAX_VERTEX_ARRAY_LENGTH&&(r=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const t=n.sub(o)._perp()._unit(),i=o.dist(n);e+i>32768&&(e=0),tl(this.layoutVertexArray,n.x,n.y,t.x,t.y,0,0,e),tl(this.layoutVertexArray,n.x,n.y,t.x,t.y,0,1,e),a.x+=2*n.x,a.y+=2*n.y,a.vertexCount+=2,e+=i,tl(this.layoutVertexArray,o.x,o.y,t.x,t.y,0,0,e),tl(this.layoutVertexArray,o.x,o.y,t.x,t.y,0,1,e),a.x+=2*o.x,a.y+=2*o.y,a.vertexCount+=2;const s=r.vertexLength;this.indexArray.emplaceBack(s,s+2,s+1),this.indexArray.emplaceBack(s+1,s+2,s+3),r.vertexLength+=4,r.primitiveLength+=2}}}}if(r.vertexLength+e>Ta.MAX_VERTEX_ARRAY_LENGTH&&(r=this.segments.prepareSegment(e,this.layoutVertexArray,this.indexArray)),"Polygon"!==Ys[t.type])continue;const n=[],o=[],s=r.vertexLength;for(const t of i)if(0!==t.length){t!==i[0]&&o.push(n.length/2);for(let e=0;e<t.length;e++){const i=t[e];tl(this.layoutVertexArray,i.x,i.y,0,0,1,1,0),a.x+=i.x,a.y+=i.y,a.vertexCount+=1,n.push(i.x),n.push(i.y)}}const l=Ss(n,o);for(let t=0;t<l.length;t+=3)this.indexArray.emplaceBack(s+l[t],s+l[t+2],s+l[t+1]);r.primitiveLength+=l.length/3,r.vertexLength+=e}for(let t=0;t<a.vertexCount;t++)this.centroidVertexArray.emplaceBack(Math.floor(a.x/a.vertexCount),Math.floor(a.y/a.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,i,n,r)}}function il(t,e){return t.x===e.x&&(t.x<0||t.x>eo)||t.y===e.y&&(t.y<0||t.y>eo)}function rl(t){return t.every((t=>t.x<0))||t.every((t=>t.x>eo))||t.every((t=>t.y<0))||t.every((t=>t.y>eo))}let nl;Rr("FillExtrusionBucket",el,{omit:["layers","features"]});var al={get paint(){return nl=nl||new wn({"fill-extrusion-opacity":new yn(X["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new _n(X["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new yn(X["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new yn(X["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new vn(X["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new _n(X["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new _n(X["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new yn(X["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class ol extends kn{constructor(t){super(t,al)}createBucket(t){return new el(t)}queryRadius(){return xo(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(t,e,i,r,n,o,s,l){const c=wo(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),o.angle,s),h=this.paint.get("fill-extrusion-height").evaluate(e,i),u=this.paint.get("fill-extrusion-base").evaluate(e,i),d=function(t,e,i,r){const n=[];for(const i of t){const t=[i.x,i.y,0,1];Po(t,t,e),n.push(new a(t[0]/t[3],t[1]/t[3]))}return n}(c,l),p=function(t,e,i,r){const n=[],o=[],s=r[8]*e,l=r[9]*e,c=r[10]*e,h=r[11]*e,u=r[8]*i,d=r[9]*i,p=r[10]*i,m=r[11]*i;for(const e of t){const t=[],i=[];for(const n of e){const e=n.x,o=n.y,f=r[0]*e+r[4]*o+r[12],g=r[1]*e+r[5]*o+r[13],y=r[2]*e+r[6]*o+r[14],_=r[3]*e+r[7]*o+r[15],v=y+c,b=_+h,x=f+u,w=g+d,S=y+p,k=_+m,C=new a((f+s)/b,(g+l)/b);C.z=v/b,t.push(C);const A=new a(x/k,w/k);A.z=S/k,i.push(A)}n.push(t),o.push(i)}return[n,o]}(r,u,h,l);return function(t,e,i){let r=1/0;ho(i,e)&&(r=ll(i,e[0]));for(let n=0;n<e.length;n++){const a=e[n],o=t[n];for(let t=0;t<a.length-1;t++){const e=a[t],n=[e,a[t+1],o[t+1],o[t],e];lo(i,n)&&(r=Math.min(r,ll(i,n)))}}return r!==1/0&&r}(p[0],p[1],d)}}function sl(t,e){return t.x*e.x+t.y*e.y}function ll(t,e){if(1===t.length){let i=0;const r=e[i++];let n;for(;!n||r.equals(n);)if(n=e[i++],!n)return 1/0;for(;i<e.length;i++){const a=e[i],o=t[0],s=n.sub(r),l=a.sub(r),c=o.sub(r),h=sl(s,s),u=sl(s,l),d=sl(l,l),p=sl(c,s),m=sl(c,l),f=h*d-u*u,g=(d*p-u*m)/f,y=(h*m-u*p)/f,_=r.z*(1-g-y)+n.z*g+a.z*y;if(isFinite(_))return _}return 1/0}{let t=1/0;for(const i of e)t=Math.min(t,i.z);return t}}const cl=En([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:hl}=cl,ul=En([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:dl}=ul,pl=Vs.VectorTileFeature.types,ml=Math.cos(Math.PI/180*37.5),fl=Math.pow(2,14)/.5;class gl{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((t=>t.id)),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((t=>{this.gradients[t.id]={}})),this.layoutVertexArray=new fa,this.layoutVertexArray2=new ga,this.indexArray=new Sa,this.programConfigurations=new Ya(t.layers,t.zoom),this.segments=new Ta,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter((t=>t.isStateDependent())).map((t=>t.id))}populate(t,e,i){this.hasPattern=Is("line",this.layers,e);const r=this.layers[0].layout.get("line-sort-key"),n=!r.isConstant(),a=[];for(const{feature:e,id:o,index:s,sourceLayerIndex:l}of t){const t=this.layers[0]._featureFilter.needGeometry,c=ao(e,t);if(!this.layers[0]._featureFilter.filter(new ln(this.zoom),c,i))continue;const h=n?r.evaluate(c,{},i):void 0,u={id:o,properties:e.properties,type:e.type,sourceLayerIndex:l,index:s,geometry:t?c.geometry:no(e),patterns:{},sortKey:h};a.push(u)}n&&a.sort(((t,e)=>t.sortKey-e.sortKey));for(const r of a){const{geometry:n,index:a,sourceLayerIndex:o}=r;if(this.hasPattern){const t=zs("line",this.layers,r,this.zoom,e);this.patternFeatures.push(t)}else this.addFeature(r,n,a,i,{});e.featureIndex.insert(t[a].feature,n,a,o,this.index)}}update(t,e,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,i)}addFeatures(t,e,i){for(const t of this.patternFeatures)this.addFeature(t,t.geometry,t.index,e,i)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,dl)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,hl),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,e,i,r,n){const a=this.layers[0].layout,o=a.get("line-join").evaluate(t,{}),s=a.get("line-cap"),l=a.get("line-miter-limit"),c=a.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const i of e)this.addLine(i,t,o,s,l,c);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,i,n,r)}addLine(t,e,i,r,n,a){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let e=0;e<t.length-1;e++)this.totalDistance+=t[e].dist(t[e+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const o="Polygon"===pl[e.type];let s=t.length;for(;s>=2&&t[s-1].equals(t[s-2]);)s--;let l=0;for(;l<s-1&&t[l].equals(t[l+1]);)l++;if(s<(o?3:2))return;"bevel"===i&&(n=1.05);const c=this.overscaling<=16?15*eo/(512*this.overscaling):0,h=this.segments.prepareSegment(10*s,this.layoutVertexArray,this.indexArray);let u,d,p,m,f;this.e1=this.e2=-1,o&&(u=t[s-2],f=t[l].sub(u)._unit()._perp());for(let e=l;e<s;e++){if(p=e===s-1?o?t[l+1]:void 0:t[e+1],p&&t[e].equals(p))continue;f&&(m=f),u&&(d=u),u=t[e],f=p?p.sub(u)._unit()._perp():m,m=m||f;let g=m.add(f);0===g.x&&0===g.y||g._unit();const y=m.x*f.x+m.y*f.y,_=g.x*f.x+g.y*f.y,v=0!==_?1/_:1/0,b=2*Math.sqrt(2-2*_),x=_<ml&&d&&p,w=m.x*f.y-m.y*f.x>0;if(x&&e>l){const t=u.dist(d);if(t>2*c){const e=u.sub(u.sub(d)._mult(c/t)._round());this.updateDistance(d,e),this.addCurrentVertex(e,m,0,0,h),d=e}}const S=d&&p;let k=S?i:o?"butt":r;if(S&&"round"===k&&(v<a?k="miter":v<=2&&(k="fakeround")),"miter"===k&&v>n&&(k="bevel"),"bevel"===k&&(v>2&&(k="flipbevel"),v<n&&(k="miter")),d&&this.updateDistance(d,u),"miter"===k)g._mult(v),this.addCurrentVertex(u,g,0,0,h);else if("flipbevel"===k){if(v>100)g=f.mult(-1);else{const t=v*m.add(f).mag()/m.sub(f).mag();g._perp()._mult(t*(w?-1:1))}this.addCurrentVertex(u,g,0,0,h),this.addCurrentVertex(u,g.mult(-1),0,0,h)}else if("bevel"===k||"fakeround"===k){const t=-Math.sqrt(v*v-1),e=w?t:0,i=w?0:t;if(d&&this.addCurrentVertex(u,m,e,i,h),"fakeround"===k){const t=Math.round(180*b/Math.PI/20);for(let e=1;e<t;e++){let i=e/t;if(.5!==i){const t=i-.5;i+=i*t*(i-1)*((1.0904+y*(y*(3.55645-1.43519*y)-3.2452))*t*t+(.848013+y*(.215638*y-1.06021)))}const r=f.sub(m)._mult(i)._add(m)._unit()._mult(w?-1:1);this.addHalfVertex(u,r.x,r.y,!1,w,0,h)}}p&&this.addCurrentVertex(u,f,-e,-i,h)}else if("butt"===k)this.addCurrentVertex(u,g,0,0,h);else if("square"===k){const t=d?1:-1;this.addCurrentVertex(u,g,t,t,h)}else"round"===k&&(d&&(this.addCurrentVertex(u,m,0,0,h),this.addCurrentVertex(u,m,1,1,h,!0)),p&&(this.addCurrentVertex(u,f,-1,-1,h,!0),this.addCurrentVertex(u,f,0,0,h)));if(x&&e<s-1){const t=u.dist(p);if(t>2*c){const e=u.add(p.sub(u)._mult(c/t)._round());this.updateDistance(u,e),this.addCurrentVertex(e,f,0,0,h),u=e}}}}addCurrentVertex(t,e,i,r,n,a=!1){const o=e.y*r-e.x,s=-e.y-e.x*r;this.addHalfVertex(t,e.x+e.y*i,e.y-e.x*i,a,!1,i,n),this.addHalfVertex(t,o,s,a,!0,-r,n),this.distance>fl/2&&0===this.totalDistance&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(t,e,i,r,n,a))}addHalfVertex({x:t,y:e},i,r,n,a,o,s){const l=.5*(this.lineClips?this.scaledDistance*(fl-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t<<1)+(n?1:0),(e<<1)+(a?1:0),Math.round(63*i)+128,Math.round(63*r)+128,1+(0===o?0:o<0?-1:1)|(63&l)<<2,l>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const c=s.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,c),s.primitiveLength++),a?this.e2=c:this.e1=c}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(t,e){this.distance+=t.dist(e),this.updateScaledDistance()}}let yl,_l;Rr("LineBucket",gl,{omit:["layers","patternFeatures"]});var vl={get paint(){return _l=_l||new wn({"line-opacity":new _n(X.paint_line["line-opacity"]),"line-color":new _n(X.paint_line["line-color"]),"line-translate":new yn(X.paint_line["line-translate"]),"line-translate-anchor":new yn(X.paint_line["line-translate-anchor"]),"line-width":new _n(X.paint_line["line-width"]),"line-gap-width":new _n(X.paint_line["line-gap-width"]),"line-offset":new _n(X.paint_line["line-offset"]),"line-blur":new _n(X.paint_line["line-blur"]),"line-dasharray":new bn(X.paint_line["line-dasharray"]),"line-pattern":new vn(X.paint_line["line-pattern"]),"line-gradient":new xn(X.paint_line["line-gradient"])})},get layout(){return yl=yl||new wn({"line-cap":new yn(X.layout_line["line-cap"]),"line-join":new _n(X.layout_line["line-join"]),"line-miter-limit":new yn(X.layout_line["line-miter-limit"]),"line-round-limit":new yn(X.layout_line["line-round-limit"]),"line-sort-key":new _n(X.layout_line["line-sort-key"])})}};class bl extends _n{possiblyEvaluate(t,e){return e=new ln(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,zoomHistory:e.zoomHistory,transition:e.transition}),super.possiblyEvaluate(t,e)}evaluate(t,e,i,r){return e=y({},e,{zoom:Math.floor(e.zoom)}),super.evaluate(t,e,i,r)}}let xl;class wl extends kn{constructor(t){super(t,vl),this.gradientVersion=0,xl||(xl=new bl(vl.paint.properties["line-width"].specification),xl.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(t){if("line-gradient"===t){const t=this.gradientExpression();this.stepInterpolant=!!function(t){return void 0!==t._styleExpression}(t)&&t._styleExpression.expression instanceof je,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(t,e){super.recalculate(t,e),this.paint._values["line-floorwidth"]=xl.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new gl(t)}queryRadius(t){const e=t,i=Sl(bo("line-width",this,e),bo("line-gap-width",this,e)),r=bo("line-offset",this,e);return i/2+Math.abs(r)+xo(this.paint.get("line-translate"))}queryIntersectsFeature(t,e,i,r,n,o,s){const l=wo(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),o.angle,s),c=s/2*Sl(this.paint.get("line-width").evaluate(e,i),this.paint.get("line-gap-width").evaluate(e,i)),h=this.paint.get("line-offset").evaluate(e,i);return h&&(r=function(t,e){const i=[];for(let r=0;r<t.length;r++){const n=t[r],o=[];for(let t=0;t<n.length;t++){const i=n[t-1],r=n[t],s=n[t+1],l=0===t?new a(0,0):r.sub(i)._unit()._perp(),c=t===n.length-1?new a(0,0):s.sub(r)._unit()._perp(),h=l._add(c)._unit(),u=h.x*c.x+h.y*c.y;0!==u&&h._mult(1/u),o.push(h._mult(e)._add(r))}i.push(o)}return i}(r,h*s)),function(t,e,i){for(let r=0;r<e.length;r++){const n=e[r];if(t.length>=3)for(let e=0;e<n.length;e++)if(_o(t,n[e]))return!0;if(uo(t,n,i))return!0}return!1}(l,r,c)}isTileClipped(){return!0}}function Sl(t,e){return e>0?e+2*t:t}const kl=En([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Cl=En([{name:"a_projected_pos",components:3,type:"Float32"}],4);En([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Al=En([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);En([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Tl=En([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),El=En([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Ml(t,e,i){return t.sections.forEach((t=>{t.text=function(t,e,i){const r=e.layout.get("text-transform").evaluate(i,{});return"uppercase"===r?t=t.toLocaleUpperCase():"lowercase"===r&&(t=t.toLocaleLowerCase()),sn.applyArabicShaping&&(t=sn.applyArabicShaping(t)),t}(t.text,e,i)})),t}En([{name:"triangle",components:3,type:"Uint16"}]),En([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),En([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),En([{type:"Float32",name:"offsetX"}]),En([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),En([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Il={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var zl=24,Pl=Rl,Ll=function(t,e,i,r,n){var a,o,s=8*n-r-1,l=(1<<s)-1,c=l>>1,h=-7,u=i?n-1:0,d=i?-1:1,p=t[e+u];for(u+=d,a=p&(1<<-h)-1,p>>=-h,h+=s;h>0;a=256*a+t[e+u],u+=d,h-=8);for(o=a&(1<<-h)-1,a>>=-h,h+=r;h>0;o=256*o+t[e+u],u+=d,h-=8);if(0===a)a=1-c;else{if(a===l)return o?NaN:1/0*(p?-1:1);o+=Math.pow(2,r),a-=c}return(p?-1:1)*o*Math.pow(2,a-r)},Dl=function(t,e,i,r,n,a){var o,s,l,c=8*a-n-1,h=(1<<c)-1,u=h>>1,d=23===n?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:a-1,m=r?1:-1,f=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,o=h):(o=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-o))<1&&(o--,l*=2),(e+=o+u>=1?d/l:d*Math.pow(2,1-u))*l>=2&&(o++,l/=2),o+u>=h?(s=0,o=h):o+u>=1?(s=(e*l-1)*Math.pow(2,n),o+=u):(s=e*Math.pow(2,u-1)*Math.pow(2,n),o=0));n>=8;t[i+p]=255&s,p+=m,s/=256,n-=8);for(o=o<<n|s,c+=n;c>0;t[i+p]=255&o,p+=m,o/=256,c-=8);t[i+p-m]|=128*f};function Rl(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}Rl.Varint=0,Rl.Fixed64=1,Rl.Bytes=2,Rl.Fixed32=5;var Bl=4294967296,Fl=1/Bl,Ol="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function $l(t){return t.type===Rl.Bytes?t.readVarint()+t.pos:t.pos+1}function Vl(t,e,i){return i?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function Nl(t,e,i){var r=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));i.realloc(r);for(var n=i.pos-1;n>=t;n--)i.buf[n+r]=i.buf[n]}function jl(t,e){for(var i=0;i<t.length;i++)e.writeVarint(t[i])}function Ul(t,e){for(var i=0;i<t.length;i++)e.writeSVarint(t[i])}function Zl(t,e){for(var i=0;i<t.length;i++)e.writeFloat(t[i])}function Hl(t,e){for(var i=0;i<t.length;i++)e.writeDouble(t[i])}function ql(t,e){for(var i=0;i<t.length;i++)e.writeBoolean(t[i])}function Gl(t,e){for(var i=0;i<t.length;i++)e.writeFixed32(t[i])}function Wl(t,e){for(var i=0;i<t.length;i++)e.writeSFixed32(t[i])}function Xl(t,e){for(var i=0;i<t.length;i++)e.writeFixed64(t[i])}function Kl(t,e){for(var i=0;i<t.length;i++)e.writeSFixed64(t[i])}function Jl(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function Yl(t,e,i){t[i]=e,t[i+1]=e>>>8,t[i+2]=e>>>16,t[i+3]=e>>>24}function Ql(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}Rl.prototype={destroy:function(){this.buf=null},readFields:function(t,e,i){for(i=i||this.length;this.pos<i;){var r=this.readVarint(),n=r>>3,a=this.pos;this.type=7&r,t(n,e,this),this.pos===a&&this.skip(r)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=Jl(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=Ql(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=Jl(this.buf,this.pos)+Jl(this.buf,this.pos+4)*Bl;return this.pos+=8,t},readSFixed64:function(){var t=Jl(this.buf,this.pos)+Ql(this.buf,this.pos+4)*Bl;return this.pos+=8,t},readFloat:function(){var t=Ll(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=Ll(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,i,r=this.buf;return e=127&(i=r[this.pos++]),i<128?e:(e|=(127&(i=r[this.pos++]))<<7,i<128?e:(e|=(127&(i=r[this.pos++]))<<14,i<128?e:(e|=(127&(i=r[this.pos++]))<<21,i<128?e:function(t,e,i){var r,n,a=i.buf;if(r=(112&(n=a[i.pos++]))>>4,n<128)return Vl(t,r,e);if(r|=(127&(n=a[i.pos++]))<<3,n<128)return Vl(t,r,e);if(r|=(127&(n=a[i.pos++]))<<10,n<128)return Vl(t,r,e);if(r|=(127&(n=a[i.pos++]))<<17,n<128)return Vl(t,r,e);if(r|=(127&(n=a[i.pos++]))<<24,n<128)return Vl(t,r,e);if(r|=(1&(n=a[i.pos++]))<<31,n<128)return Vl(t,r,e);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(i=r[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&Ol?function(t,e,i){return Ol.decode(t.subarray(e,i))}(this.buf,e,t):function(t,e,i){for(var r="",n=e;n<i;){var a,o,s,l=t[n],c=null,h=l>239?4:l>223?3:l>191?2:1;if(n+h>i)break;1===h?l<128&&(c=l):2===h?128==(192&(a=t[n+1]))&&(c=(31&l)<<6|63&a)<=127&&(c=null):3===h?(o=t[n+2],128==(192&(a=t[n+1]))&&128==(192&o)&&((c=(15&l)<<12|(63&a)<<6|63&o)<=2047||c>=55296&&c<=57343)&&(c=null)):4===h&&(o=t[n+2],s=t[n+3],128==(192&(a=t[n+1]))&&128==(192&o)&&128==(192&s)&&((c=(15&l)<<18|(63&a)<<12|(63&o)<<6|63&s)<=65535||c>=1114112)&&(c=null)),null===c?(c=65533,h=1):c>65535&&(c-=65536,r+=String.fromCharCode(c>>>10&1023|55296),c=56320|1023&c),r+=String.fromCharCode(c),n+=h}return r}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==Rl.Bytes)return t.push(this.readVarint(e));var i=$l(this);for(t=t||[];this.pos<i;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==Rl.Bytes)return t.push(this.readSVarint());var e=$l(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==Rl.Bytes)return t.push(this.readBoolean());var e=$l(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==Rl.Bytes)return t.push(this.readFloat());var e=$l(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==Rl.Bytes)return t.push(this.readDouble());var e=$l(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==Rl.Bytes)return t.push(this.readFixed32());var e=$l(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==Rl.Bytes)return t.push(this.readSFixed32());var e=$l(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==Rl.Bytes)return t.push(this.readFixed64());var e=$l(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==Rl.Bytes)return t.push(this.readSFixed64());var e=$l(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===Rl.Varint)for(;this.buf[this.pos++]>127;);else if(e===Rl.Bytes)this.pos=this.readVarint()+this.pos;else if(e===Rl.Fixed32)this.pos+=4;else{if(e!==Rl.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var i=new Uint8Array(e);i.set(this.buf),this.buf=i,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),Yl(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),Yl(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),Yl(this.buf,-1&t,this.pos),Yl(this.buf,Math.floor(t*Fl),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),Yl(this.buf,-1&t,this.pos),Yl(this.buf,Math.floor(t*Fl),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(t,e){var i,r;if(t>=0?(i=t%4294967296|0,r=t/4294967296|0):(r=~(-t/4294967296),4294967295^(i=~(-t%4294967296))?i=i+1|0:(i=0,r=r+1|0)),t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),function(t,e,i){i.buf[i.pos++]=127&t|128,t>>>=7,i.buf[i.pos++]=127&t|128,t>>>=7,i.buf[i.pos++]=127&t|128,t>>>=7,i.buf[i.pos++]=127&t|128,i.buf[i.pos]=127&(t>>>=7)}(i,0,e),function(t,e){var i=(7&t)<<4;e.buf[e.pos++]|=i|((t>>>=3)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t)))))}(r,e)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(t,e,i){for(var r,n,a=0;a<e.length;a++){if((r=e.charCodeAt(a))>55295&&r<57344){if(!n){r>56319||a+1===e.length?(t[i++]=239,t[i++]=191,t[i++]=189):n=r;continue}if(r<56320){t[i++]=239,t[i++]=191,t[i++]=189,n=r;continue}r=n-55296<<10|r-56320|65536,n=null}else n&&(t[i++]=239,t[i++]=191,t[i++]=189,n=null);r<128?t[i++]=r:(r<2048?t[i++]=r>>6|192:(r<65536?t[i++]=r>>12|224:(t[i++]=r>>18|240,t[i++]=r>>12&63|128),t[i++]=r>>6&63|128),t[i++]=63&r|128)}return i}(this.buf,t,this.pos);var i=this.pos-e;i>=128&&Nl(e,i,this),this.pos=e-1,this.writeVarint(i),this.pos+=i},writeFloat:function(t){this.realloc(4),Dl(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),Dl(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var i=0;i<e;i++)this.buf[this.pos++]=t[i]},writeRawMessage:function(t,e){this.pos++;var i=this.pos;t(e,this);var r=this.pos-i;r>=128&&Nl(i,r,this),this.pos=i-1,this.writeVarint(r),this.pos+=r},writeMessage:function(t,e,i){this.writeTag(t,Rl.Bytes),this.writeRawMessage(e,i)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,jl,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,Ul,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,ql,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,Zl,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,Hl,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,Gl,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,Wl,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,Xl,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,Kl,e)},writeBytesField:function(t,e){this.writeTag(t,Rl.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,Rl.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,Rl.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,Rl.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,Rl.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,Rl.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,Rl.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,Rl.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,Rl.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,Rl.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}};var tc=i(Pl);const ec=3;function ic(t,e,i){1===t&&i.readMessage(rc,e)}function rc(t,e,i){if(3===t){const{id:t,bitmap:r,width:n,height:a,left:o,top:s,advance:l}=i.readMessage(nc,{});e.push({id:t,bitmap:new No({width:n+2*ec,height:a+2*ec},r),metrics:{width:n,height:a,left:o,top:s,advance:l}})}}function nc(t,e,i){1===t?e.id=i.readVarint():2===t?e.bitmap=i.readBytes():3===t?e.width=i.readVarint():4===t?e.height=i.readVarint():5===t?e.left=i.readSVarint():6===t?e.top=i.readSVarint():7===t&&(e.advance=i.readVarint())}const ac=ec;function oc(t){let e=0,i=0;for(const r of t)e+=r.w*r.h,i=Math.max(i,r.w);t.sort(((t,e)=>e.h-t.h));const r=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),i),h:1/0}];let n=0,a=0;for(const e of t)for(let t=r.length-1;t>=0;t--){const i=r[t];if(!(e.w>i.w||e.h>i.h)){if(e.x=i.x,e.y=i.y,a=Math.max(a,e.y+e.h),n=Math.max(n,e.x+e.w),e.w===i.w&&e.h===i.h){const e=r.pop();t<r.length&&(r[t]=e)}else e.h===i.h?(i.x+=e.w,i.w-=e.w):e.w===i.w?(i.y+=e.h,i.h-=e.h):(r.push({x:i.x+e.w,y:i.y,w:i.w-e.w,h:e.h}),i.y+=e.h,i.h-=e.h);break}}return{w:n,h:a,fill:e/(n*a)||0}}const sc=1;class lc{constructor(t,{pixelRatio:e,version:i,stretchX:r,stretchY:n,content:a}){this.paddedRect=t,this.pixelRatio=e,this.stretchX=r,this.stretchY=n,this.content=a,this.version=i}get tl(){return[this.paddedRect.x+sc,this.paddedRect.y+sc]}get br(){return[this.paddedRect.x+this.paddedRect.w-sc,this.paddedRect.y+this.paddedRect.h-sc]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*sc)/this.pixelRatio,(this.paddedRect.h-2*sc)/this.pixelRatio]}}class cc{constructor(t,e){const i={},r={};this.haveRenderCallbacks=[];const n=[];this.addImages(t,i,n),this.addImages(e,r,n);const{w:a,h:o}=oc(n),s=new jo({width:a||1,height:o||1});for(const e in t){const r=t[e],n=i[e].paddedRect;jo.copy(r.data,s,{x:0,y:0},{x:n.x+sc,y:n.y+sc},r.data)}for(const t in e){const i=e[t],n=r[t].paddedRect,a=n.x+sc,o=n.y+sc,l=i.data.width,c=i.data.height;jo.copy(i.data,s,{x:0,y:0},{x:a,y:o},i.data),jo.copy(i.data,s,{x:0,y:c-1},{x:a,y:o-1},{width:l,height:1}),jo.copy(i.data,s,{x:0,y:0},{x:a,y:o+c},{width:l,height:1}),jo.copy(i.data,s,{x:l-1,y:0},{x:a-1,y:o},{width:1,height:c}),jo.copy(i.data,s,{x:0,y:0},{x:a+l,y:o},{width:1,height:c})}this.image=s,this.iconPositions=i,this.patternPositions=r}addImages(t,e,i){for(const r in t){const n=t[r],a={x:0,y:0,w:n.data.width+2*sc,h:n.data.height+2*sc};i.push(a),e[r]=new lc(a,n),n.hasRenderCallback&&this.haveRenderCallbacks.push(r)}}patchUpdatedImages(t,e){t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const i in t.updatedImages)this.patchUpdatedImage(this.iconPositions[i],t.getImage(i),e),this.patchUpdatedImage(this.patternPositions[i],t.getImage(i),e)}patchUpdatedImage(t,e,i){if(!t||!e)return;if(t.version===e.version)return;t.version=e.version;const[r,n]=t.tl;i.update(e.data,void 0,{x:r,y:n})}}var hc;Rr("ImagePosition",lc),Rr("ImageAtlas",cc),t.ai=void 0,(hc=t.ai||(t.ai={}))[hc.none=0]="none",hc[hc.horizontal=1]="horizontal",hc[hc.vertical=2]="vertical",hc[hc.horizontalOnly=3]="horizontalOnly";const uc=-17;class dc{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(t,e){const i=new dc;return i.scale=t||1,i.fontStack=e,i}static forImage(t){const e=new dc;return e.imageName=t,e}}class pc{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,e){const i=new pc;for(let r=0;r<t.sections.length;r++){const n=t.sections[r];n.image?i.addImageSection(n):i.addTextSection(n,e)}return i}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(){this.text=function(t){let e="";for(let i=0;i<t.length;i++){const r=t.charCodeAt(i+1)||null,n=t.charCodeAt(i-1)||null;e+=r&&Hr(r)&&!Il[t[i+1]]||n&&Hr(n)&&!Il[t[i-1]]||!Il[t[i]]?t[i]:Il[t[i]]}return e}(this.text)}trim(){let t=0;for(let e=0;e<this.text.length&&fc[this.text.charCodeAt(e)];e++)t++;let e=this.text.length;for(let i=this.text.length-1;i>=0&&i>=t&&fc[this.text.charCodeAt(i)];i--)e--;this.text=this.text.substring(t,e),this.sectionIndex=this.sectionIndex.slice(t,e)}substring(t,e){const i=new pc;return i.text=this.text.substring(t,e),i.sectionIndex=this.sectionIndex.slice(t,e),i.sections=this.sections,i}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce(((t,e)=>Math.max(t,this.sections[e].scale)),0)}addTextSection(t,e){this.text+=t.text,this.sections.push(dc.forText(t.scale,t.fontStack||e));const i=this.sections.length-1;for(let e=0;e<t.text.length;++e)this.sectionIndex.push(i)}addImageSection(t){const e=t.image?t.image.name:"";if(0===e.length)return void S("Can't add FormattedSection with an empty image.");const i=this.getNextImageSectionCharCode();i?(this.text+=String.fromCharCode(i),this.sections.push(dc.forImage(e)),this.sectionIndex.push(this.sections.length-1)):S("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function mc(e,i,r,n,a,o,s,l,c,h,u,d,p,m,f,g){const y=pc.fromFeature(e,a);let _;d===t.ai.vertical&&y.verticalizePunctuation();const{processBidirectionalText:v,processStyledBidirectionalText:b}=sn;if(v&&1===y.sections.length){_=[];const t=v(y.toString(),wc(y,h,o,i,n,m,f));for(const e of t){const t=new pc;t.text=e,t.sections=y.sections;for(let i=0;i<e.length;i++)t.sectionIndex.push(0);_.push(t)}}else if(b){_=[];const t=b(y.text,y.sectionIndex,wc(y,h,o,i,n,m,f));for(const e of t){const t=new pc;t.text=e[0],t.sectionIndex=e[1],t.sections=y.sections,_.push(t)}}else _=function(t,e){const i=[],r=t.text;let n=0;for(const r of e)i.push(t.substring(n,r)),n=r;return n<r.length&&i.push(t.substring(n,r.length)),i}(y,wc(y,h,o,i,n,m,f));const x=[],w={positionedLines:x,text:y.toString(),top:u[1],bottom:u[1],left:u[0],right:u[0],writingMode:d,iconsInText:!1,verticalizable:!1};return function(e,i,r,n,a,o,s,l,c,h,u,d){let p=0,m=uc,f=0,g=0;const y="right"===l?1:"left"===l?0:.5;let _=0;for(const s of a){s.trim();const a=s.getMaxScale(),l=(a-1)*zl,b={positionedGlyphs:[],lineOffset:0};e.positionedLines[_]=b;const x=b.positionedGlyphs;let w=0;if(!s.length()){m+=o,++_;continue}for(let o=0;o<s.length();o++){const f=s.getSection(o),g=s.getSectionIndex(o),y=s.getCharCode(o);let _=0,b=null,S=null,k=null,C=zl;const A=!(c===t.ai.horizontal||!u&&!Zr(y)||u&&(fc[y]||(v=y,Vr.Arabic(v)||Vr["Arabic Supplement"](v)||Vr["Arabic Extended-A"](v)||Vr["Arabic Presentation Forms-A"](v)||Vr["Arabic Presentation Forms-B"](v))));if(f.imageName){const t=n[f.imageName];if(!t)continue;k=f.imageName,e.iconsInText=e.iconsInText||!0,S=t.paddedRect;const i=t.displaySize;f.scale=f.scale*zl/d,b={width:i[0],height:i[1],left:sc,top:-ac,advance:A?i[1]:i[0]},_=l+(zl-i[1]*f.scale),C=b.advance;const r=A?i[0]*f.scale-zl*a:i[1]*f.scale-zl*a;r>0&&r>w&&(w=r)}else{const t=r[f.fontStack],e=t&&t[y];if(e&&e.rect)S=e.rect,b=e.metrics;else{const t=i[f.fontStack],e=t&&t[y];if(!e)continue;b=e.metrics}_=(a-f.scale)*zl}A?(e.verticalizable=!0,x.push({glyph:y,imageName:k,x:p,y:m+_,vertical:A,scale:f.scale,fontStack:f.fontStack,sectionIndex:g,metrics:b,rect:S}),p+=C*f.scale+h):(x.push({glyph:y,imageName:k,x:p,y:m+_,vertical:A,scale:f.scale,fontStack:f.fontStack,sectionIndex:g,metrics:b,rect:S}),p+=b.advance*f.scale+h)}0!==x.length&&(f=Math.max(p-h,f),kc(x,0,x.length-1,y,w)),p=0;const S=o*a+w;b.lineOffset=Math.max(w,l),m+=S,g=Math.max(S,g),++_}var v;const b=m-uc,{horizontalAlign:x,verticalAlign:w}=Sc(s);(function(t,e,i,r,n,a,o,s,l){const c=(e-i)*n;let h=0;h=a!==o?-s*r-uc:(-r*l+.5)*o;for(const e of t)for(const t of e.positionedGlyphs)t.x+=c,t.y+=h})(e.positionedLines,y,x,w,f,g,o,b,a.length),e.top+=-w*b,e.bottom=e.top+b,e.left+=-x*f,e.right=e.left+f}(w,i,r,n,_,s,l,c,d,h,p,g),!function(t){for(const e of t)if(0!==e.positionedGlyphs.length)return!1;return!0}(x)&&w}const fc={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},gc={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function yc(t,e,i,r,n,a){if(e.imageName){const t=r[e.imageName];return t?t.displaySize[0]*e.scale*zl/a+n:0}{const r=i[e.fontStack],a=r&&r[t];return a?a.metrics.advance*e.scale+n:0}}function _c(t,e,i,r){const n=Math.pow(t-e,2);return r?t<e?n/2:2*n:n+Math.abs(i)*i}function vc(t,e,i){let r=0;return 10===t&&(r-=1e4),i&&(r+=150),40!==t&&65288!==t||(r+=50),41!==e&&65289!==e||(r+=50),r}function bc(t,e,i,r,n,a){let o=null,s=_c(e,i,n,a);for(const t of r){const r=_c(e-t.x,i,n,a)+t.badness;r<=s&&(o=t,s=r)}return{index:t,x:e,priorBreak:o,badness:s}}function xc(t){return t?xc(t.priorBreak).concat(t.index):[]}function wc(t,e,i,r,n,a,o){if("point"!==a)return[];if(!t)return[];const s=[],l=function(t,e,i,r,n,a){let o=0;for(let i=0;i<t.length();i++){const s=t.getSection(i);o+=yc(t.getCharCode(i),s,r,n,e,a)}return o/Math.max(1,Math.ceil(o/i))}(t,e,i,r,n,o),c=t.text.indexOf("")>=0;let h=0;for(let i=0;i<t.length();i++){const a=t.getSection(i),d=t.getCharCode(i);if(fc[d]||(h+=yc(d,a,r,n,e,o)),i<t.length()-1){const e=!((u=d)<11904||!(Vr["Bopomofo Extended"](u)||Vr.Bopomofo(u)||Vr["CJK Compatibility Forms"](u)||Vr["CJK Compatibility Ideographs"](u)||Vr["CJK Compatibility"](u)||Vr["CJK Radicals Supplement"](u)||Vr["CJK Strokes"](u)||Vr["CJK Symbols and Punctuation"](u)||Vr["CJK Unified Ideographs Extension A"](u)||Vr["CJK Unified Ideographs"](u)||Vr["Enclosed CJK Letters and Months"](u)||Vr["Halfwidth and Fullwidth Forms"](u)||Vr.Hiragana(u)||Vr["Ideographic Description Characters"](u)||Vr["Kangxi Radicals"](u)||Vr["Katakana Phonetic Extensions"](u)||Vr.Katakana(u)||Vr["Vertical Forms"](u)||Vr["Yi Radicals"](u)||Vr["Yi Syllables"](u)));(gc[d]||e||a.imageName)&&s.push(bc(i+1,h,l,s,vc(d,t.getCharCode(i+1),e&&c),!1))}}var u;return xc(bc(t.length(),h,l,s,0,!0))}function Sc(t){let e=.5,i=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(t){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0}return{horizontalAlign:e,verticalAlign:i}}function kc(t,e,i,r,n){if(!r&&!n)return;const a=t[i],o=(t[i].x+a.metrics.advance*a.scale)*r;for(let r=e;r<=i;r++)t[r].x-=o,t[r].y+=n}function Cc(t,e,i){const{horizontalAlign:r,verticalAlign:n}=Sc(i),a=e[0]-t.displaySize[0]*r,o=e[1]-t.displaySize[1]*n;return{image:t,top:o,bottom:o+t.displaySize[1],left:a,right:a+t.displaySize[0]}}function Ac(t,e,i,r,n,a){const o=t.image;let s;if(o.content){const t=o.content,e=o.pixelRatio||1;s=[t[0]/e,t[1]/e,o.displaySize[0]-t[2]/e,o.displaySize[1]-t[3]/e]}const l=e.left*a,c=e.right*a;let h,u,d,p;"width"===i||"both"===i?(p=n[0]+l-r[3],u=n[0]+c+r[1]):(p=n[0]+(l+c-o.displaySize[0])/2,u=p+o.displaySize[0]);const m=e.top*a,f=e.bottom*a;return"height"===i||"both"===i?(h=n[1]+m-r[0],d=n[1]+f+r[2]):(h=n[1]+(m+f-o.displaySize[1])/2,d=h+o.displaySize[1]),{image:o,top:h,right:u,bottom:d,left:p,collisionPadding:s}}const Tc=255,Ec=128,Mc=Tc*Ec;function Ic(t,e){const{expression:i}=e;if("constant"===i.kind)return{kind:"constant",layoutSize:i.evaluate(new ln(t+1))};if("source"===i.kind)return{kind:"source"};{const{zoomStops:e,interpolationType:r}=i;let n=0;for(;n<e.length&&e[n]<=t;)n++;n=Math.max(0,n-1);let a=n;for(;a<e.length&&e[a]<t+1;)a++;a=Math.min(e.length-1,a);const o=e[n],s=e[a];return"composite"===i.kind?{kind:"composite",minZoom:o,maxZoom:s,interpolationType:r}:{kind:"camera",minZoom:o,maxZoom:s,minSize:i.evaluate(new ln(o)),maxSize:i.evaluate(new ln(s)),interpolationType:r}}}function zc(t,e,i){let r="never";const n=t.get(e);return n?r=n:t.get(i)&&(r="always"),r}const Pc=Vs.VectorTileFeature.types,Lc=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Dc(t,e,i,r,n,a,o,s,l,c,h,u,d){const p=s?Math.min(Mc,Math.round(s[0])):0,m=s?Math.min(Mc,Math.round(s[1])):0;t.emplaceBack(e,i,Math.round(32*r),Math.round(32*n),a,o,(p<<1)+(l?1:0),m,16*c,16*h,256*u,256*d)}function Rc(t,e,i){t.emplaceBack(e.x,e.y,i),t.emplaceBack(e.x,e.y,i),t.emplaceBack(e.x,e.y,i),t.emplaceBack(e.x,e.y,i)}function Bc(t){for(const e of t.sections)if(Wr(e.text))return!0;return!1}class Fc{constructor(t){this.layoutVertexArray=new _a,this.indexArray=new Sa,this.programConfigurations=t,this.segments=new Ta,this.dynamicLayoutVertexArray=new va,this.opacityVertexArray=new ba,this.hasVisibleVertices=!1,this.placedSymbolArray=new ia}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(t,e,i,r){this.isEmpty()||(i&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,kl.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,e),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,Cl.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,Lc,!0),this.opacityVertexBuffer.itemSize=1),(i||r)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Rr("SymbolBuffers",Fc);class Oc{constructor(t,e,i){this.layoutVertexArray=new t,this.layoutAttributes=e,this.indexArray=new i,this.segments=new Ta,this.collisionVertexArray=new wa}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,Al.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Rr("CollisionBuffers",Oc);class $c{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((t=>t.id)),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Eo([]),this.placementViewportMatrix=Eo([]);const i=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Ic(this.zoom,i["text-size"]),this.iconSizeData=Ic(this.zoom,i["icon-size"]);const r=this.layers[0].layout,n=r.get("symbol-sort-key"),a=r.get("symbol-z-order");this.canOverlap="never"!==zc(r,"text-overlap","text-allow-overlap")||"never"!==zc(r,"icon-overlap","icon-allow-overlap")||r.get("text-ignore-placement")||r.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==a&&!n.isConstant(),this.sortFeaturesByY=("viewport-y"===a||"auto"===a&&!this.sortFeaturesByKey)&&this.canOverlap,"point"===r.get("symbol-placement")&&(this.writingModes=r.get("text-writing-mode").map((e=>t.ai[e]))),this.stateDependentLayerIds=this.layers.filter((t=>t.isStateDependent())).map((t=>t.id)),this.sourceID=e.sourceID}createArrays(){this.text=new Fc(new Ya(this.layers,this.zoom,(t=>/^text/.test(t)))),this.icon=new Fc(new Ya(this.layers,this.zoom,(t=>/^icon/.test(t)))),this.glyphOffsetArray=new aa,this.lineVertexArray=new oa,this.symbolInstances=new na,this.textAnchorOffsets=new la}calculateGlyphDependencies(t,e,i,r,n){for(let a=0;a<t.length;a++)if(e[t.charCodeAt(a)]=!0,(i||r)&&n){const i=Il[t.charAt(a)];i&&(e[i.charCodeAt(0)]=!0)}}populate(e,i,r){const n=this.layers[0],a=n.layout,o=a.get("text-font"),s=a.get("text-field"),l=a.get("icon-image"),c=("constant"!==s.value.kind||s.value.value instanceof Qt&&!s.value.value.isEmpty()||s.value.value.toString().length>0)&&("constant"!==o.value.kind||o.value.value.length>0),h="constant"!==l.value.kind||!!l.value.value||Object.keys(l.parameters).length>0,u=a.get("symbol-sort-key");if(this.features=[],!c&&!h)return;const d=i.iconDependencies,p=i.glyphDependencies,m=i.availableImages,f=new ln(this.zoom);for(const{feature:i,id:s,index:l,sourceLayerIndex:g}of e){const e=n._featureFilter.needGeometry,y=ao(i,e);if(!n._featureFilter.filter(f,y,r))continue;let _,v;if(e||(y.geometry=no(i)),c){const t=n.getValueAndResolveTokens("text-field",y,r,m),e=Qt.factory(t);Bc(e)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===an()||this.hasRTLText&&sn.isParsed())&&(_=Ml(e,n,y))}if(h){const t=n.getValueAndResolveTokens("icon-image",y,r,m);v=t instanceof re?t:re.fromString(t)}if(!_&&!v)continue;const b=this.sortFeaturesByKey?u.evaluate(y,{},r):void 0;if(this.features.push({id:s,text:_,icon:v,index:l,sourceLayerIndex:g,geometry:y.geometry,properties:i.properties,type:Pc[i.type],sortKey:b}),v&&(d[v.name]=!0),_){const e=o.evaluate(y,{},r).join(","),i="viewport"!==a.get("text-rotation-alignment")&&"point"!==a.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(t.ai.vertical)>=0;for(const t of _.sections)if(t.image)d[t.image.name]=!0;else{const r=Nr(_.toString()),n=t.fontStack||e,a=p[n]=p[n]||{};this.calculateGlyphDependencies(t.text,a,i,this.allowVerticalPlacement,r)}}}"line"===a.get("symbol-placement")&&(this.features=function(t){const e={},i={},r=[];let n=0;function a(e){r.push(t[e]),n++}function o(t,e,n){const a=i[t];return delete i[t],i[e]=a,r[a].geometry[0].pop(),r[a].geometry[0]=r[a].geometry[0].concat(n[0]),a}function s(t,i,n){const a=e[i];return delete e[i],e[t]=a,r[a].geometry[0].shift(),r[a].geometry[0]=n[0].concat(r[a].geometry[0]),a}function l(t,e,i){const r=i?e[0][e[0].length-1]:e[0][0];return`${t}:${r.x}:${r.y}`}for(let c=0;c<t.length;c++){const h=t[c],u=h.geometry,d=h.text?h.text.toString():null;if(!d){a(c);continue}const p=l(d,u),m=l(d,u,!0);if(p in i&&m in e&&i[p]!==e[m]){const t=s(p,m,u),n=o(p,m,r[t].geometry);delete e[p],delete i[m],i[l(d,r[n].geometry,!0)]=n,r[t].geometry=null}else p in i?o(p,m,u):m in e?s(p,m,u):(a(c),e[p]=n-1,i[m]=n-1)}return r.filter((t=>t.geometry))}(this.features)),this.sortFeaturesByKey&&this.features.sort(((t,e)=>t.sortKey-e.sortKey))}update(t,e,i){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,e,this.layers,i),this.icon.programConfigurations.updatePaintArrays(t,e,this.layers,i))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,e){const i=this.lineVertexArray.length;if(void 0!==t.segment){let i=t.dist(e[t.segment+1]),r=t.dist(e[t.segment]);const n={};for(let r=t.segment+1;r<e.length;r++)n[r]={x:e[r].x,y:e[r].y,tileUnitDistanceFromAnchor:i},r<e.length-1&&(i+=e[r+1].dist(e[r]));for(let i=t.segment||0;i>=0;i--)n[i]={x:e[i].x,y:e[i].y,tileUnitDistanceFromAnchor:r},i>0&&(r+=e[i-1].dist(e[i]));for(let t=0;t<e.length;t++){const e=n[t];this.lineVertexArray.emplaceBack(e.x,e.y,e.tileUnitDistanceFromAnchor)}}return{lineStartIndex:i,lineLength:this.lineVertexArray.length-i}}addSymbols(e,i,r,n,a,o,s,l,c,h,u,d){const p=e.indexArray,m=e.layoutVertexArray,f=e.segments.prepareSegment(4*i.length,m,p,this.canOverlap?o.sortKey:void 0),g=this.glyphOffsetArray.length,y=f.vertexLength,_=this.allowVerticalPlacement&&s===t.ai.vertical?Math.PI/2:0,v=o.text&&o.text.sections;for(let t=0;t<i.length;t++){const{tl:n,tr:a,bl:s,br:c,tex:h,pixelOffsetTL:u,pixelOffsetBR:g,minFontScaleX:y,minFontScaleY:b,glyphOffset:x,isSDF:w,sectionIndex:S}=i[t],k=f.vertexLength,C=x[1];Dc(m,l.x,l.y,n.x,C+n.y,h.x,h.y,r,w,u.x,u.y,y,b),Dc(m,l.x,l.y,a.x,C+a.y,h.x+h.w,h.y,r,w,g.x,u.y,y,b),Dc(m,l.x,l.y,s.x,C+s.y,h.x,h.y+h.h,r,w,u.x,g.y,y,b),Dc(m,l.x,l.y,c.x,C+c.y,h.x+h.w,h.y+h.h,r,w,g.x,g.y,y,b),Rc(e.dynamicLayoutVertexArray,l,_),p.emplaceBack(k,k+1,k+2),p.emplaceBack(k+1,k+2,k+3),f.vertexLength+=4,f.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(x[0]),t!==i.length-1&&S===i[t+1].sectionIndex||e.programConfigurations.populatePaintArrays(m.length,o,o.index,{},d,v&&v[S])}e.placedSymbolArray.emplaceBack(l.x,l.y,g,this.glyphOffsetArray.length-g,y,c,h,l.segment,r?r[0]:0,r?r[1]:0,n[0],n[1],s,0,!1,0,u)}_addCollisionDebugVertex(t,e,i,r,n,a){return e.emplaceBack(0,0),t.emplaceBack(i.x,i.y,r,n,Math.round(a.x),Math.round(a.y))}addCollisionDebugVertices(t,e,i,r,n,o,s){const l=n.segments.prepareSegment(4,n.layoutVertexArray,n.indexArray),c=l.vertexLength,h=n.layoutVertexArray,u=n.collisionVertexArray,d=s.anchorX,p=s.anchorY;this._addCollisionDebugVertex(h,u,o,d,p,new a(t,e)),this._addCollisionDebugVertex(h,u,o,d,p,new a(i,e)),this._addCollisionDebugVertex(h,u,o,d,p,new a(i,r)),this._addCollisionDebugVertex(h,u,o,d,p,new a(t,r)),l.vertexLength+=4;const m=n.indexArray;m.emplaceBack(c,c+1),m.emplaceBack(c+1,c+2),m.emplaceBack(c+2,c+3),m.emplaceBack(c+3,c),l.primitiveLength+=4}addDebugCollisionBoxes(t,e,i,r){for(let n=t;n<e;n++){const t=this.collisionBoxArray.get(n);this.addCollisionDebugVertices(t.x1,t.y1,t.x2,t.y2,r?this.textCollisionBox:this.iconCollisionBox,t.anchorPoint,i)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Oc(xa,Tl.members,ka),this.iconCollisionBox=new Oc(xa,Tl.members,ka);for(let t=0;t<this.symbolInstances.length;t++){const e=this.symbolInstances.get(t);this.addDebugCollisionBoxes(e.textBoxStartIndex,e.textBoxEndIndex,e,!0),this.addDebugCollisionBoxes(e.verticalTextBoxStartIndex,e.verticalTextBoxEndIndex,e,!0),this.addDebugCollisionBoxes(e.iconBoxStartIndex,e.iconBoxEndIndex,e,!1),this.addDebugCollisionBoxes(e.verticalIconBoxStartIndex,e.verticalIconBoxEndIndex,e,!1)}}_deserializeCollisionBoxesForSymbol(t,e,i,r,n,a,o,s,l){const c={};for(let r=e;r<i;r++){const e=t.get(r);c.textBox={x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,anchorPointX:e.anchorPointX,anchorPointY:e.anchorPointY},c.textFeatureIndex=e.featureIndex;break}for(let e=r;e<n;e++){const i=t.get(e);c.verticalTextBox={x1:i.x1,y1:i.y1,x2:i.x2,y2:i.y2,anchorPointX:i.anchorPointX,anchorPointY:i.anchorPointY},c.verticalTextFeatureIndex=i.featureIndex;break}for(let e=a;e<o;e++){const i=t.get(e);c.iconBox={x1:i.x1,y1:i.y1,x2:i.x2,y2:i.y2,anchorPointX:i.anchorPointX,anchorPointY:i.anchorPointY},c.iconFeatureIndex=i.featureIndex;break}for(let e=s;e<l;e++){const i=t.get(e);c.verticalIconBox={x1:i.x1,y1:i.y1,x2:i.x2,y2:i.y2,anchorPointX:i.anchorPointX,anchorPointY:i.anchorPointY},c.verticalIconFeatureIndex=i.featureIndex;break}return c}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let e=0;e<this.symbolInstances.length;e++){const i=this.symbolInstances.get(e);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,i.textBoxStartIndex,i.textBoxEndIndex,i.verticalTextBoxStartIndex,i.verticalTextBoxEndIndex,i.iconBoxStartIndex,i.iconBoxEndIndex,i.verticalIconBoxStartIndex,i.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,e){const i=t.placedSymbolArray.get(e),r=i.vertexStartIndex+4*i.numGlyphs;for(let e=i.vertexStartIndex;e<r;e+=4)t.indexArray.emplaceBack(e,e+1,e+2),t.indexArray.emplaceBack(e+1,e+2,e+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const e=Math.sin(t),i=Math.cos(t),r=[],n=[],a=[];for(let t=0;t<this.symbolInstances.length;++t){a.push(t);const o=this.symbolInstances.get(t);r.push(0|Math.round(e*o.anchorX+i*o.anchorY)),n.push(o.featureIndex)}return a.sort(((t,e)=>r[t]-r[e]||n[e]-n[t])),a}addToSortKeyRanges(t,e){const i=this.sortKeyRanges[this.sortKeyRanges.length-1];i&&i.sortKey===e?i.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:e,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const t of this.symbolInstanceIndexes){const e=this.symbolInstances.get(t);this.featureSortOrder.push(e.featureIndex),[e.rightJustifiedTextSymbolIndex,e.centerJustifiedTextSymbolIndex,e.leftJustifiedTextSymbolIndex].forEach(((t,e,i)=>{t>=0&&i.indexOf(t)===e&&this.addIndicesForPlacedSymbol(this.text,t)})),e.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,e.verticalPlacedTextSymbolIndex),e.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,e.placedIconSymbolIndex),e.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,e.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let Vc,Nc;Rr("SymbolBucket",$c,{omit:["layers","collisionBoxArray","features","compareText"]}),$c.MAX_GLYPHS=65535,$c.addDynamicAttributes=Rc;var jc={get paint(){return Nc=Nc||new wn({"icon-opacity":new _n(X.paint_symbol["icon-opacity"]),"icon-color":new _n(X.paint_symbol["icon-color"]),"icon-halo-color":new _n(X.paint_symbol["icon-halo-color"]),"icon-halo-width":new _n(X.paint_symbol["icon-halo-width"]),"icon-halo-blur":new _n(X.paint_symbol["icon-halo-blur"]),"icon-translate":new yn(X.paint_symbol["icon-translate"]),"icon-translate-anchor":new yn(X.paint_symbol["icon-translate-anchor"]),"text-opacity":new _n(X.paint_symbol["text-opacity"]),"text-color":new _n(X.paint_symbol["text-color"],{runtimeType:ft,getOverride:t=>t.textColor,hasOverride:t=>!!t.textColor}),"text-halo-color":new _n(X.paint_symbol["text-halo-color"]),"text-halo-width":new _n(X.paint_symbol["text-halo-width"]),"text-halo-blur":new _n(X.paint_symbol["text-halo-blur"]),"text-translate":new yn(X.paint_symbol["text-translate"]),"text-translate-anchor":new yn(X.paint_symbol["text-translate-anchor"])})},get layout(){return Vc=Vc||new wn({"symbol-placement":new yn(X.layout_symbol["symbol-placement"]),"symbol-spacing":new yn(X.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new yn(X.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new _n(X.layout_symbol["symbol-sort-key"]),"symbol-z-order":new yn(X.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new yn(X.layout_symbol["icon-allow-overlap"]),"icon-overlap":new yn(X.layout_symbol["icon-overlap"]),"icon-ignore-placement":new yn(X.layout_symbol["icon-ignore-placement"]),"icon-optional":new yn(X.layout_symbol["icon-optional"]),"icon-rotation-alignment":new yn(X.layout_symbol["icon-rotation-alignment"]),"icon-size":new _n(X.layout_symbol["icon-size"]),"icon-text-fit":new yn(X.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new yn(X.layout_symbol["icon-text-fit-padding"]),"icon-image":new _n(X.layout_symbol["icon-image"]),"icon-rotate":new _n(X.layout_symbol["icon-rotate"]),"icon-padding":new _n(X.layout_symbol["icon-padding"]),"icon-keep-upright":new yn(X.layout_symbol["icon-keep-upright"]),"icon-offset":new _n(X.layout_symbol["icon-offset"]),"icon-anchor":new _n(X.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new yn(X.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new yn(X.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new yn(X.layout_symbol["text-rotation-alignment"]),"text-field":new _n(X.layout_symbol["text-field"]),"text-font":new _n(X.layout_symbol["text-font"]),"text-size":new _n(X.layout_symbol["text-size"]),"text-max-width":new _n(X.layout_symbol["text-max-width"]),"text-line-height":new yn(X.layout_symbol["text-line-height"]),"text-letter-spacing":new _n(X.layout_symbol["text-letter-spacing"]),"text-justify":new _n(X.layout_symbol["text-justify"]),"text-radial-offset":new _n(X.layout_symbol["text-radial-offset"]),"text-variable-anchor":new yn(X.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new _n(X.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new _n(X.layout_symbol["text-anchor"]),"text-max-angle":new yn(X.layout_symbol["text-max-angle"]),"text-writing-mode":new yn(X.layout_symbol["text-writing-mode"]),"text-rotate":new _n(X.layout_symbol["text-rotate"]),"text-padding":new yn(X.layout_symbol["text-padding"]),"text-keep-upright":new yn(X.layout_symbol["text-keep-upright"]),"text-transform":new _n(X.layout_symbol["text-transform"]),"text-offset":new _n(X.layout_symbol["text-offset"]),"text-allow-overlap":new yn(X.layout_symbol["text-allow-overlap"]),"text-overlap":new yn(X.layout_symbol["text-overlap"]),"text-ignore-placement":new yn(X.layout_symbol["text-ignore-placement"]),"text-optional":new yn(X.layout_symbol["text-optional"])})}};class Uc{constructor(t){if(void 0===t.property.overrides)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=t.property.overrides?t.property.overrides.runtimeType:ut,this.defaultValue=t}evaluate(t){if(t.formattedSection){const e=this.defaultValue.property.overrides;if(e&&e.hasOverride(t.formattedSection))return e.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Rr("FormatSectionOverride",Uc,{omit:["defaultValue"]});class Zc extends kn{constructor(t){super(t,jc)}recalculate(t,e){if(super.recalculate(t,e),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]="map"===this.layout.get("text-rotation-alignment")?"map":"viewport"),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement")){const t=this.layout.get("text-writing-mode");if(t){const e=[];for(const i of t)e.indexOf(i)<0&&e.push(i);this.layout._values["text-writing-mode"]=e}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(t,e,i,r){const n=this.layout.get(t).evaluate(e,{},i,r),a=this._unevaluatedLayout._values[t];return a.isDataDriven()||Ri(a.value)||!n?n:function(t,e){return e.replace(/{([^{}]+)}/g,((e,i)=>t&&i in t?String(t[i]):""))}(e.properties,n)}createBucket(t){return new $c(t)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const t of jc.paint.overridableProperties){if(!Zc.hasPaintOverride(this.layout,t))continue;const e=this.paint.get(t),i=new Uc(e),r=new Di(i,e.property.specification);let n=null;n="constant"===e.value.kind||"source"===e.value.kind?new Fi("source",r):new Oi("composite",r,e.value.zoomStops),this.paint._values[t]=new fn(e.property,n,e.parameters)}}_handleOverridablePaintPropertyUpdate(t,e,i){return!(!this.layout||e.isDataDriven()||i.isDataDriven())&&Zc.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,e){const i=t.get("text-field"),r=jc.paint.properties[e];let n=!1;const a=t=>{for(const e of t)if(r.overrides&&r.overrides.hasOverride(e))return void(n=!0)};if("constant"===i.value.kind&&i.value.value instanceof Qt)a(i.value.value.sections);else if("source"===i.value.kind){const t=e=>{n||(e instanceof le&&oe(e.value)===vt?a(e.value.sections):e instanceof di?a(e.sections):e.eachChild(t))},e=i.value;e._styleExpression&&t(e._styleExpression.expression)}return n}}let Hc;var qc={get paint(){return Hc=Hc||new wn({"background-color":new yn(X.paint_background["background-color"]),"background-pattern":new bn(X.paint_background["background-pattern"]),"background-opacity":new yn(X.paint_background["background-opacity"])})}};class Gc extends kn{constructor(t){super(t,qc)}}let Wc;var Xc={get paint(){return Wc=Wc||new wn({"raster-opacity":new yn(X.paint_raster["raster-opacity"]),"raster-hue-rotate":new yn(X.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new yn(X.paint_raster["raster-brightness-min"]),"raster-brightness-max":new yn(X.paint_raster["raster-brightness-max"]),"raster-saturation":new yn(X.paint_raster["raster-saturation"]),"raster-contrast":new yn(X.paint_raster["raster-contrast"]),"raster-resampling":new yn(X.paint_raster["raster-resampling"]),"raster-fade-duration":new yn(X.paint_raster["raster-fade-duration"])})}};class Kc extends kn{constructor(t){super(t,Xc)}}class Jc extends kn{constructor(t){super(t,{}),this.onAdd=t=>{this.implementation.onAdd&&this.implementation.onAdd(t,t.painter.context.gl)},this.onRemove=t=>{this.implementation.onRemove&&this.implementation.onRemove(t,t.painter.context.gl)},this.implementation=t}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class Yc{constructor(t){this._callback=t,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._callback()}),0))}remove(){delete this._channel,this._callback=()=>{}}}const Qc=6371008.8;class th{constructor(t,e){if(isNaN(t)||isNaN(e))throw new Error(`Invalid LngLat object: (${t}, ${e})`);if(this.lng=+t,this.lat=+e,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new th(g(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const e=Math.PI/180,i=this.lat*e,r=t.lat*e,n=Math.sin(i)*Math.sin(r)+Math.cos(i)*Math.cos(r)*Math.cos((t.lng-this.lng)*e);return Qc*Math.acos(Math.min(n,1))}static convert(t){if(t instanceof th)return t;if(Array.isArray(t)&&(2===t.length||3===t.length))return new th(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&"object"==typeof t&&null!==t)return new th(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const eh=2*Math.PI*Qc;function ih(t){return eh*Math.cos(t*Math.PI/180)}function rh(t){return(180+t)/360}function nh(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}function ah(t,e){return t/ih(e)}function oh(t){return 360*t-180}function sh(t){return 360/Math.PI*Math.atan(Math.exp((180-360*t)*Math.PI/180))-90}class lh{constructor(t,e,i=0){this.x=+t,this.y=+e,this.z=+i}static fromLngLat(t,e=0){const i=th.convert(t);return new lh(rh(i.lng),nh(i.lat),ah(e,i.lat))}toLngLat(){return new th(oh(this.x),sh(this.y))}toAltitude(){return this.z*ih(sh(this.y))}meterInMercatorCoordinateUnits(){return 1/eh*(t=sh(this.y),1/Math.cos(t*Math.PI/180));var t}}function ch(t,e,i){var r=2*Math.PI*6378137/256/Math.pow(2,i);return[t*r-2*Math.PI*6378137/2,e*r-2*Math.PI*6378137/2]}class hh{constructor(t,e,i){if(t<0||t>25||i<0||i>=Math.pow(2,t)||e<0||e>=Math.pow(2,t))throw new Error(`x=${e}, y=${i}, z=${t} outside of bounds. 0<=x<${Math.pow(2,t)}, 0<=y<${Math.pow(2,t)} 0<=z<=25 `);this.z=t,this.x=e,this.y=i,this.key=ph(0,t,t,e,i)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,e,i){const r=(a=this.y,o=this.z,s=ch(256*(n=this.x),256*(a=Math.pow(2,o)-a-1),o),l=ch(256*(n+1),256*(a+1),o),s[0]+","+s[1]+","+l[0]+","+l[1]);var n,a,o,s,l;const c=function(t,e,i){let r,n="";for(let a=t;a>0;a--)r=1<<a-1,n+=(e&r?1:0)+(i&r?2:0);return n}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===i?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,e>1?"@2x":"").replace(/{quadkey}/g,c).replace(/{bbox-epsg-3857}/g,r)}isChildOf(t){const e=this.z-t.z;return e>0&&t.x===this.x>>e&&t.y===this.y>>e}getTilePoint(t){const e=Math.pow(2,this.z);return new a((t.x*e-this.x)*eo,(t.y*e-this.y)*eo)}toString(){return`${this.z}/${this.x}/${this.y}`}}class uh{constructor(t,e){this.wrap=t,this.canonical=e,this.key=ph(t,e.z,e.z,e.x,e.y)}}class dh{constructor(t,e,i,r,n){if(t<i)throw new Error(`overscaledZ should be >= z; overscaledZ = ${t}; z = ${i}`);this.overscaledZ=t,this.wrap=e,this.canonical=new hh(i,+r,+n),this.key=ph(e,t,i,r,n)}clone(){return new dh(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const e=this.canonical.z-t;return t>this.canonical.z?new dh(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new dh(t,this.wrap,t,this.canonical.x>>e,this.canonical.y>>e)}calculateScaledKey(t,e){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const i=this.canonical.z-t;return t>this.canonical.z?ph(this.wrap*+e,t,this.canonical.z,this.canonical.x,this.canonical.y):ph(this.wrap*+e,t,t,this.canonical.x>>i,this.canonical.y>>i)}isChildOf(t){if(t.wrap!==this.wrap)return!1;const e=this.canonical.z-t.canonical.z;return 0===t.overscaledZ||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>e&&t.canonical.y===this.canonical.y>>e}children(t){if(this.overscaledZ>=t)return[new dh(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const e=this.canonical.z+1,i=2*this.canonical.x,r=2*this.canonical.y;return[new dh(e,this.wrap,e,i,r),new dh(e,this.wrap,e,i+1,r),new dh(e,this.wrap,e,i,r+1),new dh(e,this.wrap,e,i+1,r+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new dh(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new dh(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new uh(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(t){return this.canonical.getTilePoint(new lh(t.x-this.wrap,t.y))}}function ph(t,e,i,r,n){(t*=2)<0&&(t=-1*t-1);const a=1<<i;return(a*a*t+a*n+r).toString(36)+i.toString(36)+e.toString(36)}Rr("CanonicalTileID",hh),Rr("OverscaledTileID",dh,{omit:["posMatrix"]});class mh{constructor(t,e,i,r=1,n=1,a=1,o=0){if(this.uid=t,e.height!==e.width)throw new RangeError("DEM tiles must be square");if(i&&!["mapbox","terrarium","custom"].includes(i))return void S(`"${i}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=e.height;const s=this.dim=e.height-2;switch(this.data=new Uint32Array(e.data.buffer),i){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=r,this.greenFactor=n,this.blueFactor=a,this.baseShift=o;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let t=0;t<s;t++)this.data[this._idx(-1,t)]=this.data[this._idx(0,t)],this.data[this._idx(s,t)]=this.data[this._idx(s-1,t)],this.data[this._idx(t,-1)]=this.data[this._idx(t,0)],this.data[this._idx(t,s)]=this.data[this._idx(t,s-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(s,-1)]=this.data[this._idx(s-1,0)],this.data[this._idx(-1,s)]=this.data[this._idx(0,s-1)],this.data[this._idx(s,s)]=this.data[this._idx(s-1,s-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let t=0;t<s;t++)for(let e=0;e<s;e++){const i=this.get(t,e);i>this.max&&(this.max=i),i<this.min&&(this.min=i)}}get(t,e){const i=new Uint8Array(this.data.buffer),r=4*this._idx(t,e);return this.unpack(i[r],i[r+1],i[r+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(t,e){if(t<-1||t>=this.dim+1||e<-1||e>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(e+1)*this.stride+(t+1)}unpack(t,e,i){return t*this.redFactor+e*this.greenFactor+i*this.blueFactor-this.baseShift}getPixels(){return new jo({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(t,e,i){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let r=e*this.dim,n=e*this.dim+this.dim,a=i*this.dim,o=i*this.dim+this.dim;switch(e){case-1:r=n-1;break;case 1:n=r+1}switch(i){case-1:a=o-1;break;case 1:o=a+1}const s=-e*this.dim,l=-i*this.dim;for(let e=a;e<o;e++)for(let i=r;i<n;i++)this.data[this._idx(i,e)]=t.data[this._idx(i+s,e+l)]}}Rr("DEMData",mh);class fh{constructor(t){this._stringToNumber={},this._numberToString=[];for(let e=0;e<t.length;e++){const i=t[e];this._stringToNumber[i]=e,this._numberToString[e]=i}}encode(t){return this._stringToNumber[t]}decode(t){if(t>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${t} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[t]}}class gh{constructor(t,e,i,r,n){this.type="Feature",this._vectorTileFeature=t,t._z=e,t._x=i,t._y=r,this.properties=t.properties,this.id=n}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={geometry:this.geometry};for(const e in this)"_geometry"!==e&&"_vectorTileFeature"!==e&&(t[e]=this[e]);return t}}class yh{constructor(t,e){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new Lr(eo,16,0),this.grid3D=new Lr(eo,16,0),this.featureIndexArray=new ha,this.promoteId=e}insert(t,e,i,r,n,a){const o=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(i,r,n);const s=a?this.grid3D:this.grid;for(let t=0;t<e.length;t++){const i=e[t],r=[1/0,1/0,-1/0,-1/0];for(let t=0;t<i.length;t++){const e=i[t];r[0]=Math.min(r[0],e.x),r[1]=Math.min(r[1],e.y),r[2]=Math.max(r[2],e.x),r[3]=Math.max(r[3],e.y)}r[0]<eo&&r[1]<eo&&r[2]>=0&&r[3]>=0&&s.insert(o,r[0],r[1],r[2],r[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Vs.VectorTile(new tc(this.rawTileData)).layers,this.sourceLayerCoder=new fh(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(t,e,i,r){this.loadVTLayers();const n=t.params||{},o=eo/t.tileSize/t.scale,s=Zi(n.filter),l=t.queryGeometry,c=t.queryPadding*o,h=vh(l),u=this.grid.query(h.minX-c,h.minY-c,h.maxX+c,h.maxY+c),d=vh(t.cameraQueryGeometry),p=this.grid3D.query(d.minX-c,d.minY-c,d.maxX+c,d.maxY+c,((e,i,r,n)=>function(t,e,i,r,n){for(const a of t)if(e<=a.x&&i<=a.y&&r>=a.x&&n>=a.y)return!0;const o=[new a(e,i),new a(e,n),new a(r,n),new a(r,i)];if(t.length>2)for(const e of o)if(_o(t,e))return!0;for(let e=0;e<t.length-1;e++)if(vo(t[e],t[e+1],o))return!0;return!1}(t.cameraQueryGeometry,e-c,i-c,r+c,n+c)));for(const t of p)u.push(t);u.sort(bh);const m={};let f;for(let a=0;a<u.length;a++){const c=u[a];if(c===f)continue;f=c;const h=this.featureIndexArray.get(c);let d=null;this.loadMatchingFeature(m,h.bucketIndex,h.sourceLayerIndex,h.featureIndex,s,n.layers,n.availableImages,e,i,r,((e,i,r)=>(d||(d=no(e)),i.queryIntersectsFeature(l,e,r,d,this.z,t.transform,o,t.pixelPosMatrix))))}return m}loadMatchingFeature(t,e,i,r,n,a,o,s,l,c,h){const u=this.bucketLayerIDs[e];if(a&&!function(t,e){for(let i=0;i<t.length;i++)if(e.indexOf(t[i])>=0)return!0;return!1}(a,u))return;const d=this.sourceLayerCoder.decode(i),p=this.vtLayers[d].feature(r);if(n.needGeometry){const t=ao(p,!0);if(!n.filter(new ln(this.tileID.overscaledZ),t,this.tileID.canonical))return}else if(!n.filter(new ln(this.tileID.overscaledZ),p))return;const m=this.getId(p,d);for(let e=0;e<u.length;e++){const i=u[e];if(a&&a.indexOf(i)<0)continue;const n=s[i];if(!n)continue;let d={};m&&c&&(d=c.getState(n.sourceLayer||"_geojsonTileLayer",m));const f=y({},l[i]);f.paint=_h(f.paint,n.paint,p,d,o),f.layout=_h(f.layout,n.layout,p,d,o);const g=!h||h(p,n,d);if(!g)continue;const _=new gh(p,this.z,this.x,this.y,m);_.layer=f;let v=t[i];void 0===v&&(v=t[i]=[]),v.push({featureIndex:r,feature:_,intersectionZ:g})}}lookupSymbolFeatures(t,e,i,r,n,a,o,s){const l={};this.loadVTLayers();const c=Zi(n);for(const n of t)this.loadMatchingFeature(l,i,r,n,c,a,o,s,e);return l}hasLayer(t){for(const e of this.bucketLayerIDs)for(const i of e)if(t===i)return!0;return!1}getId(t,e){let i=t.id;return this.promoteId&&(i=t.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[e]],"boolean"==typeof i&&(i=Number(i))),i}}function _h(t,e,i,r,n){return v(t,((t,a)=>{const o=e instanceof gn?e.get(a):null;return o&&o.evaluate?o.evaluate(i,r,n):o}))}function vh(t){let e=1/0,i=1/0,r=-1/0,n=-1/0;for(const a of t)e=Math.min(e,a.x),i=Math.min(i,a.y),r=Math.max(r,a.x),n=Math.max(n,a.y);return{minX:e,minY:i,maxX:r,maxY:n}}function bh(t,e){return e-t}function xh(t,e,i,r,n){const o=[];for(let s=0;s<t.length;s++){const l=t[s];let c;for(let t=0;t<l.length-1;t++){let s=l[t],h=l[t+1];s.x<e&&h.x<e||(s.x<e?s=new a(e,s.y+(e-s.x)/(h.x-s.x)*(h.y-s.y))._round():h.x<e&&(h=new a(e,s.y+(e-s.x)/(h.x-s.x)*(h.y-s.y))._round()),s.y<i&&h.y<i||(s.y<i?s=new a(s.x+(i-s.y)/(h.y-s.y)*(h.x-s.x),i)._round():h.y<i&&(h=new a(s.x+(i-s.y)/(h.y-s.y)*(h.x-s.x),i)._round()),s.x>=r&&h.x>=r||(s.x>=r?s=new a(r,s.y+(r-s.x)/(h.x-s.x)*(h.y-s.y))._round():h.x>=r&&(h=new a(r,s.y+(r-s.x)/(h.x-s.x)*(h.y-s.y))._round()),s.y>=n&&h.y>=n||(s.y>=n?s=new a(s.x+(n-s.y)/(h.y-s.y)*(h.x-s.x),n)._round():h.y>=n&&(h=new a(s.x+(n-s.y)/(h.y-s.y)*(h.x-s.x),n)._round()),c&&s.equals(c[c.length-1])||(c=[s],o.push(c)),c.push(h)))))}}return o}Rr("FeatureIndex",yh,{omit:["rawTileData","sourceLayerCoder"]});class wh extends a{constructor(t,e,i,r){super(t,e),this.angle=i,void 0!==r&&(this.segment=r)}clone(){return new wh(this.x,this.y,this.angle,this.segment)}}function Sh(t,e,i,r,n){if(void 0===e.segment||0===i)return!0;let a=e,o=e.segment+1,s=0;for(;s>-i/2;){if(o--,o<0)return!1;s-=t[o].dist(a),a=t[o]}s+=t[o].dist(t[o+1]),o++;const l=[];let c=0;for(;s<i/2;){const e=t[o],i=t[o+1];if(!i)return!1;let a=t[o-1].angleTo(e)-e.angleTo(i);for(a=Math.abs((a+3*Math.PI)%(2*Math.PI)-Math.PI),l.push({distance:s,angleDelta:a}),c+=a;s-l[0].distance>r;)c-=l.shift().angleDelta;if(c>n)return!1;o++,s+=e.dist(i)}return!0}function kh(t){let e=0;for(let i=0;i<t.length-1;i++)e+=t[i].dist(t[i+1]);return e}function Ch(t,e,i){return t?.6*e*i:0}function Ah(t,e){return Math.max(t?t.right-t.left:0,e?e.right-e.left:0)}function Th(t,e,i,r,n,a){const o=Ch(i,n,a),s=Ah(i,r)*a;let l=0;const c=kh(t)/2;for(let i=0;i<t.length-1;i++){const r=t[i],n=t[i+1],a=r.dist(n);if(l+a>c){const h=(c-l)/a,u=He.number(r.x,n.x,h),d=He.number(r.y,n.y,h),p=new wh(u,d,n.angleTo(r),i);return p._round(),!o||Sh(t,p,s,o,e)?p:void 0}l+=a}}function Eh(t,e,i,r,n,a,o,s,l){const c=Ch(r,a,o),h=Ah(r,n),u=h*o,d=0===t[0].x||t[0].x===l||0===t[0].y||t[0].y===l;return e-u<e/4&&(e=u+e/4),Mh(t,d?e/2*s%e:(h/2+2*a)*o*s%e,e,c,i,u,d,!1,l)}function Mh(t,e,i,r,n,a,o,s,l){const c=a/2,h=kh(t);let u=0,d=e-i,p=[];for(let e=0;e<t.length-1;e++){const o=t[e],s=t[e+1],m=o.dist(s),f=s.angleTo(o);for(;d+i<u+m;){d+=i;const g=(d-u)/m,y=He.number(o.x,s.x,g),_=He.number(o.y,s.y,g);if(y>=0&&y<l&&_>=0&&_<l&&d-c>=0&&d+c<=h){const i=new wh(y,_,f,e);i._round(),r&&!Sh(t,i,a,r,n)||p.push(i)}}u+=m}return s||p.length||o||(p=Mh(t,u/2,i,r,n,a,o,!0,l)),p}Rr("Anchor",wh);const Ih=sc;function zh(t,e,i,r){const n=[],o=t.image,s=o.pixelRatio,l=o.paddedRect.w-2*Ih,c=o.paddedRect.h-2*Ih,h=t.right-t.left,u=t.bottom-t.top,d=o.stretchX||[[0,l]],p=o.stretchY||[[0,c]],m=(t,e)=>t+e[1]-e[0],f=d.reduce(m,0),g=p.reduce(m,0),y=l-f,_=c-g;let v=0,b=f,x=0,w=g,S=0,k=y,C=0,A=_;if(o.content&&r){const t=o.content;v=Ph(d,0,t[0]),x=Ph(p,0,t[1]),b=Ph(d,t[0],t[2]),w=Ph(p,t[1],t[3]),S=t[0]-v,C=t[1]-x,k=t[2]-t[0]-b,A=t[3]-t[1]-w}const T=(r,n,l,c)=>{const d=Dh(r.stretch-v,b,h,t.left),p=Rh(r.fixed-S,k,r.stretch,f),m=Dh(n.stretch-x,w,u,t.top),y=Rh(n.fixed-C,A,n.stretch,g),_=Dh(l.stretch-v,b,h,t.left),T=Rh(l.fixed-S,k,l.stretch,f),E=Dh(c.stretch-x,w,u,t.top),M=Rh(c.fixed-C,A,c.stretch,g),I=new a(d,m),z=new a(_,m),P=new a(_,E),L=new a(d,E),D=new a(p/s,y/s),R=new a(T/s,M/s),B=e*Math.PI/180;if(B){const t=Math.sin(B),e=Math.cos(B),i=[e,-t,t,e];I._matMult(i),z._matMult(i),L._matMult(i),P._matMult(i)}const F=r.stretch+r.fixed,O=n.stretch+n.fixed;return{tl:I,tr:z,bl:L,br:P,tex:{x:o.paddedRect.x+Ih+F,y:o.paddedRect.y+Ih+O,w:l.stretch+l.fixed-F,h:c.stretch+c.fixed-O},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:D,pixelOffsetBR:R,minFontScaleX:k/s/h,minFontScaleY:A/s/u,isSDF:i}};if(r&&(o.stretchX||o.stretchY)){const t=Lh(d,y,f),e=Lh(p,_,g);for(let i=0;i<t.length-1;i++){const r=t[i],a=t[i+1];for(let t=0;t<e.length-1;t++)n.push(T(r,e[t],a,e[t+1]))}}else n.push(T({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:l+1},{fixed:0,stretch:c+1}));return n}function Ph(t,e,i){let r=0;for(const n of t)r+=Math.max(e,Math.min(i,n[1]))-Math.max(e,Math.min(i,n[0]));return r}function Lh(t,e,i){const r=[{fixed:-Ih,stretch:0}];for(const[e,i]of t){const t=r[r.length-1];r.push({fixed:e-t.stretch,stretch:t.stretch}),r.push({fixed:e-t.stretch,stretch:t.stretch+(i-e)})}return r.push({fixed:e+Ih,stretch:i}),r}function Dh(t,e,i,r){return t/e*i+r}function Rh(t,e,i,r){return t-e*i/r}class Bh{constructor(t,e,i,r,n,o,s,l,c,h){if(this.boxStartIndex=t.length,c){let t=o.top,e=o.bottom;const i=o.collisionPadding;i&&(t-=i[1],e+=i[3]);let r=e-t;r>0&&(r=Math.max(10,r),this.circleDiameter=r)}else{let c=o.top*s-l[0],u=o.bottom*s+l[2],d=o.left*s-l[3],p=o.right*s+l[1];const m=o.collisionPadding;if(m&&(d-=m[0]*s,c-=m[1]*s,p+=m[2]*s,u+=m[3]*s),h){const t=new a(d,c),e=new a(p,c),i=new a(d,u),r=new a(p,u),n=h*Math.PI/180;t._rotate(n),e._rotate(n),i._rotate(n),r._rotate(n),d=Math.min(t.x,e.x,i.x,r.x),p=Math.max(t.x,e.x,i.x,r.x),c=Math.min(t.y,e.y,i.y,r.y),u=Math.max(t.y,e.y,i.y,r.y)}t.emplaceBack(e.x,e.y,d,c,p,u,i,r,n)}this.boxEndIndex=t.length}}class Fh{constructor(t=[],e=Oh){if(this.data=t,this.length=this.data.length,this.compare=e,this.length>0)for(let t=(this.length>>1)-1;t>=0;t--)this._down(t)}push(t){this.data.push(t),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const t=this.data[0],e=this.data.pop();return this.length--,this.length>0&&(this.data[0]=e,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:e,compare:i}=this,r=e[t];for(;t>0;){const n=t-1>>1,a=e[n];if(i(r,a)>=0)break;e[t]=a,t=n}e[t]=r}_down(t){const{data:e,compare:i}=this,r=this.length>>1,n=e[t];for(;t<r;){let r=1+(t<<1),a=e[r];const o=r+1;if(o<this.length&&i(e[o],a)<0&&(r=o,a=e[o]),i(a,n)>=0)break;e[t]=a,t=r}e[t]=n}}function Oh(t,e){return t<e?-1:t>e?1:0}function $h(t,e=1,i=!1){let r=1/0,n=1/0,o=-1/0,s=-1/0;const l=t[0];for(let t=0;t<l.length;t++){const e=l[t];(!t||e.x<r)&&(r=e.x),(!t||e.y<n)&&(n=e.y),(!t||e.x>o)&&(o=e.x),(!t||e.y>s)&&(s=e.y)}const c=Math.min(o-r,s-n);let h=c/2;const u=new Fh([],Vh);if(0===c)return new a(r,n);for(let e=r;e<o;e+=c)for(let i=n;i<s;i+=c)u.push(new Nh(e+h,i+h,h,t));let d=function(t){let e=0,i=0,r=0;const n=t[0];for(let t=0,a=n.length,o=a-1;t<a;o=t++){const a=n[t],s=n[o],l=a.x*s.y-s.x*a.y;i+=(a.x+s.x)*l,r+=(a.y+s.y)*l,e+=3*l}return new Nh(i/e,r/e,0,t)}(t),p=u.length;for(;u.length;){const r=u.pop();(r.d>d.d||!d.d)&&(d=r,i&&console.log("found best %d after %d probes",Math.round(1e4*r.d)/1e4,p)),r.max-d.d<=e||(h=r.h/2,u.push(new Nh(r.p.x-h,r.p.y-h,h,t)),u.push(new Nh(r.p.x+h,r.p.y-h,h,t)),u.push(new Nh(r.p.x-h,r.p.y+h,h,t)),u.push(new Nh(r.p.x+h,r.p.y+h,h,t)),p+=4)}return i&&(console.log(`num probes: ${p}`),console.log(`best distance: ${d.d}`)),d.p}function Vh(t,e){return e.max-t.max}function Nh(t,e,i,r){this.p=new a(t,e),this.h=i,this.d=function(t,e){let i=!1,r=1/0;for(let n=0;n<e.length;n++){const a=e[n];for(let e=0,n=a.length,o=n-1;e<n;o=e++){const n=a[e],s=a[o];n.y>t.y!=s.y>t.y&&t.x<(s.x-n.x)*(t.y-n.y)/(s.y-n.y)+n.x&&(i=!i),r=Math.min(r,go(t,n,s))}}return(i?1:-1)*Math.sqrt(r)}(this.p,r),this.max=this.d+this.h*Math.SQRT2}var jh;t.aq=void 0,(jh=t.aq||(t.aq={}))[jh.center=1]="center",jh[jh.left=2]="left",jh[jh.right=3]="right",jh[jh.top=4]="top",jh[jh.bottom=5]="bottom",jh[jh["top-left"]=6]="top-left",jh[jh["top-right"]=7]="top-right",jh[jh["bottom-left"]=8]="bottom-left",jh[jh["bottom-right"]=9]="bottom-right";const Uh=7,Zh=Number.POSITIVE_INFINITY;function Hh(t,e){return e[1]!==Zh?function(t,e,i){let r=0,n=0;switch(e=Math.abs(e),i=Math.abs(i),t){case"top-right":case"top-left":case"top":n=i-Uh;break;case"bottom-right":case"bottom-left":case"bottom":n=-i+Uh}switch(t){case"top-right":case"bottom-right":case"right":r=-e;break;case"top-left":case"bottom-left":case"left":r=e}return[r,n]}(t,e[0],e[1]):function(t,e){let i=0,r=0;e<0&&(e=0);const n=e/Math.SQRT2;switch(t){case"top-right":case"top-left":r=n-Uh;break;case"bottom-right":case"bottom-left":r=-n+Uh;break;case"bottom":r=-e+Uh;break;case"top":r=e-Uh}switch(t){case"top-right":case"bottom-right":i=-n;break;case"top-left":case"bottom-left":i=n;break;case"left":i=e;break;case"right":i=-e}return[i,r]}(t,e[0])}function qh(t,e,i){var r;const n=t.layout,a=null===(r=n.get("text-variable-anchor-offset"))||void 0===r?void 0:r.evaluate(e,{},i);if(a){const t=a.values,e=[];for(let i=0;i<t.length;i+=2){const r=e[i]=t[i],n=t[i+1].map((t=>t*zl));r.startsWith("top")?n[1]-=Uh:r.startsWith("bottom")&&(n[1]+=Uh),e[i+1]=n}return new ie(e)}const o=n.get("text-variable-anchor");if(o){let r;r=void 0!==t._unevaluatedLayout.getValue("text-radial-offset")?[n.get("text-radial-offset").evaluate(e,{},i)*zl,Zh]:n.get("text-offset").evaluate(e,{},i).map((t=>t*zl));const a=[];for(const t of o)a.push(t,Hh(t,r));return new ie(a)}return null}function Gh(t){switch(t){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Wh(e,i,r,n,a,o,s,l,c,h,u){let d=o.textMaxSize.evaluate(i,{});void 0===d&&(d=s);const p=e.layers[0].layout,m=p.get("icon-offset").evaluate(i,{},u),f=Kh(r.horizontal),g=s/24,y=e.tilePixelRatio*g,_=e.tilePixelRatio*d/24,v=e.tilePixelRatio*l,b=e.tilePixelRatio*p.get("symbol-spacing"),x=p.get("text-padding")*e.tilePixelRatio,w=function(t,e,i,r=1){const n=t.get("icon-padding").evaluate(e,{},i),a=n&&n.values;return[a[0]*r,a[1]*r,a[2]*r,a[3]*r]}(p,i,u,e.tilePixelRatio),k=p.get("text-max-angle")/180*Math.PI,C="viewport"!==p.get("text-rotation-alignment")&&"point"!==p.get("symbol-placement"),A="map"===p.get("icon-rotation-alignment")&&"point"!==p.get("symbol-placement"),T=p.get("symbol-placement"),E=b/2,M=p.get("icon-text-fit");let I;n&&"none"!==M&&(e.allowVerticalPlacement&&r.vertical&&(I=Ac(n,r.vertical,M,p.get("icon-text-fit-padding"),m,g)),f&&(n=Ac(n,f,M,p.get("icon-text-fit-padding"),m,g)));const z=(l,d)=>{d.x<0||d.x>=eo||d.y<0||d.y>=eo||function(e,i,r,n,a,o,s,l,c,h,u,d,p,m,f,g,y,_,v,b,x,w,k,C,A){const T=e.addToLineVertexArray(i,r);let E,M,I,z,P=0,L=0,D=0,R=0,B=-1,F=-1;const O={};let $=Ra("");if(e.allowVerticalPlacement&&n.vertical){const t=l.layout.get("text-rotate").evaluate(x,{},C)+90;I=new Bh(c,i,h,u,d,n.vertical,p,m,f,t),s&&(z=new Bh(c,i,h,u,d,s,y,_,f,t))}if(a){const r=l.layout.get("icon-rotate").evaluate(x,{}),n="none"!==l.layout.get("icon-text-fit"),o=zh(a,r,k,n),p=s?zh(s,r,k,n):void 0;M=new Bh(c,i,h,u,d,a,y,_,!1,r),P=4*o.length;const m=e.iconSizeData;let f=null;"source"===m.kind?(f=[Ec*l.layout.get("icon-size").evaluate(x,{})],f[0]>Mc&&S(`${e.layerIds[0]}: Value for "icon-size" is >= ${Tc}. Reduce your "icon-size".`)):"composite"===m.kind&&(f=[Ec*w.compositeIconSizes[0].evaluate(x,{},C),Ec*w.compositeIconSizes[1].evaluate(x,{},C)],(f[0]>Mc||f[1]>Mc)&&S(`${e.layerIds[0]}: Value for "icon-size" is >= ${Tc}. Reduce your "icon-size".`)),e.addSymbols(e.icon,o,f,b,v,x,t.ai.none,i,T.lineStartIndex,T.lineLength,-1,C),B=e.icon.placedSymbolArray.length-1,p&&(L=4*p.length,e.addSymbols(e.icon,p,f,b,v,x,t.ai.vertical,i,T.lineStartIndex,T.lineLength,-1,C),F=e.icon.placedSymbolArray.length-1)}const V=Object.keys(n.horizontal);for(const r of V){const a=n.horizontal[r];if(!E){$=Ra(a.text);const t=l.layout.get("text-rotate").evaluate(x,{},C);E=new Bh(c,i,h,u,d,a,p,m,f,t)}const s=1===a.positionedLines.length;if(D+=Xh(e,i,a,o,l,f,x,g,T,n.vertical?t.ai.horizontal:t.ai.horizontalOnly,s?V:[r],O,B,w,C),s)break}n.vertical&&(R+=Xh(e,i,n.vertical,o,l,f,x,g,T,t.ai.vertical,["vertical"],O,F,w,C));const N=E?E.boxStartIndex:e.collisionBoxArray.length,j=E?E.boxEndIndex:e.collisionBoxArray.length,U=I?I.boxStartIndex:e.collisionBoxArray.length,Z=I?I.boxEndIndex:e.collisionBoxArray.length,H=M?M.boxStartIndex:e.collisionBoxArray.length,q=M?M.boxEndIndex:e.collisionBoxArray.length,G=z?z.boxStartIndex:e.collisionBoxArray.length,W=z?z.boxEndIndex:e.collisionBoxArray.length;let X=-1;const K=(t,e)=>t&&t.circleDiameter?Math.max(t.circleDiameter,e):e;X=K(E,X),X=K(I,X),X=K(M,X),X=K(z,X);const J=X>-1?1:0;J&&(X*=A/zl),e.glyphOffsetArray.length>=$c.MAX_GLYPHS&&S("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==x.sortKey&&e.addToSortKeyRanges(e.symbolInstances.length,x.sortKey);const Y=qh(l,x,C),[Q,tt]=function(e,i){const r=e.length,n=null==i?void 0:i.values;if((null==n?void 0:n.length)>0)for(let i=0;i<n.length;i+=2){const r=n[i+1];e.emplaceBack(t.aq[n[i]],r[0],r[1])}return[r,e.length]}(e.textAnchorOffsets,Y);e.symbolInstances.emplaceBack(i.x,i.y,O.right>=0?O.right:-1,O.center>=0?O.center:-1,O.left>=0?O.left:-1,O.vertical||-1,B,F,$,N,j,U,Z,H,q,G,W,h,D,R,P,L,J,0,p,X,Q,tt)}(e,d,l,r,n,a,I,e.layers[0],e.collisionBoxArray,i.index,i.sourceLayerIndex,e.index,y,[x,x,x,x],C,c,v,w,A,m,i,o,h,u,s)};if("line"===T)for(const t of xh(i.geometry,0,0,eo,eo)){const i=Eh(t,b,k,r.vertical||f,n,24,_,e.overscaling,eo);for(const r of i)f&&Jh(e,f.text,E,r)||z(t,r)}else if("line-center"===T){for(const t of i.geometry)if(t.length>1){const e=Th(t,k,r.vertical||f,n,24,_);e&&z(t,e)}}else if("Polygon"===i.type)for(const t of Es(i.geometry,0)){const e=$h(t,16);z(t[0],new wh(e.x,e.y,0))}else if("LineString"===i.type)for(const t of i.geometry)z(t,new wh(t[0].x,t[0].y,0));else if("Point"===i.type)for(const t of i.geometry)for(const e of t)z([e],new wh(e.x,e.y,0))}function Xh(t,e,i,r,n,o,s,l,c,h,u,d,p,m,f){const g=function(t,e,i,r,n,o,s,l){const c=r.layout.get("text-rotate").evaluate(o,{})*Math.PI/180,h=[];for(const t of e.positionedLines)for(const r of t.positionedGlyphs){if(!r.rect)continue;const o=r.rect||{};let u=ac+1,d=!0,p=1,m=0;const f=(n||l)&&r.vertical,g=r.metrics.advance*r.scale/2;if(l&&e.verticalizable&&(m=t.lineOffset/2-(r.imageName?-(zl-r.metrics.width*r.scale)/2:(r.scale-1)*zl)),r.imageName){const t=s[r.imageName];d=t.sdf,p=t.pixelRatio,u=sc/p}const y=n?[r.x+g,r.y]:[0,0];let _=n?[0,0]:[r.x+g+i[0],r.y+i[1]-m],v=[0,0];f&&(v=_,_=[0,0]);const b=r.metrics.isDoubleResolution?2:1,x=(r.metrics.left-u)*r.scale-g+_[0],w=(-r.metrics.top-u)*r.scale+_[1],S=x+o.w/b*r.scale/p,k=w+o.h/b*r.scale/p,C=new a(x,w),A=new a(S,w),T=new a(x,k),E=new a(S,k);if(f){const t=new a(-g,g-uc),e=-Math.PI/2,i=zl/2-g,n=new a(5-uc-i,-(r.imageName?i:0)),o=new a(...v);C._rotateAround(e,t)._add(n)._add(o),A._rotateAround(e,t)._add(n)._add(o),T._rotateAround(e,t)._add(n)._add(o),E._rotateAround(e,t)._add(n)._add(o)}if(c){const t=Math.sin(c),e=Math.cos(c),i=[e,-t,t,e];C._matMult(i),A._matMult(i),T._matMult(i),E._matMult(i)}const M=new a(0,0),I=new a(0,0);h.push({tl:C,tr:A,bl:T,br:E,tex:o,writingMode:e.writingMode,glyphOffset:y,sectionIndex:r.sectionIndex,isSDF:d,pixelOffsetTL:M,pixelOffsetBR:I,minFontScaleX:0,minFontScaleY:0})}return h}(0,i,l,n,o,s,r,t.allowVerticalPlacement),y=t.textSizeData;let _=null;"source"===y.kind?(_=[Ec*n.layout.get("text-size").evaluate(s,{})],_[0]>Mc&&S(`${t.layerIds[0]}: Value for "text-size" is >= ${Tc}. Reduce your "text-size".`)):"composite"===y.kind&&(_=[Ec*m.compositeTextSizes[0].evaluate(s,{},f),Ec*m.compositeTextSizes[1].evaluate(s,{},f)],(_[0]>Mc||_[1]>Mc)&&S(`${t.layerIds[0]}: Value for "text-size" is >= ${Tc}. Reduce your "text-size".`)),t.addSymbols(t.text,g,_,l,o,s,h,e,c.lineStartIndex,c.lineLength,p,f);for(const e of u)d[e]=t.text.placedSymbolArray.length-1;return 4*g.length}function Kh(t){for(const e in t)return t[e];return null}function Jh(t,e,i,r){const n=t.compareText;if(e in n){const t=n[e];for(let e=t.length-1;e>=0;e--)if(r.dist(t[e])<i)return!0}else n[e]=[];return n[e].push(r),!1}const Yh=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Qh{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[e,i]=new Uint8Array(t,0,2);if(219!==e)throw new Error("Data does not appear to be in a KDBush format.");const r=i>>4;if(1!==r)throw new Error(`Got v${r} data when expected v1.`);const n=Yh[15&i];if(!n)throw new Error("Unrecognized array type.");const[a]=new Uint16Array(t,2,1),[o]=new Uint32Array(t,4,1);return new Qh(o,a,n,t)}constructor(t,e=64,i=Float64Array,r){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+e,2),65535),this.ArrayType=i,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const n=Yh.indexOf(this.ArrayType),a=2*t*this.ArrayType.BYTES_PER_ELEMENT,o=t*this.IndexArrayType.BYTES_PER_ELEMENT,s=(8-o%8)%8;if(n<0)throw new Error(`Unexpected typed array class: ${i}.`);r&&r instanceof ArrayBuffer?(this.data=r,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+o+s,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+a+o+s),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+o+s,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+n]),new Uint16Array(this.data,2,1)[0]=e,new Uint32Array(this.data,4,1)[0]=t)}add(t,e){const i=this._pos>>1;return this.ids[i]=i,this.coords[this._pos++]=t,this.coords[this._pos++]=e,i}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return tu(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,e,i,r){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:n,coords:a,nodeSize:o}=this,s=[0,n.length-1,0],l=[];for(;s.length;){const c=s.pop()||0,h=s.pop()||0,u=s.pop()||0;if(h-u<=o){for(let o=u;o<=h;o++){const s=a[2*o],c=a[2*o+1];s>=t&&s<=i&&c>=e&&c<=r&&l.push(n[o])}continue}const d=u+h>>1,p=a[2*d],m=a[2*d+1];p>=t&&p<=i&&m>=e&&m<=r&&l.push(n[d]),(0===c?t<=p:e<=m)&&(s.push(u),s.push(d-1),s.push(1-c)),(0===c?i>=p:r>=m)&&(s.push(d+1),s.push(h),s.push(1-c))}return l}within(t,e,i){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:r,coords:n,nodeSize:a}=this,o=[0,r.length-1,0],s=[],l=i*i;for(;o.length;){const c=o.pop()||0,h=o.pop()||0,u=o.pop()||0;if(h-u<=a){for(let i=u;i<=h;i++)nu(n[2*i],n[2*i+1],t,e)<=l&&s.push(r[i]);continue}const d=u+h>>1,p=n[2*d],m=n[2*d+1];nu(p,m,t,e)<=l&&s.push(r[d]),(0===c?t-i<=p:e-i<=m)&&(o.push(u),o.push(d-1),o.push(1-c)),(0===c?t+i>=p:e+i>=m)&&(o.push(d+1),o.push(h),o.push(1-c))}return s}}function tu(t,e,i,r,n,a){if(n-r<=i)return;const o=r+n>>1;eu(t,e,o,r,n,a),tu(t,e,i,r,o-1,1-a),tu(t,e,i,o+1,n,1-a)}function eu(t,e,i,r,n,a){for(;n>r;){if(n-r>600){const o=n-r+1,s=i-r+1,l=Math.log(o),c=.5*Math.exp(2*l/3),h=.5*Math.sqrt(l*c*(o-c)/o)*(s-o/2<0?-1:1);eu(t,e,i,Math.max(r,Math.floor(i-s*c/o+h)),Math.min(n,Math.floor(i+(o-s)*c/o+h)),a)}const o=e[2*i+a];let s=r,l=n;for(iu(t,e,r,i),e[2*n+a]>o&&iu(t,e,r,n);s<l;){for(iu(t,e,s,l),s++,l--;e[2*s+a]<o;)s++;for(;e[2*l+a]>o;)l--}e[2*r+a]===o?iu(t,e,r,l):(l++,iu(t,e,l,n)),l<=i&&(r=l+1),i<=l&&(n=l-1)}}function iu(t,e,i,r){ru(t,i,r),ru(e,2*i,2*r),ru(e,2*i+1,2*r+1)}function ru(t,e,i){const r=t[e];t[e]=t[i],t[i]=r}function nu(t,e,i,r){const n=t-i,a=e-r;return n*n+a*a}var au;t.bh=void 0,(au=t.bh||(t.bh={})).create="create",au.load="load",au.fullLoad="fullLoad";let ou=null,su=[];const lu=1e3/60,cu="loadTime",hu="fullLoadTime",uu={mark(t){performance.mark(t)},frame(t){const e=t;null!=ou&&su.push(e-ou),ou=e},clearMetrics(){ou=null,su=[],performance.clearMeasures(cu),performance.clearMeasures(hu);for(const e in t.bh)performance.clearMarks(t.bh[e])},getPerformanceMetrics(){performance.measure(cu,t.bh.create,t.bh.load),performance.measure(hu,t.bh.create,t.bh.fullLoad);const e=performance.getEntriesByName(cu)[0].duration,i=performance.getEntriesByName(hu)[0].duration,r=su.length,n=1/(su.reduce(((t,e)=>t+e),0)/r/1e3),a=su.filter((t=>t>lu)).reduce(((t,e)=>t+(e-lu)/lu),0);return{loadTime:e,fullLoadTime:i,fps:n,percentDroppedFrames:a/(r+a)*100,totalFrames:r}}};t.$=function(t,e,i){var r,n,a,o,s,l,c,h,u,d,p,m,f=i[0],g=i[1],y=i[2];return e===t?(t[12]=e[0]*f+e[4]*g+e[8]*y+e[12],t[13]=e[1]*f+e[5]*g+e[9]*y+e[13],t[14]=e[2]*f+e[6]*g+e[10]*y+e[14],t[15]=e[3]*f+e[7]*g+e[11]*y+e[15]):(n=e[1],a=e[2],o=e[3],s=e[4],l=e[5],c=e[6],h=e[7],u=e[8],d=e[9],p=e[10],m=e[11],t[0]=r=e[0],t[1]=n,t[2]=a,t[3]=o,t[4]=s,t[5]=l,t[6]=c,t[7]=h,t[8]=u,t[9]=d,t[10]=p,t[11]=m,t[12]=r*f+s*g+u*y+e[12],t[13]=n*f+l*g+d*y+e[13],t[14]=a*f+c*g+p*y+e[14],t[15]=o*f+h*g+m*y+e[15]),t},t.A=To,t.B=He,t.C=class{constructor(t,e,i){this.receive=t=>{const e=t.data,i=e.id;if(i&&(!e.targetMapId||this.mapId===e.targetMapId))if("<cancel>"===e.type){delete this.tasks[i];const t=this.cancelCallbacks[i];delete this.cancelCallbacks[i],t&&t()}else A()||e.mustQueue?(this.tasks[i]=e,this.taskQueue.push(i),this.invoker.trigger()):this.processTask(i,e)},this.process=()=>{if(!this.taskQueue.length)return;const t=this.taskQueue.shift(),e=this.tasks[t];delete this.tasks[t],this.taskQueue.length&&this.invoker.trigger(),e&&this.processTask(t,e)},this.target=t,this.parent=e,this.mapId=i,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},this.invoker=new Yc(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=A()?t:window}send(t,e,i,r,n=!1){const a=Math.round(1e18*Math.random()).toString(36).substring(0,10);i&&(this.callbacks[a]=i);const o=[],s={id:a,type:t,hasCallback:!!i,targetMapId:r,mustQueue:n,sourceMapId:this.mapId,data:Fr(e,o)};return this.target.postMessage(s,{transfer:o}),{cancel:()=>{i&&delete this.callbacks[a],this.target.postMessage({id:a,type:"<cancel>",targetMapId:r,sourceMapId:this.mapId})}}}processTask(t,e){if("<response>"===e.type){const i=this.callbacks[t];delete this.callbacks[t],i&&(e.error?i(Or(e.error)):i(null,Or(e.data)))}else{let i=!1;const r=[],n=e.hasCallback?(e,n)=>{i=!0,delete this.cancelCallbacks[t];const a={id:t,type:"<response>",sourceMapId:this.mapId,error:e?Fr(e):null,data:Fr(n,r)};this.target.postMessage(a,{transfer:r})}:t=>{i=!0};let a=null;const o=Or(e.data);if(this.parent[e.type])a=this.parent[e.type](e.sourceMapId,o,n);else if("getWorkerSource"in this.parent){const t=e.type.split(".");a=this.parent.getWorkerSource(e.sourceMapId,t[0],o.source)[t[1]](o,n)}else n(new Error(`Could not find function ${e.type}`));!i&&a&&a.cancel&&(this.cancelCallbacks[t]=a.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}},t.D=yn,t.E=W,t.F=function(t,e){const i={};for(let r=0;r<e.length;r++){const n=e[r];n in t&&(i[n]=t[n])}return i},t.G=rh,t.H=nh,t.I=lc,t.J=u,t.K=d,t.L=th,t.M=I,t.N=eo,t.O=dh,t.P=a,t.Q=En,t.R=jo,t.S=Ta,t.T=un,t.U=lh,t.V=class extends Pn{},t.W=hh,t.X=function(t,e){const i=window.document.createElement("video");i.muted=!0,i.onloadstart=function(){e(null,i)};for(let e=0;e<t.length;e++){const r=window.document.createElement("source");U(t[e])||(i.crossOrigin="Anonymous"),r.src=t[e],i.appendChild(r)}return{cancel:()=>{}}},t.Y=st,t.Z=function(){var t=new To(16);return To!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},t._=e,t.a=E,t.a$=class extends Jn{},t.a0=function(t,e,i){var r=i[0],n=i[1],a=i[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*a,t[9]=e[9]*a,t[10]=e[10]*a,t[11]=e[11]*a,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},t.a1=Mo,t.a2=function(){return _++},t.a3=ta,t.a4=$c,t.a5=function(){sn.isLoading()||sn.isLoaded()||"deferred"!==an()||on()},t.a6=Zi,t.a7=ao,t.a8=ln,t.a9=gh,t.aA=en,t.aB=function(t){t=t.slice();const e=Object.create(null);for(let i=0;i<t.length;i++)e[t[i].id]=t[i];for(let i=0;i<t.length;i++)"ref"in t[i]&&(t[i]=J(t[i],e[t[i].ref]));return t},t.aC=function(t){if("custom"===t.type)return new Jc(t);switch(t.type){case"background":return new Gc(t);case"circle":return new Lo(t);case"fill":return new Bs(t);case"fill-extrusion":return new ol(t);case"heatmap":return new Zo(t);case"hillshade":return new Go(t);case"line":return new wl(t);case"raster":return new Kc(t);case"symbol":return new Zc(t)}},t.aD=x,t.aE=function(t,e){if(!t)return[{command:Q.setStyle,args:[e]}];let i=[];try{if(!Y(t.version,e.version))return[{command:Q.setStyle,args:[e]}];Y(t.center,e.center)||i.push({command:Q.setCenter,args:[e.center]}),Y(t.zoom,e.zoom)||i.push({command:Q.setZoom,args:[e.zoom]}),Y(t.bearing,e.bearing)||i.push({command:Q.setBearing,args:[e.bearing]}),Y(t.pitch,e.pitch)||i.push({command:Q.setPitch,args:[e.pitch]}),Y(t.sprite,e.sprite)||i.push({command:Q.setSprite,args:[e.sprite]}),Y(t.glyphs,e.glyphs)||i.push({command:Q.setGlyphs,args:[e.glyphs]}),Y(t.transition,e.transition)||i.push({command:Q.setTransition,args:[e.transition]}),Y(t.light,e.light)||i.push({command:Q.setLight,args:[e.light]});const r={},n=[];!function(t,e,i,r){let n;for(n in e=e||{},t=t||{})Object.prototype.hasOwnProperty.call(t,n)&&(Object.prototype.hasOwnProperty.call(e,n)||et(n,i,r));for(n in e)Object.prototype.hasOwnProperty.call(e,n)&&(Object.prototype.hasOwnProperty.call(t,n)?Y(t[n],e[n])||("geojson"===t[n].type&&"geojson"===e[n].type&&rt(t,e,n)?i.push({command:Q.setGeoJSONSourceData,args:[n,e[n].data]}):it(n,e,i,r)):tt(n,e,i))}(t.sources,e.sources,n,r);const a=[];t.layers&&t.layers.forEach((t=>{r[t.source]?i.push({command:Q.removeLayer,args:[t.id]}):a.push(t)})),i=i.concat(n),function(t,e,i){e=e||[];const r=(t=t||[]).map(at),n=e.map(at),a=t.reduce(ot,{}),o=e.reduce(ot,{}),s=r.slice(),l=Object.create(null);let c,h,u,d,p,m,f;for(c=0,h=0;c<r.length;c++)u=r[c],Object.prototype.hasOwnProperty.call(o,u)?h++:(i.push({command:Q.removeLayer,args:[u]}),s.splice(s.indexOf(u,h),1));for(c=0,h=0;c<n.length;c++)u=n[n.length-1-c],s[s.length-1-c]!==u&&(Object.prototype.hasOwnProperty.call(a,u)?(i.push({command:Q.removeLayer,args:[u]}),s.splice(s.lastIndexOf(u,s.length-h),1)):h++,m=s[s.length-c],i.push({command:Q.addLayer,args:[o[u],m]}),s.splice(s.length-c,0,u),l[u]=!0);for(c=0;c<n.length;c++)if(u=n[c],d=a[u],p=o[u],!l[u]&&!Y(d,p))if(Y(d.source,p.source)&&Y(d["source-layer"],p["source-layer"])&&Y(d.type,p.type)){for(f in nt(d.layout,p.layout,i,u,null,Q.setLayoutProperty),nt(d.paint,p.paint,i,u,null,Q.setPaintProperty),Y(d.filter,p.filter)||i.push({command:Q.setFilter,args:[u,p.filter]}),Y(d.minzoom,p.minzoom)&&Y(d.maxzoom,p.maxzoom)||i.push({command:Q.setLayerZoomRange,args:[u,p.minzoom,p.maxzoom]}),d)Object.prototype.hasOwnProperty.call(d,f)&&"layout"!==f&&"paint"!==f&&"filter"!==f&&"metadata"!==f&&"minzoom"!==f&&"maxzoom"!==f&&(0===f.indexOf("paint.")?nt(d[f],p[f],i,u,f.slice(6),Q.setPaintProperty):Y(d[f],p[f])||i.push({command:Q.setLayerProperty,args:[u,f,p[f]]}));for(f in p)Object.prototype.hasOwnProperty.call(p,f)&&!Object.prototype.hasOwnProperty.call(d,f)&&"layout"!==f&&"paint"!==f&&"filter"!==f&&"metadata"!==f&&"minzoom"!==f&&"maxzoom"!==f&&(0===f.indexOf("paint.")?nt(d[f],p[f],i,u,f.slice(6),Q.setPaintProperty):Y(d[f],p[f])||i.push({command:Q.setLayerProperty,args:[u,f,p[f]]}))}else i.push({command:Q.removeLayer,args:[u]}),m=s[s.lastIndexOf(u)+1],i.push({command:Q.addLayer,args:[p,m]})}(a,e.layers,i)}catch(t){console.warn("Unable to compute style diff:",t),i=[{command:Q.setStyle,args:[e]}]}return i},t.aF=function(t){const e=[],i=t.id;return void 0===i&&e.push({message:`layers.${i}: missing required property "id"`}),void 0===t.render&&e.push({message:`layers.${i}: missing required method "render"`}),t.renderingMode&&"2d"!==t.renderingMode&&"3d"!==t.renderingMode&&e.push({message:`layers.${i}: property "renderingMode" must be either "2d" or "3d"`}),e},t.aG=function t(e,i){if(Array.isArray(e)){if(!Array.isArray(i)||e.length!==i.length)return!1;for(let r=0;r<e.length;r++)if(!t(e[r],i[r]))return!1;return!0}if("object"==typeof e&&null!==e&&null!==i){if("object"!=typeof i)return!1;if(Object.keys(e).length!==Object.keys(i).length)return!1;for(const r in e)if(!t(e[r],i[r]))return!1;return!0}return e===i},t.aH=v,t.aI=b,t.aJ=nn,t.aK=function(t){return t({pluginStatus:Qr,pluginURL:tn}),nn.on("pluginStateChange",t),t},t.aL=class extends Va{constructor(t,e){super(t,e),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1i(this.location,t))}},t.aM=Na,t.aN=class extends Va{constructor(t,e){super(t,e),this.current=Za}set(t){if(t[12]!==this.current[12]||t[0]!==this.current[0])return this.current=t,void this.gl.uniformMatrix4fv(this.location,!1,t);for(let e=1;e<16;e++)if(t[e]!==this.current[e]){this.current=t,this.gl.uniformMatrix4fv(this.location,!1,t);break}}},t.aO=ja,t.aP=class extends Va{constructor(t,e){super(t,e),this.current=[0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]||(this.current=t,this.gl.uniform3f(this.location,t[0],t[1],t[2]))}},t.aQ=class extends Va{constructor(t,e){super(t,e),this.current=[0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]||(this.current=t,this.gl.uniform2f(this.location,t[0],t[1]))}},t.aR=Ua,t.aS=function(t,e,i,r,n,a,o){var s=1/(e-i),l=1/(r-n),c=1/(a-o);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+i)*s,t[13]=(n+r)*l,t[14]=(o+a)*c,t[15]=1,t},t.aT=Kt,t.aU=zo,t.aV=class extends jn{},t.aW=El,t.aX=class extends Zn{},t.aY=function(t){return t<=1?1:Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},t.aZ=Uo,t.a_=ua,t.aa=function(t){const e={};if(t.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,((t,i,r,n)=>{const a=r||n;return e[i]=!a||a.toLowerCase(),""})),e["max-age"]){const t=parseInt(e["max-age"],10);isNaN(t)?delete e["max-age"]:e["max-age"]=t}return e},t.ab=function(t,e){const i=[];for(const r in t)r in e||i.push(r);return i},t.ac=function(t){if(null==T){const e=t.navigator?t.navigator.userAgent:null;T=!!t.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return T},t.ad=f,t.ae=function(t,e,i){var r=Math.sin(i),n=Math.cos(i),a=e[0],o=e[1],s=e[2],l=e[3],c=e[4],h=e[5],u=e[6],d=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*n+c*r,t[1]=o*n+h*r,t[2]=s*n+u*r,t[3]=l*n+d*r,t[4]=c*n-a*r,t[5]=h*n-o*r,t[6]=u*n-s*r,t[7]=d*n-l*r,t},t.af=function(t){var e=new To(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},t.ag=Po,t.ah=function(t,e){let i=0,r=0;if("constant"===t.kind)r=t.layoutSize;else if("source"!==t.kind){const{interpolationType:n,minZoom:a,maxZoom:o}=t,s=n?f(qe.interpolationFactor(n,e,a,o),0,1):0;"camera"===t.kind?r=He.number(t.minSize,t.maxSize,s):i=s}return{uSizeT:i,uSize:r}},t.aj=function(t,{uSize:e,uSizeT:i},{lowerSize:r,upperSize:n}){return"source"===t.kind?r/Ec:"composite"===t.kind?He.number(r/Ec,n/Ec,i):e},t.ak=Rc,t.al=function(t,e,i,r){const n=e.y-t.y,o=e.x-t.x,s=r.y-i.y,l=r.x-i.x,c=s*o-l*n;if(0===c)return null;const h=(l*(t.y-i.y)-s*(t.x-i.x))/c;return new a(t.x+h*o,t.y+h*n)},t.am=xh,t.an=lo,t.ao=Eo,t.ap=zl,t.ar=zc,t.as=function(t,e){var i=e[0],r=e[1],n=e[2],a=e[3],o=e[4],s=e[5],l=e[6],c=e[7],h=e[8],u=e[9],d=e[10],p=e[11],m=e[12],f=e[13],g=e[14],y=e[15],_=i*s-r*o,v=i*l-n*o,b=i*c-a*o,x=r*l-n*s,w=r*c-a*s,S=n*c-a*l,k=h*f-u*m,C=h*g-d*m,A=h*y-p*m,T=u*g-d*f,E=u*y-p*f,M=d*y-p*g,I=_*M-v*E+b*T+x*A-w*C+S*k;return I?(t[0]=(s*M-l*E+c*T)*(I=1/I),t[1]=(n*E-r*M-a*T)*I,t[2]=(f*S-g*w+y*x)*I,t[3]=(d*w-u*S-p*x)*I,t[4]=(l*A-o*M-c*C)*I,t[5]=(i*M-n*A+a*C)*I,t[6]=(g*b-m*S-y*v)*I,t[7]=(h*S-d*b+p*v)*I,t[8]=(o*E-s*A+c*k)*I,t[9]=(r*A-i*E-a*k)*I,t[10]=(m*w-f*b+y*_)*I,t[11]=(u*b-h*w-p*_)*I,t[12]=(s*C-o*T-l*k)*I,t[13]=(i*T-r*C+n*k)*I,t[14]=(f*v-m*x-g*_)*I,t[15]=(h*x-u*v+d*_)*I,t):null},t.at=Gh,t.au=Sc,t.av=Qh,t.aw=function(){const t={},e=X.$version;for(const i in X.$root){const r=X.$root[i];if(r.required){let n=null;n="version"===i?e:"array"===r.type?[]:{},null!=n&&(t[i]=n)}}return t},t.ax=Q,t.ay=$r,t.az=O,t.b=function(t,e){const i=new Blob([new Uint8Array(t)],{type:"image/png"});createImageBitmap(i).then((t=>{e(null,t)})).catch((t=>{e(new Error(`Could not load image because of ${t.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))}))},t.b0=Sa,t.b1=function(t,e){var i=t[0],r=t[1],n=t[2],a=t[3],o=t[4],s=t[5],l=t[6],c=t[7],h=t[8],u=t[9],d=t[10],p=t[11],m=t[12],f=t[13],g=t[14],y=t[15],_=e[0],v=e[1],b=e[2],x=e[3],w=e[4],S=e[5],k=e[6],C=e[7],A=e[8],T=e[9],E=e[10],M=e[11],I=e[12],z=e[13],P=e[14],L=e[15];return Math.abs(i-_)<=Ao*Math.max(1,Math.abs(i),Math.abs(_))&&Math.abs(r-v)<=Ao*Math.max(1,Math.abs(r),Math.abs(v))&&Math.abs(n-b)<=Ao*Math.max(1,Math.abs(n),Math.abs(b))&&Math.abs(a-x)<=Ao*Math.max(1,Math.abs(a),Math.abs(x))&&Math.abs(o-w)<=Ao*Math.max(1,Math.abs(o),Math.abs(w))&&Math.abs(s-S)<=Ao*Math.max(1,Math.abs(s),Math.abs(S))&&Math.abs(l-k)<=Ao*Math.max(1,Math.abs(l),Math.abs(k))&&Math.abs(c-C)<=Ao*Math.max(1,Math.abs(c),Math.abs(C))&&Math.abs(h-A)<=Ao*Math.max(1,Math.abs(h),Math.abs(A))&&Math.abs(u-T)<=Ao*Math.max(1,Math.abs(u),Math.abs(T))&&Math.abs(d-E)<=Ao*Math.max(1,Math.abs(d),Math.abs(E))&&Math.abs(p-M)<=Ao*Math.max(1,Math.abs(p),Math.abs(M))&&Math.abs(m-I)<=Ao*Math.max(1,Math.abs(m),Math.abs(I))&&Math.abs(f-z)<=Ao*Math.max(1,Math.abs(f),Math.abs(z))&&Math.abs(g-P)<=Ao*Math.max(1,Math.abs(g),Math.abs(P))&&Math.abs(y-L)<=Ao*Math.max(1,Math.abs(y),Math.abs(L))},t.b2=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},t.b3=function(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t[2]=e[2]*i[2],t[3]=e[3]*i[3],t},t.b4=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},t.b5=g,t.b6=uh,t.b7=ah,t.b8=function(t,e,i,r,n){var a,o=1/Math.tan(e/2);return t[0]=o/i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=n&&n!==1/0?(t[10]=(n+r)*(a=1/(r-n)),t[14]=2*n*r*a):(t[10]=-1,t[14]=-2*r),t},t.b9=function(t,e,i){var r=Math.sin(i),n=Math.cos(i),a=e[4],o=e[5],s=e[6],l=e[7],c=e[8],h=e[9],u=e[10],d=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=a*n+c*r,t[5]=o*n+h*r,t[6]=s*n+u*r,t[7]=l*n+d*r,t[8]=c*n-a*r,t[9]=h*n-o*r,t[10]=u*n-s*r,t[11]=d*n-l*r,t},t.bA=r,t.bB=Pl,t.bC=Bi,t.bD=sn,t.ba=p,t.bb=m,t.bc=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},t.bd=class extends zn{},t.be=Qc,t.bf=oh,t.bg=uu,t.bi=F,t.bj=function(t,e,i=!1){if(Qr===Xr||Qr===Kr||Qr===Jr)throw new Error("setRTLTextPlugin cannot be called multiple times.");tn=R.resolveURL(t),Qr=Xr,Yr=e,rn(),i||on()},t.bk=an,t.bl=function(t,e){const i={};for(let r=0;r<t.length;r++){const n=e&&e[t[r].id]||Qi(t[r]);e&&(e[t[r].id]=n);let a=i[n];a||(a=i[n]=[]),a.push(t[r])}const r=[];for(const t in i)r.push(i[t]);return r},t.bm=Rr,t.bn=fh,t.bo=yh,t.bp=cc,t.bq=function(e){e.bucket.createArrays(),e.bucket.tilePixelRatio=eo/(512*e.bucket.overscaling),e.bucket.compareText={},e.bucket.iconsNeedLinear=!1;const i=e.bucket.layers[0],r=i.layout,n=i._unevaluatedLayout._values,a={layoutIconSize:n["icon-size"].possiblyEvaluate(new ln(e.bucket.zoom+1),e.canonical),layoutTextSize:n["text-size"].possiblyEvaluate(new ln(e.bucket.zoom+1),e.canonical),textMaxSize:n["text-size"].possiblyEvaluate(new ln(18))};if("composite"===e.bucket.textSizeData.kind){const{minZoom:t,maxZoom:i}=e.bucket.textSizeData;a.compositeTextSizes=[n["text-size"].possiblyEvaluate(new ln(t),e.canonical),n["text-size"].possiblyEvaluate(new ln(i),e.canonical)]}if("composite"===e.bucket.iconSizeData.kind){const{minZoom:t,maxZoom:i}=e.bucket.iconSizeData;a.compositeIconSizes=[n["icon-size"].possiblyEvaluate(new ln(t),e.canonical),n["icon-size"].possiblyEvaluate(new ln(i),e.canonical)]}const o=r.get("text-line-height")*zl,s="viewport"!==r.get("text-rotation-alignment")&&"point"!==r.get("symbol-placement"),l=r.get("text-keep-upright"),c=r.get("text-size");for(const n of e.bucket.features){const h=r.get("text-font").evaluate(n,{},e.canonical).join(","),u=c.evaluate(n,{},e.canonical),d=a.layoutTextSize.evaluate(n,{},e.canonical),p=a.layoutIconSize.evaluate(n,{},e.canonical),m={horizontal:{},vertical:void 0},f=n.text;let g,y=[0,0];if(f){const a=f.toString(),c=r.get("text-letter-spacing").evaluate(n,{},e.canonical)*zl,p=jr(a)?c:0,g=r.get("text-anchor").evaluate(n,{},e.canonical),_=qh(i,n,e.canonical);if(!_){const t=r.get("text-radial-offset").evaluate(n,{},e.canonical);y=t?Hh(g,[t*zl,Zh]):r.get("text-offset").evaluate(n,{},e.canonical).map((t=>t*zl))}let v=s?"center":r.get("text-justify").evaluate(n,{},e.canonical);const b=r.get("symbol-placement"),x="point"===b?r.get("text-max-width").evaluate(n,{},e.canonical)*zl:0,w=()=>{e.bucket.allowVerticalPlacement&&Nr(a)&&(m.vertical=mc(f,e.glyphMap,e.glyphPositions,e.imagePositions,h,x,o,g,"left",p,y,t.ai.vertical,!0,b,d,u))};if(!s&&_){const i=new Set;if("auto"===v)for(let t=0;t<_.values.length;t+=2)i.add(Gh(_.values[t]));else i.add(v);let r=!1;for(const n of i)if(!m.horizontal[n])if(r)m.horizontal[n]=m.horizontal[0];else{const i=mc(f,e.glyphMap,e.glyphPositions,e.imagePositions,h,x,o,"center",n,p,y,t.ai.horizontal,!1,b,d,u);i&&(m.horizontal[n]=i,r=1===i.positionedLines.length)}w()}else{"auto"===v&&(v=Gh(g));const i=mc(f,e.glyphMap,e.glyphPositions,e.imagePositions,h,x,o,g,v,p,y,t.ai.horizontal,!1,b,d,u);i&&(m.horizontal[v]=i),w(),Nr(a)&&s&&l&&(m.vertical=mc(f,e.glyphMap,e.glyphPositions,e.imagePositions,h,x,o,g,v,p,y,t.ai.vertical,!1,b,d,u))}}let _=!1;if(n.icon&&n.icon.name){const t=e.imageMap[n.icon.name];t&&(g=Cc(e.imagePositions[n.icon.name],r.get("icon-offset").evaluate(n,{},e.canonical),r.get("icon-anchor").evaluate(n,{},e.canonical)),_=!!t.sdf,void 0===e.bucket.sdfIcons?e.bucket.sdfIcons=_:e.bucket.sdfIcons!==_&&S("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(t.pixelRatio!==e.bucket.pixelRatio||0!==r.get("icon-rotate").constantOr(1))&&(e.bucket.iconsNeedLinear=!0))}const v=Kh(m.horizontal)||m.vertical;e.bucket.iconsInText=!!v&&v.iconsInText,(v||g)&&Wh(e.bucket,n,m,g,e.imageMap,a,d,p,y,_,e.canonical)}e.showCollisionBoxes&&e.bucket.generateCollisionDebugBuffers()},t.br=gl,t.bs=Ps,t.bt=el,t.bu=class{constructor(t){this._marks={start:[t.url,"start"].join("#"),end:[t.url,"end"].join("#"),measure:t.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let t=performance.getEntriesByName(this._marks.measure);return 0===t.length&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),t=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),t}},t.bv=tc,t.bw=Vs,t.bx=function(t,i,r,n,a){return e(this,void 0,void 0,(function*(){if(d())try{return yield I(t,i,r,n,a)}catch(t){}return function(t,e,i,r,n){const a=t.width,o=t.height;z&&P||(z=new OffscreenCanvas(a,o),P=z.getContext("2d",{willReadFrequently:!0})),z.width=a,z.height=o,P.drawImage(t,0,0,a,o);const s=P.getImageData(e,i,r,n);return P.clearRect(0,0,a,o),s.data}(t,i,r,n,a)}))},t.by=mh,t.bz=i,t.c=B,t.d=function(t,e){const i=new Image;i.onload=()=>{e(null,i),URL.revokeObjectURL(i.src),i.onload=null,window.requestAnimationFrame((()=>{i.src=M}))},i.onerror=()=>e(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const r=new Blob([new Uint8Array(t)],{type:"image/png"});i.src=t.byteLength?URL.createObjectURL(r):M},t.e=y,t.f=function(t,e){return N(y(t,{type:"json"}),e)},t.g=$,t.h=R,t.i=A,t.j=G,t.k=q,t.l=j,t.m=N,t.n=function(t){return new tc(t).readFields(ic,[])},t.o=function(t,e,i){if(!t.length)return i(null,[]);let r=t.length;const n=new Array(t.length);let a=null;t.forEach(((t,o)=>{e(t,((t,e)=>{t&&(a=t),n[o]=e,0==--r&&i(a,n)}))}))},t.p=oc,t.q=No,t.r=wn,t.s=U,t.t=Mr,t.u=Vr,t.v=X,t.w=S,t.x=Pr,t.y=Er,t.z=function([t,e,i]){return e+=90,e*=Math.PI/180,i*=Math.PI/180,{x:t*Math.cos(e)*Math.sin(i),y:t*Math.sin(e)*Math.sin(i),z:t*Math.cos(i)}}})),r(["./shared"],(function(t){class e{constructor(t){this.keyCache={},t&&this.replace(t)}replace(t){this._layerConfigs={},this._layers={},this.update(t,[])}update(e,i){for(const i of e){this._layerConfigs[i.id]=i;const e=this._layers[i.id]=t.aC(i);e._featureFilter=t.a6(e.filter),this.keyCache[i.id]&&delete this.keyCache[i.id]}for(const t of i)delete this.keyCache[t],delete this._layerConfigs[t],delete this._layers[t];this.familiesBySource={};const r=t.bl(Object.values(this._layerConfigs),this.keyCache);for(const t of r){const e=t.map((t=>this._layers[t.id])),i=e[0];if("none"===i.visibility)continue;const r=i.source||"";let n=this.familiesBySource[r];n||(n=this.familiesBySource[r]={});const a=i.sourceLayer||"_geojsonTileLayer";let o=n[a];o||(o=n[a]=[]),o.push(e)}}}class i{constructor(e){const i={},r=[];for(const t in e){const n=e[t],a=i[t]={};for(const t in n){const e=n[+t];if(!e||0===e.bitmap.width||0===e.bitmap.height)continue;const i={x:0,y:0,w:e.bitmap.width+2,h:e.bitmap.height+2};r.push(i),a[t]={rect:i,metrics:e.metrics}}}const{w:n,h:a}=t.p(r),o=new t.q({width:n||1,height:a||1});for(const r in e){const n=e[r];for(const e in n){const a=n[+e];if(!a||0===a.bitmap.width||0===a.bitmap.height)continue;const s=i[r][e].rect;t.q.copy(a.bitmap,o,{x:0,y:0},{x:s.x+1,y:s.y+1},a.bitmap)}}this.image=o,this.positions=i}}t.bm("GlyphAtlas",i);class r{constructor(e){this.tileID=new t.O(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.uid=e.uid,this.zoom=e.zoom,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming,this.returnDependencies=!!e.returnDependencies,this.promoteId=e.promoteId,this.inFlightDependencies=[],this.dependencySentinel=-1}parse(e,r,a,o,s){this.status="parsing",this.data=e,this.collisionBoxArray=new t.a3;const l=new t.bn(Object.keys(e.layers).sort()),c=new t.bo(this.tileID,this.promoteId);c.bucketLayerIDs=[];const h={},u={featureIndex:c,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:a},d=r.familiesBySource[this.source];for(const i in d){const r=e.layers[i];if(!r)continue;1===r.version&&t.w(`Vector tile source "${this.source}" layer "${i}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const o=l.encode(i),s=[];for(let t=0;t<r.length;t++){const e=r.feature(t),n=c.getId(e,i);s.push({feature:e,id:n,index:t,sourceLayerIndex:o})}for(const e of d[i]){const i=e[0];i.source!==this.source&&t.w(`layer.source = ${i.source} does not equal this.source = ${this.source}`),i.minzoom&&this.zoom<Math.floor(i.minzoom)||i.maxzoom&&this.zoom>=i.maxzoom||"none"!==i.visibility&&(n(e,this.zoom,a),(h[i.id]=i.createBucket({index:c.bucketLayerIDs.length,layers:e,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:o,sourceID:this.source})).populate(s,u,this.tileID.canonical),c.bucketLayerIDs.push(e.map((t=>t.id))))}}let p,m,f,g;const y=t.aH(u.glyphDependencies,(t=>Object.keys(t).map(Number)));this.inFlightDependencies.forEach((t=>null==t?void 0:t.cancel())),this.inFlightDependencies=[];const _=++this.dependencySentinel;Object.keys(y).length?this.inFlightDependencies.push(o.send("getGlyphs",{uid:this.uid,stacks:y,source:this.source,tileID:this.tileID,type:"glyphs"},((t,e)=>{_===this.dependencySentinel&&(p||(p=t,m=e,x.call(this)))}))):m={};const v=Object.keys(u.iconDependencies);v.length?this.inFlightDependencies.push(o.send("getImages",{icons:v,source:this.source,tileID:this.tileID,type:"icons"},((t,e)=>{_===this.dependencySentinel&&(p||(p=t,f=e,x.call(this)))}))):f={};const b=Object.keys(u.patternDependencies);function x(){if(p)return s(p);if(m&&f&&g){const e=new i(m),r=new t.bp(f,g);for(const i in h){const o=h[i];o instanceof t.a4?(n(o.layers,this.zoom,a),t.bq({bucket:o,glyphMap:m,glyphPositions:e.positions,imageMap:f,imagePositions:r.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):o.hasPattern&&(o instanceof t.br||o instanceof t.bs||o instanceof t.bt)&&(n(o.layers,this.zoom,a),o.addFeatures(u,this.tileID.canonical,r.patternPositions))}this.status="done",s(null,{buckets:Object.values(h).filter((t=>!t.isEmpty())),featureIndex:c,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:e.image,imageAtlas:r,glyphMap:this.returnDependencies?m:null,iconMap:this.returnDependencies?f:null,glyphPositions:this.returnDependencies?e.positions:null})}}b.length?this.inFlightDependencies.push(o.send("getImages",{icons:b,source:this.source,tileID:this.tileID,type:"patterns"},((t,e)=>{_===this.dependencySentinel&&(p||(p=t,g=e,x.call(this)))}))):g={},x.call(this)}}function n(e,i,r){const n=new t.a8(i);for(const t of e)t.recalculate(n,r)}function a(e,i){const r=t.l(e.request,((r,n,a,o)=>{if(r)i(r);else if(n)try{const e=new t.bw.VectorTile(new t.bv(n));i(null,{vectorTile:e,rawData:n,cacheControl:a,expires:o})}catch(t){const r=new Uint8Array(n);let a=`Unable to parse the tile at ${e.request.url}, `;a+=31===r[0]&&139===r[1]?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${t.messge}`,i(new Error(a))}}));return()=>{r.cancel(),i()}}class o{constructor(t,e,i,r){this.actor=t,this.layerIndex=e,this.availableImages=i,this.loadVectorData=r||a,this.fetching={},this.loading={},this.loaded={}}loadTile(e,i){const n=e.uid;this.loading||(this.loading={});const a=!!(e&&e.request&&e.request.collectResourceTiming)&&new t.bu(e.request),o=this.loading[n]=new r(e);o.abort=this.loadVectorData(e,((e,r)=>{if(delete this.loading[n],e||!r)return o.status="done",this.loaded[n]=o,i(e);const s=r.rawData,l={};r.expires&&(l.expires=r.expires),r.cacheControl&&(l.cacheControl=r.cacheControl);const c={};if(a){const t=a.finish();t&&(c.resourceTiming=JSON.parse(JSON.stringify(t)))}o.vectorTile=r.vectorTile,o.parse(r.vectorTile,this.layerIndex,this.availableImages,this.actor,((e,r)=>{if(delete this.fetching[n],e||!r)return i(e);i(null,t.e({rawTileData:s.slice(0)},r,l,c))})),this.loaded=this.loaded||{},this.loaded[n]=o,this.fetching[n]={rawTileData:s,cacheControl:l,resourceTiming:c}}))}reloadTile(e,i){const r=this.loaded,n=e.uid;if(r&&r[n]){const a=r[n];a.showCollisionBoxes=e.showCollisionBoxes,"parsing"===a.status?a.parse(a.vectorTile,this.layerIndex,this.availableImages,this.actor,((e,r)=>{if(e||!r)return i(e,r);let a;if(this.fetching[n]){const{rawTileData:e,cacheControl:i,resourceTiming:o}=this.fetching[n];delete this.fetching[n],a=t.e({rawTileData:e.slice(0)},r,i,o)}else a=r;i(null,a)})):"done"===a.status&&(a.vectorTile?a.parse(a.vectorTile,this.layerIndex,this.availableImages,this.actor,i):i())}}abortTile(t,e){const i=this.loading,r=t.uid;i&&i[r]&&i[r].abort&&(i[r].abort(),delete i[r]),e()}removeTile(t,e){const i=this.loaded,r=t.uid;i&&i[r]&&delete i[r],e()}}class s{constructor(){this.loaded={}}loadTile(e,i){return t._(this,void 0,void 0,(function*(){const{uid:r,encoding:n,rawImageData:a,redFactor:o,greenFactor:s,blueFactor:l,baseShift:c}=e,h=a.width+2,u=a.height+2,d=t.a(a)?new t.R({width:h,height:u},yield t.bx(a,-1,-1,h,u)):a,p=new t.by(r,d,n,o,s,l,c);this.loaded=this.loaded||{},this.loaded[r]=p,i(null,p)}))}removeTile(t){const e=this.loaded,i=t.uid;e&&e[i]&&delete e[i]}}function l(t,e){if(0!==t.length){c(t[0],e);for(var i=1;i<t.length;i++)c(t[i],!e)}}function c(t,e){for(var i=0,r=0,n=0,a=t.length,o=a-1;n<a;o=n++){var s=(t[n][0]-t[o][0])*(t[o][1]+t[n][1]),l=i+s;r+=Math.abs(i)>=Math.abs(s)?i-l+s:s-l+i,i=l}i+r>=0!=!!e&&t.reverse()}var h=t.bz((function t(e,i){var r,n=e&&e.type;if("FeatureCollection"===n)for(r=0;r<e.features.length;r++)t(e.features[r],i);else if("GeometryCollection"===n)for(r=0;r<e.geometries.length;r++)t(e.geometries[r],i);else if("Feature"===n)t(e.geometry,i);else if("Polygon"===n)l(e.coordinates,i);else if("MultiPolygon"===n)for(r=0;r<e.coordinates.length;r++)l(e.coordinates[r],i);return e}));const u=t.bw.VectorTileFeature.prototype.toGeoJSON;var d={exports:{}},p=t.bA,m=t.bw.VectorTileFeature,f=g;function g(t,e){this.options=e||{},this.features=t,this.length=t.length}function y(t,e){this.id="number"==typeof t.id?t.id:void 0,this.type=t.type,this.rawGeometry=1===t.type?[t.geometry]:t.geometry,this.properties=t.tags,this.extent=e||4096}g.prototype.feature=function(t){return new y(this.features[t],this.options.extent)},y.prototype.loadGeometry=function(){var t=this.rawGeometry;this.geometry=[];for(var e=0;e<t.length;e++){for(var i=t[e],r=[],n=0;n<i.length;n++)r.push(new p(i[n][0],i[n][1]));this.geometry.push(r)}return this.geometry},y.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var t=this.geometry,e=1/0,i=-1/0,r=1/0,n=-1/0,a=0;a<t.length;a++)for(var o=t[a],s=0;s<o.length;s++){var l=o[s];e=Math.min(e,l.x),i=Math.max(i,l.x),r=Math.min(r,l.y),n=Math.max(n,l.y)}return[e,r,i,n]},y.prototype.toGeoJSON=m.prototype.toGeoJSON;var _=t.bB,v=f;function b(t){var e=new _;return function(t,e){for(var i in t.layers)e.writeMessage(3,x,t.layers[i])}(t,e),e.finish()}function x(t,e){var i;e.writeVarintField(15,t.version||1),e.writeStringField(1,t.name||""),e.writeVarintField(5,t.extent||4096);var r={keys:[],values:[],keycache:{},valuecache:{}};for(i=0;i<t.length;i++)r.feature=t.feature(i),e.writeMessage(2,w,r);var n=r.keys;for(i=0;i<n.length;i++)e.writeStringField(3,n[i]);var a=r.values;for(i=0;i<a.length;i++)e.writeMessage(4,T,a[i])}function w(t,e){var i=t.feature;void 0!==i.id&&e.writeVarintField(1,i.id),e.writeMessage(2,S,t),e.writeVarintField(3,i.type),e.writeMessage(4,A,i)}function S(t,e){var i=t.feature,r=t.keys,n=t.values,a=t.keycache,o=t.valuecache;for(var s in i.properties){var l=i.properties[s],c=a[s];if(null!==l){void 0===c&&(r.push(s),a[s]=c=r.length-1),e.writeVarint(c);var h=typeof l;"string"!==h&&"boolean"!==h&&"number"!==h&&(l=JSON.stringify(l));var u=h+":"+l,d=o[u];void 0===d&&(n.push(l),o[u]=d=n.length-1),e.writeVarint(d)}}}function k(t,e){return(e<<3)+(7&t)}function C(t){return t<<1^t>>31}function A(t,e){for(var i=t.loadGeometry(),r=t.type,n=0,a=0,o=i.length,s=0;s<o;s++){var l=i[s],c=1;1===r&&(c=l.length),e.writeVarint(k(1,c));for(var h=3===r?l.length-1:l.length,u=0;u<h;u++){1===u&&1!==r&&e.writeVarint(k(2,h-1));var d=l[u].x-n,p=l[u].y-a;e.writeVarint(C(d)),e.writeVarint(C(p)),n+=d,a+=p}3===r&&e.writeVarint(k(7,1))}}function T(t,e){var i=typeof t;"string"===i?e.writeStringField(1,t):"boolean"===i?e.writeBooleanField(7,t):"number"===i&&(t%1!=0?e.writeDoubleField(3,t):t<0?e.writeSVarintField(6,t):e.writeVarintField(5,t))}d.exports=b,d.exports.fromVectorTileJs=b,d.exports.fromGeojsonVt=function(t,e){e=e||{};var i={};for(var r in t)i[r]=new v(t[r].features,e),i[r].name=r,i[r].version=e.version,i[r].extent=e.extent;return b({layers:i})},d.exports.GeoJSONWrapper=v;var E=t.bz(d.exports);const M={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:t=>t},I=Math.fround||(z=new Float32Array(1),t=>(z[0]=+t,z[0]));var z;const P=3,L=5,D=6;class R{constructor(t){this.options=Object.assign(Object.create(M),t),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(t){const{log:e,minZoom:i,maxZoom:r}=this.options;e&&console.time("total time");const n=`prepare ${t.length} points`;e&&console.time(n),this.points=t;const a=[];for(let e=0;e<t.length;e++){const i=t[e];if(!i.geometry)continue;const[r,n]=i.geometry.coordinates,o=I(O(r)),s=I($(n));a.push(o,s,1/0,e,-1,1),this.options.reduce&&a.push(0)}let o=this.trees[r+1]=this._createTree(a);e&&console.timeEnd(n);for(let t=r;t>=i;t--){const i=+Date.now();o=this.trees[t]=this._createTree(this._cluster(o,t)),e&&console.log("z%d: %d clusters in %dms",t,o.numItems,+Date.now()-i)}return e&&console.timeEnd("total time"),this}getClusters(t,e){let i=((t[0]+180)%360+360)%360-180;const r=Math.max(-90,Math.min(90,t[1]));let n=180===t[2]?180:((t[2]+180)%360+360)%360-180;const a=Math.max(-90,Math.min(90,t[3]));if(t[2]-t[0]>=360)i=-180,n=180;else if(i>n){const t=this.getClusters([i,r,180,a],e),o=this.getClusters([-180,r,n,a],e);return t.concat(o)}const o=this.trees[this._limitZoom(e)],s=o.range(O(i),$(a),O(n),$(r)),l=o.data,c=[];for(const t of s){const e=this.stride*t;c.push(l[e+L]>1?B(l,e,this.clusterProps):this.points[l[e+P]])}return c}getChildren(t){const e=this._getOriginId(t),i=this._getOriginZoom(t),r="No cluster with the specified id.",n=this.trees[i];if(!n)throw new Error(r);const a=n.data;if(e*this.stride>=a.length)throw new Error(r);const o=this.options.radius/(this.options.extent*Math.pow(2,i-1)),s=n.within(a[e*this.stride],a[e*this.stride+1],o),l=[];for(const e of s){const i=e*this.stride;a[i+4]===t&&l.push(a[i+L]>1?B(a,i,this.clusterProps):this.points[a[i+P]])}if(0===l.length)throw new Error(r);return l}getLeaves(t,e,i){const r=[];return this._appendLeaves(r,t,e=e||10,i=i||0,0),r}getTile(t,e,i){const r=this.trees[this._limitZoom(t)],n=Math.pow(2,t),{extent:a,radius:o}=this.options,s=o/a,l=(i-s)/n,c=(i+1+s)/n,h={features:[]};return this._addTileFeatures(r.range((e-s)/n,l,(e+1+s)/n,c),r.data,e,i,n,h),0===e&&this._addTileFeatures(r.range(1-s/n,l,1,c),r.data,n,i,n,h),e===n-1&&this._addTileFeatures(r.range(0,l,s/n,c),r.data,-1,i,n,h),h.features.length?h:null}getClusterExpansionZoom(t){let e=this._getOriginZoom(t)-1;for(;e<=this.options.maxZoom;){const i=this.getChildren(t);if(e++,1!==i.length)break;t=i[0].properties.cluster_id}return e}_appendLeaves(t,e,i,r,n){const a=this.getChildren(e);for(const e of a){const a=e.properties;if(a&&a.cluster?n+a.point_count<=r?n+=a.point_count:n=this._appendLeaves(t,a.cluster_id,i,r,n):n<r?n++:t.push(e),t.length===i)break}return n}_createTree(e){const i=new t.av(e.length/this.stride|0,this.options.nodeSize,Float32Array);for(let t=0;t<e.length;t+=this.stride)i.add(e[t],e[t+1]);return i.finish(),i.data=e,i}_addTileFeatures(t,e,i,r,n,a){for(const o of t){const t=o*this.stride,s=e[t+L]>1;let l,c,h;if(s)l=F(e,t,this.clusterProps),c=e[t],h=e[t+1];else{const i=this.points[e[t+P]];l=i.properties;const[r,n]=i.geometry.coordinates;c=O(r),h=$(n)}const u={type:1,geometry:[[Math.round(this.options.extent*(c*n-i)),Math.round(this.options.extent*(h*n-r))]],tags:l};let d;d=s||this.options.generateId?e[t+P]:this.points[e[t+P]].id,void 0!==d&&(u.id=d),a.features.push(u)}}_limitZoom(t){return Math.max(this.options.minZoom,Math.min(Math.floor(+t),this.options.maxZoom+1))}_cluster(t,e){const{radius:i,extent:r,reduce:n,minPoints:a}=this.options,o=i/(r*Math.pow(2,e)),s=t.data,l=[],c=this.stride;for(let i=0;i<s.length;i+=c){if(s[i+2]<=e)continue;s[i+2]=e;const r=s[i],h=s[i+1],u=t.within(s[i],s[i+1],o),d=s[i+L];let p=d;for(const t of u){const i=t*c;s[i+2]>e&&(p+=s[i+L])}if(p>d&&p>=a){let t,a=r*d,o=h*d,m=-1;const f=((i/c|0)<<5)+(e+1)+this.points.length;for(const r of u){const l=r*c;if(s[l+2]<=e)continue;s[l+2]=e;const h=s[l+L];a+=s[l]*h,o+=s[l+1]*h,s[l+4]=f,n&&(t||(t=this._map(s,i,!0),m=this.clusterProps.length,this.clusterProps.push(t)),n(t,this._map(s,l)))}s[i+4]=f,l.push(a/p,o/p,1/0,f,-1,p),n&&l.push(m)}else{for(let t=0;t<c;t++)l.push(s[i+t]);if(p>1)for(const t of u){const i=t*c;if(!(s[i+2]<=e)){s[i+2]=e;for(let t=0;t<c;t++)l.push(s[i+t])}}}}return l}_getOriginId(t){return t-this.points.length>>5}_getOriginZoom(t){return(t-this.points.length)%32}_map(t,e,i){if(t[e+L]>1){const r=this.clusterProps[t[e+D]];return i?Object.assign({},r):r}const r=this.points[t[e+P]].properties,n=this.options.map(r);return i&&n===r?Object.assign({},n):n}}function B(t,e,i){return{type:"Feature",id:t[e+P],properties:F(t,e,i),geometry:{type:"Point",coordinates:[(r=t[e],360*(r-.5)),V(t[e+1])]}};var r}function F(t,e,i){const r=t[e+L],n=r>=1e4?`${Math.round(r/1e3)}k`:r>=1e3?Math.round(r/100)/10+"k":r,a=t[e+D],o=-1===a?{}:Object.assign({},i[a]);return Object.assign(o,{cluster:!0,cluster_id:t[e+P],point_count:r,point_count_abbreviated:n})}function O(t){return t/360+.5}function $(t){const e=Math.sin(t*Math.PI/180),i=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return i<0?0:i>1?1:i}function V(t){const e=(180-360*t)*Math.PI/180;return 360*Math.atan(Math.exp(e))/Math.PI-90}function N(t,e,i,r){for(var n,a=r,o=i-e>>1,s=i-e,l=t[e],c=t[e+1],h=t[i],u=t[i+1],d=e+3;d<i;d+=3){var p=j(t[d],t[d+1],l,c,h,u);if(p>a)n=d,a=p;else if(p===a){var m=Math.abs(d-o);m<s&&(n=d,s=m)}}a>r&&(n-e>3&&N(t,e,n,r),t[n+2]=a,i-n>3&&N(t,n,i,r))}function j(t,e,i,r,n,a){var o=n-i,s=a-r;if(0!==o||0!==s){var l=((t-i)*o+(e-r)*s)/(o*o+s*s);l>1?(i=n,r=a):l>0&&(i+=o*l,r+=s*l)}return(o=t-i)*o+(s=e-r)*s}function U(t,e,i,r){var n={id:void 0===t?null:t,type:e,geometry:i,tags:r,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(t){var e=t.geometry,i=t.type;if("Point"===i||"MultiPoint"===i||"LineString"===i)Z(t,e);else if("Polygon"===i||"MultiLineString"===i)for(var r=0;r<e.length;r++)Z(t,e[r]);else if("MultiPolygon"===i)for(r=0;r<e.length;r++)for(var n=0;n<e[r].length;n++)Z(t,e[r][n])}(n),n}function Z(t,e){for(var i=0;i<e.length;i+=3)t.minX=Math.min(t.minX,e[i]),t.minY=Math.min(t.minY,e[i+1]),t.maxX=Math.max(t.maxX,e[i]),t.maxY=Math.max(t.maxY,e[i+1])}function H(t,e,i,r){if(e.geometry){var n=e.geometry.coordinates,a=e.geometry.type,o=Math.pow(i.tolerance/((1<<i.maxZoom)*i.extent),2),s=[],l=e.id;if(i.promoteId?l=e.properties[i.promoteId]:i.generateId&&(l=r||0),"Point"===a)q(n,s);else if("MultiPoint"===a)for(var c=0;c<n.length;c++)q(n[c],s);else if("LineString"===a)G(n,s,o,!1);else if("MultiLineString"===a){if(i.lineMetrics){for(c=0;c<n.length;c++)G(n[c],s=[],o,!1),t.push(U(l,"LineString",s,e.properties));return}W(n,s,o,!1)}else if("Polygon"===a)W(n,s,o,!0);else{if("MultiPolygon"!==a){if("GeometryCollection"===a){for(c=0;c<e.geometry.geometries.length;c++)H(t,{id:l,geometry:e.geometry.geometries[c],properties:e.properties},i,r);return}throw new Error("Input data is not a valid GeoJSON object.")}for(c=0;c<n.length;c++){var h=[];W(n[c],h,o,!0),s.push(h)}}t.push(U(l,a,s,e.properties))}}function q(t,e){e.push(X(t[0])),e.push(K(t[1])),e.push(0)}function G(t,e,i,r){for(var n,a,o=0,s=0;s<t.length;s++){var l=X(t[s][0]),c=K(t[s][1]);e.push(l),e.push(c),e.push(0),s>0&&(o+=r?(n*c-l*a)/2:Math.sqrt(Math.pow(l-n,2)+Math.pow(c-a,2))),n=l,a=c}var h=e.length-3;e[2]=1,N(e,0,h,i),e[h+2]=1,e.size=Math.abs(o),e.start=0,e.end=e.size}function W(t,e,i,r){for(var n=0;n<t.length;n++){var a=[];G(t[n],a,i,r),e.push(a)}}function X(t){return t/360+.5}function K(t){var e=Math.sin(t*Math.PI/180),i=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return i<0?0:i>1?1:i}function J(t,e,i,r,n,a,o,s){if(r/=e,a>=(i/=e)&&o<r)return t;if(o<i||a>=r)return null;for(var l=[],c=0;c<t.length;c++){var h=t[c],u=h.geometry,d=h.type,p=0===n?h.minX:h.minY,m=0===n?h.maxX:h.maxY;if(p>=i&&m<r)l.push(h);else if(!(m<i||p>=r)){var f=[];if("Point"===d||"MultiPoint"===d)Y(u,f,i,r,n);else if("LineString"===d)Q(u,f,i,r,n,!1,s.lineMetrics);else if("MultiLineString"===d)et(u,f,i,r,n,!1);else if("Polygon"===d)et(u,f,i,r,n,!0);else if("MultiPolygon"===d)for(var g=0;g<u.length;g++){var y=[];et(u[g],y,i,r,n,!0),y.length&&f.push(y)}if(f.length){if(s.lineMetrics&&"LineString"===d){for(g=0;g<f.length;g++)l.push(U(h.id,d,f[g],h.tags));continue}"LineString"!==d&&"MultiLineString"!==d||(1===f.length?(d="LineString",f=f[0]):d="MultiLineString"),"Point"!==d&&"MultiPoint"!==d||(d=3===f.length?"Point":"MultiPoint"),l.push(U(h.id,d,f,h.tags))}}}return l.length?l:null}function Y(t,e,i,r,n){for(var a=0;a<t.length;a+=3){var o=t[a+n];o>=i&&o<=r&&(e.push(t[a]),e.push(t[a+1]),e.push(t[a+2]))}}function Q(t,e,i,r,n,a,o){for(var s,l,c=tt(t),h=0===n?rt:nt,u=t.start,d=0;d<t.length-3;d+=3){var p=t[d],m=t[d+1],f=t[d+2],g=t[d+3],y=t[d+4],_=0===n?p:m,v=0===n?g:y,b=!1;o&&(s=Math.sqrt(Math.pow(p-g,2)+Math.pow(m-y,2))),_<i?v>i&&(l=h(c,p,m,g,y,i),o&&(c.start=u+s*l)):_>r?v<r&&(l=h(c,p,m,g,y,r),o&&(c.start=u+s*l)):it(c,p,m,f),v<i&&_>=i&&(l=h(c,p,m,g,y,i),b=!0),v>r&&_<=r&&(l=h(c,p,m,g,y,r),b=!0),!a&&b&&(o&&(c.end=u+s*l),e.push(c),c=tt(t)),o&&(u+=s)}var x=t.length-3;p=t[x],m=t[x+1],f=t[x+2],(_=0===n?p:m)>=i&&_<=r&&it(c,p,m,f),x=c.length-3,a&&x>=3&&(c[x]!==c[0]||c[x+1]!==c[1])&&it(c,c[0],c[1],c[2]),c.length&&e.push(c)}function tt(t){var e=[];return e.size=t.size,e.start=t.start,e.end=t.end,e}function et(t,e,i,r,n,a){for(var o=0;o<t.length;o++)Q(t[o],e,i,r,n,a,!1)}function it(t,e,i,r){t.push(e),t.push(i),t.push(r)}function rt(t,e,i,r,n,a){var o=(a-e)/(r-e);return t.push(a),t.push(i+(n-i)*o),t.push(1),o}function nt(t,e,i,r,n,a){var o=(a-i)/(n-i);return t.push(e+(r-e)*o),t.push(a),t.push(1),o}function at(t,e){for(var i=[],r=0;r<t.length;r++){var n,a=t[r],o=a.type;if("Point"===o||"MultiPoint"===o||"LineString"===o)n=ot(a.geometry,e);else if("MultiLineString"===o||"Polygon"===o){n=[];for(var s=0;s<a.geometry.length;s++)n.push(ot(a.geometry[s],e))}else if("MultiPolygon"===o)for(n=[],s=0;s<a.geometry.length;s++){for(var l=[],c=0;c<a.geometry[s].length;c++)l.push(ot(a.geometry[s][c],e));n.push(l)}i.push(U(a.id,o,n,a.tags))}return i}function ot(t,e){var i=[];i.size=t.size,void 0!==t.start&&(i.start=t.start,i.end=t.end);for(var r=0;r<t.length;r+=3)i.push(t[r]+e,t[r+1],t[r+2]);return i}function st(t,e){if(t.transformed)return t;var i,r,n,a=1<<t.z,o=t.x,s=t.y;for(i=0;i<t.features.length;i++){var l=t.features[i],c=l.geometry,h=l.type;if(l.geometry=[],1===h)for(r=0;r<c.length;r+=2)l.geometry.push(lt(c[r],c[r+1],e,a,o,s));else for(r=0;r<c.length;r++){var u=[];for(n=0;n<c[r].length;n+=2)u.push(lt(c[r][n],c[r][n+1],e,a,o,s));l.geometry.push(u)}}return t.transformed=!0,t}function lt(t,e,i,r,n,a){return[Math.round(i*(t*r-n)),Math.round(i*(e*r-a))]}function ct(t,e,i,r,n){for(var a=e===n.maxZoom?0:n.tolerance/((1<<e)*n.extent),o={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:i,y:r,z:e,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},s=0;s<t.length;s++){o.numFeatures++,ht(o,t[s],a,n);var l=t[s].minX,c=t[s].minY,h=t[s].maxX,u=t[s].maxY;l<o.minX&&(o.minX=l),c<o.minY&&(o.minY=c),h>o.maxX&&(o.maxX=h),u>o.maxY&&(o.maxY=u)}return o}function ht(t,e,i,r){var n=e.geometry,a=e.type,o=[];if("Point"===a||"MultiPoint"===a)for(var s=0;s<n.length;s+=3)o.push(n[s]),o.push(n[s+1]),t.numPoints++,t.numSimplified++;else if("LineString"===a)ut(o,n,t,i,!1,!1);else if("MultiLineString"===a||"Polygon"===a)for(s=0;s<n.length;s++)ut(o,n[s],t,i,"Polygon"===a,0===s);else if("MultiPolygon"===a)for(var l=0;l<n.length;l++){var c=n[l];for(s=0;s<c.length;s++)ut(o,c[s],t,i,!0,0===s)}if(o.length){var h=e.tags||null;if("LineString"===a&&r.lineMetrics){for(var u in h={},e.tags)h[u]=e.tags[u];h.mapbox_clip_start=n.start/n.size,h.mapbox_clip_end=n.end/n.size}var d={geometry:o,type:"Polygon"===a||"MultiPolygon"===a?3:"LineString"===a||"MultiLineString"===a?2:1,tags:h};null!==e.id&&(d.id=e.id),t.features.push(d)}}function ut(t,e,i,r,n,a){var o=r*r;if(r>0&&e.size<(n?o:r))i.numPoints+=e.length/3;else{for(var s=[],l=0;l<e.length;l+=3)(0===r||e[l+2]>o)&&(i.numSimplified++,s.push(e[l]),s.push(e[l+1])),i.numPoints++;n&&function(t,e){for(var i=0,r=0,n=t.length,a=n-2;r<n;a=r,r+=2)i+=(t[r]-t[a])*(t[r+1]+t[a+1]);if(i>0===e)for(r=0,n=t.length;r<n/2;r+=2){var o=t[r],s=t[r+1];t[r]=t[n-2-r],t[r+1]=t[n-1-r],t[n-2-r]=o,t[n-1-r]=s}}(s,a),t.push(s)}}function dt(t,e){var i=(e=this.options=function(t,e){for(var i in e)t[i]=e[i];return t}(Object.create(this.options),e)).debug;if(i&&console.time("preprocess data"),e.maxZoom<0||e.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(e.promoteId&&e.generateId)throw new Error("promoteId and generateId cannot be used together.");var r=function(t,e){var i=[];if("FeatureCollection"===t.type)for(var r=0;r<t.features.length;r++)H(i,t.features[r],e,r);else H(i,"Feature"===t.type?t:{geometry:t},e);return i}(t,e);this.tiles={},this.tileCoords=[],i&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",e.indexMaxZoom,e.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),r=function(t,e){var i=e.buffer/e.extent,r=t,n=J(t,1,-1-i,i,0,-1,2,e),a=J(t,1,1-i,2+i,0,-1,2,e);return(n||a)&&(r=J(t,1,-i,1+i,0,-1,2,e)||[],n&&(r=at(n,1).concat(r)),a&&(r=r.concat(at(a,-1)))),r}(r,e),r.length&&this.splitTile(r,0,0,0),i&&(r.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function pt(t,e,i){return 32*((1<<t)*i+e)+t}function mt(t,e){return e?t.properties[e]:t.id}function ft(t,e){if(null==t)return!0;if("Feature"===t.type)return null!=mt(t,e);if("FeatureCollection"===t.type){const i=new Set;for(const r of t.features){const t=mt(r,e);if(null==t)return!1;if(i.has(t))return!1;i.add(t)}return!0}return!1}function gt(t,e){const i=new Map;if(null==t);else if("Feature"===t.type)i.set(mt(t,e),t);else for(const r of t.features)i.set(mt(r,e),r);return i}dt.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},dt.prototype.splitTile=function(t,e,i,r,n,a,o){for(var s=[t,e,i,r],l=this.options,c=l.debug;s.length;){r=s.pop(),i=s.pop(),e=s.pop(),t=s.pop();var h=1<<e,u=pt(e,i,r),d=this.tiles[u];if(!d&&(c>1&&console.time("creation"),d=this.tiles[u]=ct(t,e,i,r,l),this.tileCoords.push({z:e,x:i,y:r}),c)){c>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",e,i,r,d.numFeatures,d.numPoints,d.numSimplified),console.timeEnd("creation"));var p="z"+e;this.stats[p]=(this.stats[p]||0)+1,this.total++}if(d.source=t,n){if(e===l.maxZoom||e===n)continue;var m=1<<n-e;if(i!==Math.floor(a/m)||r!==Math.floor(o/m))continue}else if(e===l.indexMaxZoom||d.numPoints<=l.indexMaxPoints)continue;if(d.source=null,0!==t.length){c>1&&console.time("clipping");var f,g,y,_,v,b,x=.5*l.buffer/l.extent,w=.5-x,S=.5+x,k=1+x;f=g=y=_=null,v=J(t,h,i-x,i+S,0,d.minX,d.maxX,l),b=J(t,h,i+w,i+k,0,d.minX,d.maxX,l),t=null,v&&(f=J(v,h,r-x,r+S,1,d.minY,d.maxY,l),g=J(v,h,r+w,r+k,1,d.minY,d.maxY,l),v=null),b&&(y=J(b,h,r-x,r+S,1,d.minY,d.maxY,l),_=J(b,h,r+w,r+k,1,d.minY,d.maxY,l),b=null),c>1&&console.timeEnd("clipping"),s.push(f||[],e+1,2*i,2*r),s.push(g||[],e+1,2*i,2*r+1),s.push(y||[],e+1,2*i+1,2*r),s.push(_||[],e+1,2*i+1,2*r+1)}}},dt.prototype.getTile=function(t,e,i){var r=this.options,n=r.extent,a=r.debug;if(t<0||t>24)return null;var o=1<<t,s=pt(t,e=(e%o+o)%o,i);if(this.tiles[s])return st(this.tiles[s],n);a>1&&console.log("drilling down to z%d-%d-%d",t,e,i);for(var l,c=t,h=e,u=i;!l&&c>0;)c--,h=Math.floor(h/2),u=Math.floor(u/2),l=this.tiles[pt(c,h,u)];return l&&l.source?(a>1&&console.log("found parent tile z%d-%d-%d",c,h,u),a>1&&console.time("drilling down"),this.splitTile(l.source,c,h,u,t,e,i),a>1&&console.timeEnd("drilling down"),this.tiles[s]?st(this.tiles[s],n):null):null};class yt extends o{constructor(e,i,r,n){super(e,i,r),this._dataUpdateable=new Map,this.loadGeoJSON=(e,i)=>{const{promoteId:r}=e;if(e.request)return t.f(e.request,((t,e,n,a)=>{this._dataUpdateable=ft(e,r)?gt(e,r):void 0,i(t,e,n,a)}));if("string"==typeof e.data)try{const t=JSON.parse(e.data);this._dataUpdateable=ft(t,r)?gt(t,r):void 0,i(null,t)}catch(t){i(new Error(`Input data given to '${e.source}' is not a valid GeoJSON object.`))}else e.dataDiff?this._dataUpdateable?(function(t,e,i){var r,n,a,o;if(e.removeAll&&t.clear(),e.remove)for(const i of e.remove)t.delete(i);if(e.add)for(const r of e.add){const e=mt(r,i);null!=e&&t.set(e,r)}if(e.update)for(const i of e.update){let e=t.get(i.id);if(null==e)continue;const s=!i.removeAllProperties&&((null===(r=i.removeProperties)||void 0===r?void 0:r.length)>0||(null===(n=i.addOrUpdateProperties)||void 0===n?void 0:n.length)>0);if((i.newGeometry||i.removeAllProperties||s)&&(e=Object.assign({},e),t.set(i.id,e),s&&(e.properties=Object.assign({},e.properties))),i.newGeometry&&(e.geometry=i.newGeometry),i.removeAllProperties)e.properties={};else if((null===(a=i.removeProperties)||void 0===a?void 0:a.length)>0)for(const t of i.removeProperties)Object.prototype.hasOwnProperty.call(e.properties,t)&&delete e.properties[t];if((null===(o=i.addOrUpdateProperties)||void 0===o?void 0:o.length)>0)for(const{key:t,value:r}of i.addOrUpdateProperties)e.properties[t]=r}}(this._dataUpdateable,e.dataDiff,r),i(null,{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())})):i(new Error(`Cannot update existing geojson data in ${e.source}`)):i(new Error(`Input data given to '${e.source}' is not a valid GeoJSON object.`));return{cancel:()=>{}}},this.loadVectorData=this.loadGeoJSONTile,n&&(this.loadGeoJSON=n)}loadGeoJSONTile(e,i){const r=e.tileID.canonical;if(!this._geoJSONIndex)return i(null,null);const n=this._geoJSONIndex.getTile(r.z,r.x,r.y);if(!n)return i(null,null);const a=new class{constructor(e){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=t.N,this.length=e.length,this._features=e}feature(e){return new class{constructor(e){this._feature=e,this.extent=t.N,this.type=e.type,this.properties=e.tags,"id"in e&&!isNaN(e.id)&&(this.id=parseInt(e.id,10))}loadGeometry(){if(1===this._feature.type){const e=[];for(const i of this._feature.geometry)e.push([new t.P(i[0],i[1])]);return e}{const e=[];for(const i of this._feature.geometry){const r=[];for(const e of i)r.push(new t.P(e[0],e[1]));e.push(r)}return e}}toGeoJSON(t,e,i){return u.call(this,t,e,i)}}(this._features[e])}}(n.features);let o=E(a);0===o.byteOffset&&o.byteLength===o.buffer.byteLength||(o=new Uint8Array(o)),i(null,{vectorTile:a,rawData:o.buffer})}loadData(e,i){var r;null===(r=this._pendingRequest)||void 0===r||r.cancel(),this._pendingCallback&&this._pendingCallback(null,{abandoned:!0});const n=!!(e&&e.request&&e.request.collectResourceTiming)&&new t.bu(e.request);this._pendingCallback=i,this._pendingRequest=this.loadGeoJSON(e,((r,a)=>{if(delete this._pendingCallback,delete this._pendingRequest,r||!a)return i(r);if("object"!=typeof a)return i(new Error(`Input data given to '${e.source}' is not a valid GeoJSON object.`));{h(a,!0);try{if(e.filter){const i=t.bC(e.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===i.result)throw new Error(i.value.map((t=>`${t.key}: ${t.message}`)).join(", "));const r=a.features.filter((t=>i.value.evaluate({zoom:0},t)));a={type:"FeatureCollection",features:r}}this._geoJSONIndex=e.cluster?new R(function({superclusterOptions:e,clusterProperties:i}){if(!i||!e)return e;const r={},n={},a={accumulated:null,zoom:0},o={properties:null},s=Object.keys(i);for(const e of s){const[a,o]=i[e],s=t.bC(o),l=t.bC("string"==typeof a?[a,["accumulated"],["get",e]]:a);r[e]=s.value,n[e]=l.value}return e.map=t=>{o.properties=t;const e={};for(const t of s)e[t]=r[t].evaluate(a,o);return e},e.reduce=(t,e)=>{o.properties=e;for(const e of s)a.accumulated=t[e],t[e]=n[e].evaluate(a,o)},e}(e)).load(a.features):function(t,e){return new dt(t,e)}(a,e.geojsonVtOptions)}catch(r){return i(r)}this.loaded={};const o={};if(n){const t=n.finish();t&&(o.resourceTiming={},o.resourceTiming[e.source]=JSON.parse(JSON.stringify(t)))}i(null,o)}}))}reloadTile(t,e){const i=this.loaded;return i&&i[t.uid]?super.reloadTile(t,e):this.loadTile(t,e)}removeSource(t,e){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),e()}getClusterExpansionZoom(t,e){try{e(null,this._geoJSONIndex.getClusterExpansionZoom(t.clusterId))}catch(t){e(t)}}getClusterChildren(t,e){try{e(null,this._geoJSONIndex.getChildren(t.clusterId))}catch(t){e(t)}}getClusterLeaves(t,e){try{e(null,this._geoJSONIndex.getLeaves(t.clusterId,t.limit,t.offset))}catch(t){e(t)}}}class _t{constructor(e){this.self=e,this.actor=new t.C(e,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:o,geojson:yt},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(t,e)=>{if(this.workerSourceTypes[t])throw new Error(`Worker source with name "${t}" already registered.`);this.workerSourceTypes[t]=e},this.self.registerRTLTextPlugin=e=>{if(t.bD.isParsed())throw new Error("RTL text plugin already registered.");t.bD.applyArabicShaping=e.applyArabicShaping,t.bD.processBidirectionalText=e.processBidirectionalText,t.bD.processStyledBidirectionalText=e.processStyledBidirectionalText}}setReferrer(t,e){this.referrer=e}setImages(t,e,i){this.availableImages[t]=e;for(const i in this.workerSources[t]){const r=this.workerSources[t][i];for(const t in r)r[t].availableImages=e}i()}setLayers(t,e,i){this.getLayerIndex(t).replace(e),i()}updateLayers(t,e,i){this.getLayerIndex(t).update(e.layers,e.removedIds),i()}loadTile(t,e,i){this.getWorkerSource(t,e.type,e.source).loadTile(e,i)}loadDEMTile(t,e,i){this.getDEMWorkerSource(t,e.source).loadTile(e,i)}reloadTile(t,e,i){this.getWorkerSource(t,e.type,e.source).reloadTile(e,i)}abortTile(t,e,i){this.getWorkerSource(t,e.type,e.source).abortTile(e,i)}removeTile(t,e,i){this.getWorkerSource(t,e.type,e.source).removeTile(e,i)}removeDEMTile(t,e){this.getDEMWorkerSource(t,e.source).removeTile(e)}removeSource(t,e,i){if(!this.workerSources[t]||!this.workerSources[t][e.type]||!this.workerSources[t][e.type][e.source])return;const r=this.workerSources[t][e.type][e.source];delete this.workerSources[t][e.type][e.source],void 0!==r.removeSource?r.removeSource(e,i):i()}loadWorkerSource(t,e,i){try{this.self.importScripts(e.url),i()}catch(t){i(t.toString())}}syncRTLPluginState(e,i,r){try{t.bD.setState(i);const e=t.bD.getPluginURL();if(t.bD.isLoaded()&&!t.bD.isParsed()&&null!=e){this.self.importScripts(e);const i=t.bD.isParsed();r(i?void 0:new Error(`RTL Text Plugin failed to import scripts from ${e}`),i)}}catch(t){r(t.toString())}}getAvailableImages(t){let e=this.availableImages[t];return e||(e=[]),e}getLayerIndex(t){let i=this.layerIndexes[t];return i||(i=this.layerIndexes[t]=new e),i}getWorkerSource(t,e,i){return this.workerSources[t]||(this.workerSources[t]={}),this.workerSources[t][e]||(this.workerSources[t][e]={}),this.workerSources[t][e][i]||(this.workerSources[t][e][i]=new this.workerSourceTypes[e]({send:(e,i,r)=>{this.actor.send(e,i,r,t)}},this.getLayerIndex(t),this.getAvailableImages(t))),this.workerSources[t][e][i]}getDEMWorkerSource(t,e){return this.demWorkerSources[t]||(this.demWorkerSources[t]={}),this.demWorkerSources[t][e]||(this.demWorkerSources[t][e]=new s),this.demWorkerSources[t][e]}}return t.i()&&(self.worker=new _t(self)),_t})),r(["./shared"],(function(t){var e="3.6.2";class i{static testProp(t){if(!i.docStyle)return t[0];for(let e=0;e<t.length;e++)if(t[e]in i.docStyle)return t[e];return t[0]}static create(t,e,i){const r=window.document.createElement(t);return void 0!==e&&(r.className=e),i&&i.appendChild(r),r}static createNS(t,e){return window.document.createElementNS(t,e)}static disableDrag(){i.docStyle&&i.selectProp&&(i.userSelect=i.docStyle[i.selectProp],i.docStyle[i.selectProp]="none")}static enableDrag(){i.docStyle&&i.selectProp&&(i.docStyle[i.selectProp]=i.userSelect)}static setTransform(t,e){t.style[i.transformProp]=e}static addEventListener(t,e,i,r={}){t.addEventListener(e,i,"passive"in r?r:r.capture)}static removeEventListener(t,e,i,r={}){t.removeEventListener(e,i,"passive"in r?r:r.capture)}static suppressClickInternal(t){t.preventDefault(),t.stopPropagation(),window.removeEventListener("click",i.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",i.suppressClickInternal,!0),window.setTimeout((()=>{window.removeEventListener("click",i.suppressClickInternal,!0)}),0)}static mousePos(e,i){const r=e.getBoundingClientRect();return new t.P(i.clientX-r.left-e.clientLeft,i.clientY-r.top-e.clientTop)}static touchPos(e,i){const r=e.getBoundingClientRect(),n=[];for(let a=0;a<i.length;a++)n.push(new t.P(i[a].clientX-r.left-e.clientLeft,i[a].clientY-r.top-e.clientTop));return n}static mouseButton(t){return t.button}static remove(t){t.parentNode&&t.parentNode.removeChild(t)}}i.docStyle="undefined"!=typeof window&&window.document&&window.document.documentElement.style,i.selectProp=i.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),i.transformProp=i.testProp(["transform","WebkitTransform"]);const r={supported:!1,testSupport:function(t){!o&&a&&(s?l(t):n=t)}};let n,a,o=!1,s=!1;function l(t){const e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e);try{if(t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,a),t.isContextLost())return;r.supported=!0}catch(t){}t.deleteTexture(e),o=!0}var c,h;"undefined"!=typeof document&&(a=document.createElement("img"),a.onload=function(){n&&l(n),n=null,s=!0},a.onerror=function(){o=!0,n=null},a.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(e){let i,n,a,o;e.resetRequestQueue=()=>{i=[],n=0,a=0,o={}},e.addThrottleControl=t=>{const e=a++;return o[e]=t,e},e.removeThrottleControl=t=>{delete o[t],c()},e.getImage=(t,e,a=!0)=>{r.supported&&(t.headers||(t.headers={}),t.headers.accept="image/webp,*/*");const o={requestParameters:t,supportImageRefresh:a,callback:e,cancelled:!1,completed:!1,cancel:()=>{o.completed||o.cancelled||(o.cancelled=!0,o.innerRequest&&(o.innerRequest.cancel(),n--),c())}};return i.push(o),c(),o};const s=e=>{const{requestParameters:i,supportImageRefresh:r,callback:n}=e;return t.e(i,{type:"image"}),(!1!==r||t.i()||t.g(i.url)||i.headers&&!Object.keys(i.headers).reduce(((t,e)=>t&&"accept"===e),!0)?t.m:h)(i,((t,i,r,a)=>{l(e,n,t,i,r,a)}))},l=(e,i,r,a,o,s)=>{r?i(r):a instanceof HTMLImageElement||t.a(a)?i(null,a):a&&((e,i)=>{"function"==typeof createImageBitmap?t.b(e,i):t.d(e,i)})(a,((t,e)=>{null!=t?i(t):null!=e&&i(null,e,{cacheControl:o,expires:s})})),e.cancelled||(e.completed=!0,n--,c())},c=()=>{const e=(()=>{const t=Object.keys(o);let e=!1;if(t.length>0)for(const i of t)if(e=o[i](),e)break;return e})()?t.c.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:t.c.MAX_PARALLEL_IMAGE_REQUESTS;for(let t=n;t<e&&i.length>0;t++){const e=i.shift();if(e.cancelled){t--;continue}const r=s(e);n++,e.innerRequest=r}},h=(e,i)=>{const r=new Image,n=e.url;let a=!1;const o=e.credentials;return o&&"include"===o?r.crossOrigin="use-credentials":(o&&"same-origin"===o||!t.s(n))&&(r.crossOrigin="anonymous"),r.fetchPriority="high",r.onload=()=>{i(null,r),r.onerror=r.onload=null},r.onerror=()=>{a||i(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.")),r.onerror=r.onload=null},r.src=n,{cancel:()=>{a=!0,r.src=""}}}}(c||(c={})),c.resetRequestQueue(),function(t){t.Glyphs="Glyphs",t.Image="Image",t.Source="Source",t.SpriteImage="SpriteImage",t.SpriteJSON="SpriteJSON",t.Style="Style",t.Tile="Tile",t.Unknown="Unknown"}(h||(h={}));class u{constructor(t){this._transformRequestFn=t}transformRequest(t,e){return this._transformRequestFn&&this._transformRequestFn(t,e)||{url:t}}normalizeSpriteURL(t,e,i){const r=function(t){const e=t.match(d);if(!e)throw new Error(`Unable to parse URL "${t}"`);return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}(t);return r.path+=`${e}${i}`,function(t){const e=t.params.length?`?${t.params.join("&")}`:"";return`${t.protocol}://${t.authority}${t.path}${e}`}(r)}setTransformRequest(t){this._transformRequestFn=t}}const d=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function p(e){var i=new t.A(3);return i[0]=e[0],i[1]=e[1],i[2]=e[2],i}var m,f=function(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t};m=new t.A(3),t.A!=Float32Array&&(m[0]=0,m[1]=0,m[2]=0);var g=function(t){var e=t[0],i=t[1];return e*e+i*i};function y(t){const e=[];if("string"==typeof t)e.push({id:"default",url:t});else if(t&&t.length>0){const i=[];for(const{id:r,url:n}of t){const t=`${r}${n}`;-1===i.indexOf(t)&&(i.push(t),e.push({id:r,url:n}))}}return e}function _(e,i,r,n,a){if(n)return void e(n);if(a!==Object.values(i).length||a!==Object.values(r).length)return;const o={};for(const e in i){o[e]={};const n=t.h.getImageCanvasContext(r[e]),a=i[e];for(const t in a){const{width:i,height:r,x:s,y:l,sdf:c,pixelRatio:h,stretchX:u,stretchY:d,content:p}=a[t];o[e][t]={data:null,pixelRatio:h,sdf:c,stretchX:u,stretchY:d,content:p,spriteData:{width:i,height:r,x:s,y:l,context:n}}}}e(null,o)}!function(){var e=new t.A(2);t.A!=Float32Array&&(e[0]=0,e[1]=0)}();class v{constructor(t,e,i,r){this.context=t,this.format=i,this.texture=t.gl.createTexture(),this.update(e,r)}update(e,i,r){const{width:n,height:a}=e,o=!(this.size&&this.size[0]===n&&this.size[1]===a||r),{context:s}=this,{gl:l}=s;if(this.useMipmap=Boolean(i&&i.useMipmap),l.bindTexture(l.TEXTURE_2D,this.texture),s.pixelStoreUnpackFlipY.set(!1),s.pixelStoreUnpack.set(1),s.pixelStoreUnpackPremultiplyAlpha.set(this.format===l.RGBA&&(!i||!1!==i.premultiply)),o)this.size=[n,a],e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||t.a(e)?l.texImage2D(l.TEXTURE_2D,0,this.format,this.format,l.UNSIGNED_BYTE,e):l.texImage2D(l.TEXTURE_2D,0,this.format,n,a,0,this.format,l.UNSIGNED_BYTE,e.data);else{const{x:i,y:o}=r||{x:0,y:0};e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||t.a(e)?l.texSubImage2D(l.TEXTURE_2D,0,i,o,l.RGBA,l.UNSIGNED_BYTE,e):l.texSubImage2D(l.TEXTURE_2D,0,i,o,n,a,l.RGBA,l.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&l.generateMipmap(l.TEXTURE_2D)}bind(t,e,i){const{context:r}=this,{gl:n}=r;n.bindTexture(n.TEXTURE_2D,this.texture),i!==n.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(i=n.LINEAR),t!==this.filter&&(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,t),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,i||t),this.filter=t),e!==this.wrap&&(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,e),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,e),this.wrap=e)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}function b(t){const{userImage:e}=t;return!!(e&&e.render&&e.render())&&(t.data.replace(new Uint8Array(e.data.buffer)),!0)}class x extends t.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new t.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(t){if(this.loaded!==t&&(this.loaded=t,t)){for(const{ids:t,callback:e}of this.requestors)this._notify(t,e);this.requestors=[]}}getImage(e){const i=this.images[e];if(i&&!i.data&&i.spriteData){const e=i.spriteData;i.data=new t.R({width:e.width,height:e.height},e.context.getImageData(e.x,e.y,e.width,e.height).data),i.spriteData=null}return i}addImage(t,e){if(this.images[t])throw new Error(`Image id ${t} already exist, use updateImage instead`);this._validate(t,e)&&(this.images[t]=e)}_validate(e,i){let r=!0;const n=i.data||i.spriteData;return this._validateStretch(i.stretchX,n&&n.width)||(this.fire(new t.j(new Error(`Image "${e}" has invalid "stretchX" value`))),r=!1),this._validateStretch(i.stretchY,n&&n.height)||(this.fire(new t.j(new Error(`Image "${e}" has invalid "stretchY" value`))),r=!1),this._validateContent(i.content,i)||(this.fire(new t.j(new Error(`Image "${e}" has invalid "content" value`))),r=!1),r}_validateStretch(t,e){if(!t)return!0;let i=0;for(const r of t){if(r[0]<i||r[1]<r[0]||e<r[1])return!1;i=r[1]}return!0}_validateContent(t,e){if(!t)return!0;if(4!==t.length)return!1;const i=e.spriteData,r=i&&i.width||e.data.width,n=i&&i.height||e.data.height;return!(t[0]<0||r<t[0]||t[1]<0||n<t[1]||t[2]<0||r<t[2]||t[3]<0||n<t[3]||t[2]<t[0]||t[3]<t[1])}updateImage(t,e,i=!0){const r=this.getImage(t);if(i&&(r.data.width!==e.data.width||r.data.height!==e.data.height))throw new Error(`size mismatch between old image (${r.data.width}x${r.data.height}) and new image (${e.data.width}x${e.data.height}).`);e.version=r.version+1,this.images[t]=e,this.updatedImages[t]=!0}removeImage(t){const e=this.images[t];delete this.images[t],delete this.patterns[t],e.userImage&&e.userImage.onRemove&&e.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(t,e){let i=!0;if(!this.isLoaded())for(const e of t)this.images[e]||(i=!1);this.isLoaded()||i?this._notify(t,e):this.requestors.push({ids:t,callback:e})}_notify(e,i){const r={};for(const i of e){let e=this.getImage(i);e||(this.fire(new t.k("styleimagemissing",{id:i})),e=this.getImage(i)),e?r[i]={data:e.data.clone(),pixelRatio:e.pixelRatio,sdf:e.sdf,version:e.version,stretchX:e.stretchX,stretchY:e.stretchY,content:e.content,hasRenderCallback:Boolean(e.userImage&&e.userImage.render)}:t.w(`Image "${i}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}i(null,r)}getPixelSize(){const{width:t,height:e}=this.atlasImage;return{width:t,height:e}}getPattern(e){const i=this.patterns[e],r=this.getImage(e);if(!r)return null;if(i&&i.position.version===r.version)return i.position;if(i)i.position.version=r.version;else{const i={w:r.data.width+2,h:r.data.height+2,x:0,y:0},n=new t.I(i,r);this.patterns[e]={bin:i,position:n}}return this._updatePatternAtlas(),this.patterns[e].position}bind(t){const e=t.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new v(t,this.atlasImage,e.RGBA),this.atlasTexture.bind(e.LINEAR,e.CLAMP_TO_EDGE)}_updatePatternAtlas(){const e=[];for(const t in this.patterns)e.push(this.patterns[t].bin);const{w:i,h:r}=t.p(e),n=this.atlasImage;n.resize({width:i||1,height:r||1});for(const e in this.patterns){const{bin:i}=this.patterns[e],r=i.x+1,a=i.y+1,o=this.getImage(e).data,s=o.width,l=o.height;t.R.copy(o,n,{x:0,y:0},{x:r,y:a},{width:s,height:l}),t.R.copy(o,n,{x:0,y:l-1},{x:r,y:a-1},{width:s,height:1}),t.R.copy(o,n,{x:0,y:0},{x:r,y:a+l},{width:s,height:1}),t.R.copy(o,n,{x:s-1,y:0},{x:r-1,y:a},{width:1,height:l}),t.R.copy(o,n,{x:0,y:0},{x:r+s,y:a},{width:1,height:l})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(e){for(const i of e){if(this.callbackDispatchedThisFrame[i])continue;this.callbackDispatchedThisFrame[i]=!0;const e=this.getImage(i);e||t.w(`Image with ID: "${i}" was not found`),b(e)&&this.updateImage(i,e)}}}const w=1e20;function S(t,e,i,r,n,a,o,s,l){for(let c=e;c<e+r;c++)k(t,i*a+c,a,n,o,s,l);for(let c=i;c<i+n;c++)k(t,c*a+e,1,r,o,s,l)}function k(t,e,i,r,n,a,o){a[0]=0,o[0]=-w,o[1]=w,n[0]=t[e];for(let s=1,l=0,c=0;s<r;s++){n[s]=t[e+s*i];const r=s*s;do{const t=a[l];c=(n[s]-n[t]+r-t*t)/(s-t)/2}while(c<=o[l]&&--l>-1);l++,a[l]=s,o[l]=c,o[l+1]=w}for(let s=0,l=0;s<r;s++){for(;o[l+1]<s;)l++;const r=a[l],c=s-r;t[e+s*i]=n[r]+c*c}}class C{constructor(t,e){this.requestManager=t,this.localIdeographFontFamily=e,this.entries={}}setURL(t){this.url=t}getGlyphs(e,i){const r=[];for(const t in e)for(const i of e[t])r.push({stack:t,id:i});t.o(r,(({stack:t,id:e},i)=>{let r=this.entries[t];r||(r=this.entries[t]={glyphs:{},requests:{},ranges:{}});let n=r.glyphs[e];if(void 0!==n)return void i(null,{stack:t,id:e,glyph:n});if(n=this._tinySDF(r,t,e),n)return r.glyphs[e]=n,void i(null,{stack:t,id:e,glyph:n});const a=Math.floor(e/256);if(256*a>65535)return void i(new Error("glyphs > 65535 not supported"));if(r.ranges[a])return void i(null,{stack:t,id:e,glyph:n});if(!this.url)return void i(new Error("glyphsUrl is not set"));let o=r.requests[a];o||(o=r.requests[a]=[],C.loadGlyphRange(t,a,this.url,this.requestManager,((t,e)=>{if(e){for(const t in e)this._doesCharSupportLocalGlyph(+t)||(r.glyphs[+t]=e[+t]);r.ranges[a]=!0}for(const i of o)i(t,e);delete r.requests[a]}))),o.push(((r,n)=>{r?i(r):n&&i(null,{stack:t,id:e,glyph:n[e]||null})}))}),((t,e)=>{if(t)i(t);else if(e){const t={};for(const{stack:i,id:r,glyph:n}of e)(t[i]||(t[i]={}))[r]=n&&{id:n.id,bitmap:n.bitmap.clone(),metrics:n.metrics};i(null,t)}}))}_doesCharSupportLocalGlyph(e){return!!this.localIdeographFontFamily&&(t.u["CJK Unified Ideographs"](e)||t.u["Hangul Syllables"](e)||t.u.Hiragana(e)||t.u.Katakana(e))}_tinySDF(e,i,r){const n=this.localIdeographFontFamily;if(!n)return;if(!this._doesCharSupportLocalGlyph(r))return;let a=e.tinySDF;if(!a){let t="400";/bold/i.test(i)?t="900":/medium/i.test(i)?t="500":/light/i.test(i)&&(t="200"),a=e.tinySDF=new C.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:n,fontWeight:t})}const o=a.draw(String.fromCharCode(r));return{id:r,bitmap:new t.q({width:o.width||60,height:o.height||60},o.data),metrics:{width:o.glyphWidth/2||24,height:o.glyphHeight/2||24,left:o.glyphLeft/2+.5||0,top:o.glyphTop/2-27.5||-8,advance:o.glyphAdvance/2||24,isDoubleResolution:!0}}}}C.loadGlyphRange=function(e,i,r,n,a){const o=256*i,s=o+255,l=n.transformRequest(r.replace("{fontstack}",e).replace("{range}",`${o}-${s}`),h.Glyphs);t.l(l,((e,i)=>{if(e)a(e);else if(i){const e={};for(const r of t.n(i))e[r.id]=r;a(null,e)}}))},C.TinySDF=class{constructor({fontSize:t=24,buffer:e=3,radius:i=8,cutoff:r=.25,fontFamily:n="sans-serif",fontWeight:a="normal",fontStyle:o="normal"}={}){this.buffer=e,this.cutoff=r,this.radius=i;const s=this.size=t+4*e,l=this._createCanvas(s),c=this.ctx=l.getContext("2d",{willReadFrequently:!0});c.font=`${o} ${a} ${t}px ${n}`,c.textBaseline="alphabetic",c.textAlign="left",c.fillStyle="black",this.gridOuter=new Float64Array(s*s),this.gridInner=new Float64Array(s*s),this.f=new Float64Array(s),this.z=new Float64Array(s+1),this.v=new Uint16Array(s)}_createCanvas(t){const e=document.createElement("canvas");return e.width=e.height=t,e}draw(t){const{width:e,actualBoundingBoxAscent:i,actualBoundingBoxDescent:r,actualBoundingBoxLeft:n,actualBoundingBoxRight:a}=this.ctx.measureText(t),o=Math.ceil(i),s=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(a-n))),l=Math.min(this.size-this.buffer,o+Math.ceil(r)),c=s+2*this.buffer,h=l+2*this.buffer,u=Math.max(c*h,0),d=new Uint8ClampedArray(u),p={data:d,width:c,height:h,glyphWidth:s,glyphHeight:l,glyphTop:o,glyphLeft:0,glyphAdvance:e};if(0===s||0===l)return p;const{ctx:m,buffer:f,gridInner:g,gridOuter:y}=this;m.clearRect(f,f,s,l),m.fillText(t,f,f+o);const _=m.getImageData(f,f,s,l);y.fill(w,0,u),g.fill(0,0,u);for(let t=0;t<l;t++)for(let e=0;e<s;e++){const i=_.data[4*(t*s+e)+3]/255;if(0===i)continue;const r=(t+f)*c+e+f;if(1===i)y[r]=0,g[r]=w;else{const t=.5-i;y[r]=t>0?t*t:0,g[r]=t<0?t*t:0}}S(y,0,0,c,h,c,this.f,this.v,this.z),S(g,f,f,s,l,c,this.f,this.v,this.z);for(let t=0;t<u;t++){const e=Math.sqrt(y[t])-Math.sqrt(g[t]);d[t]=Math.round(255-255*(e/this.radius+this.cutoff))}return p}};class A{constructor(){this.specification=t.v.light.position}possiblyEvaluate(e,i){return t.z(e.expression.evaluate(i))}interpolate(e,i,r){return{x:t.B.number(e.x,i.x,r),y:t.B.number(e.y,i.y,r),z:t.B.number(e.z,i.z,r)}}}let T;class E extends t.E{constructor(e){super(),T=T||new t.r({anchor:new t.D(t.v.light.anchor),position:new A,color:new t.D(t.v.light.color),intensity:new t.D(t.v.light.intensity)}),this._transitionable=new t.T(T),this.setLight(e),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(e,i={}){if(!this._validate(t.t,e,i))for(const t in e){const i=e[t];t.endsWith("-transition")?this._transitionable.setTransition(t.slice(0,-11),i):this._transitionable.setValue(t,i)}}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(e,i,r){return(!r||!1!==r.validate)&&t.x(this,e.call(t.y,t.e({value:i,style:{glyphs:!0,sprite:!0},styleSpec:t.v})))}}class M{constructor(t,e){this.width=t,this.height=e,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(t,e){const i=t.join(",")+String(e);return this.dashEntry[i]||(this.dashEntry[i]=this.addDash(t,e)),this.dashEntry[i]}getDashRanges(t,e,i){const r=[];let n=t.length%2==1?-t[t.length-1]*i:0,a=t[0]*i,o=!0;r.push({left:n,right:a,isDash:o,zeroLength:0===t[0]});let s=t[0];for(let e=1;e<t.length;e++){o=!o;const l=t[e];n=s*i,s+=l,a=s*i,r.push({left:n,right:a,isDash:o,zeroLength:0===l})}return r}addRoundDash(t,e,i){const r=e/2;for(let e=-i;e<=i;e++){const n=this.width*(this.nextRow+i+e);let a=0,o=t[a];for(let s=0;s<this.width;s++){s/o.right>1&&(o=t[++a]);const l=Math.abs(s-o.left),c=Math.abs(s-o.right),h=Math.min(l,c);let u;const d=e/i*(r+1);if(o.isDash){const t=r-Math.abs(d);u=Math.sqrt(h*h+t*t)}else u=r-Math.sqrt(h*h+d*d);this.data[n+s]=Math.max(0,Math.min(255,u+128))}}}addRegularDash(t){for(let e=t.length-1;e>=0;--e){const i=t[e],r=t[e+1];i.zeroLength?t.splice(e,1):r&&r.isDash===i.isDash&&(r.left=i.left,t.splice(e,1))}const e=t[0],i=t[t.length-1];e.isDash===i.isDash&&(e.left=i.left-this.width,i.right=e.right+this.width);const r=this.width*this.nextRow;let n=0,a=t[n];for(let e=0;e<this.width;e++){e/a.right>1&&(a=t[++n]);const i=Math.abs(e-a.left),o=Math.abs(e-a.right),s=Math.min(i,o);this.data[r+e]=Math.max(0,Math.min(255,(a.isDash?s:-s)+128))}}addDash(e,i){const r=i?7:0,n=2*r+1;if(this.nextRow+n>this.height)return t.w("LineAtlas out of space"),null;let a=0;for(let t=0;t<e.length;t++)a+=e[t];if(0!==a){const t=this.width/a,n=this.getDashRanges(e,this.width,t);i?this.addRoundDash(n,t,r):this.addRegularDash(n)}const o={y:(this.nextRow+r+.5)/this.height,height:2*r/this.height,width:a};return this.nextRow+=n,this.dirty=!0,o}bind(t){const e=t.gl;this.texture?(e.bindTexture(e.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,e.texSubImage2D(e.TEXTURE_2D,0,0,0,this.width,this.height,e.ALPHA,e.UNSIGNED_BYTE,this.data))):(this.texture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this.texture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texImage2D(e.TEXTURE_2D,0,e.ALPHA,this.width,this.height,0,e.ALPHA,e.UNSIGNED_BYTE,this.data))}}class I{constructor(e,i,r){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=r;const n=this.workerPool.acquire(r);for(let e=0;e<n.length;e++){const a=new t.C(n[e],i,r);a.name=`Worker ${e}`,this.actors.push(a)}if(!this.actors.length)throw new Error("No actors found")}broadcast(e,i,r){t.o(this.actors,((t,r)=>{t.send(e,i,r)}),r=r||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(t=!0){this.actors.forEach((t=>{t.remove()})),this.actors=[],t&&this.workerPool.release(this.id)}}function z(e,i,r){const n=function(i,n){if(i)return r(i);if(n){const i=t.F(t.e(n,e),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);n.vector_layers&&(i.vectorLayers=n.vector_layers,i.vectorLayerIds=i.vectorLayers.map((t=>t.id))),r(null,i)}};return e.url?t.f(i.transformRequest(e.url,h.Source),n):t.h.frame((()=>n(null,e)))}class P{constructor(t,e){t&&(e?this.setSouthWest(t).setNorthEast(e):Array.isArray(t)&&(4===t.length?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1])))}setNorthEast(e){return this._ne=e instanceof t.L?new t.L(e.lng,e.lat):t.L.convert(e),this}setSouthWest(e){return this._sw=e instanceof t.L?new t.L(e.lng,e.lat):t.L.convert(e),this}extend(e){const i=this._sw,r=this._ne;let n,a;if(e instanceof t.L)n=e,a=e;else{if(!(e instanceof P))return Array.isArray(e)?4===e.length||e.every(Array.isArray)?this.extend(P.convert(e)):this.extend(t.L.convert(e)):e&&("lng"in e||"lon"in e)&&"lat"in e?this.extend(t.L.convert(e)):this;if(n=e._sw,a=e._ne,!n||!a)return this}return i||r?(i.lng=Math.min(n.lng,i.lng),i.lat=Math.min(n.lat,i.lat),r.lng=Math.max(a.lng,r.lng),r.lat=Math.max(a.lat,r.lat)):(this._sw=new t.L(n.lng,n.lat),this._ne=new t.L(a.lng,a.lat)),this}getCenter(){return new t.L((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new t.L(this.getWest(),this.getNorth())}getSouthEast(){return new t.L(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:i,lat:r}=t.L.convert(e);let n=this._sw.lng<=i&&i<=this._ne.lng;return this._sw.lng>this._ne.lng&&(n=this._sw.lng>=i&&i>=this._ne.lng),this._sw.lat<=r&&r<=this._ne.lat&&n}static convert(t){return t instanceof P?t:t?new P(t):t}static fromLngLat(e,i=0){const r=360*i/40075017,n=r/Math.cos(Math.PI/180*e.lat);return new P(new t.L(e.lng-n,e.lat-r),new t.L(e.lng+n,e.lat+r))}}class L{constructor(t,e,i){this.bounds=P.convert(this.validateBounds(t)),this.minzoom=e||0,this.maxzoom=i||24}validateBounds(t){return Array.isArray(t)&&4===t.length?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]}contains(e){const i=Math.pow(2,e.z),r=Math.floor(t.G(this.bounds.getWest())*i),n=Math.floor(t.H(this.bounds.getNorth())*i),a=Math.ceil(t.G(this.bounds.getEast())*i),o=Math.ceil(t.H(this.bounds.getSouth())*i);return e.x>=r&&e.x<a&&e.y>=n&&e.y<o}}class D extends t.E{constructor(e,i,r,n){if(super(),this.load=()=>{this._loaded=!1,this.fire(new t.k("dataloading",{dataType:"source"})),this._tileJSONRequest=z(this._options,this.map._requestManager,((e,i)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),e?this.fire(new t.j(e)):i&&(t.e(this,i),i.bounds&&(this.tileBounds=new L(i.bounds,this.minzoom,this.maxzoom)),this.fire(new t.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new t.k("data",{dataType:"source",sourceDataType:"content"})))}))},this.serialize=()=>t.e({},this._options),this.id=e,this.dispatcher=r,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,t.e(this,t.F(i,["url","scheme","tileSize","promoteId"])),this._options=t.e({type:"vector"},i),this._collectResourceTiming=i.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(n)}loaded(){return this._loaded}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}onAdd(t){this.map=t,this.load()}setSourceProperty(t){this._tileJSONRequest&&this._tileJSONRequest.cancel(),t(),this.load()}setTiles(t){return this.setSourceProperty((()=>{this._options.tiles=t})),this}setUrl(t){return this.setSourceProperty((()=>{this.url=t,this._options.url=t})),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}loadTile(t,e){const i=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),r={request:this.map._requestManager.transformRequest(i,h.Tile),uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function n(i,r){return delete t.request,t.aborted?e(null):i&&404!==i.status?e(i):(r&&r.resourceTiming&&(t.resourceTiming=r.resourceTiming),this.map._refreshExpiredTiles&&r&&t.setExpiryData(r),t.loadVectorData(r,this.map.painter),e(null),void(t.reloadCallback&&(this.loadTile(t,t.reloadCallback),t.reloadCallback=null)))}r.request.collectResourceTiming=this._collectResourceTiming,t.actor&&"expired"!==t.state?"loading"===t.state?t.reloadCallback=e:t.request=t.actor.send("reloadTile",r,n.bind(this)):(t.actor=this.dispatcher.getActor(),t.request=t.actor.send("loadTile",r,n.bind(this)))}abortTile(t){t.request&&(t.request.cancel(),delete t.request),t.actor&&t.actor.send("abortTile",{uid:t.uid,type:this.type,source:this.id},void 0)}unloadTile(t){t.unloadVectorData(),t.actor&&t.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class R extends t.E{constructor(e,i,r,n){super(),this.id=e,this.dispatcher=r,this.setEventedParent(n),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=t.e({type:"raster"},i),t.e(this,t.F(i,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new t.k("dataloading",{dataType:"source"})),this._tileJSONRequest=z(this._options,this.map._requestManager,((e,i)=>{this._tileJSONRequest=null,this._loaded=!0,e?this.fire(new t.j(e)):i&&(t.e(this,i),i.bounds&&(this.tileBounds=new L(i.bounds,this.minzoom,this.maxzoom)),this.fire(new t.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new t.k("data",{dataType:"source",sourceDataType:"content"})))}))}loaded(){return this._loaded}onAdd(t){this.map=t,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}setSourceProperty(t){this._tileJSONRequest&&this._tileJSONRequest.cancel(),t(),this.load()}setTiles(t){return this.setSourceProperty((()=>{this._options.tiles=t})),this}serialize(){return t.e({},this._options)}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(t,e){const i=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);t.request=c.getImage(this.map._requestManager.transformRequest(i,h.Tile),((i,r,n)=>{if(delete t.request,t.aborted)t.state="unloaded",e(null);else if(i)t.state="errored",e(i);else if(r){this.map._refreshExpiredTiles&&n&&t.setExpiryData(n);const i=this.map.painter.context,a=i.gl;t.texture=this.map.painter.getTileTexture(r.width),t.texture?t.texture.update(r,{useMipmap:!0}):(t.texture=new v(i,r,a.RGBA,{useMipmap:!0}),t.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST),i.extTextureFilterAnisotropic&&a.texParameterf(a.TEXTURE_2D,i.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,i.extTextureFilterAnisotropicMax)),t.state="loaded",e(null)}}),this.map._refreshExpiredTiles)}abortTile(t,e){t.request&&(t.request.cancel(),delete t.request),e()}unloadTile(t,e){t.texture&&this.map.painter.saveTileTexture(t.texture),e()}hasTransition(){return!1}}class B extends R{constructor(e,i,r,n){super(e,i,r,n),this.type="raster-dem",this.maxzoom=22,this._options=t.e({type:"raster-dem"},i),this.encoding=i.encoding||"mapbox",this.redFactor=i.redFactor,this.greenFactor=i.greenFactor,this.blueFactor=i.blueFactor,this.baseShift=i.baseShift}loadTile(e,i){const r=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),n=this.map._requestManager.transformRequest(r,h.Tile);function a(t,r){t&&(e.state="errored",i(t)),r&&(e.dem=r,e.needsHillshadePrepare=!0,e.needsTerrainPrepare=!0,e.state="loaded",i(null))}e.neighboringTiles=this._getNeighboringTiles(e.tileID),e.request=c.getImage(n,((r,n,o)=>t._(this,void 0,void 0,(function*(){if(delete e.request,e.aborted)e.state="unloaded",i(null);else if(r)e.state="errored",i(r);else if(n){this.map._refreshExpiredTiles&&e.setExpiryData(o);const i=t.a(n)&&t.J()?n:yield function(e){return t._(this,void 0,void 0,(function*(){if("undefined"!=typeof VideoFrame&&t.K()){const i=e.width+2,r=e.height+2;try{return new t.R({width:i,height:r},yield t.M(e,-1,-1,i,r))}catch(t){}}return t.h.getImageData(e,1)}))}(n),r={uid:e.uid,coord:e.tileID,source:this.id,rawImageData:i,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};e.actor&&"expired"!==e.state||(e.actor=this.dispatcher.getActor(),e.actor.send("loadDEMTile",r,a))}}))),this.map._refreshExpiredTiles)}_getNeighboringTiles(e){const i=e.canonical,r=Math.pow(2,i.z),n=(i.x-1+r)%r,a=0===i.x?e.wrap-1:e.wrap,o=(i.x+1+r)%r,s=i.x+1===r?e.wrap+1:e.wrap,l={};return l[new t.O(e.overscaledZ,a,i.z,n,i.y).key]={backfilled:!1},l[new t.O(e.overscaledZ,s,i.z,o,i.y).key]={backfilled:!1},i.y>0&&(l[new t.O(e.overscaledZ,a,i.z,n,i.y-1).key]={backfilled:!1},l[new t.O(e.overscaledZ,e.wrap,i.z,i.x,i.y-1).key]={backfilled:!1},l[new t.O(e.overscaledZ,s,i.z,o,i.y-1).key]={backfilled:!1}),i.y+1<r&&(l[new t.O(e.overscaledZ,a,i.z,n,i.y+1).key]={backfilled:!1},l[new t.O(e.overscaledZ,e.wrap,i.z,i.x,i.y+1).key]={backfilled:!1},l[new t.O(e.overscaledZ,s,i.z,o,i.y+1).key]={backfilled:!1}),l}unloadTile(t){t.demTexture&&this.map.painter.saveTileTexture(t.demTexture),t.fbo&&(t.fbo.destroy(),delete t.fbo),t.dem&&delete t.dem,delete t.neighboringTiles,t.state="unloaded",t.actor&&t.actor.send("removeDEMTile",{uid:t.uid,source:this.id})}}class F extends t.E{constructor(e,i,r,n){super(),this.load=()=>{this._updateWorkerData()},this.serialize=()=>t.e({},this._options,{type:this.type,data:this._data}),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=r.getActor(),this.setEventedParent(n),this._data=i.data,this._options=t.e({},i),this._collectResourceTiming=i.collectResourceTiming,void 0!==i.maxzoom&&(this.maxzoom=i.maxzoom),i.type&&(this.type=i.type),i.attribution&&(this.attribution=i.attribution),this.promoteId=i.promoteId;const a=t.N/this.tileSize;this.workerOptions=t.e({source:this.id,cluster:i.cluster||!1,geojsonVtOptions:{buffer:(void 0!==i.buffer?i.buffer:128)*a,tolerance:(void 0!==i.tolerance?i.tolerance:.375)*a,extent:t.N,maxZoom:this.maxzoom,lineMetrics:i.lineMetrics||!1,generateId:i.generateId||!1},superclusterOptions:{maxZoom:void 0!==i.clusterMaxZoom?i.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,i.clusterMinPoints||2),extent:t.N,radius:(i.clusterRadius||50)*a,log:!1,generateId:i.generateId||!1},clusterProperties:i.clusterProperties,filter:i.filter},i.workerOptions),"string"==typeof this.promoteId&&(this.workerOptions.promoteId=this.promoteId)}onAdd(t){this.map=t,this.load()}setData(t){return this._data=t,this._updateWorkerData(),this}updateData(t){return this._updateWorkerData(t),this}setClusterOptions(t){return this.workerOptions.cluster=t.cluster,t&&(void 0!==t.clusterRadius&&(this.workerOptions.superclusterOptions.radius=t.clusterRadius),void 0!==t.clusterMaxZoom&&(this.workerOptions.superclusterOptions.maxZoom=t.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(t,e){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:t,source:this.id},e),this}getClusterChildren(t,e){return this.actor.send("geojson.getClusterChildren",{clusterId:t,source:this.id},e),this}getClusterLeaves(t,e,i,r){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:t,limit:e,offset:i},r),this}_updateWorkerData(e){const i=t.e({},this.workerOptions);e?i.dataDiff=e:"string"==typeof this._data?(i.request=this.map._requestManager.transformRequest(t.h.resolveURL(this._data),h.Source),i.request.collectResourceTiming=this._collectResourceTiming):i.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new t.k("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,i,((e,i)=>{if(this._pendingLoads--,this._removed||i&&i.abandoned)return void this.fire(new t.k("dataabort",{dataType:"source"}));let r=null;if(i&&i.resourceTiming&&i.resourceTiming[this.id]&&(r=i.resourceTiming[this.id].slice(0)),e)return void this.fire(new t.j(e));const n={dataType:"source"};this._collectResourceTiming&&r&&r.length>0&&t.e(n,{resourceTiming:r}),this.fire(new t.k("data",Object.assign(Object.assign({},n),{sourceDataType:"metadata"}))),this.fire(new t.k("data",Object.assign(Object.assign({},n),{sourceDataType:"content"})))}))}loaded(){return 0===this._pendingLoads}loadTile(t,e){const i=t.actor?"reloadTile":"loadTile";t.actor=this.actor;const r={type:this.type,uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};t.request=this.actor.send(i,r,((r,n)=>(delete t.request,t.unloadVectorData(),t.aborted?e(null):r?e(r):(t.loadVectorData(n,this.map.painter,"reloadTile"===i),e(null)))))}abortTile(t){t.request&&(t.request.cancel(),delete t.request),t.aborted=!0}unloadTile(t){t.unloadVectorData(),this.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}hasTransition(){return!1}}var O=t.Q([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class $ extends t.E{constructor(e,i,r,n){super(),this.load=(e,i)=>{this._loaded=!1,this.fire(new t.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=c.getImage(this.map._requestManager.transformRequest(this.url,h.Image),((r,n)=>{this._request=null,this._loaded=!0,r?this.fire(new t.j(r)):n&&(this.image=n,e&&(this.coordinates=e),i&&i(),this._finishLoading())}))},this.prepare=()=>{if(0===Object.keys(this.tiles).length||!this.image)return;const e=this.map.painter.context,i=e.gl;this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,O.members)),this.boundsSegments||(this.boundsSegments=t.S.simpleSegment(0,0,4,2)),this.texture||(this.texture=new v(e,this.image,i.RGBA),this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE));let r=!1;for(const t in this.tiles){const e=this.tiles[t];"loaded"!==e.state&&(e.state="loaded",e.texture=this.texture,r=!0)}r&&this.fire(new t.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"image",url:this.options.url,coordinates:this.coordinates}),this.id=e,this.dispatcher=r,this.coordinates=i.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(n),this.options=i}loaded(){return this._loaded}updateImage(t){return t.url?(this._request&&(this._request.cancel(),this._request=null),this.options.url=t.url,this.load(t.coordinates,(()=>{this.texture=null})),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new t.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}onRemove(){this._request&&(this._request.cancel(),this._request=null)}setCoordinates(e){this.coordinates=e;const i=e.map(t.U.fromLngLat);this.tileID=function(e){let i=1/0,r=1/0,n=-1/0,a=-1/0;for(const t of e)i=Math.min(i,t.x),r=Math.min(r,t.y),n=Math.max(n,t.x),a=Math.max(a,t.y);const o=Math.max(n-i,a-r),s=Math.max(0,Math.floor(-Math.log(o)/Math.LN2)),l=Math.pow(2,s);return new t.W(s,Math.floor((i+n)/2*l),Math.floor((r+a)/2*l))}(i),this.minzoom=this.maxzoom=this.tileID.z;const r=i.map((t=>this.tileID.getTilePoint(t)._round()));return this._boundsArray=new t.V,this._boundsArray.emplaceBack(r[0].x,r[0].y,0,0),this._boundsArray.emplaceBack(r[1].x,r[1].y,t.N,0),this._boundsArray.emplaceBack(r[3].x,r[3].y,0,t.N),this._boundsArray.emplaceBack(r[2].x,r[2].y,t.N,t.N),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new t.k("data",{dataType:"source",sourceDataType:"content"})),this}loadTile(t,e){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={},e(null)):(t.state="errored",e(null))}hasTransition(){return!1}}class V extends ${constructor(e,i,r,n){super(e,i,r,n),this.load=()=>{this._loaded=!1;const e=this.options;this.urls=[];for(const t of e.urls)this.urls.push(this.map._requestManager.transformRequest(t,h.Source).url);t.X(this.urls,((e,i)=>{this._loaded=!0,e?this.fire(new t.j(e)):i&&(this.video=i,this.video.loop=!0,this.video.addEventListener("playing",(()=>{this.map.triggerRepaint()})),this.map&&this.video.play(),this._finishLoading())}))},this.prepare=()=>{if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const e=this.map.painter.context,i=e.gl;this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,O.members)),this.boundsSegments||(this.boundsSegments=t.S.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE),i.texSubImage2D(i.TEXTURE_2D,0,0,0,i.RGBA,i.UNSIGNED_BYTE,this.video)):(this.texture=new v(e,this.video,i.RGBA),this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE));let r=!1;for(const t in this.tiles){const e=this.tiles[t];"loaded"!==e.state&&(e.state="loaded",e.texture=this.texture,r=!0)}r&&this.fire(new t.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"video",urls:this.urls,coordinates:this.coordinates}),this.roundZoom=!0,this.type="video",this.options=i}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(e){if(this.video){const i=this.video.seekable;e<i.start(0)||e>i.end(0)?this.fire(new t.j(new t.Y(`sources.${this.id}`,null,`Playback for this video can be set only between the ${i.start(0)} and ${i.end(0)}-second mark.`))):this.video.currentTime=e}}getVideo(){return this.video}onAdd(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}hasTransition(){return this.video&&!this.video.paused}}class N extends ${constructor(e,i,r,n){super(e,i,r,n),this.load=()=>{this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new t.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},this.prepare=()=>{let e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),this._hasInvalidDimensions())return;if(0===Object.keys(this.tiles).length)return;const i=this.map.painter.context,r=i.gl;this.boundsBuffer||(this.boundsBuffer=i.createVertexBuffer(this._boundsArray,O.members)),this.boundsSegments||(this.boundsSegments=t.S.simpleSegment(0,0,4,2)),this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new v(i,this.canvas,r.RGBA,{premultiply:!0});let n=!1;for(const t in this.tiles){const e=this.tiles[t];"loaded"!==e.state&&(e.state="loaded",e.texture=this.texture,n=!0)}n&&this.fire(new t.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"canvas",coordinates:this.coordinates}),i.coordinates?Array.isArray(i.coordinates)&&4===i.coordinates.length&&!i.coordinates.some((t=>!Array.isArray(t)||2!==t.length||t.some((t=>"number"!=typeof t))))||this.fire(new t.j(new t.Y(`sources.${e}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new t.j(new t.Y(`sources.${e}`,null,'missing required property "coordinates"'))),i.animate&&"boolean"!=typeof i.animate&&this.fire(new t.j(new t.Y(`sources.${e}`,null,'optional "animate" property must be a boolean value'))),i.canvas?"string"==typeof i.canvas||i.canvas instanceof HTMLCanvasElement||this.fire(new t.j(new t.Y(`sources.${e}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new t.j(new t.Y(`sources.${e}`,null,'missing required property "canvas"'))),this.options=i,this.animate=void 0===i.animate||i.animate}getCanvas(){return this.canvas}onAdd(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const t of[this.canvas.width,this.canvas.height])if(isNaN(t)||t<=0)return!0;return!1}}const j={},U=t=>{switch(t){case"geojson":return F;case"image":return $;case"raster":return R;case"raster-dem":return B;case"vector":return D;case"video":return V;case"canvas":return N}return j[t]};function Z(e,i){const r=t.Z();return t.$(r,r,[1,1,0]),t.a0(r,r,[.5*e.width,.5*e.height,1]),t.a1(r,r,e.calculatePosMatrix(i.toUnwrapped()))}function H(t,e,i,r,n,a){const o=function(t,e,i){if(t)for(const r of t){const t=e[r];if(t&&t.source===i&&"fill-extrusion"===t.type)return!0}else for(const t in e){const r=e[t];if(r.source===i&&"fill-extrusion"===r.type)return!0}return!1}(n&&n.layers,e,t.id),s=a.maxPitchScaleFactor(),l=t.tilesIn(r,s,o);l.sort(q);const c=[];for(const r of l)c.push({wrappedTileID:r.tileID.wrapped().key,queryResults:r.tile.queryRenderedFeatures(e,i,t._state,r.queryGeometry,r.cameraQueryGeometry,r.scale,n,a,s,Z(t.transform,r.tileID))});const h=function(t){const e={},i={};for(const r of t){const t=r.queryResults,n=r.wrappedTileID,a=i[n]=i[n]||{};for(const i in t){const r=t[i],n=a[i]=a[i]||{},o=e[i]=e[i]||[];for(const t of r)n[t.featureIndex]||(n[t.featureIndex]=!0,o.push(t))}}return e}(c);for(const e in h)h[e].forEach((e=>{const i=e.feature,r=t.getFeatureState(i.layer["source-layer"],i.id);i.source=i.layer.source,i.layer["source-layer"]&&(i.sourceLayer=i.layer["source-layer"]),i.state=r}));return h}function q(t,e){const i=t.tileID,r=e.tileID;return i.overscaledZ-r.overscaledZ||i.canonical.y-r.canonical.y||i.wrap-r.wrap||i.canonical.x-r.canonical.x}class G{constructor(e,i){this.timeAdded=0,this.fadeEndTime=0,this.tileID=e,this.uid=t.a2(),this.uses=0,this.tileSize=i,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(t){const e=t+this.timeAdded;e<this.fadeEndTime||(this.fadeEndTime=e)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}clearTextures(t){this.demTexture&&t.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(e,i,r){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(t,e){const i={};if(!e)return i;for(const r of t){const t=r.layerIds.map((t=>e.getLayer(t))).filter(Boolean);if(0!==t.length){r.layers=t,r.stateDependentLayerIds&&(r.stateDependentLayers=r.stateDependentLayerIds.map((e=>t.filter((t=>t.id===e))[0])));for(const e of t)i[e.id]=r}}return i}(e.buckets,i.style),this.hasSymbolBuckets=!1;for(const e in this.buckets){const i=this.buckets[e];if(i instanceof t.a4){if(this.hasSymbolBuckets=!0,!r)break;i.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const e in this.buckets){const i=this.buckets[e];if(i instanceof t.a4&&i.hasRTLText){this.hasRTLText=!0,t.a5();break}}this.queryPadding=0;for(const t in this.buckets){const e=this.buckets[t];this.queryPadding=Math.max(this.queryPadding,i.style.getLayer(t).queryRadius(e))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new t.a3}unloadVectorData(){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(t){return this.buckets[t.id]}upload(t){for(const e in this.buckets){const i=this.buckets[e];i.uploadPending()&&i.upload(t)}const e=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new v(t,this.imageAtlas.image,e.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new v(t,this.glyphAtlasImage,e.ALPHA),this.glyphAtlasImage=null)}prepare(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)}queryRenderedFeatures(t,e,i,r,n,a,o,s,l,c){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:r,cameraQueryGeometry:n,scale:a,tileSize:this.tileSize,pixelPosMatrix:c,transform:s,params:o,queryPadding:this.queryPadding*l},t,e,i):{}}querySourceFeatures(e,i){const r=this.latestFeatureIndex;if(!r||!r.rawTileData)return;const n=r.loadVTLayers(),a=i&&i.sourceLayer?i.sourceLayer:"",o=n._geojsonTileLayer||n[a];if(!o)return;const s=t.a6(i&&i.filter),{z:l,x:c,y:h}=this.tileID.canonical,u={z:l,x:c,y:h};for(let i=0;i<o.length;i++){const n=o.feature(i);if(s.needGeometry){const e=t.a7(n,!0);if(!s.filter(new t.a8(this.tileID.overscaledZ),e,this.tileID.canonical))continue}else if(!s.filter(new t.a8(this.tileID.overscaledZ),n))continue;const d=r.getId(n,a),p=new t.a9(n,l,c,h,d);p.tile=u,e.push(p)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const i=this.expirationTime;if(e.cacheControl){const i=t.aa(e.cacheControl);i["max-age"]&&(this.expirationTime=Date.now()+1e3*i["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const t=Date.now();let e=!1;if(this.expirationTime>t)e=!1;else if(i)if(this.expirationTime<i)e=!0;else{const r=this.expirationTime-i;r?this.expirationTime=t+Math.max(r,3e4):e=!0}else e=!0;e?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(t,e){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(t).length)return;const i=this.latestFeatureIndex.loadVTLayers();for(const r in this.buckets){if(!e.style.hasLayer(r))continue;const n=this.buckets[r],a=n.layers[0].sourceLayer||"_geojsonTileLayer",o=i[a],s=t[a];if(!o||!s||0===Object.keys(s).length)continue;n.update(s,o,this.imageAtlas&&this.imageAtlas.patternPositions||{});const l=e&&e.style&&e.style.getLayer(r);l&&(this.queryPadding=Math.max(this.queryPadding,l.queryRadius(n)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<t.h.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=t.h.now()+e}setDependencies(t,e){const i={};for(const t of e)i[t]=!0;this.dependencies[t]=i}hasDependency(t,e){for(const i of t){const t=this.dependencies[i];if(t)for(const i of e)if(t[i])return!0}return!1}}class W{constructor(t,e){this.max=t,this.onRemove=e,this.reset()}reset(){for(const t in this.data)for(const e of this.data[t])e.timeout&&clearTimeout(e.timeout),this.onRemove(e.value);return this.data={},this.order=[],this}add(t,e,i){const r=t.wrapped().key;void 0===this.data[r]&&(this.data[r]=[]);const n={value:e,timeout:void 0};if(void 0!==i&&(n.timeout=setTimeout((()=>{this.remove(t,n)}),i)),this.data[r].push(n),this.order.push(r),this.order.length>this.max){const t=this._getAndRemoveByKey(this.order[0]);t&&this.onRemove(t)}return this}has(t){return t.wrapped().key in this.data}getAndRemove(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null}_getAndRemoveByKey(t){const e=this.data[t].shift();return e.timeout&&clearTimeout(e.timeout),0===this.data[t].length&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),e.value}getByKey(t){const e=this.data[t];return e?e[0].value:null}get(t){return this.has(t)?this.data[t.wrapped().key][0].value:null}remove(t,e){if(!this.has(t))return this;const i=t.wrapped().key,r=void 0===e?0:this.data[i].indexOf(e),n=this.data[i][r];return this.data[i].splice(r,1),n.timeout&&clearTimeout(n.timeout),0===this.data[i].length&&delete this.data[i],this.onRemove(n.value),this.order.splice(this.order.indexOf(i),1),this}setMaxSize(t){for(this.max=t;this.order.length>this.max;){const t=this._getAndRemoveByKey(this.order[0]);t&&this.onRemove(t)}return this}filter(t){const e=[];for(const i in this.data)for(const r of this.data[i])t(r.value)||e.push(r);for(const t of e)this.remove(t.value.tileID,t)}}class X{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,i,r){const n=String(i);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][n]=this.stateChanges[e][n]||{},t.e(this.stateChanges[e][n],r),null===this.deletedStates[e]){this.deletedStates[e]={};for(const t in this.state[e])t!==n&&(this.deletedStates[e][t]=null)}else if(this.deletedStates[e]&&null===this.deletedStates[e][n]){this.deletedStates[e][n]={};for(const t in this.state[e][n])r[t]||(this.deletedStates[e][n][t]=null)}else for(const t in r)this.deletedStates[e]&&this.deletedStates[e][n]&&null===this.deletedStates[e][n][t]&&delete this.deletedStates[e][n][t]}removeFeatureState(t,e,i){if(null===this.deletedStates[t])return;const r=String(e);if(this.deletedStates[t]=this.deletedStates[t]||{},i&&void 0!==e)null!==this.deletedStates[t][r]&&(this.deletedStates[t][r]=this.deletedStates[t][r]||{},this.deletedStates[t][r][i]=null);else if(void 0!==e)if(this.stateChanges[t]&&this.stateChanges[t][r])for(i in this.deletedStates[t][r]={},this.stateChanges[t][r])this.deletedStates[t][r][i]=null;else this.deletedStates[t][r]=null;else this.deletedStates[t]=null}getState(e,i){const r=String(i),n=t.e({},(this.state[e]||{})[r],(this.stateChanges[e]||{})[r]);if(null===this.deletedStates[e])return{};if(this.deletedStates[e]){const t=this.deletedStates[e][i];if(null===t)return{};for(const e in t)delete n[e]}return n}initializeTileState(t,e){t.setFeatureState(this.state,e)}coalesceChanges(e,i){const r={};for(const e in this.stateChanges){this.state[e]=this.state[e]||{};const i={};for(const r in this.stateChanges[e])this.state[e][r]||(this.state[e][r]={}),t.e(this.state[e][r],this.stateChanges[e][r]),i[r]=this.state[e][r];r[e]=i}for(const e in this.deletedStates){this.state[e]=this.state[e]||{};const i={};if(null===this.deletedStates[e])for(const t in this.state[e])i[t]={},this.state[e][t]={};else for(const t in this.deletedStates[e]){if(null===this.deletedStates[e][t])this.state[e][t]={};else for(const i of Object.keys(this.deletedStates[e][t]))delete this.state[e][t][i];i[t]=this.state[e][t]}r[e]=r[e]||{},t.e(r[e],i)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(r).length)for(const t in e)e[t].setFeatureState(r,i)}}class K extends t.E{constructor(t,e,i){super(),this.id=t,this.dispatcher=i,this.on("data",(t=>{"source"===t.dataType&&"metadata"===t.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===t.dataType&&"content"===t.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)})),this.on("dataloading",(()=>{this._sourceErrored=!1})),this.on("error",(()=>{this._sourceErrored=this._source.loaded()})),this._source=((t,e,i,r)=>{const n=new(U(e.type))(t,e,i,r);if(n.id!==t)throw new Error(`Expected Source id to be ${t} instead of ${n.id}`);return n})(t,e,i,this),this._tiles={},this._cache=new W(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new X,this._didEmitContent=!1,this._updated=!1}onAdd(t){this.map=t,this._maxTileCacheSize=t?t._maxTileCacheSize:null,this._maxTileCacheZoomLevels=t?t._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(t)}onRemove(t){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(t)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;if(!this._source.loaded())return!1;if(!(void 0===this.used&&void 0===this.usedForTerrain||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const t in this._tiles){const e=this._tiles[t];if("loaded"!==e.state&&"errored"!==e.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(t,e){return this._source.loadTile(t,e)}_unloadTile(t){if(this._source.unloadTile)return this._source.unloadTile(t,(()=>{}))}_abortTile(e){this._source.abortTile&&this._source.abortTile(e,(()=>{})),this._source.fire(new t.k("dataabort",{tile:e,coord:e.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(t){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const e in this._tiles){const i=this._tiles[e];i.upload(t),i.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map((t=>t.tileID)).sort(J).map((t=>t.key))}getRenderableIds(e){const i=[];for(const t in this._tiles)this._isIdRenderable(t,e)&&i.push(this._tiles[t]);return e?i.sort(((e,i)=>{const r=e.tileID,n=i.tileID,a=new t.P(r.canonical.x,r.canonical.y)._rotate(this.transform.angle),o=new t.P(n.canonical.x,n.canonical.y)._rotate(this.transform.angle);return r.overscaledZ-n.overscaledZ||o.y-a.y||o.x-a.x})).map((t=>t.tileID.key)):i.map((t=>t.tileID)).sort(J).map((t=>t.key))}hasRenderableParent(t){const e=this.findLoadedParent(t,0);return!!e&&this._isIdRenderable(e.tileID.key)}_isIdRenderable(t,e){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(e||!this._tiles[t].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const t in this._tiles)"errored"!==this._tiles[t].state&&this._reloadTile(t,"reloading")}}_reloadTile(t,e){const i=this._tiles[t];i&&("loading"!==i.state&&(i.state=e),this._loadTile(i,this._tileLoaded.bind(this,i,t,e)))}_tileLoaded(e,i,r,n){if(n)return e.state="errored",void(404!==n.status?this._source.fire(new t.j(n,{tile:e})):this.update(this.transform,this.terrain));e.timeAdded=t.h.now(),"expired"===r&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(i,e),"raster-dem"===this.getSource().type&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),e.aborted||this._source.fire(new t.k("data",{dataType:"source",tile:e,coord:e.tileID}))}_backfillDEM(t){const e=this.getRenderableIds();for(let r=0;r<e.length;r++){const n=e[r];if(t.neighboringTiles&&t.neighboringTiles[n]){const e=this.getTileByID(n);i(t,e),i(e,t)}}function i(t,e){t.needsHillshadePrepare=!0,t.needsTerrainPrepare=!0;let i=e.tileID.canonical.x-t.tileID.canonical.x;const r=e.tileID.canonical.y-t.tileID.canonical.y,n=Math.pow(2,t.tileID.canonical.z),a=e.tileID.key;0===i&&0===r||Math.abs(r)>1||(Math.abs(i)>1&&(1===Math.abs(i+n)?i+=n:1===Math.abs(i-n)&&(i-=n)),e.dem&&t.dem&&(t.dem.backfillBorder(e.dem,i,r),t.neighboringTiles&&t.neighboringTiles[a]&&(t.neighboringTiles[a].backfilled=!0)))}}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._tiles[t]}_retainLoadedChildren(t,e,i,r){for(const n in this._tiles){let a=this._tiles[n];if(r[n]||!a.hasData()||a.tileID.overscaledZ<=e||a.tileID.overscaledZ>i)continue;let o=a.tileID;for(;a&&a.tileID.overscaledZ>e+1;){const t=a.tileID.scaledTo(a.tileID.overscaledZ-1);a=this._tiles[t.key],a&&a.hasData()&&(o=t)}let s=o;for(;s.overscaledZ>e;)if(s=s.scaledTo(s.overscaledZ-1),t[s.key]){r[o.key]=o;break}}}findLoadedParent(t,e){if(t.key in this._loadedParentTiles){const i=this._loadedParentTiles[t.key];return i&&i.tileID.overscaledZ>=e?i:null}for(let i=t.overscaledZ-1;i>=e;i--){const e=t.scaledTo(i),r=this._getLoadedTile(e);if(r)return r}}_getLoadedTile(t){const e=this._tiles[t.key];return e&&e.hasData()?e:this._cache.getByKey(t.wrapped().key)}updateCacheSize(e){const i=Math.ceil(e.width/this._source.tileSize)+1,r=Math.ceil(e.height/this._source.tileSize)+1,n=Math.floor(i*r*(null===this._maxTileCacheZoomLevels?t.c.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),a="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,n):n;this._cache.setMaxSize(a)}handleWrapJump(t){const e=Math.round((t-(void 0===this._prevLng?t:this._prevLng))/360);if(this._prevLng=t,e){const t={};for(const i in this._tiles){const r=this._tiles[i];r.tileID=r.tileID.unwrapTo(r.tileID.wrap+e),t[r.tileID.key]=r}this._tiles=t;for(const t in this._timers)clearTimeout(this._timers[t]),delete this._timers[t];for(const t in this._tiles)this._setTileReloadTimer(t,this._tiles[t])}}update(e,i){if(this.transform=e,this.terrain=i,!this._sourceLoaded||this._paused)return;let r;this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?r=e.getVisibleUnwrappedCoordinates(this._source.tileID).map((e=>new t.O(e.canonical.z,e.wrap,e.canonical.z,e.canonical.x,e.canonical.y))):(r=e.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:i}),this._source.hasTile&&(r=r.filter((t=>this._source.hasTile(t))))):r=[];const n=e.coveringZoomLevel(this._source),a=Math.max(n-K.maxOverzooming,this._source.minzoom),o=Math.max(n+K.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const t={};for(const e of r)if(e.canonical.z>this._source.minzoom){const i=e.scaledTo(e.canonical.z-1);t[i.key]=i;const r=e.scaledTo(Math.max(this._source.minzoom,Math.min(e.canonical.z,5)));t[r.key]=r}r=r.concat(Object.values(t))}const s=0===r.length&&!this._updated&&this._didEmitContent;this._updated=!0,s&&this.fire(new t.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const l=this._updateRetainedTiles(r,n);if(Y(this._source.type)){const e={},s={},c=Object.keys(l),h=t.h.now();for(const t of c){const i=l[t],r=this._tiles[t];if(!r||0!==r.fadeEndTime&&r.fadeEndTime<=h)continue;const n=this.findLoadedParent(i,a);n&&(this._addTile(n.tileID),e[n.tileID.key]=n.tileID),s[t]=i}this._retainLoadedChildren(s,n,o,l);for(const t in e)l[t]||(this._coveredTiles[t]=!0,l[t]=e[t]);if(i){const t={},e={};for(const i of r)this._tiles[i.key].hasData()?t[i.key]=i:e[i.key]=i;for(const i in e){const r=e[i].children(this._source.maxzoom);this._tiles[r[0].key]&&this._tiles[r[1].key]&&this._tiles[r[2].key]&&this._tiles[r[3].key]&&(t[r[0].key]=l[r[0].key]=r[0],t[r[1].key]=l[r[1].key]=r[1],t[r[2].key]=l[r[2].key]=r[2],t[r[3].key]=l[r[3].key]=r[3],delete e[i])}for(const i in e){const r=this.findLoadedParent(e[i],this._source.minzoom);if(r){t[r.tileID.key]=l[r.tileID.key]=r.tileID;for(const e in t)t[e].isChildOf(r.tileID)&&delete t[e]}}for(const e in this._tiles)t[e]||(this._coveredTiles[e]=!0)}}for(const t in l)this._tiles[t].clearFadeHold();const c=t.ab(this._tiles,l);for(const t of c){const e=this._tiles[t];e.hasSymbolBuckets&&!e.holdingForFade()?e.setHoldDuration(this.map._fadeDuration):e.hasSymbolBuckets&&!e.symbolFadeFinished()||this._removeTile(t)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(t)}_updateRetainedTiles(t,e){const i={},r={},n=Math.max(e-K.maxOverzooming,this._source.minzoom),a=Math.max(e+K.maxUnderzooming,this._source.minzoom),o={};for(const r of t){const t=this._addTile(r);i[r.key]=r,t.hasData()||e<this._source.maxzoom&&(o[r.key]=r)}this._retainLoadedChildren(o,e,a,i);for(const a of t){let t=this._tiles[a.key];if(t.hasData())continue;if(e+1>this._source.maxzoom){const t=a.children(this._source.maxzoom)[0],e=this.getTile(t);if(e&&e.hasData()){i[t.key]=t;continue}}else{const t=a.children(this._source.maxzoom);if(i[t[0].key]&&i[t[1].key]&&i[t[2].key]&&i[t[3].key])continue}let o=t.wasRequested();for(let e=a.overscaledZ-1;e>=n;--e){const n=a.scaledTo(e);if(r[n.key])break;if(r[n.key]=!0,t=this.getTile(n),!t&&o&&(t=this._addTile(n)),t){const e=t.hasData();if((o||e)&&(i[n.key]=n),o=t.wasRequested(),e)break}}}return i}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const t in this._tiles){const e=[];let i,r=this._tiles[t].tileID;for(;r.overscaledZ>0;){if(r.key in this._loadedParentTiles){i=this._loadedParentTiles[r.key];break}e.push(r.key);const t=r.scaledTo(r.overscaledZ-1);if(i=this._getLoadedTile(t),i)break;r=t}for(const t of e)this._loadedParentTiles[t]=i}}_addTile(e){let i=this._tiles[e.key];if(i)return i;i=this._cache.getAndRemove(e),i&&(this._setTileReloadTimer(e.key,i),i.tileID=e,this._state.initializeTileState(i,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,i)));const r=i;return i||(i=new G(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(i,this._tileLoaded.bind(this,i,e.key,i.state))),i.uses++,this._tiles[e.key]=i,r||this._source.fire(new t.k("dataloading",{tile:i,coord:i.tileID,dataType:"source"})),i}_setTileReloadTimer(t,e){t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);const i=e.getExpiryTimeout();i&&(this._timers[t]=setTimeout((()=>{this._reloadTile(t,"expired"),delete this._timers[t]}),i))}_removeTile(t){const e=this._tiles[t];e&&(e.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),e.uses>0||(e.hasData()&&"reloading"!==e.state?this._cache.add(e.tileID,e,e.getExpiryTimeout()):(e.aborted=!0,this._abortTile(e),this._unloadTile(e))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const t in this._tiles)this._removeTile(t);this._cache.reset()}tilesIn(e,i,r){const n=[],a=this.transform;if(!a)return n;const o=r?a.getCameraQueryGeometry(e):e,s=e.map((t=>a.pointCoordinate(t,this.terrain))),l=o.map((t=>a.pointCoordinate(t,this.terrain))),c=this.getIds();let h=1/0,u=1/0,d=-1/0,p=-1/0;for(const t of l)h=Math.min(h,t.x),u=Math.min(u,t.y),d=Math.max(d,t.x),p=Math.max(p,t.y);for(let e=0;e<c.length;e++){const r=this._tiles[c[e]];if(r.holdingForFade())continue;const o=r.tileID,m=Math.pow(2,a.zoom-r.tileID.overscaledZ),f=i*r.queryPadding*t.N/r.tileSize/m,g=[o.getTilePoint(new t.U(h,u)),o.getTilePoint(new t.U(d,p))];if(g[0].x-f<t.N&&g[0].y-f<t.N&&g[1].x+f>=0&&g[1].y+f>=0){const t=s.map((t=>o.getTilePoint(t))),e=l.map((t=>o.getTilePoint(t)));n.push({tile:r,tileID:o,queryGeometry:t,cameraQueryGeometry:e,scale:m})}}return n}getVisibleCoordinates(t){const e=this.getRenderableIds(t).map((t=>this._tiles[t].tileID));for(const t of e)t.posMatrix=this.transform.calculatePosMatrix(t.toUnwrapped());return e}hasTransition(){if(this._source.hasTransition())return!0;if(Y(this._source.type)){const e=t.h.now();for(const t in this._tiles)if(this._tiles[t].fadeEndTime>=e)return!0}return!1}setFeatureState(t,e,i){this._state.updateState(t=t||"_geojsonTileLayer",e,i)}removeFeatureState(t,e,i){this._state.removeFeatureState(t=t||"_geojsonTileLayer",e,i)}getFeatureState(t,e){return this._state.getState(t=t||"_geojsonTileLayer",e)}setDependencies(t,e,i){const r=this._tiles[t];r&&r.setDependencies(e,i)}reloadTilesForDependencies(t,e){for(const i in this._tiles)this._tiles[i].hasDependency(t,e)&&this._reloadTile(i,"reloading");this._cache.filter((i=>!i.hasDependency(t,e)))}}function J(t,e){const i=Math.abs(2*t.wrap)-+(t.wrap<0),r=Math.abs(2*e.wrap)-+(e.wrap<0);return t.overscaledZ-e.overscaledZ||r-i||e.canonical.y-t.canonical.y||e.canonical.x-t.canonical.x}function Y(t){return"raster"===t||"image"===t||"video"===t}K.maxOverzooming=10,K.maxUnderzooming=3;const Q="mapboxgl_preloaded_worker_pool";class tt{constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<tt.workerCount;)this.workers.push(new Worker(t.c.WORKER_URL));return this.active[e]=!0,this.workers.slice()}release(t){delete this.active[t],0===this.numActive()&&(this.workers.forEach((t=>{t.terminate()})),this.workers=null)}isPreloaded(){return!!this.active[Q]}numActive(){return Object.keys(this.active).length}}const et=Math.floor(t.h.hardwareConcurrency/2);let it;function rt(){return it||(it=new tt),it}tt.workerCount=t.ac(globalThis)?Math.max(Math.min(et,3),1):1;class nt{constructor(t,e){this.reset(t,e)}reset(t,e){this.points=t||[],this._distances=[0];for(let t=1;t<this.points.length;t++)this._distances[t]=this._distances[t-1]+this.points[t].dist(this.points[t-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(e||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(e){if(1===this.points.length)return this.points[0];e=t.ad(e,0,1);let i=1,r=this._distances[i];const n=e*this.paddedLength+this.padding;for(;r<n&&i<this._distances.length;)r=this._distances[++i];const a=i-1,o=this._distances[a],s=r-o,l=s>0?(n-o)/s:0;return this.points[a].mult(1-l).add(this.points[i].mult(l))}}function at(t,e){let i=!0;return"always"===t||"never"!==t&&"never"!==e||(i=!1),i}class ot{constructor(t,e,i){const r=this.boxCells=[],n=this.circleCells=[];this.xCellCount=Math.ceil(t/i),this.yCellCount=Math.ceil(e/i);for(let t=0;t<this.xCellCount*this.yCellCount;t++)r.push([]),n.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=e,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/e,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(t,e,i,r,n){this._forEachCell(e,i,r,n,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(e),this.bboxes.push(i),this.bboxes.push(r),this.bboxes.push(n)}insertCircle(t,e,i,r){this._forEachCell(e-r,i-r,e+r,i+r,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(e),this.circles.push(i),this.circles.push(r)}_insertBoxCell(t,e,i,r,n,a){this.boxCells[n].push(a)}_insertCircleCell(t,e,i,r,n,a){this.circleCells[n].push(a)}_query(t,e,i,r,n,a,o){if(i<0||t>this.width||r<0||e>this.height)return[];const s=[];if(t<=0&&e<=0&&this.width<=i&&this.height<=r){if(n)return[{key:null,x1:t,y1:e,x2:i,y2:r}];for(let t=0;t<this.boxKeys.length;t++)s.push({key:this.boxKeys[t],x1:this.bboxes[4*t],y1:this.bboxes[4*t+1],x2:this.bboxes[4*t+2],y2:this.bboxes[4*t+3]});for(let t=0;t<this.circleKeys.length;t++){const e=this.circles[3*t],i=this.circles[3*t+1],r=this.circles[3*t+2];s.push({key:this.circleKeys[t],x1:e-r,y1:i-r,x2:e+r,y2:i+r})}}else this._forEachCell(t,e,i,r,this._queryCell,s,{hitTest:n,overlapMode:a,seenUids:{box:{},circle:{}}},o);return s}query(t,e,i,r){return this._query(t,e,i,r,!1,null)}hitTest(t,e,i,r,n,a){return this._query(t,e,i,r,!0,n,a).length>0}hitTestCircle(t,e,i,r,n){const a=t-i,o=t+i,s=e-i,l=e+i;if(o<0||a>this.width||l<0||s>this.height)return!1;const c=[];return this._forEachCell(a,s,o,l,this._queryCellCircle,c,{hitTest:!0,overlapMode:r,circle:{x:t,y:e,radius:i},seenUids:{box:{},circle:{}}},n),c.length>0}_queryCell(t,e,i,r,n,a,o,s){const{seenUids:l,hitTest:c,overlapMode:h}=o,u=this.boxCells[n];if(null!==u){const n=this.bboxes;for(const o of u)if(!l.box[o]){l.box[o]=!0;const u=4*o,d=this.boxKeys[o];if(t<=n[u+2]&&e<=n[u+3]&&i>=n[u+0]&&r>=n[u+1]&&(!s||s(d))&&(!c||!at(h,d.overlapMode))&&(a.push({key:d,x1:n[u],y1:n[u+1],x2:n[u+2],y2:n[u+3]}),c))return!0}}const d=this.circleCells[n];if(null!==d){const n=this.circles;for(const o of d)if(!l.circle[o]){l.circle[o]=!0;const u=3*o,d=this.circleKeys[o];if(this._circleAndRectCollide(n[u],n[u+1],n[u+2],t,e,i,r)&&(!s||s(d))&&(!c||!at(h,d.overlapMode))){const t=n[u],e=n[u+1],i=n[u+2];if(a.push({key:d,x1:t-i,y1:e-i,x2:t+i,y2:e+i}),c)return!0}}}return!1}_queryCellCircle(t,e,i,r,n,a,o,s){const{circle:l,seenUids:c,overlapMode:h}=o,u=this.boxCells[n];if(null!==u){const t=this.bboxes;for(const e of u)if(!c.box[e]){c.box[e]=!0;const i=4*e,r=this.boxKeys[e];if(this._circleAndRectCollide(l.x,l.y,l.radius,t[i+0],t[i+1],t[i+2],t[i+3])&&(!s||s(r))&&!at(h,r.overlapMode))return a.push(!0),!0}}const d=this.circleCells[n];if(null!==d){const t=this.circles;for(const e of d)if(!c.circle[e]){c.circle[e]=!0;const i=3*e,r=this.circleKeys[e];if(this._circlesCollide(t[i],t[i+1],t[i+2],l.x,l.y,l.radius)&&(!s||s(r))&&!at(h,r.overlapMode))return a.push(!0),!0}}}_forEachCell(t,e,i,r,n,a,o,s){const l=this._convertToXCellCoord(t),c=this._convertToYCellCoord(e),h=this._convertToXCellCoord(i),u=this._convertToYCellCoord(r);for(let d=l;d<=h;d++)for(let l=c;l<=u;l++)if(n.call(this,t,e,i,r,this.xCellCount*l+d,a,o,s))return}_convertToXCellCoord(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}_convertToYCellCoord(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}_circlesCollide(t,e,i,r,n,a){const o=r-t,s=n-e,l=i+a;return l*l>o*o+s*s}_circleAndRectCollide(t,e,i,r,n,a,o){const s=(a-r)/2,l=Math.abs(t-(r+s));if(l>s+i)return!1;const c=(o-n)/2,h=Math.abs(e-(n+c));if(h>c+i)return!1;if(l<=s||h<=c)return!0;const u=l-s,d=h-c;return u*u+d*d<=i*i}}function st(e,i,r,n,a){const o=t.Z();return i?(t.a0(o,o,[1/a,1/a,1]),r||t.ae(o,o,n.angle)):t.a1(o,n.labelPlaneMatrix,e),o}function lt(e,i,r,n,a){if(i){const i=t.af(e);return t.a0(i,i,[a,a,1]),r||t.ae(i,i,-n.angle),i}return n.glCoordMatrix}function ct(e,i,r){let n;r?(n=[e.x,e.y,r(e.x,e.y),1],t.ag(n,n,i)):(n=[e.x,e.y,0,1],St(n,n,i));const a=n[3];return{point:new t.P(n[0]/a,n[1]/a),signedDistanceFromCamera:a}}function ht(t,e){return.5+t/e*.5}function ut(t,e){const i=t[0]/t[3],r=t[1]/t[3];return i>=-e[0]&&i<=e[0]&&r>=-e[1]&&r<=e[1]}function dt(e,i,r,n,a,o,s,l,c,h){const u=n?e.textSizeData:e.iconSizeData,d=t.ah(u,r.transform.zoom),p=[256/r.width*2+1,256/r.height*2+1],m=n?e.text.dynamicLayoutVertexArray:e.icon.dynamicLayoutVertexArray;m.clear();const f=e.lineVertexArray,g=n?e.text.placedSymbolArray:e.icon.placedSymbolArray,y=r.transform.width/r.transform.height;let _=!1;for(let n=0;n<g.length;n++){const v=g.get(n);if(v.hidden||v.writingMode===t.ai.vertical&&!_){wt(v.numGlyphs,m);continue}let b;if(_=!1,h?(b=[v.anchorX,v.anchorY,h(v.anchorX,v.anchorY),1],t.ag(b,b,i)):(b=[v.anchorX,v.anchorY,0,1],St(b,b,i)),!ut(b,p)){wt(v.numGlyphs,m);continue}const x=ht(r.transform.cameraToCenterDistance,b[3]),w=t.aj(u,d,v),S=s?w/x:w*x,k=new t.P(v.anchorX,v.anchorY),C=ct(k,a,h).point,A={projections:{},offsets:{}},T=ft(v,S,!1,l,i,a,o,e.glyphOffsetArray,f,m,C,k,A,y,c,h);_=T.useVertical,(T.notEnoughRoom||_||T.needsFlipping&&ft(v,S,!0,l,i,a,o,e.glyphOffsetArray,f,m,C,k,A,y,c,h).notEnoughRoom)&&wt(v.numGlyphs,m)}n?e.text.dynamicLayoutVertexBuffer.updateData(m):e.icon.dynamicLayoutVertexBuffer.updateData(m)}function pt(t,e,i,r,n,a,o,s,l,c,h,u,d){const p=s.glyphStartIndex+s.numGlyphs,m=s.lineStartIndex,f=s.lineStartIndex+s.lineLength,g=e.getoffsetX(s.glyphStartIndex),y=e.getoffsetX(p-1),_=bt(t*g,i,r,n,a,o,s.segment,m,f,l,c,h,u,d);if(!_)return null;const v=bt(t*y,i,r,n,a,o,s.segment,m,f,l,c,h,u,d);return v?{first:_,last:v}:null}function mt(e,i,r,n){return e===t.ai.horizontal&&Math.abs(r.y-i.y)>Math.abs(r.x-i.x)*n?{useVertical:!0}:(e===t.ai.vertical?i.y<r.y:i.x>r.x)?{needsFlipping:!0}:null}function ft(e,i,r,n,a,o,s,l,c,h,u,d,p,m,f,g){const y=i/24,_=e.lineOffsetX*y,v=e.lineOffsetY*y;let b;if(e.numGlyphs>1){const t=e.glyphStartIndex+e.numGlyphs,i=e.lineStartIndex,a=e.lineStartIndex+e.lineLength,h=pt(y,l,_,v,r,u,d,e,c,o,p,f,g);if(!h)return{notEnoughRoom:!0};const x=ct(h.first.point,s,g).point,w=ct(h.last.point,s,g).point;if(n&&!r){const t=mt(e.writingMode,x,w,m);if(t)return t}b=[h.first];for(let n=e.glyphStartIndex+1;n<t-1;n++)b.push(bt(y*l.getoffsetX(n),_,v,r,u,d,e.segment,i,a,c,o,p,f,g));b.push(h.last)}else{if(n&&!r){const i=ct(d,a,g).point,r=e.lineStartIndex+e.segment+1,n=new t.P(c.getx(r),c.gety(r)),o=ct(n,a,g),s=o.signedDistanceFromCamera>0?o.point:gt(d,n,i,1,a,g),l=mt(e.writingMode,i,s,m);if(l)return l}const i=bt(y*l.getoffsetX(e.glyphStartIndex),_,v,r,u,d,e.segment,e.lineStartIndex,e.lineStartIndex+e.lineLength,c,o,p,f,g);if(!i)return{notEnoughRoom:!0};b=[i]}for(const e of b)t.ak(h,e.point,e.angle);return{}}function gt(t,e,i,r,n,a){const o=ct(t.add(t.sub(e)._unit()),n,a).point,s=i.sub(o);return i.add(s._mult(r/s.mag()))}function yt(e,i){const{projectionCache:r,lineVertexArray:n,labelPlaneMatrix:a,tileAnchorPoint:o,distanceFromAnchor:s,getElevation:l,previousVertex:c,direction:h,absOffsetX:u}=i;if(r.projections[e])return r.projections[e];const d=new t.P(n.getx(e),n.gety(e)),p=ct(d,a,l);if(p.signedDistanceFromCamera>0)return r.projections[e]=p.point,p.point;const m=e-h;return gt(0===s?o:new t.P(n.getx(m),n.gety(m)),d,c,u-s+1,a,l)}function _t(t,e,i){return t._unit()._perp()._mult(e*i)}function vt(e,i,r,n,a,o,s,l){const{projectionCache:c,direction:h}=l;if(c.offsets[e])return c.offsets[e];const u=r.add(i);if(e+h<n||e+h>=a)return c.offsets[e]=u,u;const d=yt(e+h,l),p=_t(d.sub(r),s,h),m=r.add(p),f=d.add(p);return c.offsets[e]=t.al(o,u,m,f)||u,c.offsets[e]}function bt(t,e,i,r,n,a,o,s,l,c,h,u,d,p){const m=r?t-e:t+e;let f=m>0?1:-1,g=0;r&&(f*=-1,g=Math.PI),f<0&&(g+=Math.PI);let y,_,v=f>0?s+o:s+o+1,b=n,x=n,w=0,S=0;const k=Math.abs(m),C=[];let A;for(;w+S<=k;){if(v+=f,v<s||v>=l)return null;w+=S,x=b,_=y;const t={projectionCache:u,lineVertexArray:c,labelPlaneMatrix:h,tileAnchorPoint:a,distanceFromAnchor:w,getElevation:p,previousVertex:x,direction:f,absOffsetX:k};if(b=yt(v,t),0===i)C.push(x),A=b.sub(x);else{let e;const r=b.sub(x);e=0===r.mag()?_t(yt(v+f,t).sub(b),i,f):_t(r,i,f),_||(_=x.add(e)),y=vt(v,e,b,s,l,_,i,t),C.push(_),A=y.sub(_)}S=A.mag()}const T=A._mult((k-w)/S)._add(_||x),E=g+Math.atan2(b.y-x.y,b.x-x.x);return C.push(T),{point:T,angle:d?E:0,path:C}}const xt=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function wt(t,e){for(let i=0;i<t;i++){const t=e.length;e.resize(t+4),e.float32.set(xt,3*t)}}function St(t,e,i){const r=e[0],n=e[1];return t[0]=i[0]*r+i[4]*n+i[12],t[1]=i[1]*r+i[5]*n+i[13],t[3]=i[3]*r+i[7]*n+i[15],t}const kt=100;class Ct{constructor(t,e=new ot(t.width+200,t.height+200,25),i=new ot(t.width+200,t.height+200,25)){this.transform=t,this.grid=e,this.ignoredGrid=i,this.pitchfactor=Math.cos(t._pitch)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+kt,this.screenBottomBoundary=t.height+kt,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(t,e,i,r,n,a){const o=this.projectAndGetPerspectiveRatio(r,t.anchorPointX,t.anchorPointY,a),s=i*o.perspectiveRatio,l=t.x1*s+o.point.x,c=t.y1*s+o.point.y,h=t.x2*s+o.point.x,u=t.y2*s+o.point.y;return!this.isInsideGrid(l,c,h,u)||"always"!==e&&this.grid.hitTest(l,c,h,u,e,n)||o.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[l,c,h,u],offscreen:this.isOffscreen(l,c,h,u)}}placeCollisionCircles(e,i,r,n,a,o,s,l,c,h,u,d,p,m){const f=[],g=new t.P(i.anchorX,i.anchorY),y=ct(g,o,m),_=ht(this.transform.cameraToCenterDistance,y.signedDistanceFromCamera),v=(h?a/_:a*_)/t.ap,b=ct(g,s,m).point,x=pt(v,n,i.lineOffsetX*v,i.lineOffsetY*v,!1,b,g,i,r,s,{projections:{},offsets:{}},!1,m);let w=!1,S=!1,k=!0;if(x){const i=.5*d*_+p,r=new t.P(-100,-100),n=new t.P(this.screenRightBoundary,this.screenBottomBoundary),a=new nt,o=x.first,s=x.last;let h=[];for(let t=o.path.length-1;t>=1;t--)h.push(o.path[t]);for(let t=1;t<s.path.length;t++)h.push(s.path[t]);const g=2.5*i;if(l){const t=h.map((t=>ct(t,l,m)));h=t.some((t=>t.signedDistanceFromCamera<=0))?[]:t.map((t=>t.point))}let y=[];if(h.length>0){const e=h[0].clone(),i=h[0].clone();for(let t=1;t<h.length;t++)e.x=Math.min(e.x,h[t].x),e.y=Math.min(e.y,h[t].y),i.x=Math.max(i.x,h[t].x),i.y=Math.max(i.y,h[t].y);y=e.x>=r.x&&i.x<=n.x&&e.y>=r.y&&i.y<=n.y?[h]:i.x<r.x||e.x>n.x||i.y<r.y||e.y>n.y?[]:t.am([h],r.x,r.y,n.x,n.y)}for(const t of y){a.reset(t,.25*i);let r=0;r=a.length<=.5*i?1:Math.ceil(a.paddedLength/g)+1;for(let t=0;t<r;t++){const n=t/Math.max(r-1,1),o=a.lerp(n),s=o.x+kt,l=o.y+kt;f.push(s,l,i,0);const h=s-i,d=l-i,p=s+i,m=l+i;if(k=k&&this.isOffscreen(h,d,p,m),S=S||this.isInsideGrid(h,d,p,m),"always"!==e&&this.grid.hitTestCircle(s,l,i,e,u)&&(w=!0,!c))return{circles:[],offscreen:!1,collisionDetected:w}}}}return{circles:!c&&w||!S||_<this.perspectiveRatioCutoff?[]:f,offscreen:k,collisionDetected:w}}queryRenderedSymbols(e){if(0===e.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const i=[];let r=1/0,n=1/0,a=-1/0,o=-1/0;for(const s of e){const e=new t.P(s.x+kt,s.y+kt);r=Math.min(r,e.x),n=Math.min(n,e.y),a=Math.max(a,e.x),o=Math.max(o,e.y),i.push(e)}const s=this.grid.query(r,n,a,o).concat(this.ignoredGrid.query(r,n,a,o)),l={},c={};for(const e of s){const r=e.key;if(void 0===l[r.bucketInstanceId]&&(l[r.bucketInstanceId]={}),l[r.bucketInstanceId][r.featureIndex])continue;const n=[new t.P(e.x1,e.y1),new t.P(e.x2,e.y1),new t.P(e.x2,e.y2),new t.P(e.x1,e.y2)];t.an(i,n)&&(l[r.bucketInstanceId][r.featureIndex]=!0,void 0===c[r.bucketInstanceId]&&(c[r.bucketInstanceId]=[]),c[r.bucketInstanceId].push(r.featureIndex))}return c}insertCollisionBox(t,e,i,r,n,a){(i?this.ignoredGrid:this.grid).insert({bucketInstanceId:r,featureIndex:n,collisionGroupID:a,overlapMode:e},t[0],t[1],t[2],t[3])}insertCollisionCircles(t,e,i,r,n,a){const o=i?this.ignoredGrid:this.grid,s={bucketInstanceId:r,featureIndex:n,collisionGroupID:a,overlapMode:e};for(let e=0;e<t.length;e+=4)o.insertCircle(s,t[e],t[e+1],t[e+2])}projectAndGetPerspectiveRatio(e,i,r,n){let a;return n?(a=[i,r,n(i,r),1],t.ag(a,a,e)):(a=[i,r,0,1],St(a,a,e)),{point:new t.P((a[0]/a[3]+1)/2*this.transform.width+kt,(-a[1]/a[3]+1)/2*this.transform.height+kt),perspectiveRatio:.5+this.transform.cameraToCenterDistance/a[3]*.5}}isOffscreen(t,e,i,r){return i<kt||t>=this.screenRightBoundary||r<kt||e>this.screenBottomBoundary}isInsideGrid(t,e,i,r){return i>=0&&t<this.gridRightBoundary&&r>=0&&e<this.gridBottomBoundary}getViewportMatrix(){const e=t.ao([]);return t.$(e,e,[-100,-100,0]),e}}function At(e,i,r){return i*(t.N/(e.tileSize*Math.pow(2,r-e.tileID.overscaledZ)))}class Tt{constructor(t,e,i,r){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?e:-e))):r&&i?1:0,this.placed=i}isHidden(){return 0===this.opacity&&!this.placed}}class Et{constructor(t,e,i,r,n){this.text=new Tt(t?t.text:null,e,i,n),this.icon=new Tt(t?t.icon:null,e,r,n)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Mt{constructor(t,e,i){this.text=t,this.icon=e,this.skipFade=i}}class It{constructor(){this.invProjMatrix=t.Z(),this.viewportMatrix=t.Z(),this.circles=[]}}class zt{constructor(t,e,i,r,n){this.bucketInstanceId=t,this.featureIndex=e,this.sourceLayerIndex=i,this.bucketIndex=r,this.tileID=n}}class Pt{constructor(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}get(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){const e=++this.maxGroupID;this.collisionGroups[t]={ID:e,predicate:t=>t.collisionGroupID===e}}return this.collisionGroups[t]}}function Lt(e,i,r,n,a){const{horizontalAlign:o,verticalAlign:s}=t.au(e);return new t.P(-(o-.5)*i+n[0]*a,-(s-.5)*r+n[1]*a)}function Dt(e,i,r,n,a,o){const{x1:s,x2:l,y1:c,y2:h,anchorPointX:u,anchorPointY:d}=e,p=new t.P(i,r);return n&&p._rotate(a?o:-o),{x1:s+p.x,y1:c+p.y,x2:l+p.x,y2:h+p.y,anchorPointX:u,anchorPointY:d}}class Rt{constructor(t,e,i,r,n){this.transform=t.clone(),this.terrain=e,this.collisionIndex=new Ct(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=i,this.retainedQueryData={},this.collisionGroups=new Pt(r),this.collisionCircleArrays={},this.prevPlacement=n,n&&(n.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(e,i,r,n){const a=r.getBucket(i),o=r.latestFeatureIndex;if(!a||!o||i.id!==a.layerIds[0])return;const s=r.collisionBoxArray,l=a.layers[0].layout,c=Math.pow(2,this.transform.zoom-r.tileID.overscaledZ),h=r.tileSize/t.N,u=this.transform.calculatePosMatrix(r.tileID.toUnwrapped()),d="map"===l.get("text-pitch-alignment"),p="map"===l.get("text-rotation-alignment"),m=At(r,1,this.transform.zoom),f=st(u,d,p,this.transform,m);let g=null;if(d){const e=lt(u,d,p,this.transform,m);g=t.a1([],this.transform.labelPlaneMatrix,e)}this.retainedQueryData[a.bucketInstanceId]=new zt(a.bucketInstanceId,o,a.sourceLayerIndex,a.index,r.tileID);const y={bucket:a,layout:l,posMatrix:u,textLabelPlaneMatrix:f,labelToScreenMatrix:g,scale:c,textPixelRatio:h,holdingForFade:r.holdingForFade(),collisionBoxArray:s,partiallyEvaluatedTextSize:t.ah(a.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(a.sourceID)};if(n)for(const t of a.sortKeyRanges){const{sortKey:i,symbolInstanceStart:r,symbolInstanceEnd:n}=t;e.push({sortKey:i,symbolInstanceStart:r,symbolInstanceEnd:n,parameters:y})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:a.symbolInstances.length,parameters:y})}attemptAnchorPlacement(e,i,r,n,a,o,s,l,c,h,u,d,p,m,f,g){const y=t.aq[e.textAnchor],_=[e.textOffset0,e.textOffset1],v=Lt(y,r,n,_,a),b=this.collisionIndex.placeCollisionBox(Dt(i,v.x,v.y,o,s,this.transform.angle),u,l,c,h.predicate,g);if((!f||0!==this.collisionIndex.placeCollisionBox(Dt(f,v.x,v.y,o,s,this.transform.angle),u,l,c,h.predicate,g).box.length)&&b.box.length>0){let t;if(this.prevPlacement&&this.prevPlacement.variableOffsets[d.crossTileID]&&this.prevPlacement.placements[d.crossTileID]&&this.prevPlacement.placements[d.crossTileID].text&&(t=this.prevPlacement.variableOffsets[d.crossTileID].anchor),0===d.crossTileID)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[d.crossTileID]={textOffset:_,width:r,height:n,anchor:y,textBoxScale:a,prevAnchor:t},this.markUsedJustification(p,y,d,m),p.allowVerticalPlacement&&(this.markUsedOrientation(p,m,d),this.placedOrientations[d.crossTileID]=m),{shift:v,placedGlyphBoxes:b}}}placeLayerBucketPart(e,i,r){const{bucket:n,layout:a,posMatrix:o,textLabelPlaneMatrix:s,labelToScreenMatrix:l,textPixelRatio:c,holdingForFade:h,collisionBoxArray:u,partiallyEvaluatedTextSize:d,collisionGroup:p}=e.parameters,m=a.get("text-optional"),f=a.get("icon-optional"),g=t.ar(a,"text-overlap","text-allow-overlap"),y="always"===g,_=t.ar(a,"icon-overlap","icon-allow-overlap"),v="always"===_,b="map"===a.get("text-rotation-alignment"),x="map"===a.get("text-pitch-alignment"),w="none"!==a.get("icon-text-fit"),S="viewport-y"===a.get("symbol-z-order"),k=y&&(v||!n.hasIconData()||f),C=v&&(y||!n.hasTextData()||m);!n.collisionArrays&&u&&n.deserializeCollisionBoxes(u);const A=this.retainedQueryData[n.bucketInstanceId].tileID,T=this.terrain?(t,e)=>this.terrain.getElevation(A,t,e):null,E=(e,u)=>{var v,S;if(i[e.crossTileID])return;if(h)return void(this.placements[e.crossTileID]=new Mt(!1,!1,!1));let A=!1,E=!1,M=!0,I=null,z={box:null,offscreen:null},P={box:null,offscreen:null},L=null,D=null,R=null,B=0,F=0,O=0;u.textFeatureIndex?B=u.textFeatureIndex:e.useRuntimeCollisionCircles&&(B=e.featureIndex),u.verticalTextFeatureIndex&&(F=u.verticalTextFeatureIndex);const $=u.textBox;if($){const i=i=>{let r=t.ai.horizontal;if(n.allowVerticalPlacement&&!i&&this.prevPlacement){const t=this.prevPlacement.placedOrientations[e.crossTileID];t&&(this.placedOrientations[e.crossTileID]=t,r=t,this.markUsedOrientation(n,r,e))}return r},r=(i,r)=>{if(n.allowVerticalPlacement&&e.numVerticalGlyphVertices>0&&u.verticalTextBox){for(const e of n.writingModes)if(e===t.ai.vertical?(z=r(),P=z):z=i(),z&&z.box&&z.box.length)break}else z=i()},a=e.textAnchorOffsetStartIndex,s=e.textAnchorOffsetEndIndex;if(s===a){const a=(t,i)=>{const r=this.collisionIndex.placeCollisionBox(t,g,c,o,p.predicate,T);return r&&r.box&&r.box.length&&(this.markUsedOrientation(n,i,e),this.placedOrientations[e.crossTileID]=i),r};r((()=>a($,t.ai.horizontal)),(()=>{const i=u.verticalTextBox;return n.allowVerticalPlacement&&e.numVerticalGlyphVertices>0&&i?a(i,t.ai.vertical):{box:null,offscreen:null}})),i(z&&z.box&&z.box.length)}else{let l=t.aq[null===(S=null===(v=this.prevPlacement)||void 0===v?void 0:v.variableOffsets[e.crossTileID])||void 0===S?void 0:S.anchor];const h=(t,i,r)=>{const h=t.x2-t.x1,u=t.y2-t.y1,d=e.textBoxScale,m=w&&"never"===_?i:null;let f={box:[],offscreen:!1},y="never"===g?1:2,v="never";l&&y++;for(let i=0;i<y;i++){for(let i=a;i<s;i++){const a=n.textAnchorOffsets.get(i);if(l&&a.textAnchor!==l)continue;const s=this.attemptAnchorPlacement(a,t,h,u,d,b,x,c,o,p,v,e,n,r,m,T);if(s&&(f=s.placedGlyphBoxes,f&&f.box&&f.box.length))return A=!0,I=s.shift,f}l?l=null:v=g}return f};r((()=>h($,u.iconBox,t.ai.horizontal)),(()=>{const i=u.verticalTextBox;return n.allowVerticalPlacement&&!(z&&z.box&&z.box.length)&&e.numVerticalGlyphVertices>0&&i?h(i,u.verticalIconBox,t.ai.vertical):{box:null,offscreen:null}})),z&&(A=z.box,M=z.offscreen);const d=i(z&&z.box);if(!A&&this.prevPlacement){const t=this.prevPlacement.variableOffsets[e.crossTileID];t&&(this.variableOffsets[e.crossTileID]=t,this.markUsedJustification(n,t.anchor,e,d))}}}if(L=z,A=L&&L.box&&L.box.length>0,M=L&&L.offscreen,e.useRuntimeCollisionCircles){const i=n.text.placedSymbolArray.get(e.centerJustifiedTextSymbolIndex),c=t.aj(n.textSizeData,d,i),h=a.get("text-padding");D=this.collisionIndex.placeCollisionCircles(g,i,n.lineVertexArray,n.glyphOffsetArray,c,o,s,l,r,x,p.predicate,e.collisionCircleDiameter,h,T),D.circles.length&&D.collisionDetected&&!r&&t.w("Collisions detected, but collision boxes are not shown"),A=y||D.circles.length>0&&!D.collisionDetected,M=M&&D.offscreen}if(u.iconFeatureIndex&&(O=u.iconFeatureIndex),u.iconBox){const t=t=>{const e=w&&I?Dt(t,I.x,I.y,b,x,this.transform.angle):t;return this.collisionIndex.placeCollisionBox(e,_,c,o,p.predicate,T)};P&&P.box&&P.box.length&&u.verticalIconBox?(R=t(u.verticalIconBox),E=R.box.length>0):(R=t(u.iconBox),E=R.box.length>0),M=M&&R.offscreen}const V=m||0===e.numHorizontalGlyphVertices&&0===e.numVerticalGlyphVertices,N=f||0===e.numIconVertices;if(V||N?N?V||(E=E&&A):A=E&&A:E=A=E&&A,A&&L&&L.box&&this.collisionIndex.insertCollisionBox(L.box,g,a.get("text-ignore-placement"),n.bucketInstanceId,P&&P.box&&F?F:B,p.ID),E&&R&&this.collisionIndex.insertCollisionBox(R.box,_,a.get("icon-ignore-placement"),n.bucketInstanceId,O,p.ID),D&&(A&&this.collisionIndex.insertCollisionCircles(D.circles,g,a.get("text-ignore-placement"),n.bucketInstanceId,B,p.ID),r)){const t=n.bucketInstanceId;let e=this.collisionCircleArrays[t];void 0===e&&(e=this.collisionCircleArrays[t]=new It);for(let t=0;t<D.circles.length;t+=4)e.circles.push(D.circles[t+0]),e.circles.push(D.circles[t+1]),e.circles.push(D.circles[t+2]),e.circles.push(D.collisionDetected?1:0)}if(0===e.crossTileID)throw new Error("symbolInstance.crossTileID can't be 0");if(0===n.bucketInstanceId)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[e.crossTileID]=new Mt(A||k,E||C,M||n.justReloaded),i[e.crossTileID]=!0};if(S){if(0!==e.symbolInstanceStart)throw new Error("bucket.bucketInstanceId should be 0");const t=n.getSortedSymbolIndexes(this.transform.angle);for(let e=t.length-1;e>=0;--e){const i=t[e];E(n.symbolInstances.get(i),n.collisionArrays[i])}}else for(let t=e.symbolInstanceStart;t<e.symbolInstanceEnd;t++)E(n.symbolInstances.get(t),n.collisionArrays[t]);if(r&&n.bucketInstanceId in this.collisionCircleArrays){const e=this.collisionCircleArrays[n.bucketInstanceId];t.as(e.invProjMatrix,o),e.viewportMatrix=this.collisionIndex.getViewportMatrix()}n.justReloaded=!1}markUsedJustification(e,i,r,n){let a;a=n===t.ai.vertical?r.verticalPlacedTextSymbolIndex:{left:r.leftJustifiedTextSymbolIndex,center:r.centerJustifiedTextSymbolIndex,right:r.rightJustifiedTextSymbolIndex}[t.at(i)];const o=[r.leftJustifiedTextSymbolIndex,r.centerJustifiedTextSymbolIndex,r.rightJustifiedTextSymbolIndex,r.verticalPlacedTextSymbolIndex];for(const t of o)t>=0&&(e.text.placedSymbolArray.get(t).crossTileID=a>=0&&t!==a?0:r.crossTileID)}markUsedOrientation(e,i,r){const n=i===t.ai.horizontal||i===t.ai.horizontalOnly?i:0,a=i===t.ai.vertical?i:0,o=[r.leftJustifiedTextSymbolIndex,r.centerJustifiedTextSymbolIndex,r.rightJustifiedTextSymbolIndex];for(const t of o)e.text.placedSymbolArray.get(t).placedOrientation=n;r.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(r.verticalPlacedTextSymbolIndex).placedOrientation=a)}commit(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;const e=this.prevPlacement;let i=!1;this.prevZoomAdjustment=e?e.zoomAdjustment(this.transform.zoom):0;const r=e?e.symbolFadeChange(t):1,n=e?e.opacities:{},a=e?e.variableOffsets:{},o=e?e.placedOrientations:{};for(const t in this.placements){const e=this.placements[t],a=n[t];a?(this.opacities[t]=new Et(a,r,e.text,e.icon),i=i||e.text!==a.text.placed||e.icon!==a.icon.placed):(this.opacities[t]=new Et(null,r,e.text,e.icon,e.skipFade),i=i||e.text||e.icon)}for(const t in n){const e=n[t];if(!this.opacities[t]){const n=new Et(e,r,!1,!1);n.isHidden()||(this.opacities[t]=n,i=i||e.text.placed||e.icon.placed)}}for(const t in a)this.variableOffsets[t]||!this.opacities[t]||this.opacities[t].isHidden()||(this.variableOffsets[t]=a[t]);for(const t in o)this.placedOrientations[t]||!this.opacities[t]||this.opacities[t].isHidden()||(this.placedOrientations[t]=o[t]);if(e&&void 0===e.lastPlacementChangeTime)throw new Error("Last placement time for previous placement is not defined");i?this.lastPlacementChangeTime=t:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=e?e.lastPlacementChangeTime:t)}updateLayerOpacities(t,e){const i={};for(const r of e){const e=r.getBucket(t);e&&r.latestFeatureIndex&&t.id===e.layerIds[0]&&this.updateBucketOpacities(e,i,r.collisionBoxArray)}}updateBucketOpacities(e,i,r){e.hasTextData()&&(e.text.opacityVertexArray.clear(),e.text.hasVisibleVertices=!1),e.hasIconData()&&(e.icon.opacityVertexArray.clear(),e.icon.hasVisibleVertices=!1),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();const n=e.layers[0],a=n.layout,o=new Et(null,0,!1,!1,!0),s=a.get("text-allow-overlap"),l=a.get("icon-allow-overlap"),c=n._unevaluatedLayout.hasValue("text-variable-anchor")||n._unevaluatedLayout.hasValue("text-variable-anchor-offset"),h="map"===a.get("text-rotation-alignment"),u="map"===a.get("text-pitch-alignment"),d="none"!==a.get("icon-text-fit"),p=new Et(null,0,s&&(l||!e.hasIconData()||a.get("icon-optional")),l&&(s||!e.hasTextData()||a.get("text-optional")),!0);!e.collisionArrays&&r&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(r);const m=(t,e,i)=>{for(let r=0;r<e/4;r++)t.opacityVertexArray.emplaceBack(i);t.hasVisibleVertices=t.hasVisibleVertices||i!==Ht};for(let r=0;r<e.symbolInstances.length;r++){const n=e.symbolInstances.get(r),{numHorizontalGlyphVertices:a,numVerticalGlyphVertices:s,crossTileID:l}=n;let f=this.opacities[l];i[l]?f=o:f||(f=p,this.opacities[l]=f),i[l]=!0;const g=n.numIconVertices>0,y=this.placedOrientations[n.crossTileID],_=y===t.ai.vertical,v=y===t.ai.horizontal||y===t.ai.horizontalOnly;if(a>0||s>0){const t=Zt(f.text);m(e.text,a,_?Ht:t),m(e.text,s,v?Ht:t);const i=f.text.isHidden();[n.rightJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.leftJustifiedTextSymbolIndex].forEach((t=>{t>=0&&(e.text.placedSymbolArray.get(t).hidden=i||_?1:0)})),n.verticalPlacedTextSymbolIndex>=0&&(e.text.placedSymbolArray.get(n.verticalPlacedTextSymbolIndex).hidden=i||v?1:0);const r=this.variableOffsets[n.crossTileID];r&&this.markUsedJustification(e,r.anchor,n,y);const o=this.placedOrientations[n.crossTileID];o&&(this.markUsedJustification(e,"left",n,o),this.markUsedOrientation(e,o,n))}if(g){const t=Zt(f.icon),i=!(d&&n.verticalPlacedIconSymbolIndex&&_);n.placedIconSymbolIndex>=0&&(m(e.icon,n.numIconVertices,i?t:Ht),e.icon.placedSymbolArray.get(n.placedIconSymbolIndex).hidden=f.icon.isHidden()),n.verticalPlacedIconSymbolIndex>=0&&(m(e.icon,n.numVerticalIconVertices,i?Ht:t),e.icon.placedSymbolArray.get(n.verticalPlacedIconSymbolIndex).hidden=f.icon.isHidden())}if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){const i=e.collisionArrays[r];if(i){let r=new t.P(0,0);if(i.textBox||i.verticalTextBox){let t=!0;if(c){const e=this.variableOffsets[l];e?(r=Lt(e.anchor,e.width,e.height,e.textOffset,e.textBoxScale),h&&r._rotate(u?this.transform.angle:-this.transform.angle)):t=!1}i.textBox&&Bt(e.textCollisionBox.collisionVertexArray,f.text.placed,!t||_,r.x,r.y),i.verticalTextBox&&Bt(e.textCollisionBox.collisionVertexArray,f.text.placed,!t||v,r.x,r.y)}const n=Boolean(!v&&i.verticalIconBox);i.iconBox&&Bt(e.iconCollisionBox.collisionVertexArray,f.icon.placed,n,d?r.x:0,d?r.y:0),i.verticalIconBox&&Bt(e.iconCollisionBox.collisionVertexArray,f.icon.placed,!n,d?r.x:0,d?r.y:0)}}}if(e.sortFeatures(this.transform.angle),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.text.opacityVertexArray.length!==e.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${e.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${e.text.layoutVertexArray.length}) / 4`);if(e.icon.opacityVertexArray.length!==e.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${e.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${e.icon.layoutVertexArray.length}) / 4`);if(e.bucketInstanceId in this.collisionCircleArrays){const t=this.collisionCircleArrays[e.bucketInstanceId];e.placementInvProjMatrix=t.invProjMatrix,e.placementViewportMatrix=t.viewportMatrix,e.collisionCircleArray=t.circles,delete this.collisionCircleArrays[e.bucketInstanceId]}}symbolFadeChange(t){return 0===this.fadeDuration?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(t){return Math.max(0,(this.transform.zoom-t)/1.5)}hasTransitions(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(t,e){const i=this.zoomAtLastRecencyCheck===e?1-this.zoomAdjustment(e):1;return this.zoomAtLastRecencyCheck=e,this.commitTime+this.fadeDuration*i>t}setStale(){this.stale=!0}}function Bt(t,e,i,r,n){t.emplaceBack(e?1:0,i?1:0,r||0,n||0),t.emplaceBack(e?1:0,i?1:0,r||0,n||0),t.emplaceBack(e?1:0,i?1:0,r||0,n||0),t.emplaceBack(e?1:0,i?1:0,r||0,n||0)}const Ft=Math.pow(2,25),Ot=Math.pow(2,24),$t=Math.pow(2,17),Vt=Math.pow(2,16),Nt=Math.pow(2,9),jt=Math.pow(2,8),Ut=Math.pow(2,1);function Zt(t){if(0===t.opacity&&!t.placed)return 0;if(1===t.opacity&&t.placed)return 4294967295;const e=t.placed?1:0,i=Math.floor(127*t.opacity);return i*Ft+e*Ot+i*$t+e*Vt+i*Nt+e*jt+i*Ut+e}const Ht=0;class qt{constructor(t){this._sortAcrossTiles="viewport-y"!==t.layout.get("symbol-z-order")&&!t.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(t,e,i,r,n){const a=this._bucketParts;for(;this._currentTileIndex<t.length;)if(e.getBucketParts(a,r,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,n())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,a.sort(((t,e)=>t.sortKey-e.sortKey)));this._currentPartIndex<a.length;)if(e.placeLayerBucketPart(a[this._currentPartIndex],this._seenCrossTileIDs,i),this._currentPartIndex++,n())return!0;return!1}}class Gt{constructor(t,e,i,r,n,a,o,s){this.placement=new Rt(t,e,a,o,s),this._currentPlacementIndex=i.length-1,this._forceFullPlacement=r,this._showCollisionBoxes=n,this._done=!1}isDone(){return this._done}continuePlacement(e,i,r){const n=t.h.now(),a=()=>!this._forceFullPlacement&&t.h.now()-n>2;for(;this._currentPlacementIndex>=0;){const t=i[e[this._currentPlacementIndex]],n=this.placement.collisionIndex.transform.zoom;if("symbol"===t.type&&(!t.minzoom||t.minzoom<=n)&&(!t.maxzoom||t.maxzoom>n)){if(this._inProgressLayer||(this._inProgressLayer=new qt(t)),this._inProgressLayer.continuePlacement(r[t.source],this.placement,this._showCollisionBoxes,t,a))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(t){return this.placement.commit(t),this.placement}}const Wt=512/t.N/2;class Xt{constructor(e,i,r){this.tileID=e,this.bucketInstanceId=r,this._symbolsByKey={};const n=new Map;for(let t=0;t<i.length;t++){const e=i.get(t),r=e.key,a=n.get(r);a?a.push(e):n.set(r,[e])}for(const[e,i]of n){const r={positions:i.map((t=>({x:Math.floor(t.anchorX*Wt),y:Math.floor(t.anchorY*Wt)}))),crossTileIDs:i.map((t=>t.crossTileID))};if(r.positions.length>128){const e=new t.av(r.positions.length,16,Uint16Array);for(const{x:t,y:i}of r.positions)e.add(t,i);e.finish(),delete r.positions,r.index=e}this._symbolsByKey[e]=r}}getScaledCoordinates(e,i){const{x:r,y:n,z:a}=this.tileID.canonical,{x:o,y:s,z:l}=i.canonical,c=Wt/Math.pow(2,l-a),h=(s*t.N+e.anchorY)*c,u=n*t.N*Wt;return{x:Math.floor((o*t.N+e.anchorX)*c-r*t.N*Wt),y:Math.floor(h-u)}}findMatches(t,e,i){const r=this.tileID.canonical.z<e.canonical.z?1:Math.pow(2,this.tileID.canonical.z-e.canonical.z);for(let n=0;n<t.length;n++){const a=t.get(n);if(a.crossTileID)continue;const o=this._symbolsByKey[a.key];if(!o)continue;const s=this.getScaledCoordinates(a,e);if(o.index){const t=o.index.range(s.x-r,s.y-r,s.x+r,s.y+r).sort();for(const e of t){const t=o.crossTileIDs[e];if(!i[t]){i[t]=!0,a.crossTileID=t;break}}}else if(o.positions)for(let t=0;t<o.positions.length;t++){const e=o.positions[t],n=o.crossTileIDs[t];if(Math.abs(e.x-s.x)<=r&&Math.abs(e.y-s.y)<=r&&!i[n]){i[n]=!0,a.crossTileID=n;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map((({crossTileIDs:t})=>t))}}class Kt{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Jt{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(t){const e=Math.round((t-this.lng)/360);if(0!==e)for(const t in this.indexes){const i=this.indexes[t],r={};for(const t in i){const n=i[t];n.tileID=n.tileID.unwrapTo(n.tileID.wrap+e),r[n.tileID.key]=n}this.indexes[t]=r}this.lng=t}addBucket(t,e,i){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===e.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(let t=0;t<e.symbolInstances.length;t++)e.symbolInstances.get(t).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});const r=this.usedCrossTileIDs[t.overscaledZ];for(const i in this.indexes){const n=this.indexes[i];if(Number(i)>t.overscaledZ)for(const i in n){const a=n[i];a.tileID.isChildOf(t)&&a.findMatches(e.symbolInstances,t,r)}else{const a=n[t.scaledTo(Number(i)).key];a&&a.findMatches(e.symbolInstances,t,r)}}for(let t=0;t<e.symbolInstances.length;t++){const n=e.symbolInstances.get(t);n.crossTileID||(n.crossTileID=i.generate(),r[n.crossTileID]=!0)}return void 0===this.indexes[t.overscaledZ]&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new Xt(t,e.symbolInstances,e.bucketInstanceId),!0}removeBucketCrossTileIDs(t,e){for(const i of e.getCrossTileIDsLists())for(const e of i)delete this.usedCrossTileIDs[t][e]}removeStaleBuckets(t){let e=!1;for(const i in this.indexes){const r=this.indexes[i];for(const n in r)t[r[n].bucketInstanceId]||(this.removeBucketCrossTileIDs(i,r[n]),delete r[n],e=!0)}return e}}class Yt{constructor(){this.layerIndexes={},this.crossTileIDs=new Kt,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(t,e,i){let r=this.layerIndexes[t.id];void 0===r&&(r=this.layerIndexes[t.id]=new Jt);let n=!1;const a={};r.handleWrapJump(i);for(const i of e){const e=i.getBucket(t);e&&t.id===e.layerIds[0]&&(e.bucketInstanceId||(e.bucketInstanceId=++this.maxBucketInstanceId),r.addBucket(i.tileID,e,this.crossTileIDs)&&(n=!0),a[e.bucketInstanceId]=!0)}return r.removeStaleBuckets(a)&&(n=!0),n}pruneUnusedLayers(t){const e={};t.forEach((t=>{e[t]=!0}));for(const t in this.layerIndexes)e[t]||delete this.layerIndexes[t]}}const Qt=(e,i)=>t.x(e,i&&i.filter((t=>"source.canvas"!==t.identifier))),te=t.F(t.ax,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setGlyphs","setSprite"]),ee=t.F(t.ax,["setCenter","setZoom","setBearing","setPitch"]),ie=t.aw();class re extends t.E{constructor(e,i={}){super(),this.map=e,this.dispatcher=new I(rt(),this,e._getMapId()),this.imageManager=new x,this.imageManager.setEventedParent(this),this.glyphManager=new C(e._requestManager,i.localIdeographFontFamily),this.lineAtlas=new M(256,512),this.crossTileSymbolIndex=new Yt,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new t.ay,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",t.az());const r=this;this._rtlTextPluginCallback=re.registerForPluginStateChange((e=>{r.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:e.pluginStatus,pluginURL:e.pluginURL},((e,i)=>{if(t.aA(e),i&&i.every((t=>t)))for(const t in r.sourceCaches){const e=r.sourceCaches[t].getSource().type;"vector"!==e&&"geojson"!==e||r.sourceCaches[t].reload()}}))})),this.on("data",(t=>{if("source"!==t.dataType||"metadata"!==t.sourceDataType)return;const e=this.sourceCaches[t.sourceId];if(!e)return;const i=e.getSource();if(i&&i.vectorLayerIds)for(const t in this._layers){const e=this._layers[t];e.source===i.id&&this._validateLayer(e)}}))}loadURL(e,i={},r){this.fire(new t.k("dataloading",{dataType:"style"})),i.validate="boolean"!=typeof i.validate||i.validate;const n=this.map._requestManager.transformRequest(e,h.Style);this._request=t.f(n,((e,n)=>{this._request=null,e?this.fire(new t.j(e)):n&&this._load(n,i,r)}))}loadJSON(e,i={},r){this.fire(new t.k("dataloading",{dataType:"style"})),this._request=t.h.frame((()=>{this._request=null,i.validate=!1!==i.validate,this._load(e,i,r)}))}loadEmpty(){this.fire(new t.k("dataloading",{dataType:"style"})),this._load(ie,{validate:!1})}_load(e,i,r){var n;const a=i.transformStyle?i.transformStyle(r,e):e;if(!i.validate||!Qt(this,t.y(a))){this._loaded=!0,this.stylesheet=a;for(const t in a.sources)this.addSource(t,a.sources[t],{validate:!1});a.sprite?this._loadSprite(a.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(a.glyphs),this._createLayers(),this.light=new E(this.stylesheet.light),this.map.setTerrain(null!==(n=this.stylesheet.terrain)&&void 0!==n?n:null),this.fire(new t.k("data",{dataType:"style"})),this.fire(new t.k("style.load"))}}_createLayers(){const e=t.aB(this.stylesheet.layers);this.dispatcher.broadcast("setLayers",e),this._order=e.map((t=>t.id)),this._layers={},this._serializedLayers=null;for(const i of e){const e=t.aC(i);e.setEventedParent(this,{layer:{id:i.id}}),this._layers[i.id]=e}}_loadSprite(e,i=!1,r=void 0){this.imageManager.setLoaded(!1),this._spriteRequest=function(e,i,r,n){const a=y(e),o=a.length,s=r>1?"@2x":"",l={},u={},d={};for(const{id:e,url:r}of a){const a=i.transformRequest(i.normalizeSpriteURL(r,s,".json"),h.SpriteJSON),p=`${e}_${a.url}`;l[p]=t.f(a,((t,i)=>{delete l[p],u[e]=i,_(n,u,d,t,o)}));const m=i.transformRequest(i.normalizeSpriteURL(r,s,".png"),h.SpriteImage),f=`${e}_${m.url}`;l[f]=c.getImage(m,((t,i)=>{delete l[f],d[e]=i,_(n,u,d,t,o)}))}return{cancel(){for(const t of Object.values(l))t.cancel()}}}(e,this.map._requestManager,this.map.getPixelRatio(),((e,n)=>{if(this._spriteRequest=null,e)this.fire(new t.j(e));else if(n)for(const t in n){this._spritesImagesIds[t]=[];const e=this._spritesImagesIds[t]?this._spritesImagesIds[t].filter((t=>!(t in n))):[];for(const t of e)this.imageManager.removeImage(t),this._changedImages[t]=!0;for(const e in n[t]){const r="default"===t?e:`${t}:${e}`;this._spritesImagesIds[t].push(r),r in this.imageManager.images?this.imageManager.updateImage(r,n[t][e],!1):this.imageManager.addImage(r,n[t][e]),i&&(this._changedImages[r]=!0)}}this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),i&&(this._changed=!0),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new t.k("data",{dataType:"style"})),r&&r(e)}))}_unloadSprite(){for(const t of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(t),this._changedImages[t]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new t.k("data",{dataType:"style"}))}_validateLayer(e){const i=this.sourceCaches[e.source];if(!i)return;const r=e.sourceLayer;if(!r)return;const n=i.getSource();("geojson"===n.type||n.vectorLayerIds&&-1===n.vectorLayerIds.indexOf(r))&&this.fire(new t.j(new Error(`Source layer "${r}" does not exist on source "${n.id}" as specified by style layer "${e.id}".`)))}loaded(){if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(const t in this.sourceCaches)if(!this.sourceCaches[t].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(t){const e=this._serializedAllLayers();if(!t||0===t.length)return Object.values(e);const i=[];for(const r of t)e[r]&&i.push(e[r]);return i}_serializedAllLayers(){let t=this._serializedLayers;if(t)return t;t=this._serializedLayers={};const e=Object.keys(this._layers);for(const i of e){const e=this._layers[i];"custom"!==e.type&&(t[i]=e.serialize())}return t}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const t in this.sourceCaches)if(this.sourceCaches[t].hasTransition())return!0;for(const t in this._layers)if(this._layers[t].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(e){if(!this._loaded)return;const i=this._changed;if(this._changed){const t=Object.keys(this._updatedLayers),i=Object.keys(this._removedLayers);(t.length||i.length)&&this._updateWorkerLayers(t,i);for(const t in this._updatedSources){const e=this._updatedSources[t];if("reload"===e)this._reloadSource(t);else{if("clear"!==e)throw new Error(`Invalid action ${e}`);this._clearSource(t)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const t in this._updatedPaintProps)this._layers[t].updateTransitions(e);this.light.updateTransitions(e),this._resetUpdates()}const r={};for(const t in this.sourceCaches){const e=this.sourceCaches[t];r[t]=e.used,e.used=!1}for(const t of this._order){const i=this._layers[t];i.recalculate(e,this._availableImages),!i.isHidden(e.zoom)&&i.source&&(this.sourceCaches[i.source].used=!0)}for(const e in r){const i=this.sourceCaches[e];r[e]!==i.used&&i.fire(new t.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:e}))}this.light.recalculate(e),this.z=e.zoom,i&&this.fire(new t.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const t=Object.keys(this._changedImages);if(t.length){for(const e in this.sourceCaches)this.sourceCaches[e].reloadTilesForDependencies(["icons","patterns"],t);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const t in this.sourceCaches)this.sourceCaches[t].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(t,e){this.dispatcher.broadcast("updateLayers",{layers:this._serializeByIds(t),removedIds:e})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(e,i={}){this._checkLoaded();const r=this.serialize();if(e=i.transformStyle?i.transformStyle(r,e):e,Qt(this,t.y(e)))return!1;(e=t.aD(e)).layers=t.aB(e.layers);const n=t.aE(r,e).filter((t=>!(t.command in ee)));if(0===n.length)return!1;const a=n.filter((t=>!(t.command in te)));if(a.length>0)throw new Error(`Unimplemented: ${a.map((t=>t.command)).join(", ")}.`);for(const t of n)"setTransition"!==t.command&&this[t.command].apply(this,t.args);return this.stylesheet=e,this._serializedLayers=null,!0}addImage(e,i){if(this.getImage(e))return this.fire(new t.j(new Error(`An image named "${e}" already exists.`)));this.imageManager.addImage(e,i),this._afterImageUpdated(e)}updateImage(t,e){this.imageManager.updateImage(t,e)}getImage(t){return this.imageManager.getImage(t)}removeImage(e){if(!this.getImage(e))return this.fire(new t.j(new Error(`An image named "${e}" does not exist.`)));this.imageManager.removeImage(e),this._afterImageUpdated(e)}_afterImageUpdated(e){this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new t.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(e,i,r={}){if(this._checkLoaded(),void 0!==this.sourceCaches[e])throw new Error(`Source "${e}" already exists.`);if(!i.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(i).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(i.type)>=0&&this._validate(t.y.source,`sources.${e}`,i,null,r))return;this.map&&this.map._collectResourceTiming&&(i.collectResourceTiming=!0);const n=this.sourceCaches[e]=new K(e,i,this.dispatcher);n.style=this,n.setEventedParent(this,(()=>({isSourceLoaded:n.loaded(),source:n.serialize(),sourceId:e}))),n.onAdd(this.map),this._changed=!0}removeSource(e){if(this._checkLoaded(),void 0===this.sourceCaches[e])throw new Error("There is no source with this ID");for(const i in this._layers)if(this._layers[i].source===e)return this.fire(new t.j(new Error(`Source "${e}" cannot be removed while layer "${i}" is using it.`)));const i=this.sourceCaches[e];delete this.sourceCaches[e],delete this._updatedSources[e],i.fire(new t.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),i.setEventedParent(null),i.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(t,e){if(this._checkLoaded(),void 0===this.sourceCaches[t])throw new Error(`There is no source with this ID=${t}`);const i=this.sourceCaches[t].getSource();if("geojson"!==i.type)throw new Error(`geojsonSource.type is ${i.type}, which is !== 'geojson`);i.setData(e),this._changed=!0}getSource(t){return this.sourceCaches[t]&&this.sourceCaches[t].getSource()}addLayer(e,i,r={}){this._checkLoaded();const n=e.id;if(this.getLayer(n))return void this.fire(new t.j(new Error(`Layer "${n}" already exists on this map.`)));let a;if("custom"===e.type){if(Qt(this,t.aF(e)))return;a=t.aC(e)}else{if("source"in e&&"object"==typeof e.source&&(this.addSource(n,e.source),e=t.aD(e),e=t.e(e,{source:n})),this._validate(t.y.layer,`layers.${n}`,e,{arrayIndex:-1},r))return;a=t.aC(e),this._validateLayer(a),a.setEventedParent(this,{layer:{id:n}})}const o=i?this._order.indexOf(i):this._order.length;if(i&&-1===o)this.fire(new t.j(new Error(`Cannot add layer "${n}" before non-existing layer "${i}".`)));else{if(this._order.splice(o,0,n),this._layerOrderChanged=!0,this._layers[n]=a,this._removedLayers[n]&&a.source&&"custom"!==a.type){const t=this._removedLayers[n];delete this._removedLayers[n],t.type!==a.type?this._updatedSources[a.source]="clear":(this._updatedSources[a.source]="reload",this.sourceCaches[a.source].pause())}this._updateLayer(a),a.onAdd&&a.onAdd(this.map)}}moveLayer(e,i){if(this._checkLoaded(),this._changed=!0,!this._layers[e])return void this.fire(new t.j(new Error(`The layer '${e}' does not exist in the map's style and cannot be moved.`)));if(e===i)return;const r=this._order.indexOf(e);this._order.splice(r,1);const n=i?this._order.indexOf(i):this._order.length;i&&-1===n?this.fire(new t.j(new Error(`Cannot move layer "${e}" before non-existing layer "${i}".`))):(this._order.splice(n,0,e),this._layerOrderChanged=!0)}removeLayer(e){this._checkLoaded();const i=this._layers[e];if(!i)return void this.fire(new t.j(new Error(`Cannot remove non-existing layer "${e}".`)));i.setEventedParent(null);const r=this._order.indexOf(e);this._order.splice(r,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=i,delete this._layers[e],this._serializedLayers&&delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],i.onRemove&&i.onRemove(this.map)}getLayer(t){return this._layers[t]}getLayersOrder(){return[...this._order]}hasLayer(t){return t in this._layers}setLayerZoomRange(e,i,r){this._checkLoaded();const n=this.getLayer(e);n?n.minzoom===i&&n.maxzoom===r||(null!=i&&(n.minzoom=i),null!=r&&(n.maxzoom=r),this._updateLayer(n)):this.fire(new t.j(new Error(`Cannot set the zoom range of non-existing layer "${e}".`)))}setFilter(e,i,r={}){this._checkLoaded();const n=this.getLayer(e);if(n){if(!t.aG(n.filter,i))return null==i?(n.filter=void 0,void this._updateLayer(n)):void(this._validate(t.y.filter,`layers.${n.id}.filter`,i,null,r)||(n.filter=t.aD(i),this._updateLayer(n)))}else this.fire(new t.j(new Error(`Cannot filter non-existing layer "${e}".`)))}getFilter(e){return t.aD(this.getLayer(e).filter)}setLayoutProperty(e,i,r,n={}){this._checkLoaded();const a=this.getLayer(e);a?t.aG(a.getLayoutProperty(i),r)||(a.setLayoutProperty(i,r,n),this._updateLayer(a)):this.fire(new t.j(new Error(`Cannot style non-existing layer "${e}".`)))}getLayoutProperty(e,i){const r=this.getLayer(e);if(r)return r.getLayoutProperty(i);this.fire(new t.j(new Error(`Cannot get style of non-existing layer "${e}".`)))}setPaintProperty(e,i,r,n={}){this._checkLoaded();const a=this.getLayer(e);a?t.aG(a.getPaintProperty(i),r)||(a.setPaintProperty(i,r,n)&&this._updateLayer(a),this._changed=!0,this._updatedPaintProps[e]=!0):this.fire(new t.j(new Error(`Cannot style non-existing layer "${e}".`)))}getPaintProperty(t,e){return this.getLayer(t).getPaintProperty(e)}setFeatureState(e,i){this._checkLoaded();const r=e.source,n=e.sourceLayer,a=this.sourceCaches[r];if(void 0===a)return void this.fire(new t.j(new Error(`The source '${r}' does not exist in the map's style.`)));const o=a.getSource().type;"geojson"===o&&n?this.fire(new t.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):"vector"!==o||n?(void 0===e.id&&this.fire(new t.j(new Error("The feature id parameter must be provided."))),a.setFeatureState(n,e.id,i)):this.fire(new t.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(e,i){this._checkLoaded();const r=e.source,n=this.sourceCaches[r];if(void 0===n)return void this.fire(new t.j(new Error(`The source '${r}' does not exist in the map's style.`)));const a=n.getSource().type,o="vector"===a?e.sourceLayer:void 0;"vector"!==a||o?i&&"string"!=typeof e.id&&"number"!=typeof e.id?this.fire(new t.j(new Error("A feature id is required to remove its specific state property."))):n.removeFeatureState(o,e.id,i):this.fire(new t.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(e){this._checkLoaded();const i=e.source,r=e.sourceLayer,n=this.sourceCaches[i];if(void 0!==n)return"vector"!==n.getSource().type||r?(void 0===e.id&&this.fire(new t.j(new Error("The feature id parameter must be provided."))),n.getFeatureState(r,e.id)):void this.fire(new t.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new t.j(new Error(`The source '${i}' does not exist in the map's style.`)))}getTransition(){return t.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const e=t.aH(this.sourceCaches,(t=>t.serialize())),i=this._serializeByIds(this._order),r=this.map.getTerrain()||void 0,n=this.stylesheet;return t.aI({version:n.version,name:n.name,metadata:n.metadata,light:n.light,center:n.center,zoom:n.zoom,bearing:n.bearing,pitch:n.pitch,sprite:n.sprite,glyphs:n.glyphs,transition:n.transition,sources:e,layers:i,terrain:r},(t=>void 0!==t))}_updateLayer(t){this._updatedLayers[t.id]=!0,t.source&&!this._updatedSources[t.source]&&"raster"!==this.sourceCaches[t.source].getSource().type&&(this._updatedSources[t.source]="reload",this.sourceCaches[t.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(t){const e=t=>"fill-extrusion"===this._layers[t].type,i={},r=[];for(let n=this._order.length-1;n>=0;n--){const a=this._order[n];if(e(a)){i[a]=n;for(const e of t){const t=e[a];if(t)for(const e of t)r.push(e)}}}r.sort(((t,e)=>e.intersectionZ-t.intersectionZ));const n=[];for(let a=this._order.length-1;a>=0;a--){const o=this._order[a];if(e(o))for(let t=r.length-1;t>=0;t--){const e=r[t].feature;if(i[e.layer.id]<a)break;n.push(e),r.pop()}else for(const e of t){const t=e[o];if(t)for(const e of t)n.push(e.feature)}}return n}queryRenderedFeatures(e,i,r){i&&i.filter&&this._validate(t.y.filter,"queryRenderedFeatures.filter",i.filter,null,i);const n={};if(i&&i.layers){if(!Array.isArray(i.layers))return this.fire(new t.j(new Error("parameters.layers must be an Array."))),[];for(const e of i.layers){const i=this._layers[e];if(!i)return this.fire(new t.j(new Error(`The layer '${e}' does not exist in the map's style and cannot be queried for features.`))),[];n[i.source]=!0}}const a=[];i.availableImages=this._availableImages;const o=this._serializedAllLayers();for(const t in this.sourceCaches)i.layers&&!n[t]||a.push(H(this.sourceCaches[t],this._layers,o,e,i,r));return this.placement&&a.push(function(t,e,i,r,n,a,o){const s={},l=a.queryRenderedSymbols(r),c=[];for(const t of Object.keys(l).map(Number))c.push(o[t]);c.sort(q);for(const i of c){const r=i.featureIndex.lookupSymbolFeatures(l[i.bucketInstanceId],e,i.bucketIndex,i.sourceLayerIndex,n.filter,n.layers,n.availableImages,t);for(const t in r){const e=s[t]=s[t]||[],n=r[t];n.sort(((t,e)=>{const r=i.featureSortOrder;if(r){const i=r.indexOf(t.featureIndex);return r.indexOf(e.featureIndex)-i}return e.featureIndex-t.featureIndex}));for(const t of n)e.push(t)}}for(const e in s)s[e].forEach((r=>{const n=r.feature,a=i[t[e].source].getFeatureState(n.layer["source-layer"],n.id);n.source=n.layer.source,n.layer["source-layer"]&&(n.sourceLayer=n.layer["source-layer"]),n.state=a}));return s}(this._layers,o,this.sourceCaches,e,i,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(a)}querySourceFeatures(e,i){i&&i.filter&&this._validate(t.y.filter,"querySourceFeatures.filter",i.filter,null,i);const r=this.sourceCaches[e];return r?function(t,e){const i=t.getRenderableIds().map((e=>t.getTileByID(e))),r=[],n={};for(let t=0;t<i.length;t++){const a=i[t],o=a.tileID.canonical.key;n[o]||(n[o]=!0,a.querySourceFeatures(r,e))}return r}(r,i):[]}addSourceType(t,e,i){return U(t)?i(new Error(`A source type called "${t}" already exists.`)):(((t,e)=>{j[t]=e})(t,e),e.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:t,url:e.workerSourceURL},i):i(null,null))}getLight(){return this.light.getLight()}setLight(e,i={}){this._checkLoaded();const r=this.light.getLight();let n=!1;for(const i in e)if(!t.aG(e[i],r[i])){n=!0;break}if(!n)return;const a={now:t.h.now(),transition:t.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e,i),this.light.updateTransitions(a)}_validate(e,i,r,n,a={}){return(!a||!1!==a.validate)&&Qt(this,e.call(t.y,t.e({key:i,style:this.serialize(),value:r,styleSpec:t.v},n)))}_remove(e=!0){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),t.aJ.off("pluginStateChange",this._rtlTextPluginCallback);for(const t in this._layers)this._layers[t].setEventedParent(null);for(const t in this.sourceCaches){const e=this.sourceCaches[t];e.setEventedParent(null),e.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove(e)}_clearSource(t){this.sourceCaches[t].clearTiles()}_reloadSource(t){this.sourceCaches[t].resume(),this.sourceCaches[t].reload()}_updateSources(t){for(const e in this.sourceCaches)this.sourceCaches[e].update(t,this.map.terrain)}_generateCollisionBoxes(){for(const t in this.sourceCaches)this._reloadSource(t)}_updatePlacement(e,i,r,n,a=!1){let o=!1,s=!1;const l={};for(const t of this._order){const i=this._layers[t];if("symbol"!==i.type)continue;if(!l[i.source]){const t=this.sourceCaches[i.source];l[i.source]=t.getRenderableIds(!0).map((e=>t.getTileByID(e))).sort(((t,e)=>e.tileID.overscaledZ-t.tileID.overscaledZ||(t.tileID.isLessThan(e.tileID)?-1:1)))}const r=this.crossTileSymbolIndex.addLayer(i,l[i.source],e.center.lng);o=o||r}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((a=a||this._layerOrderChanged||0===r)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(t.h.now(),e.zoom))&&(this.pauseablePlacement=new Gt(e,this.map.terrain,this._order,a,i,r,n,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,l),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(t.h.now()),s=!0),o&&this.pauseablePlacement.placement.setStale()),s||o)for(const t of this._order){const e=this._layers[t];"symbol"===e.type&&this.placement.updateLayerOpacities(e,l[e.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(t.h.now())}_releaseSymbolFadeTiles(){for(const t in this.sourceCaches)this.sourceCaches[t].releaseSymbolFadeTiles()}getImages(t,e,i){this.imageManager.getImages(e.icons,i),this._updateTilesForChangedImages();const r=this.sourceCaches[e.source];r&&r.setDependencies(e.tileID.key,e.type,e.icons)}getGlyphs(t,e,i){this.glyphManager.getGlyphs(e.stacks,i);const r=this.sourceCaches[e.source];r&&r.setDependencies(e.tileID.key,e.type,[""])}getResource(e,i,r){return t.m(i,r)}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(e,i={}){this._checkLoaded(),e&&this._validate(t.y.glyphs,"glyphs",e,null,i)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=e,this.glyphManager.entries={},this.glyphManager.setURL(e))}addSprite(e,i,r={},n){this._checkLoaded();const a=[{id:e,url:i}],o=[...y(this.stylesheet.sprite),...a];this._validate(t.y.sprite,"sprite",o,null,r)||(this.stylesheet.sprite=o,this._loadSprite(a,!0,n))}removeSprite(e){this._checkLoaded();const i=y(this.stylesheet.sprite);if(i.find((t=>t.id===e))){if(this._spritesImagesIds[e])for(const t of this._spritesImagesIds[e])this.imageManager.removeImage(t),this._changedImages[t]=!0;i.splice(i.findIndex((t=>t.id===e)),1),this.stylesheet.sprite=i.length>0?i:void 0,delete this._spritesImagesIds[e],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new t.k("data",{dataType:"style"}))}else this.fire(new t.j(new Error(`Sprite "${e}" doesn't exists on this map.`)))}getSprite(){return y(this.stylesheet.sprite)}setSprite(e,i={},r){this._checkLoaded(),e&&this._validate(t.y.sprite,"sprite",e,null,i)||(this.stylesheet.sprite=e,e?this._loadSprite(e,!0,r):(this._unloadSprite(),r&&r(null)))}}re.registerForPluginStateChange=t.aK;var ne=t.Q([{name:"a_pos",type:"Int16",components:2}]),ae="attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_depth;void main() {float extent=8192.0;float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/extent;gl_Position=u_matrix*vec4(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}";const oe={prelude:se("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\n","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}\n#ifdef TERRAIN3D\nuniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;\n#endif\nconst highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {\n#ifdef TERRAIN3D\nhighp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));\n#else\nreturn 1.0;\n#endif\n}float calculate_visibility(vec4 pos) {\n#ifdef TERRAIN3D\nvec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;\n#else\nreturn 1.0;\n#endif\n}float ele(vec2 pos) {\n#ifdef TERRAIN3D\nvec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;\n#else\nreturn 0.0;\n#endif\n}float get_elevation(vec2 pos) {\n#ifdef TERRAIN3D\nvec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;\n#else\nreturn 0.0;\n#endif\n}"),background:se("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:se("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:se("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),clippingMask:se("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:se("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}"),heatmapTexture:se("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:se("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:se("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:se("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:se("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"),fillOutline:se("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),fillOutlinePattern:se("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),fillPattern:se("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),fillExtrusion:se("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;\n#ifdef TERRAIN3D\nattribute vec2 a_centroid;\n#endif\nvarying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;\n#ifdef TERRAIN3D\nfloat height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);\n#else\nfloat height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;\n#endif\nbase=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),fillExtrusionPattern:se("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;\n#ifdef TERRAIN3D\nattribute vec2 a_centroid;\n#endif\nvarying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;\n#ifdef TERRAIN3D\nfloat height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);\n#else\nfloat height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;\n#endif\nbase=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),hillshadePrepare:se("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:se("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;\n#define PI 3.141592653589793\nvoid main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:se("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_width2=vec2(outset,inset);}"),lineGradient:se("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_width2=vec2(outset,inset);}"),linePattern:se("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}"),lineSDF:se("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),raster:se("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:se("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}"),symbolSDF:se("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),symbolTextAndIcon:se("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}"),terrain:se("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",ae),terrainDepth:se("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",ae),terrainCoords:se("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",ae)};function se(t,e){const i=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,r=e.match(/attribute ([\w]+) ([\w]+)/g),n=t.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),a=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),o=a?a.concat(n):n,s={};return{fragmentSource:t=t.replace(i,((t,e,i,r,n)=>(s[n]=!0,"define"===e?`\n#ifndef HAS_UNIFORM_u_${n}\nvarying ${i} ${r} ${n};\n#else\nuniform ${i} ${r} u_${n};\n#endif\n`:`\n#ifdef HAS_UNIFORM_u_${n}\n    ${i} ${r} ${n} = u_${n};\n#endif\n`))),vertexSource:e=e.replace(i,((t,e,i,r,n)=>{const a="float"===r?"vec2":"vec4",o=n.match(/color/)?"color":a;return s[n]?"define"===e?`\n#ifndef HAS_UNIFORM_u_${n}\nuniform lowp float u_${n}_t;\nattribute ${i} ${a} a_${n};\nvarying ${i} ${r} ${n};\n#else\nuniform ${i} ${r} u_${n};\n#endif\n`:"vec4"===o?`\n#ifndef HAS_UNIFORM_u_${n}\n    ${n} = a_${n};\n#else\n    ${i} ${r} ${n} = u_${n};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${n}\n    ${n} = unpack_mix_${o}(a_${n}, u_${n}_t);\n#else\n    ${i} ${r} ${n} = u_${n};\n#endif\n`:"define"===e?`\n#ifndef HAS_UNIFORM_u_${n}\nuniform lowp float u_${n}_t;\nattribute ${i} ${a} a_${n};\n#else\nuniform ${i} ${r} u_${n};\n#endif\n`:"vec4"===o?`\n#ifndef HAS_UNIFORM_u_${n}\n    ${i} ${r} ${n} = a_${n};\n#else\n    ${i} ${r} ${n} = u_${n};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${n}\n    ${i} ${r} ${n} = unpack_mix_${o}(a_${n}, u_${n}_t);\n#else\n    ${i} ${r} ${n} = u_${n};\n#endif\n`})),staticAttributes:r,staticUniforms:o}}class le{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(t,e,i,r,n,a,o,s,l){this.context=t;let c=this.boundPaintVertexBuffers.length!==r.length;for(let t=0;!c&&t<r.length;t++)this.boundPaintVertexBuffers[t]!==r[t]&&(c=!0);!this.vao||this.boundProgram!==e||this.boundLayoutVertexBuffer!==i||c||this.boundIndexBuffer!==n||this.boundVertexOffset!==a||this.boundDynamicVertexBuffer!==o||this.boundDynamicVertexBuffer2!==s||this.boundDynamicVertexBuffer3!==l?this.freshBind(e,i,r,n,a,o,s,l):(t.bindVertexArray.set(this.vao),o&&o.bind(),n&&n.dynamicDraw&&n.bind(),s&&s.bind(),l&&l.bind())}freshBind(t,e,i,r,n,a,o,s){const l=t.numAttributes,c=this.context,h=c.gl;this.vao&&this.destroy(),this.vao=c.createVertexArray(),c.bindVertexArray.set(this.vao),this.boundProgram=t,this.boundLayoutVertexBuffer=e,this.boundPaintVertexBuffers=i,this.boundIndexBuffer=r,this.boundVertexOffset=n,this.boundDynamicVertexBuffer=a,this.boundDynamicVertexBuffer2=o,this.boundDynamicVertexBuffer3=s,e.enableAttributes(h,t);for(const e of i)e.enableAttributes(h,t);a&&a.enableAttributes(h,t),o&&o.enableAttributes(h,t),s&&s.enableAttributes(h,t),e.bind(),e.setVertexAttribPointers(h,t,n);for(const e of i)e.bind(),e.setVertexAttribPointers(h,t,n);a&&(a.bind(),a.setVertexAttribPointers(h,t,n)),r&&r.bind(),o&&(o.bind(),o.setVertexAttribPointers(h,t,n)),s&&(s.bind(),s.setVertexAttribPointers(h,t,n)),c.currentNumAttributes=l}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}function ce(t){const e=[];for(let i=0;i<t.length;i++){if(null===t[i])continue;const r=t[i].split(" ");e.push(r.pop())}return e}class he{constructor(e,i,r,n,a,o){const s=e.gl;this.program=s.createProgram();const l=ce(i.staticAttributes),c=r?r.getBinderAttributes():[],h=l.concat(c),u=oe.prelude.staticUniforms?ce(oe.prelude.staticUniforms):[],d=i.staticUniforms?ce(i.staticUniforms):[],p=r?r.getBinderUniforms():[],m=u.concat(d).concat(p),f=[];for(const t of m)f.indexOf(t)<0&&f.push(t);const g=r?r.defines():[];a&&g.push("#define OVERDRAW_INSPECTOR;"),o&&g.push("#define TERRAIN3D;");const y=g.concat(oe.prelude.fragmentSource,i.fragmentSource).join("\n"),_=g.concat(oe.prelude.vertexSource,i.vertexSource).join("\n"),v=s.createShader(s.FRAGMENT_SHADER);if(s.isContextLost())return void(this.failedToCreate=!0);if(s.shaderSource(v,y),s.compileShader(v),!s.getShaderParameter(v,s.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${s.getShaderInfoLog(v)}`);s.attachShader(this.program,v);const b=s.createShader(s.VERTEX_SHADER);if(s.isContextLost())return void(this.failedToCreate=!0);if(s.shaderSource(b,_),s.compileShader(b),!s.getShaderParameter(b,s.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${s.getShaderInfoLog(b)}`);s.attachShader(this.program,b),this.attributes={};const x={};this.numAttributes=h.length;for(let t=0;t<this.numAttributes;t++)h[t]&&(s.bindAttribLocation(this.program,t,h[t]),this.attributes[h[t]]=t);if(s.linkProgram(this.program),!s.getProgramParameter(this.program,s.LINK_STATUS))throw new Error(`Program failed to link: ${s.getProgramInfoLog(this.program)}`);s.deleteShader(b),s.deleteShader(v);for(let t=0;t<f.length;t++){const e=f[t];if(e&&!x[e]){const t=s.getUniformLocation(this.program,e);t&&(x[e]=t)}}this.fixedUniforms=n(e,x),this.terrainUniforms=((e,i)=>({u_depth:new t.aL(e,i.u_depth),u_terrain:new t.aL(e,i.u_terrain),u_terrain_dim:new t.aM(e,i.u_terrain_dim),u_terrain_matrix:new t.aN(e,i.u_terrain_matrix),u_terrain_unpack:new t.aO(e,i.u_terrain_unpack),u_terrain_exaggeration:new t.aM(e,i.u_terrain_exaggeration)}))(e,x),this.binderUniforms=r?r.getUniforms(e,x):[]}draw(t,e,i,r,n,a,o,s,l,c,h,u,d,p,m,f,g,y){const _=t.gl;if(this.failedToCreate)return;if(t.program.set(this.program),t.setDepthMode(i),t.setStencilMode(r),t.setColorMode(n),t.setCullFace(a),s){t.activeTexture.set(_.TEXTURE2),_.bindTexture(_.TEXTURE_2D,s.depthTexture),t.activeTexture.set(_.TEXTURE3),_.bindTexture(_.TEXTURE_2D,s.texture);for(const t in this.terrainUniforms)this.terrainUniforms[t].set(s[t])}for(const t in this.fixedUniforms)this.fixedUniforms[t].set(o[t]);m&&m.setUniforms(t,this.binderUniforms,d,{zoom:p});let v=0;switch(e){case _.LINES:v=2;break;case _.TRIANGLES:v=3;break;case _.LINE_STRIP:v=1}for(const i of u.get()){const r=i.vaos||(i.vaos={});(r[l]||(r[l]=new le)).bind(t,this,c,m?m.getPaintVertexBuffers():[],h,i.vertexOffset,f,g,y),_.drawElements(e,i.primitiveLength*v,_.UNSIGNED_SHORT,i.primitiveOffset*v*2)}}}function ue(t,e,i){const r=1/At(i,1,e.transform.tileZoom),n=Math.pow(2,i.tileID.overscaledZ),a=i.tileSize*Math.pow(2,e.transform.tileZoom)/n,o=a*(i.tileID.canonical.x+i.tileID.wrap*n),s=a*i.tileID.canonical.y;return{u_image:0,u_texsize:i.imageAtlasTexture.size,u_scale:[r,t.fromScale,t.toScale],u_fade:t.t,u_pixel_coord_upper:[o>>16,s>>16],u_pixel_coord_lower:[65535&o,65535&s]}}const de=(e,i,r,n)=>{const a=i.style.light,o=a.properties.get("position"),s=[o.x,o.y,o.z],l=function(){var e=new t.A(9);return t.A!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}();"viewport"===a.properties.get("anchor")&&function(t,e){var i=Math.sin(e),r=Math.cos(e);t[0]=r,t[1]=i,t[2]=0,t[3]=-i,t[4]=r,t[5]=0,t[6]=0,t[7]=0,t[8]=1}(l,-i.transform.angle),function(t,e,i){var r=e[0],n=e[1],a=e[2];t[0]=r*i[0]+n*i[3]+a*i[6],t[1]=r*i[1]+n*i[4]+a*i[7],t[2]=r*i[2]+n*i[5]+a*i[8]}(s,s,l);const c=a.properties.get("color");return{u_matrix:e,u_lightpos:s,u_lightintensity:a.properties.get("intensity"),u_lightcolor:[c.r,c.g,c.b],u_vertical_gradient:+r,u_opacity:n}},pe=(e,i,r,n,a,o,s)=>t.e(de(e,i,r,n),ue(o,i,s),{u_height_factor:-Math.pow(2,a.overscaledZ)/s.tileSize/8}),me=t=>({u_matrix:t}),fe=(e,i,r,n)=>t.e(me(e),ue(r,i,n)),ge=(t,e)=>({u_matrix:t,u_world:e}),ye=(e,i,r,n,a)=>t.e(fe(e,i,r,n),{u_world:a}),_e=(t,e,i,r)=>{const n=t.transform;let a,o;if("map"===r.paint.get("circle-pitch-alignment")){const t=At(i,1,n.zoom);a=!0,o=[t,t]}else a=!1,o=n.pixelsToGLUnits;return{u_camera_to_center_distance:n.cameraToCenterDistance,u_scale_with_map:+("map"===r.paint.get("circle-pitch-scale")),u_matrix:t.translatePosMatrix(e.posMatrix,i,r.paint.get("circle-translate"),r.paint.get("circle-translate-anchor")),u_pitch_with_map:+a,u_device_pixel_ratio:t.pixelRatio,u_extrude_scale:o}},ve=(t,e,i)=>{const r=At(i,1,e.zoom),n=Math.pow(2,e.zoom-i.tileID.overscaledZ),a=i.tileID.overscaleFactor();return{u_matrix:t,u_camera_to_center_distance:e.cameraToCenterDistance,u_pixels_to_tile_units:r,u_extrude_scale:[e.pixelsToGLUnits[0]/(r*n),e.pixelsToGLUnits[1]/(r*n)],u_overscale_factor:a}},be=(t,e,i=1)=>({u_matrix:t,u_color:e,u_overlay:0,u_overlay_scale:i}),xe=t=>({u_matrix:t}),we=(t,e,i,r)=>({u_matrix:t,u_extrude_scale:At(e,1,i),u_intensity:r});function Se(e,i){const r=Math.pow(2,i.canonical.z),n=i.canonical.y;return[new t.U(0,n/r).toLngLat().lat,new t.U(0,(n+1)/r).toLngLat().lat]}const ke=(t,e,i,r)=>{const n=t.transform;return{u_matrix:Me(t,e,i,r),u_ratio:1/At(e,1,n.zoom),u_device_pixel_ratio:t.pixelRatio,u_units_to_pixels:[1/n.pixelsToGLUnits[0],1/n.pixelsToGLUnits[1]]}},Ce=(e,i,r,n,a)=>t.e(ke(e,i,r,a),{u_image:0,u_image_height:n}),Ae=(t,e,i,r,n)=>{const a=t.transform,o=Ee(e,a);return{u_matrix:Me(t,e,i,n),u_texsize:e.imageAtlasTexture.size,u_ratio:1/At(e,1,a.zoom),u_device_pixel_ratio:t.pixelRatio,u_image:0,u_scale:[o,r.fromScale,r.toScale],u_fade:r.t,u_units_to_pixels:[1/a.pixelsToGLUnits[0],1/a.pixelsToGLUnits[1]]}},Te=(e,i,r,n,a,o)=>{const s=e.lineAtlas,l=Ee(i,e.transform),c="round"===r.layout.get("line-cap"),h=s.getDash(n.from,c),u=s.getDash(n.to,c),d=h.width*a.fromScale,p=u.width*a.toScale;return t.e(ke(e,i,r,o),{u_patternscale_a:[l/d,-h.height/2],u_patternscale_b:[l/p,-u.height/2],u_sdfgamma:s.width/(256*Math.min(d,p)*e.pixelRatio)/2,u_image:0,u_tex_y_a:h.y,u_tex_y_b:u.y,u_mix:a.t})};function Ee(t,e){return 1/At(t,1,e.tileZoom)}function Me(t,e,i,r){return t.translatePosMatrix(r?r.posMatrix:e.tileID.posMatrix,e,i.paint.get("line-translate"),i.paint.get("line-translate-anchor"))}const Ie=(t,e,i,r,n)=>{return{u_matrix:t,u_tl_parent:e,u_scale_parent:i,u_buffer_scale:1,u_fade_t:r.mix,u_opacity:r.opacity*n.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:n.paint.get("raster-brightness-min"),u_brightness_high:n.paint.get("raster-brightness-max"),u_saturation_factor:(o=n.paint.get("raster-saturation"),o>0?1-1/(1.001-o):-o),u_contrast_factor:(a=n.paint.get("raster-contrast"),a>0?1/(1-a):1+a),u_spin_weights:ze(n.paint.get("raster-hue-rotate"))};var a,o};function ze(t){t*=Math.PI/180;const e=Math.sin(t),i=Math.cos(t);return[(2*i+1)/3,(-Math.sqrt(3)*e-i+1)/3,(Math.sqrt(3)*e-i+1)/3]}const Pe=(t,e,i,r,n,a,o,s,l,c)=>{const h=n.transform;return{u_is_size_zoom_constant:+("constant"===t||"source"===t),u_is_size_feature_constant:+("constant"===t||"camera"===t),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:h.cameraToCenterDistance,u_pitch:h.pitch/360*2*Math.PI,u_rotate_symbol:+i,u_aspect_ratio:h.width/h.height,u_fade_change:n.options.fadeDuration?n.symbolFadeChange:1,u_matrix:a,u_label_plane_matrix:o,u_coord_matrix:s,u_is_text:+l,u_pitch_with_map:+r,u_texsize:c,u_texture:0}},Le=(e,i,r,n,a,o,s,l,c,h,u)=>{const d=a.transform;return t.e(Pe(e,i,r,n,a,o,s,l,c,h),{u_gamma_scale:n?Math.cos(d._pitch)*d.cameraToCenterDistance:1,u_device_pixel_ratio:a.pixelRatio,u_is_halo:+u})},De=(e,i,r,n,a,o,s,l,c,h)=>t.e(Le(e,i,r,n,a,o,s,l,!0,c,!0),{u_texsize_icon:h,u_texture_icon:1}),Re=(t,e,i)=>({u_matrix:t,u_opacity:e,u_color:i}),Be=(e,i,r,n,a,o)=>t.e(function(t,e,i,r){const n=i.imageManager.getPattern(t.from.toString()),a=i.imageManager.getPattern(t.to.toString()),{width:o,height:s}=i.imageManager.getPixelSize(),l=Math.pow(2,r.tileID.overscaledZ),c=r.tileSize*Math.pow(2,i.transform.tileZoom)/l,h=c*(r.tileID.canonical.x+r.tileID.wrap*l),u=c*r.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:n.tl,u_pattern_br_a:n.br,u_pattern_tl_b:a.tl,u_pattern_br_b:a.br,u_texsize:[o,s],u_mix:e.t,u_pattern_size_a:n.displaySize,u_pattern_size_b:a.displaySize,u_scale_a:e.fromScale,u_scale_b:e.toScale,u_tile_units_to_pixels:1/At(r,1,i.transform.tileZoom),u_pixel_coord_upper:[h>>16,u>>16],u_pixel_coord_lower:[65535&h,65535&u]}}(n,o,r,a),{u_matrix:e,u_opacity:i}),Fe={fillExtrusion:(e,i)=>({u_matrix:new t.aN(e,i.u_matrix),u_lightpos:new t.aP(e,i.u_lightpos),u_lightintensity:new t.aM(e,i.u_lightintensity),u_lightcolor:new t.aP(e,i.u_lightcolor),u_vertical_gradient:new t.aM(e,i.u_vertical_gradient),u_opacity:new t.aM(e,i.u_opacity)}),fillExtrusionPattern:(e,i)=>({u_matrix:new t.aN(e,i.u_matrix),u_lightpos:new t.aP(e,i.u_lightpos),u_lightintensity:new t.aM(e,i.u_lightintensity),u_lightcolor:new t.aP(e,i.u_lightcolor),u_vertical_gradient:new t.aM(e,i.u_vertical_gradient),u_height_factor:new t.aM(e,i.u_height_factor),u_image:new t.aL(e,i.u_image),u_texsize:new t.aQ(e,i.u_texsize),u_pixel_coord_upper:new t.aQ(e,i.u_pixel_coord_upper),u_pixel_coord_lower:new t.aQ(e,i.u_pixel_coord_lower),u_scale:new t.aP(e,i.u_scale),u_fade:new t.aM(e,i.u_fade),u_opacity:new t.aM(e,i.u_opacity)}),fill:(e,i)=>({u_matrix:new t.aN(e,i.u_matrix)}),fillPattern:(e,i)=>({u_matrix:new t.aN(e,i.u_matrix),u_image:new t.aL(e,i.u_image),u_texsize:new t.aQ(e,i.u_texsize),u_pixel_coord_upper:new t.aQ(e,i.u_pixel_coord_upper),u_pixel_coord_lower:new t.aQ(e,i.u_pixel_coord_lower),u_scale:new t.aP(e,i.u_scale),u_fade:new t.aM(e,i.u_fade)}),fillOutline:(e,i)=>({u_matrix:new t.aN(e,i.u_matrix),u_world:new t.aQ(e,i.u_world)}),fillOutlinePattern:(e,i)=>({u_matrix:new t.aN(e,i.u_matrix),u_world:new t.aQ(e,i.u_world),u_image:new t.aL(e,i.u_image),u_texsize:new t.aQ(e,i.u_texsize),u_pixel_coord_upper:new t.aQ(e,i.u_pixel_coord_upper),u_pixel_coord_lower:new t.aQ(e,i.u_pixel_coord_lower),u_scale:new t.aP(e,i.u_scale),u_fade:new t.aM(e,i.u_fade)}),circle:(e,i)=>({u_camera_to_center_distance:new t.aM(e,i.u_camera_to_center_distance),u_scale_with_map:new t.aL(e,i.u_scale_with_map),u_pitch_with_map:new t.aL(e,i.u_pitch_with_map),u_extrude_scale:new t.aQ(e,i.u_extrude_scale),u_device_pixel_ratio:new t.aM(e,i.u_device_pixel_ratio),u_matrix:new t.aN(e,i.u_matrix)}),collisionBox:(e,i)=>({u_matrix:new t.aN(e,i.u_matrix),u_camera_to_center_distance:new t.aM(e,i.u_camera_to_center_distance),u_pixels_to_tile_units:new t.aM(e,i.u_pixels_to_tile_units),u_extrude_scale:new t.aQ(e,i.u_extrude_scale),u_overscale_factor:new t.aM(e,i.u_overscale_factor)}),collisionCircle:(e,i)=>({u_matrix:new t.aN(e,i.u_matrix),u_inv_matrix:new t.aN(e,i.u_inv_matrix),u_camera_to_center_distance:new t.aM(e,i.u_camera_to_center_distance),u_viewport_size:new t.aQ(e,i.u_viewport_size)}),debug:(e,i)=>({u_color:new t.aR(e,i.u_color),u_matrix:new t.aN(e,i.u_matrix),u_overlay:new t.aL(e,i.u_overlay),u_overlay_scale:new t.aM(e,i.u_overlay_scale)}),clippingMask:(e,i)=>({u_matrix:new t.aN(e,i.u_matrix)}),heatmap:(e,i)=>({u_extrude_scale:new t.aM(e,i.u_extrude_scale),u_intensity:new t.aM(e,i.u_intensity),u_matrix:new t.aN(e,i.u_matrix)}),heatmapTexture:(e,i)=>({u_matrix:new t.aN(e,i.u_matrix),u_world:new t.aQ(e,i.u_world),u_image:new t.aL(e,i.u_image),u_color_ramp:new t.aL(e,i.u_color_ramp),u_opacity:new t.aM(e,i.u_opacity)}),hillshade:(e,i)=>({u_matrix:new t.aN(e,i.u_matrix),u_image:new t.aL(e,i.u_image),u_latrange:new t.aQ(e,i.u_latrange),u_light:new t.aQ(e,i.u_light),u_shadow:new t.aR(e,i.u_shadow),u_highlight:new t.aR(e,i.u_highlight),u_accent:new t.aR(e,i.u_accent)}),hillshadePrepare:(e,i)=>({u_matrix:new t.aN(e,i.u_matrix),u_image:new t.aL(e,i.u_image),u_dimension:new t.aQ(e,i.u_dimension),u_zoom:new t.aM(e,i.u_zoom),u_unpack:new t.aO(e,i.u_unpack)}),line:(e,i)=>({u_matrix:new t.aN(e,i.u_matrix),u_ratio:new t.aM(e,i.u_ratio),u_device_pixel_ratio:new t.aM(e,i.u_device_pixel_ratio),u_units_to_pixels:new t.aQ(e,i.u_units_to_pixels)}),lineGradient:(e,i)=>({u_matrix:new t.aN(e,i.u_matrix),u_ratio:new t.aM(e,i.u_ratio),u_device_pixel_ratio:new t.aM(e,i.u_device_pixel_ratio),u_units_to_pixels:new t.aQ(e,i.u_units_to_pixels),u_image:new t.aL(e,i.u_image),u_image_height:new t.aM(e,i.u_image_height)}),linePattern:(e,i)=>({u_matrix:new t.aN(e,i.u_matrix),u_texsize:new t.aQ(e,i.u_texsize),u_ratio:new t.aM(e,i.u_ratio),u_device_pixel_ratio:new t.aM(e,i.u_device_pixel_ratio),u_image:new t.aL(e,i.u_image),u_units_to_pixels:new t.aQ(e,i.u_units_to_pixels),u_scale:new t.aP(e,i.u_scale),u_fade:new t.aM(e,i.u_fade)}),lineSDF:(e,i)=>({u_matrix:new t.aN(e,i.u_matrix),u_ratio:new t.aM(e,i.u_ratio),u_device_pixel_ratio:new t.aM(e,i.u_device_pixel_ratio),u_units_to_pixels:new t.aQ(e,i.u_units_to_pixels),u_patternscale_a:new t.aQ(e,i.u_patternscale_a),u_patternscale_b:new t.aQ(e,i.u_patternscale_b),u_sdfgamma:new t.aM(e,i.u_sdfgamma),u_image:new t.aL(e,i.u_image),u_tex_y_a:new t.aM(e,i.u_tex_y_a),u_tex_y_b:new t.aM(e,i.u_tex_y_b),u_mix:new t.aM(e,i.u_mix)}),raster:(e,i)=>({u_matrix:new t.aN(e,i.u_matrix),u_tl_parent:new t.aQ(e,i.u_tl_parent),u_scale_parent:new t.aM(e,i.u_scale_parent),u_buffer_scale:new t.aM(e,i.u_buffer_scale),u_fade_t:new t.aM(e,i.u_fade_t),u_opacity:new t.aM(e,i.u_opacity),u_image0:new t.aL(e,i.u_image0),u_image1:new t.aL(e,i.u_image1),u_brightness_low:new t.aM(e,i.u_brightness_low),u_brightness_high:new t.aM(e,i.u_brightness_high),u_saturation_factor:new t.aM(e,i.u_saturation_factor),u_contrast_factor:new t.aM(e,i.u_contrast_factor),u_spin_weights:new t.aP(e,i.u_spin_weights)}),symbolIcon:(e,i)=>({u_is_size_zoom_constant:new t.aL(e,i.u_is_size_zoom_constant),u_is_size_feature_constant:new t.aL(e,i.u_is_size_feature_constant),u_size_t:new t.aM(e,i.u_size_t),u_size:new t.aM(e,i.u_size),u_camera_to_center_distance:new t.aM(e,i.u_camera_to_center_distance),u_pitch:new t.aM(e,i.u_pitch),u_rotate_symbol:new t.aL(e,i.u_rotate_symbol),u_aspect_ratio:new t.aM(e,i.u_aspect_ratio),u_fade_change:new t.aM(e,i.u_fade_change),u_matrix:new t.aN(e,i.u_matrix),u_label_plane_matrix:new t.aN(e,i.u_label_plane_matrix),u_coord_matrix:new t.aN(e,i.u_coord_matrix),u_is_text:new t.aL(e,i.u_is_text),u_pitch_with_map:new t.aL(e,i.u_pitch_with_map),u_texsize:new t.aQ(e,i.u_texsize),u_texture:new t.aL(e,i.u_texture)}),symbolSDF:(e,i)=>({u_is_size_zoom_constant:new t.aL(e,i.u_is_size_zoom_constant),u_is_size_feature_constant:new t.aL(e,i.u_is_size_feature_constant),u_size_t:new t.aM(e,i.u_size_t),u_size:new t.aM(e,i.u_size),u_camera_to_center_distance:new t.aM(e,i.u_camera_to_center_distance),u_pitch:new t.aM(e,i.u_pitch),u_rotate_symbol:new t.aL(e,i.u_rotate_symbol),u_aspect_ratio:new t.aM(e,i.u_aspect_ratio),u_fade_change:new t.aM(e,i.u_fade_change),u_matrix:new t.aN(e,i.u_matrix),u_label_plane_matrix:new t.aN(e,i.u_label_plane_matrix),u_coord_matrix:new t.aN(e,i.u_coord_matrix),u_is_text:new t.aL(e,i.u_is_text),u_pitch_with_map:new t.aL(e,i.u_pitch_with_map),u_texsize:new t.aQ(e,i.u_texsize),u_texture:new t.aL(e,i.u_texture),u_gamma_scale:new t.aM(e,i.u_gamma_scale),u_device_pixel_ratio:new t.aM(e,i.u_device_pixel_ratio),u_is_halo:new t.aL(e,i.u_is_halo)}),symbolTextAndIcon:(e,i)=>({u_is_size_zoom_constant:new t.aL(e,i.u_is_size_zoom_constant),u_is_size_feature_constant:new t.aL(e,i.u_is_size_feature_constant),u_size_t:new t.aM(e,i.u_size_t),u_size:new t.aM(e,i.u_size),u_camera_to_center_distance:new t.aM(e,i.u_camera_to_center_distance),u_pitch:new t.aM(e,i.u_pitch),u_rotate_symbol:new t.aL(e,i.u_rotate_symbol),u_aspect_ratio:new t.aM(e,i.u_aspect_ratio),u_fade_change:new t.aM(e,i.u_fade_change),u_matrix:new t.aN(e,i.u_matrix),u_label_plane_matrix:new t.aN(e,i.u_label_plane_matrix),u_coord_matrix:new t.aN(e,i.u_coord_matrix),u_is_text:new t.aL(e,i.u_is_text),u_pitch_with_map:new t.aL(e,i.u_pitch_with_map),u_texsize:new t.aQ(e,i.u_texsize),u_texsize_icon:new t.aQ(e,i.u_texsize_icon),u_texture:new t.aL(e,i.u_texture),u_texture_icon:new t.aL(e,i.u_texture_icon),u_gamma_scale:new t.aM(e,i.u_gamma_scale),u_device_pixel_ratio:new t.aM(e,i.u_device_pixel_ratio),u_is_halo:new t.aL(e,i.u_is_halo)}),background:(e,i)=>({u_matrix:new t.aN(e,i.u_matrix),u_opacity:new t.aM(e,i.u_opacity),u_color:new t.aR(e,i.u_color)}),backgroundPattern:(e,i)=>({u_matrix:new t.aN(e,i.u_matrix),u_opacity:new t.aM(e,i.u_opacity),u_image:new t.aL(e,i.u_image),u_pattern_tl_a:new t.aQ(e,i.u_pattern_tl_a),u_pattern_br_a:new t.aQ(e,i.u_pattern_br_a),u_pattern_tl_b:new t.aQ(e,i.u_pattern_tl_b),u_pattern_br_b:new t.aQ(e,i.u_pattern_br_b),u_texsize:new t.aQ(e,i.u_texsize),u_mix:new t.aM(e,i.u_mix),u_pattern_size_a:new t.aQ(e,i.u_pattern_size_a),u_pattern_size_b:new t.aQ(e,i.u_pattern_size_b),u_scale_a:new t.aM(e,i.u_scale_a),u_scale_b:new t.aM(e,i.u_scale_b),u_pixel_coord_upper:new t.aQ(e,i.u_pixel_coord_upper),u_pixel_coord_lower:new t.aQ(e,i.u_pixel_coord_lower),u_tile_units_to_pixels:new t.aM(e,i.u_tile_units_to_pixels)}),terrain:(e,i)=>({u_matrix:new t.aN(e,i.u_matrix),u_texture:new t.aL(e,i.u_texture),u_ele_delta:new t.aM(e,i.u_ele_delta)}),terrainDepth:(e,i)=>({u_matrix:new t.aN(e,i.u_matrix),u_ele_delta:new t.aM(e,i.u_ele_delta)}),terrainCoords:(e,i)=>({u_matrix:new t.aN(e,i.u_matrix),u_texture:new t.aL(e,i.u_texture),u_terrain_coords_id:new t.aM(e,i.u_terrain_coords_id),u_ele_delta:new t.aM(e,i.u_ele_delta)})};class Oe{constructor(t,e,i){this.context=t;const r=t.gl;this.buffer=r.createBuffer(),this.dynamicDraw=Boolean(i),this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),r.bufferData(r.ELEMENT_ARRAY_BUFFER,e.arrayBuffer,this.dynamicDraw?r.DYNAMIC_DRAW:r.STATIC_DRAW),this.dynamicDraw||delete e.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(t){const e=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),e.bufferSubData(e.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const $e={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Ve{constructor(t,e,i,r){this.length=e.length,this.attributes=i,this.itemSize=e.bytesPerElement,this.dynamicDraw=r,this.context=t;const n=t.gl;this.buffer=n.createBuffer(),t.bindVertexBuffer.set(this.buffer),n.bufferData(n.ARRAY_BUFFER,e.arrayBuffer,this.dynamicDraw?n.DYNAMIC_DRAW:n.STATIC_DRAW),this.dynamicDraw||delete e.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(t){if(t.length!==this.length)throw new Error(`Length of new data is ${t.length}, which doesn't match current length of ${this.length}`);const e=this.context.gl;this.bind(),e.bufferSubData(e.ARRAY_BUFFER,0,t.arrayBuffer)}enableAttributes(t,e){for(let i=0;i<this.attributes.length;i++){const r=e.attributes[this.attributes[i].name];void 0!==r&&t.enableVertexAttribArray(r)}}setVertexAttribPointers(t,e,i){for(let r=0;r<this.attributes.length;r++){const n=this.attributes[r],a=e.attributes[n.name];void 0!==a&&t.vertexAttribPointer(a,n.components,t[$e[n.type]],!1,this.itemSize,n.offset+this.itemSize*(i||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Ne=new WeakMap;function je(t){var e;if(Ne.has(t))return Ne.get(t);{const i=null===(e=t.getParameter(t.VERSION))||void 0===e?void 0:e.startsWith("WebGL 2.0");return Ne.set(t,i),i}}class Ue{constructor(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(t){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Ze extends Ue{getDefault(){return t.aT.transparent}set(t){const e=this.current;(t.r!==e.r||t.g!==e.g||t.b!==e.b||t.a!==e.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class He extends Ue{getDefault(){return 1}set(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)}}class qe extends Ue{getDefault(){return 0}set(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)}}class Ge extends Ue{getDefault(){return[!0,!0,!0,!0]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||t[3]!==e[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class We extends Ue{getDefault(){return!0}set(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)}}class Xe extends Ue{getDefault(){return 255}set(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)}}class Ke extends Ue{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(t){const e=this.current;(t.func!==e.func||t.ref!==e.ref||t.mask!==e.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)}}class Je extends Ue{getDefault(){const t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)}}class Ye extends Ue{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;t?e.enable(e.STENCIL_TEST):e.disable(e.STENCIL_TEST),this.current=t,this.dirty=!1}}class Qe extends Ue{getDefault(){return[0,1]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)}}class ti extends Ue{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;t?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST),this.current=t,this.dirty=!1}}class ei extends Ue{getDefault(){return this.gl.LESS}set(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)}}class ii extends Ue{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;t?e.enable(e.BLEND):e.disable(e.BLEND),this.current=t,this.dirty=!1}}class ri extends Ue{getDefault(){const t=this.gl;return[t.ONE,t.ZERO]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||this.dirty)&&(this.gl.blendFunc(t[0],t[1]),this.current=t,this.dirty=!1)}}class ni extends Ue{getDefault(){return t.aT.transparent}set(t){const e=this.current;(t.r!==e.r||t.g!==e.g||t.b!==e.b||t.a!==e.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class ai extends Ue{getDefault(){return this.gl.FUNC_ADD}set(t){(t!==this.current||this.dirty)&&(this.gl.blendEquation(t),this.current=t,this.dirty=!1)}}class oi extends Ue{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;t?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE),this.current=t,this.dirty=!1}}class si extends Ue{getDefault(){return this.gl.BACK}set(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)}}class li extends Ue{getDefault(){return this.gl.CCW}set(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)}}class ci extends Ue{getDefault(){return null}set(t){(t!==this.current||this.dirty)&&(this.gl.useProgram(t),this.current=t,this.dirty=!1)}}class hi extends Ue{getDefault(){return this.gl.TEXTURE0}set(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)}}class ui extends Ue{getDefault(){const t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||t[3]!==e[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class di extends Ue{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,t),this.current=t,this.dirty=!1}}class pi extends Ue{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.bindRenderbuffer(e.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class mi extends Ue{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.bindTexture(e.TEXTURE_2D,t),this.current=t,this.dirty=!1}}class fi extends Ue{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.bindBuffer(e.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class gi extends Ue{getDefault(){return null}set(t){const e=this.gl;e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class yi extends Ue{getDefault(){return null}set(t){var e;if(t===this.current&&!this.dirty)return;const i=this.gl;je(i)?i.bindVertexArray(t):null===(e=i.getExtension("OES_vertex_array_object"))||void 0===e||e.bindVertexArrayOES(t),this.current=t,this.dirty=!1}}class _i extends Ue{getDefault(){return 4}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.pixelStorei(e.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}}class vi extends Ue{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}}class bi extends Ue{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}}class xi extends Ue{constructor(t,e){super(t),this.context=t,this.parent=e}getDefault(){return null}}class wi extends xi{setDirty(){this.dirty=!0}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const e=this.gl;e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class Si extends xi{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const e=this.gl;e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class ki extends xi{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const e=this.gl;e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class Ci{constructor(t,e,i,r,n){this.context=t,this.width=e,this.height=i;const a=t.gl,o=this.framebuffer=a.createFramebuffer();if(this.colorAttachment=new wi(t,o),r)this.depthAttachment=n?new ki(t,o):new Si(t,o);else if(n)throw new Error("Stencil cannot be setted without depth");if(a.checkFramebufferStatus(a.FRAMEBUFFER)!==a.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const t=this.context.gl,e=this.colorAttachment.get();if(e&&t.deleteTexture(e),this.depthAttachment){const e=this.depthAttachment.get();e&&t.deleteRenderbuffer(e)}t.deleteFramebuffer(this.framebuffer)}}class Ai{constructor(t,e,i){this.blendFunction=t,this.blendColor=e,this.mask=i}}Ai.Replace=[1,0],Ai.disabled=new Ai(Ai.Replace,t.aT.transparent,[!1,!1,!1,!1]),Ai.unblended=new Ai(Ai.Replace,t.aT.transparent,[!0,!0,!0,!0]),Ai.alphaBlended=new Ai([1,771],t.aT.transparent,[!0,!0,!0,!0]);class Ti{constructor(t){var e,i;if(this.gl=t,this.clearColor=new Ze(this),this.clearDepth=new He(this),this.clearStencil=new qe(this),this.colorMask=new Ge(this),this.depthMask=new We(this),this.stencilMask=new Xe(this),this.stencilFunc=new Ke(this),this.stencilOp=new Je(this),this.stencilTest=new Ye(this),this.depthRange=new Qe(this),this.depthTest=new ti(this),this.depthFunc=new ei(this),this.blend=new ii(this),this.blendFunc=new ri(this),this.blendColor=new ni(this),this.blendEquation=new ai(this),this.cullFace=new oi(this),this.cullFaceSide=new si(this),this.frontFace=new li(this),this.program=new ci(this),this.activeTexture=new hi(this),this.viewport=new ui(this),this.bindFramebuffer=new di(this),this.bindRenderbuffer=new pi(this),this.bindTexture=new mi(this),this.bindVertexBuffer=new fi(this),this.bindElementBuffer=new gi(this),this.bindVertexArray=new yi(this),this.pixelStoreUnpack=new _i(this),this.pixelStoreUnpackPremultiplyAlpha=new vi(this),this.pixelStoreUnpackFlipY=new bi(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),je(t)){this.HALF_FLOAT=t.HALF_FLOAT;const r=t.getExtension("EXT_color_buffer_half_float");this.RGBA16F=null!==(e=t.RGBA16F)&&void 0!==e?e:null==r?void 0:r.RGBA16F_EXT,this.RGB16F=null!==(i=t.RGB16F)&&void 0!==i?i:null==r?void 0:r.RGB16F_EXT,t.getExtension("EXT_color_buffer_float")}else{t.getExtension("EXT_color_buffer_half_float"),t.getExtension("OES_texture_half_float_linear");const e=t.getExtension("OES_texture_half_float");this.HALF_FLOAT=null==e?void 0:e.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(t,e){return new Oe(this,t,e)}createVertexBuffer(t,e,i){return new Ve(this,t,e,i)}createRenderbuffer(t,e,i){const r=this.gl,n=r.createRenderbuffer();return this.bindRenderbuffer.set(n),r.renderbufferStorage(r.RENDERBUFFER,t,e,i),this.bindRenderbuffer.set(null),n}createFramebuffer(t,e,i,r){return new Ci(this,t,e,i,r)}clear({color:t,depth:e,stencil:i}){const r=this.gl;let n=0;t&&(n|=r.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set([!0,!0,!0,!0])),void 0!==e&&(n|=r.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(e),this.depthMask.set(!0)),void 0!==i&&(n|=r.STENCIL_BUFFER_BIT,this.clearStencil.set(i),this.stencilMask.set(255)),r.clear(n)}setCullFace(t){!1===t.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))}setDepthMode(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)}setStencilMode(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)}setColorMode(e){t.aG(e.blendFunction,Ai.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)}createVertexArray(){var t;return je(this.gl)?this.gl.createVertexArray():null===(t=this.gl.getExtension("OES_vertex_array_object"))||void 0===t?void 0:t.createVertexArrayOES()}deleteVertexArray(t){var e;return je(this.gl)?this.gl.deleteVertexArray(t):null===(e=this.gl.getExtension("OES_vertex_array_object"))||void 0===e?void 0:e.deleteVertexArrayOES(t)}unbindVAO(){this.bindVertexArray.set(null)}}class Ei{constructor(t,e,i){this.func=t,this.mask=e,this.range=i}}Ei.ReadOnly=!1,Ei.ReadWrite=!0,Ei.disabled=new Ei(519,Ei.ReadOnly,[0,1]);const Mi=7680;class Ii{constructor(t,e,i,r,n,a){this.test=t,this.ref=e,this.mask=i,this.fail=r,this.depthFail=n,this.pass=a}}Ii.disabled=new Ii({func:519,mask:0},0,0,Mi,Mi,Mi);class zi{constructor(t,e,i){this.enable=t,this.mode=e,this.frontFace=i}}let Pi;function Li(e,i,r,n,a,o,s){const l=e.context,c=l.gl,h=e.useProgram("collisionBox"),u=[];let d=0,p=0;for(let m=0;m<n.length;m++){const f=n[m],g=i.getTile(f),y=g.getBucket(r);if(!y)continue;let _=f.posMatrix;0===a[0]&&0===a[1]||(_=e.translatePosMatrix(f.posMatrix,g,a,o));const v=s?y.textCollisionBox:y.iconCollisionBox,b=y.collisionCircleArray;if(b.length>0){const i=t.Z(),r=_;t.aU(i,y.placementInvProjMatrix,e.transform.glCoordMatrix),t.aU(i,i,y.placementViewportMatrix),u.push({circleArray:b,circleOffset:p,transform:r,invTransform:i,coord:f}),d+=b.length/4,p=d}v&&h.draw(l,c.LINES,Ei.disabled,Ii.disabled,e.colorModeForRenderPass(),zi.disabled,ve(_,e.transform,g),e.style.map.terrain&&e.style.map.terrain.getTerrainData(f),r.id,v.layoutVertexBuffer,v.indexBuffer,v.segments,null,e.transform.zoom,null,null,v.collisionVertexBuffer)}if(!s||!u.length)return;const m=e.useProgram("collisionCircle"),f=new t.aV;f.resize(4*d),f._trim();let g=0;for(const t of u)for(let e=0;e<t.circleArray.length/4;e++){const i=4*e,r=t.circleArray[i+0],n=t.circleArray[i+1],a=t.circleArray[i+2],o=t.circleArray[i+3];f.emplace(g++,r,n,a,o,0),f.emplace(g++,r,n,a,o,1),f.emplace(g++,r,n,a,o,2),f.emplace(g++,r,n,a,o,3)}(!Pi||Pi.length<2*d)&&(Pi=function(e){const i=2*e,r=new t.aX;r.resize(i),r._trim();for(let t=0;t<i;t++){const e=6*t;r.uint16[e+0]=4*t+0,r.uint16[e+1]=4*t+1,r.uint16[e+2]=4*t+2,r.uint16[e+3]=4*t+2,r.uint16[e+4]=4*t+3,r.uint16[e+5]=4*t+0}return r}(d));const y=l.createIndexBuffer(Pi,!0),_=l.createVertexBuffer(f,t.aW.members,!0);for(const i of u){const n={u_matrix:i.transform,u_inv_matrix:i.invTransform,u_camera_to_center_distance:(v=e.transform).cameraToCenterDistance,u_viewport_size:[v.width,v.height]};m.draw(l,c.TRIANGLES,Ei.disabled,Ii.disabled,e.colorModeForRenderPass(),zi.disabled,n,e.style.map.terrain&&e.style.map.terrain.getTerrainData(i.coord),r.id,_,y,t.S.simpleSegment(0,2*i.circleOffset,i.circleArray.length,i.circleArray.length/2),null,e.transform.zoom,null,null,null)}var v;_.destroy(),y.destroy()}zi.disabled=new zi(!1,1029,2305),zi.backCCW=new zi(!0,1029,2305);const Di=t.ao(new Float32Array(16));function Ri(e,i,r,n,a,o){const{horizontalAlign:s,verticalAlign:l}=t.au(e);return new t.P((-(s-.5)*i/a+n[0])*o,(-(l-.5)*r/a+n[1])*o)}function Bi(e,i,r,n,a,o,s,l,c,h,u){const d=e.text.placedSymbolArray,p=e.text.dynamicLayoutVertexArray,m=e.icon.dynamicLayoutVertexArray,f={};p.clear();for(let m=0;m<d.length;m++){const g=d.get(m),y=g.hidden||!g.crossTileID||e.allowVerticalPlacement&&!g.placedOrientation?null:n[g.crossTileID];if(y){const n=new t.P(g.anchorX,g.anchorY),d=ct(n,r?s:o,u),m=ht(a.cameraToCenterDistance,d.signedDistanceFromCamera);let _=t.aj(e.textSizeData,c,g)*m/t.ap;r&&(_*=e.tilePixelRatio/l);const{width:v,height:b,anchor:x,textOffset:w,textBoxScale:S}=y,k=Ri(x,v,b,w,S,_),C=r?ct(n.add(k),o,u).point:d.point.add(i?k.rotate(-a.angle):k),A=e.allowVerticalPlacement&&g.placedOrientation===t.ai.vertical?Math.PI/2:0;for(let e=0;e<g.numGlyphs;e++)t.ak(p,C,A);h&&g.associatedIconIndex>=0&&(f[g.associatedIconIndex]={shiftedAnchor:C,angle:A})}else wt(g.numGlyphs,p)}if(h){m.clear();const i=e.icon.placedSymbolArray;for(let e=0;e<i.length;e++){const r=i.get(e);if(r.hidden)wt(r.numGlyphs,m);else{const i=f[e];if(i)for(let e=0;e<r.numGlyphs;e++)t.ak(m,i.shiftedAnchor,i.angle);else wt(r.numGlyphs,m)}}e.icon.dynamicLayoutVertexBuffer.updateData(m)}e.text.dynamicLayoutVertexBuffer.updateData(p)}function Fi(t,e,i){return i.iconsInText&&e?"symbolTextAndIcon":t?"symbolSDF":"symbolIcon"}function Oi(e,i,r,n,a,o,s,l,c,h,u,d){const p=e.context,m=p.gl,f=e.transform,g="map"===l,y="map"===c,_="viewport"!==l&&"point"!==r.layout.get("symbol-placement"),v=g&&!y&&!_,b=!r.layout.get("symbol-sort-key").isConstant();let x=!1;const w=e.depthModeForSublayer(0,Ei.ReadOnly),S=r._unevaluatedLayout.hasValue("text-variable-anchor")||r._unevaluatedLayout.hasValue("text-variable-anchor-offset"),k=[];for(const l of n){const n=i.getTile(l),c=n.getBucket(r);if(!c)continue;const u=a?c.text:c.icon;if(!u||!u.segments.get().length||!u.hasVisibleVertices)continue;const d=u.programConfigurations.get(r.id),p=a||c.sdfIcons,w=a?c.textSizeData:c.iconSizeData,C=y||0!==f.pitch,A=e.useProgram(Fi(p,a,c),d),T=t.ah(w,f.zoom),E=e.style.map.terrain&&e.style.map.terrain.getTerrainData(l);let M,I,z,P,L=[0,0],D=null;if(a)I=n.glyphAtlasTexture,z=m.LINEAR,M=n.glyphAtlasTexture.size,c.iconsInText&&(L=n.imageAtlasTexture.size,D=n.imageAtlasTexture,P=C||e.options.rotating||e.options.zooming||"composite"===w.kind||"camera"===w.kind?m.LINEAR:m.NEAREST);else{const t=1!==r.layout.get("icon-size").constantOr(0)||c.iconsNeedLinear;I=n.imageAtlasTexture,z=p||e.options.rotating||e.options.zooming||t||C?m.LINEAR:m.NEAREST,M=n.imageAtlasTexture.size}const R=At(n,1,e.transform.zoom),B=st(l.posMatrix,y,g,e.transform,R),F=lt(l.posMatrix,y,g,e.transform,R),O=S&&c.hasTextData(),$="none"!==r.layout.get("icon-text-fit")&&O&&c.hasIconData();if(_){const t=e.style.map.terrain?(t,i)=>e.style.map.terrain.getElevation(l,t,i):null,i="map"===r.layout.get("text-rotation-alignment");dt(c,l.posMatrix,e,a,B,F,y,h,i,t)}const V=e.translatePosMatrix(l.posMatrix,n,o,s),N=_||a&&S||$?Di:B,j=e.translatePosMatrix(F,n,o,s,!0),U=p&&0!==r.paint.get(a?"text-halo-width":"icon-halo-width").constantOr(1);let Z;Z=p?c.iconsInText?De(w.kind,T,v,y,e,V,N,j,M,L):Le(w.kind,T,v,y,e,V,N,j,a,M,!0):Pe(w.kind,T,v,y,e,V,N,j,a,M);const H={program:A,buffers:u,uniformValues:Z,atlasTexture:I,atlasTextureIcon:D,atlasInterpolation:z,atlasInterpolationIcon:P,isSDF:p,hasHalo:U};if(b&&c.canOverlap){x=!0;const e=u.segments.get();for(const i of e)k.push({segments:new t.S([i]),sortKey:i.sortKey,state:H,terrainData:E})}else k.push({segments:u.segments,sortKey:0,state:H,terrainData:E})}x&&k.sort(((t,e)=>t.sortKey-e.sortKey));for(const t of k){const i=t.state;if(p.activeTexture.set(m.TEXTURE0),i.atlasTexture.bind(i.atlasInterpolation,m.CLAMP_TO_EDGE),i.atlasTextureIcon&&(p.activeTexture.set(m.TEXTURE1),i.atlasTextureIcon&&i.atlasTextureIcon.bind(i.atlasInterpolationIcon,m.CLAMP_TO_EDGE)),i.isSDF){const n=i.uniformValues;i.hasHalo&&(n.u_is_halo=1,$i(i.buffers,t.segments,r,e,i.program,w,u,d,n,t.terrainData)),n.u_is_halo=0}$i(i.buffers,t.segments,r,e,i.program,w,u,d,i.uniformValues,t.terrainData)}}function $i(t,e,i,r,n,a,o,s,l,c){const h=r.context;n.draw(h,h.gl.TRIANGLES,a,o,s,zi.disabled,l,c,i.id,t.layoutVertexBuffer,t.indexBuffer,e,i.paint,r.transform.zoom,t.programConfigurations.get(i.id),t.dynamicLayoutVertexBuffer,t.opacityVertexBuffer)}function Vi(t,e,i,r,n){if(!i||!r||!r.imageAtlas)return;const a=r.imageAtlas.patternPositions;let o=a[i.to.toString()],s=a[i.from.toString()];if(!o&&s&&(o=s),!s&&o&&(s=o),!o||!s){const t=n.getPaintProperty(e);o=a[t],s=a[t]}o&&s&&t.setConstantPatternPositions(o,s)}function Ni(t,e,i,r,n,a,o){const s=t.context.gl,l="fill-pattern",c=i.paint.get(l),h=c&&c.constantOr(1),u=i.getCrossfadeParameters();let d,p,m,f,g;o?(p=h&&!i.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",d=s.LINES):(p=h?"fillPattern":"fill",d=s.TRIANGLES);const y=c.constantOr(null);for(const c of r){const r=e.getTile(c);if(h&&!r.patternsLoaded())continue;const _=r.getBucket(i);if(!_)continue;const v=_.programConfigurations.get(i.id),b=t.useProgram(p,v),x=t.style.map.terrain&&t.style.map.terrain.getTerrainData(c);h&&(t.context.activeTexture.set(s.TEXTURE0),r.imageAtlasTexture.bind(s.LINEAR,s.CLAMP_TO_EDGE),v.updatePaintBuffers(u)),Vi(v,l,y,r,i);const w=x?c:null,S=t.translatePosMatrix(w?w.posMatrix:c.posMatrix,r,i.paint.get("fill-translate"),i.paint.get("fill-translate-anchor"));if(o){f=_.indexBuffer2,g=_.segments2;const e=[s.drawingBufferWidth,s.drawingBufferHeight];m="fillOutlinePattern"===p&&h?ye(S,t,u,r,e):ge(S,e)}else f=_.indexBuffer,g=_.segments,m=h?fe(S,t,u,r):me(S);b.draw(t.context,d,n,t.stencilModeForClipping(c),a,zi.disabled,m,x,i.id,_.layoutVertexBuffer,f,g,i.paint,t.transform.zoom,v)}}function ji(t,e,i,r,n,a,o){const s=t.context,l=s.gl,c="fill-extrusion-pattern",h=i.paint.get(c),u=h.constantOr(1),d=i.getCrossfadeParameters(),p=i.paint.get("fill-extrusion-opacity"),m=h.constantOr(null);for(const h of r){const r=e.getTile(h),f=r.getBucket(i);if(!f)continue;const g=t.style.map.terrain&&t.style.map.terrain.getTerrainData(h),y=f.programConfigurations.get(i.id),_=t.useProgram(u?"fillExtrusionPattern":"fillExtrusion",y);u&&(t.context.activeTexture.set(l.TEXTURE0),r.imageAtlasTexture.bind(l.LINEAR,l.CLAMP_TO_EDGE),y.updatePaintBuffers(d)),Vi(y,c,m,r,i);const v=t.translatePosMatrix(h.posMatrix,r,i.paint.get("fill-extrusion-translate"),i.paint.get("fill-extrusion-translate-anchor")),b=i.paint.get("fill-extrusion-vertical-gradient"),x=u?pe(v,t,b,p,h,d,r):de(v,t,b,p);_.draw(s,s.gl.TRIANGLES,n,a,o,zi.backCCW,x,g,i.id,f.layoutVertexBuffer,f.indexBuffer,f.segments,i.paint,t.transform.zoom,y,t.style.map.terrain&&f.centroidVertexBuffer)}}function Ui(t,e,i,r,n,a,o){const s=t.context,l=s.gl,c=i.fbo;if(!c)return;const h=t.useProgram("hillshade"),u=t.style.map.terrain&&t.style.map.terrain.getTerrainData(e);s.activeTexture.set(l.TEXTURE0),l.bindTexture(l.TEXTURE_2D,c.colorAttachment.get()),h.draw(s,l.TRIANGLES,n,a,o,zi.disabled,((t,e,i,r)=>{const n=i.paint.get("hillshade-shadow-color"),a=i.paint.get("hillshade-highlight-color"),o=i.paint.get("hillshade-accent-color");let s=i.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===i.paint.get("hillshade-illumination-anchor")&&(s-=t.transform.angle);const l=!t.options.moving;return{u_matrix:r?r.posMatrix:t.transform.calculatePosMatrix(e.tileID.toUnwrapped(),l),u_image:0,u_latrange:Se(0,e.tileID),u_light:[i.paint.get("hillshade-exaggeration"),s],u_shadow:n,u_highlight:a,u_accent:o}})(t,i,r,u?e:null),u,r.id,t.rasterBoundsBuffer,t.quadTriangleIndexBuffer,t.rasterBoundsSegments)}function Zi(e,i,r,n,a,o){const s=e.context,l=s.gl,c=i.dem;if(c&&c.data){const h=c.dim,u=c.stride,d=c.getPixels();if(s.activeTexture.set(l.TEXTURE1),s.pixelStoreUnpackPremultiplyAlpha.set(!1),i.demTexture=i.demTexture||e.getTileTexture(u),i.demTexture){const t=i.demTexture;t.update(d,{premultiply:!1}),t.bind(l.NEAREST,l.CLAMP_TO_EDGE)}else i.demTexture=new v(s,d,l.RGBA,{premultiply:!1}),i.demTexture.bind(l.NEAREST,l.CLAMP_TO_EDGE);s.activeTexture.set(l.TEXTURE0);let p=i.fbo;if(!p){const t=new v(s,{width:h,height:h,data:null},l.RGBA);t.bind(l.LINEAR,l.CLAMP_TO_EDGE),p=i.fbo=s.createFramebuffer(h,h,!0,!1),p.colorAttachment.set(t.texture)}s.bindFramebuffer.set(p.framebuffer),s.viewport.set([0,0,h,h]),e.useProgram("hillshadePrepare").draw(s,l.TRIANGLES,n,a,o,zi.disabled,((e,i)=>{const r=i.stride,n=t.Z();return t.aS(n,0,t.N,-t.N,0,0,1),t.$(n,n,[0,-t.N,0]),{u_matrix:n,u_image:1,u_dimension:[r,r],u_zoom:e.overscaledZ,u_unpack:i.getUnpackVector()}})(i.tileID,c),null,r.id,e.rasterBoundsBuffer,e.quadTriangleIndexBuffer,e.rasterBoundsSegments),i.needsHillshadePrepare=!1}}function Hi(e,i,r,n,a,o){const s=n.paint.get("raster-fade-duration");if(!o&&s>0){const n=t.h.now(),o=(n-e.timeAdded)/s,l=i?(n-i.timeAdded)/s:-1,c=r.getSource(),h=a.coveringZoomLevel({tileSize:c.tileSize,roundZoom:c.roundZoom}),u=!i||Math.abs(i.tileID.overscaledZ-h)>Math.abs(e.tileID.overscaledZ-h),d=u&&e.refreshedUponExpiration?1:t.ad(u?o:1-l,0,1);return e.refreshedUponExpiration&&o>=1&&(e.refreshedUponExpiration=!1),i?{opacity:1,mix:1-d}:{opacity:d,mix:0}}return{opacity:1,mix:0}}const qi=new t.aT(1,0,0,1),Gi=new t.aT(0,1,0,1),Wi=new t.aT(0,0,1,1),Xi=new t.aT(1,0,1,1),Ki=new t.aT(0,1,1,1);function Ji(t,e,i,r){Qi(t,0,e+i/2,t.transform.width,i,r)}function Yi(t,e,i,r){Qi(t,e-i/2,0,i,t.transform.height,r)}function Qi(t,e,i,r,n,a){const o=t.context,s=o.gl;s.enable(s.SCISSOR_TEST),s.scissor(e*t.pixelRatio,i*t.pixelRatio,r*t.pixelRatio,n*t.pixelRatio),o.clear({color:a}),s.disable(s.SCISSOR_TEST)}function tr(e,i,r){const n=e.context,a=n.gl,o=r.posMatrix,s=e.useProgram("debug"),l=Ei.disabled,c=Ii.disabled,h=e.colorModeForRenderPass(),u="$debug",d=e.style.map.terrain&&e.style.map.terrain.getTerrainData(r);n.activeTexture.set(a.TEXTURE0);const p=i.getTileByID(r.key).latestRawTileData,m=Math.floor((p&&p.byteLength||0)/1024),f=i.getTile(r).tileSize,g=512/Math.min(f,512)*(r.overscaledZ/e.transform.zoom)*.5;let y=r.canonical.toString();r.overscaledZ!==r.canonical.z&&(y+=` => ${r.overscaledZ}`),function(t,e){t.initDebugOverlayCanvas();const i=t.debugOverlayCanvas,r=t.context.gl,n=t.debugOverlayCanvas.getContext("2d");n.clearRect(0,0,i.width,i.height),n.shadowColor="white",n.shadowBlur=2,n.lineWidth=1.5,n.strokeStyle="white",n.textBaseline="top",n.font="bold 36px Open Sans, sans-serif",n.fillText(e,5,5),n.strokeText(e,5,5),t.debugOverlayTexture.update(i),t.debugOverlayTexture.bind(r.LINEAR,r.CLAMP_TO_EDGE)}(e,`${y} ${m}kB`),s.draw(n,a.TRIANGLES,l,c,Ai.alphaBlended,zi.disabled,be(o,t.aT.transparent,g),null,u,e.debugBuffer,e.quadTriangleIndexBuffer,e.debugSegments),s.draw(n,a.LINE_STRIP,l,c,h,zi.disabled,be(o,t.aT.red),d,u,e.debugBuffer,e.tileBorderIndexBuffer,e.debugSegments)}function er(t,e,i){const r=t.context,n=r.gl,a=t.colorModeForRenderPass(),o=new Ei(n.LEQUAL,Ei.ReadWrite,t.depthRangeFor3D),s=t.useProgram("terrain"),l=e.getTerrainMesh();r.bindFramebuffer.set(null),r.viewport.set([0,0,t.width,t.height]);for(const c of i){const i=t.renderToTexture.getTexture(c),h=e.getTerrainData(c.tileID);r.activeTexture.set(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,i.texture);const u={u_matrix:t.transform.calculatePosMatrix(c.tileID.toUnwrapped()),u_texture:0,u_ele_delta:e.getMeshFrameDelta(t.transform.zoom)};s.draw(r,n.TRIANGLES,o,Ii.disabled,a,zi.backCCW,u,h,"terrain",l.vertexBuffer,l.indexBuffer,l.segments)}}class ir{constructor(e,i){this.context=new Ti(e),this.transform=i,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:t.Z(),renderTime:0},this.setup(),this.numSublayers=K.maxUnderzooming+K.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Yt}resize(t,e,i){if(this.width=Math.floor(t*i),this.height=Math.floor(e*i),this.pixelRatio=i,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const t of this.style._order)this.style._layers[t].resize()}setup(){const e=this.context,i=new t.a_;i.emplaceBack(0,0),i.emplaceBack(t.N,0),i.emplaceBack(0,t.N),i.emplaceBack(t.N,t.N),this.tileExtentBuffer=e.createVertexBuffer(i,ne.members),this.tileExtentSegments=t.S.simpleSegment(0,0,4,2);const r=new t.a_;r.emplaceBack(0,0),r.emplaceBack(t.N,0),r.emplaceBack(0,t.N),r.emplaceBack(t.N,t.N),this.debugBuffer=e.createVertexBuffer(r,ne.members),this.debugSegments=t.S.simpleSegment(0,0,4,5);const n=new t.V;n.emplaceBack(0,0,0,0),n.emplaceBack(t.N,0,t.N,0),n.emplaceBack(0,t.N,0,t.N),n.emplaceBack(t.N,t.N,t.N,t.N),this.rasterBoundsBuffer=e.createVertexBuffer(n,O.members),this.rasterBoundsSegments=t.S.simpleSegment(0,0,4,2);const a=new t.a_;a.emplaceBack(0,0),a.emplaceBack(1,0),a.emplaceBack(0,1),a.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(a,ne.members),this.viewportSegments=t.S.simpleSegment(0,0,4,2);const o=new t.a$;o.emplaceBack(0),o.emplaceBack(1),o.emplaceBack(3),o.emplaceBack(2),o.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(o);const s=new t.b0;s.emplaceBack(0,1,2),s.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(s);const l=this.context.gl;this.stencilClearMode=new Ii({func:l.ALWAYS,mask:0},0,255,l.ZERO,l.ZERO,l.ZERO)}clearStencil(){const e=this.context,i=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const r=t.Z();t.aS(r,0,this.width,this.height,0,0,1),t.a0(r,r,[i.drawingBufferWidth,i.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(e,i.TRIANGLES,Ei.disabled,this.stencilClearMode,Ai.disabled,zi.disabled,xe(r),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(t,e){if(this.currentStencilSource===t.source||!t.isTileClipped()||!e||!e.length)return;this.currentStencilSource=t.source;const i=this.context,r=i.gl;this.nextStencilID+e.length>256&&this.clearStencil(),i.setColorMode(Ai.disabled),i.setDepthMode(Ei.disabled);const n=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const t of e){const e=this._tileClippingMaskIDs[t.key]=this.nextStencilID++,a=this.style.map.terrain&&this.style.map.terrain.getTerrainData(t);n.draw(i,r.TRIANGLES,Ei.disabled,new Ii({func:r.ALWAYS,mask:0},e,255,r.KEEP,r.KEEP,r.REPLACE),Ai.disabled,zi.disabled,xe(t.posMatrix),a,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const t=this.nextStencilID++,e=this.context.gl;return new Ii({func:e.NOTEQUAL,mask:255},t,255,e.KEEP,e.KEEP,e.REPLACE)}stencilModeForClipping(t){const e=this.context.gl;return new Ii({func:e.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,e.KEEP,e.KEEP,e.REPLACE)}stencilConfigForOverlap(t){const e=this.context.gl,i=t.sort(((t,e)=>e.overscaledZ-t.overscaledZ)),r=i[i.length-1].overscaledZ,n=i[0].overscaledZ-r+1;if(n>1){this.currentStencilSource=void 0,this.nextStencilID+n>256&&this.clearStencil();const t={};for(let i=0;i<n;i++)t[i+r]=new Ii({func:e.GEQUAL,mask:255},i+this.nextStencilID,255,e.KEEP,e.KEEP,e.REPLACE);return this.nextStencilID+=n,[t,i]}return[{[r]:Ii.disabled},i]}colorModeForRenderPass(){const e=this.context.gl;if(this._showOverdrawInspector){const i=1/8;return new Ai([e.CONSTANT_COLOR,e.ONE],new t.aT(i,i,i,0),[!0,!0,!0,!0])}return"opaque"===this.renderPass?Ai.unblended:Ai.alphaBlended}depthModeForSublayer(t,e,i){if(!this.opaquePassEnabledForLayer())return Ei.disabled;const r=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new Ei(i||this.context.gl.LEQUAL,e,[r,r])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(e,i){this.style=e,this.options=i,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(t.h.now()),this.imageManager.beginFrame();const r=this.style._order,n=this.style.sourceCaches,a={},o={},s={};for(const t in n){const e=n[t];e.used&&e.prepare(this.context),a[t]=e.getVisibleCoordinates(),o[t]=a[t].slice().reverse(),s[t]=e.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let t=0;t<r.length;t++)if(this.style._layers[r[t]].is3D()){this.opaquePassCutoff=t;break}if(this.renderToTexture){this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0;const e=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!t.b1(this.terrainFacilitator.matrix,this.transform.projMatrix)||e.length)&&(t.b2(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(e,i){const r=e.context,n=r.gl,a=Ai.unblended,o=new Ei(n.LEQUAL,Ei.ReadWrite,[0,1]),s=i.getTerrainMesh(),l=i.sourceCache.getRenderableTiles(),c=e.useProgram("terrainDepth");r.bindFramebuffer.set(i.getFramebuffer("depth").framebuffer),r.viewport.set([0,0,e.width/devicePixelRatio,e.height/devicePixelRatio]),r.clear({color:t.aT.transparent,depth:1});for(const t of l){const l=i.getTerrainData(t.tileID),h={u_matrix:e.transform.calculatePosMatrix(t.tileID.toUnwrapped()),u_ele_delta:i.getMeshFrameDelta(e.transform.zoom)};c.draw(r,n.TRIANGLES,o,Ii.disabled,a,zi.backCCW,h,l,"terrain",s.vertexBuffer,s.indexBuffer,s.segments)}r.bindFramebuffer.set(null),r.viewport.set([0,0,e.width,e.height])}(this,this.style.map.terrain),function(e,i){const r=e.context,n=r.gl,a=Ai.unblended,o=new Ei(n.LEQUAL,Ei.ReadWrite,[0,1]),s=i.getTerrainMesh(),l=i.getCoordsTexture(),c=i.sourceCache.getRenderableTiles(),h=e.useProgram("terrainCoords");r.bindFramebuffer.set(i.getFramebuffer("coords").framebuffer),r.viewport.set([0,0,e.width/devicePixelRatio,e.height/devicePixelRatio]),r.clear({color:t.aT.transparent,depth:1}),i.coordsIndex=[];for(const t of c){const c=i.getTerrainData(t.tileID);r.activeTexture.set(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,l.texture);const u={u_matrix:e.transform.calculatePosMatrix(t.tileID.toUnwrapped()),u_terrain_coords_id:(255-i.coordsIndex.length)/255,u_texture:0,u_ele_delta:i.getMeshFrameDelta(e.transform.zoom)};h.draw(r,n.TRIANGLES,o,Ii.disabled,a,zi.backCCW,u,c,"terrain",s.vertexBuffer,s.indexBuffer,s.segments),i.coordsIndex.push(t.tileID.key)}r.bindFramebuffer.set(null),r.viewport.set([0,0,e.width,e.height])}(this,this.style.map.terrain))}this.renderPass="offscreen";for(const t of r){const e=this.style._layers[t];if(!e.hasOffscreenPass()||e.isHidden(this.transform.zoom))continue;const i=o[e.source];("custom"===e.type||i.length)&&this.renderLayer(this,n[e.source],e,i)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:i.showOverdrawInspector?t.aT.black:t.aT.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=i.showOverdrawInspector,this.depthRangeFor3D=[0,1-(e._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=r.length-1;this.currentLayer>=0;this.currentLayer--){const t=this.style._layers[r[this.currentLayer]],e=n[t.source],i=a[t.source];this._renderTileClippingMasks(t,i),this.renderLayer(this,e,t,i)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<r.length;this.currentLayer++){const t=this.style._layers[r[this.currentLayer]],e=n[t.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(t))continue;const i=("symbol"===t.type?s:o)[t.source];this._renderTileClippingMasks(t,a[t.source]),this.renderLayer(this,e,t,i)}if(this.options.showTileBoundaries){const t=function(t,e){let i=null;const r=Object.values(t._layers).flatMap((i=>i.source&&!i.isHidden(e)?[t.sourceCaches[i.source]]:[])),n=r.filter((t=>"vector"===t.getSource().type)),a=r.filter((t=>"vector"!==t.getSource().type)),o=t=>{(!i||i.getSource().maxzoom<t.getSource().maxzoom)&&(i=t)};return n.forEach((t=>o(t))),i||a.forEach((t=>o(t))),i}(this.style,this.transform.zoom);t&&function(t,e,i){for(let r=0;r<i.length;r++)tr(t,e,i[r])}(this,t,t.getVisibleCoordinates())}this.options.showPadding&&function(t){const e=t.transform.padding;Ji(t,t.transform.height-(e.top||0),3,qi),Ji(t,e.bottom||0,3,Gi),Yi(t,e.left||0,3,Wi),Yi(t,t.transform.width-(e.right||0),3,Xi);const i=t.transform.centerPoint;!function(t,e,i,r){Qi(t,e-1,i-10,2,20,r),Qi(t,e-10,i-1,20,2,r)}(t,i.x,t.transform.height-i.y,Ki)}(this),this.context.setDefault()}renderLayer(e,i,r,n){if(!r.isHidden(this.transform.zoom)&&("background"===r.type||"custom"===r.type||(n||[]).length))switch(this.id=r.id,r.type){case"symbol":!function(e,i,r,n,a){if("translucent"!==e.renderPass)return;const o=Ii.disabled,s=e.colorModeForRenderPass();(r._unevaluatedLayout.hasValue("text-variable-anchor")||r._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(e,i,r,n,a,o,s){const l=i.transform,c="map"===a,h="map"===o;for(const a of e){const e=n.getTile(a),o=e.getBucket(r);if(!o||!o.text||!o.text.segments.get().length)continue;const u=t.ah(o.textSizeData,l.zoom),d=At(e,1,i.transform.zoom),p=st(a.posMatrix,h,c,i.transform,d),m="none"!==r.layout.get("icon-text-fit")&&o.hasIconData();if(u){const t=Math.pow(2,l.zoom-e.tileID.overscaledZ);Bi(o,c,h,s,l,p,a.posMatrix,t,u,m,i.style.map.terrain?(t,e)=>i.style.map.terrain.getElevation(a,t,e):null)}}}(n,e,r,i,r.layout.get("text-rotation-alignment"),r.layout.get("text-pitch-alignment"),a),0!==r.paint.get("icon-opacity").constantOr(1)&&Oi(e,i,r,n,!1,r.paint.get("icon-translate"),r.paint.get("icon-translate-anchor"),r.layout.get("icon-rotation-alignment"),r.layout.get("icon-pitch-alignment"),r.layout.get("icon-keep-upright"),o,s),0!==r.paint.get("text-opacity").constantOr(1)&&Oi(e,i,r,n,!0,r.paint.get("text-translate"),r.paint.get("text-translate-anchor"),r.layout.get("text-rotation-alignment"),r.layout.get("text-pitch-alignment"),r.layout.get("text-keep-upright"),o,s),i.map.showCollisionBoxes&&(Li(e,i,r,n,r.paint.get("text-translate"),r.paint.get("text-translate-anchor"),!0),Li(e,i,r,n,r.paint.get("icon-translate"),r.paint.get("icon-translate-anchor"),!1))}(e,i,r,n,this.style.placement.variableOffsets);break;case"circle":!function(e,i,r,n){if("translucent"!==e.renderPass)return;const a=r.paint.get("circle-opacity"),o=r.paint.get("circle-stroke-width"),s=r.paint.get("circle-stroke-opacity"),l=!r.layout.get("circle-sort-key").isConstant();if(0===a.constantOr(1)&&(0===o.constantOr(1)||0===s.constantOr(1)))return;const c=e.context,h=c.gl,u=e.depthModeForSublayer(0,Ei.ReadOnly),d=Ii.disabled,p=e.colorModeForRenderPass(),m=[];for(let a=0;a<n.length;a++){const o=n[a],s=i.getTile(o),c=s.getBucket(r);if(!c)continue;const h=c.programConfigurations.get(r.id),u=e.useProgram("circle",h),d=c.layoutVertexBuffer,p=c.indexBuffer,f=e.style.map.terrain&&e.style.map.terrain.getTerrainData(o),g={programConfiguration:h,program:u,layoutVertexBuffer:d,indexBuffer:p,uniformValues:_e(e,o,s,r),terrainData:f};if(l){const e=c.segments.get();for(const i of e)m.push({segments:new t.S([i]),sortKey:i.sortKey,state:g})}else m.push({segments:c.segments,sortKey:0,state:g})}l&&m.sort(((t,e)=>t.sortKey-e.sortKey));for(const t of m){const{programConfiguration:i,program:n,layoutVertexBuffer:a,indexBuffer:o,uniformValues:s,terrainData:l}=t.state;n.draw(c,h.TRIANGLES,u,d,p,zi.disabled,s,l,r.id,a,o,t.segments,r.paint,e.transform.zoom,i)}}(e,i,r,n);break;case"heatmap":!function(e,i,r,n){if(0!==r.paint.get("heatmap-opacity"))if("offscreen"===e.renderPass){const a=e.context,o=a.gl,s=Ii.disabled,l=new Ai([o.ONE,o.ONE],t.aT.transparent,[!0,!0,!0,!0]);!function(t,e,i){const r=t.gl;t.activeTexture.set(r.TEXTURE1),t.viewport.set([0,0,e.width/4,e.height/4]);let n=i.heatmapFbo;if(n)r.bindTexture(r.TEXTURE_2D,n.colorAttachment.get()),t.bindFramebuffer.set(n.framebuffer);else{const a=r.createTexture();r.bindTexture(r.TEXTURE_2D,a),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),n=i.heatmapFbo=t.createFramebuffer(e.width/4,e.height/4,!1,!1),function(t,e,i,r){var n,a;const o=t.gl,s=null!==(n=t.HALF_FLOAT)&&void 0!==n?n:o.UNSIGNED_BYTE,l=null!==(a=t.RGBA16F)&&void 0!==a?a:o.RGBA;o.texImage2D(o.TEXTURE_2D,0,l,e.width/4,e.height/4,0,o.RGBA,s,null),r.colorAttachment.set(i)}(t,e,a,n)}}(a,e,r),a.clear({color:t.aT.transparent});for(let t=0;t<n.length;t++){const c=n[t];if(i.hasRenderableParent(c))continue;const h=i.getTile(c),u=h.getBucket(r);if(!u)continue;const d=u.programConfigurations.get(r.id),p=e.useProgram("heatmap",d),{zoom:m}=e.transform;p.draw(a,o.TRIANGLES,Ei.disabled,s,l,zi.disabled,we(c.posMatrix,h,m,r.paint.get("heatmap-intensity")),null,r.id,u.layoutVertexBuffer,u.indexBuffer,u.segments,r.paint,e.transform.zoom,d)}a.viewport.set([0,0,e.width,e.height])}else"translucent"===e.renderPass&&(e.context.setColorMode(e.colorModeForRenderPass()),function(e,i){const r=e.context,n=r.gl,a=i.heatmapFbo;if(!a)return;r.activeTexture.set(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,a.colorAttachment.get()),r.activeTexture.set(n.TEXTURE1);let o=i.colorRampTexture;o||(o=i.colorRampTexture=new v(r,i.colorRamp,n.RGBA)),o.bind(n.LINEAR,n.CLAMP_TO_EDGE),e.useProgram("heatmapTexture").draw(r,n.TRIANGLES,Ei.disabled,Ii.disabled,e.colorModeForRenderPass(),zi.disabled,((e,i,r,n)=>{const a=t.Z();t.aS(a,0,e.width,e.height,0,0,1);const o=e.context.gl;return{u_matrix:a,u_world:[o.drawingBufferWidth,o.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:i.paint.get("heatmap-opacity")}})(e,i),null,i.id,e.viewportBuffer,e.quadTriangleIndexBuffer,e.viewportSegments,i.paint,e.transform.zoom)}(e,r))}(e,i,r,n);break;case"line":!function(e,i,r,n){if("translucent"!==e.renderPass)return;const a=r.paint.get("line-opacity"),o=r.paint.get("line-width");if(0===a.constantOr(1)||0===o.constantOr(1))return;const s=e.depthModeForSublayer(0,Ei.ReadOnly),l=e.colorModeForRenderPass(),c=r.paint.get("line-dasharray"),h=r.paint.get("line-pattern"),u=h.constantOr(1),d=r.paint.get("line-gradient"),p=r.getCrossfadeParameters(),m=u?"linePattern":c?"lineSDF":d?"lineGradient":"line",f=e.context,g=f.gl;let y=!0;for(const a of n){const n=i.getTile(a);if(u&&!n.patternsLoaded())continue;const o=n.getBucket(r);if(!o)continue;const _=o.programConfigurations.get(r.id),b=e.context.program.get(),x=e.useProgram(m,_),w=y||x.program!==b,S=e.style.map.terrain&&e.style.map.terrain.getTerrainData(a),k=h.constantOr(null);if(k&&n.imageAtlas){const t=n.imageAtlas,e=t.patternPositions[k.to.toString()],i=t.patternPositions[k.from.toString()];e&&i&&_.setConstantPatternPositions(e,i)}const C=S?a:null,A=u?Ae(e,n,r,p,C):c?Te(e,n,r,c,p,C):d?Ce(e,n,r,o.lineClipsArray.length,C):ke(e,n,r,C);if(u)f.activeTexture.set(g.TEXTURE0),n.imageAtlasTexture.bind(g.LINEAR,g.CLAMP_TO_EDGE),_.updatePaintBuffers(p);else if(c&&(w||e.lineAtlas.dirty))f.activeTexture.set(g.TEXTURE0),e.lineAtlas.bind(f);else if(d){const n=o.gradients[r.id];let s=n.texture;if(r.gradientVersion!==n.version){let l=256;if(r.stepInterpolant){const r=i.getSource().maxzoom,n=a.canonical.z===r?Math.ceil(1<<e.transform.maxZoom-a.canonical.z):1;l=t.ad(t.aY(o.maxLineLength/t.N*1024*n),256,f.maxTextureSize)}n.gradient=t.aZ({expression:r.gradientExpression(),evaluationKey:"lineProgress",resolution:l,image:n.gradient||void 0,clips:o.lineClipsArray}),n.texture?n.texture.update(n.gradient):n.texture=new v(f,n.gradient,g.RGBA),n.version=r.gradientVersion,s=n.texture}f.activeTexture.set(g.TEXTURE0),s.bind(r.stepInterpolant?g.NEAREST:g.LINEAR,g.CLAMP_TO_EDGE)}x.draw(f,g.TRIANGLES,s,e.stencilModeForClipping(a),l,zi.disabled,A,S,r.id,o.layoutVertexBuffer,o.indexBuffer,o.segments,r.paint,e.transform.zoom,_,o.layoutVertexBuffer2),y=!1}}(e,i,r,n);break;case"fill":!function(e,i,r,n){const a=r.paint.get("fill-color"),o=r.paint.get("fill-opacity");if(0===o.constantOr(1))return;const s=e.colorModeForRenderPass(),l=r.paint.get("fill-pattern"),c=e.opaquePassEnabledForLayer()&&!l.constantOr(1)&&1===a.constantOr(t.aT.transparent).a&&1===o.constantOr(0)?"opaque":"translucent";if(e.renderPass===c){const t=e.depthModeForSublayer(1,"opaque"===e.renderPass?Ei.ReadWrite:Ei.ReadOnly);Ni(e,i,r,n,t,s,!1)}if("translucent"===e.renderPass&&r.paint.get("fill-antialias")){const t=e.depthModeForSublayer(r.getPaintProperty("fill-outline-color")?2:0,Ei.ReadOnly);Ni(e,i,r,n,t,s,!0)}}(e,i,r,n);break;case"fill-extrusion":!function(t,e,i,r){const n=i.paint.get("fill-extrusion-opacity");if(0!==n&&"translucent"===t.renderPass){const a=new Ei(t.context.gl.LEQUAL,Ei.ReadWrite,t.depthRangeFor3D);if(1!==n||i.paint.get("fill-extrusion-pattern").constantOr(1))ji(t,e,i,r,a,Ii.disabled,Ai.disabled),ji(t,e,i,r,a,t.stencilModeFor3D(),t.colorModeForRenderPass());else{const n=t.colorModeForRenderPass();ji(t,e,i,r,a,Ii.disabled,n)}}}(e,i,r,n);break;case"hillshade":!function(t,e,i,r){if("offscreen"!==t.renderPass&&"translucent"!==t.renderPass)return;const n=t.context,a=t.depthModeForSublayer(0,Ei.ReadOnly),o=t.colorModeForRenderPass(),[s,l]="translucent"===t.renderPass?t.stencilConfigForOverlap(r):[{},r];for(const r of l){const n=e.getTile(r);void 0!==n.needsHillshadePrepare&&n.needsHillshadePrepare&&"offscreen"===t.renderPass?Zi(t,n,i,a,Ii.disabled,o):"translucent"===t.renderPass&&Ui(t,r,n,i,a,s[r.overscaledZ],o)}n.viewport.set([0,0,t.width,t.height])}(e,i,r,n);break;case"raster":!function(t,e,i,r){if("translucent"!==t.renderPass)return;if(0===i.paint.get("raster-opacity"))return;if(!r.length)return;const n=t.context,a=n.gl,o=e.getSource(),s=t.useProgram("raster"),l=t.colorModeForRenderPass(),[c,h]=o instanceof $?[{},r]:t.stencilConfigForOverlap(r),u=h[h.length-1].overscaledZ,d=!t.options.moving;for(const r of h){const h=t.depthModeForSublayer(r.overscaledZ-u,1===i.paint.get("raster-opacity")?Ei.ReadWrite:Ei.ReadOnly,a.LESS),p=e.getTile(r);p.registerFadeDuration(i.paint.get("raster-fade-duration"));const m=e.findLoadedParent(r,0),f=Hi(p,m,e,i,t.transform,t.style.map.terrain);let g,y;const _="nearest"===i.paint.get("raster-resampling")?a.NEAREST:a.LINEAR;n.activeTexture.set(a.TEXTURE0),p.texture.bind(_,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST),n.activeTexture.set(a.TEXTURE1),m?(m.texture.bind(_,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST),g=Math.pow(2,m.tileID.overscaledZ-p.tileID.overscaledZ),y=[p.tileID.canonical.x*g%1,p.tileID.canonical.y*g%1]):p.texture.bind(_,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST);const v=t.style.map.terrain&&t.style.map.terrain.getTerrainData(r),b=v?r:null,x=b?b.posMatrix:t.transform.calculatePosMatrix(r.toUnwrapped(),d),w=Ie(x,y||[0,0],g||1,f,i);o instanceof $?s.draw(n,a.TRIANGLES,h,Ii.disabled,l,zi.disabled,w,v,i.id,o.boundsBuffer,t.quadTriangleIndexBuffer,o.boundsSegments):s.draw(n,a.TRIANGLES,h,c[r.overscaledZ],l,zi.disabled,w,v,i.id,t.rasterBoundsBuffer,t.quadTriangleIndexBuffer,t.rasterBoundsSegments)}}(e,i,r,n);break;case"background":!function(t,e,i,r){const n=i.paint.get("background-color"),a=i.paint.get("background-opacity");if(0===a)return;const o=t.context,s=o.gl,l=t.transform,c=l.tileSize,h=i.paint.get("background-pattern");if(t.isPatternMissing(h))return;const u=!h&&1===n.a&&1===a&&t.opaquePassEnabledForLayer()?"opaque":"translucent";if(t.renderPass!==u)return;const d=Ii.disabled,p=t.depthModeForSublayer(0,"opaque"===u?Ei.ReadWrite:Ei.ReadOnly),m=t.colorModeForRenderPass(),f=t.useProgram(h?"backgroundPattern":"background"),g=r||l.coveringTiles({tileSize:c,terrain:t.style.map.terrain});h&&(o.activeTexture.set(s.TEXTURE0),t.imageManager.bind(t.context));const y=i.getCrossfadeParameters();for(const e of g){const l=r?e.posMatrix:t.transform.calculatePosMatrix(e.toUnwrapped()),u=h?Be(l,a,t,h,{tileID:e,tileSize:c},y):Re(l,a,n),g=t.style.map.terrain&&t.style.map.terrain.getTerrainData(e);f.draw(o,s.TRIANGLES,p,d,m,zi.disabled,u,g,i.id,t.tileExtentBuffer,t.quadTriangleIndexBuffer,t.tileExtentSegments)}}(e,0,r,n);break;case"custom":!function(t,e,i){const r=t.context,n=i.implementation;if("offscreen"===t.renderPass){const e=n.prerender;e&&(t.setCustomLayerDefaults(),r.setColorMode(t.colorModeForRenderPass()),e.call(n,r.gl,t.transform.customLayerMatrix()),r.setDirty(),t.setBaseState())}else if("translucent"===t.renderPass){t.setCustomLayerDefaults(),r.setColorMode(t.colorModeForRenderPass()),r.setStencilMode(Ii.disabled);const e="3d"===n.renderingMode?new Ei(t.context.gl.LEQUAL,Ei.ReadWrite,t.depthRangeFor3D):t.depthModeForSublayer(0,Ei.ReadOnly);r.setDepthMode(e),n.render(r.gl,t.transform.customLayerMatrix()),r.setDirty(),t.setBaseState(),r.bindFramebuffer.set(null)}}(e,0,r)}}translatePosMatrix(e,i,r,n,a){if(!r[0]&&!r[1])return e;const o=a?"map"===n?this.transform.angle:0:"viewport"===n?-this.transform.angle:0;if(o){const t=Math.sin(o),e=Math.cos(o);r=[r[0]*e-r[1]*t,r[0]*t+r[1]*e]}const s=[a?r[0]:At(i,r[0],this.transform.zoom),a?r[1]:At(i,r[1],this.transform.zoom),0],l=new Float32Array(16);return t.$(l,e,s),l}saveTileTexture(t){const e=this._tileTextures[t.size[0]];e?e.push(t):this._tileTextures[t.size[0]]=[t]}getTileTexture(t){const e=this._tileTextures[t];return e&&e.length>0?e.pop():null}isPatternMissing(t){if(!t)return!1;if(!t.from||!t.to)return!0;const e=this.imageManager.getPattern(t.from.toString()),i=this.imageManager.getPattern(t.to.toString());return!e||!i}useProgram(t,e){this.cache=this.cache||{};const i=t+(e?e.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[i]||(this.cache[i]=new he(this.context,oe[t],e,Fe[t],this._showOverdrawInspector,this.style.map.terrain)),this.cache[i]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new v(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:t,drawingBufferHeight:e}=this.context.gl;return this.width!==t||this.height!==e}}class rr{constructor(t,e){this.points=t,this.planes=e}static fromInvProjectionMatrix(e,i,r){const n=Math.pow(2,r),a=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((r=>{const a=1/(r=t.ag([],r,e))[3]/i*n;return t.b3(r,r,[a,a,1/r[3],a])})),o=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map((t=>{const e=function(t,e){var i=e[0],r=e[1],n=e[2],a=i*i+r*r+n*n;return a>0&&(a=1/Math.sqrt(a)),t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t}([],function(t,e,i){var r=e[0],n=e[1],a=e[2],o=i[0],s=i[1],l=i[2];return t[0]=n*l-a*s,t[1]=a*o-r*l,t[2]=r*s-n*o,t}([],f([],a[t[0]],a[t[1]]),f([],a[t[2]],a[t[1]]))),i=-((r=e)[0]*(n=a[t[1]])[0]+r[1]*n[1]+r[2]*n[2]);var r,n;return e.concat(i)}));return new rr(a,o)}}class nr{constructor(t,e){this.min=t,this.max=e,this.center=function(t,e,i){return t[0]=.5*e[0],t[1]=.5*e[1],t[2]=.5*e[2],t}([],function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t}([],this.min,this.max))}quadrant(t){const e=[t%2==0,t<2],i=p(this.min),r=p(this.max);for(let t=0;t<e.length;t++)i[t]=e[t]?this.min[t]:this.center[t],r[t]=e[t]?this.center[t]:this.max[t];return r[2]=this.max[2],new nr(i,r)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}intersects(e){const i=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let r=!0;for(let n=0;n<e.planes.length;n++){const a=e.planes[n];let o=0;for(let e=0;e<i.length;e++)t.b4(a,i[e])>=0&&o++;if(0===o)return 0;o!==i.length&&(r=!1)}if(r)return 2;for(let t=0;t<3;t++){let i=Number.MAX_VALUE,r=-Number.MAX_VALUE;for(let n=0;n<e.points.length;n++){const a=e.points[n][t]-this.min[t];i=Math.min(i,a),r=Math.max(r,a)}if(r<0||i>this.max[t]-this.min[t])return 0}return 1}}class ar{constructor(t=0,e=0,i=0,r=0){if(isNaN(t)||t<0||isNaN(e)||e<0||isNaN(i)||i<0||isNaN(r)||r<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=e,this.left=i,this.right=r}interpolate(e,i,r){return null!=i.top&&null!=e.top&&(this.top=t.B.number(e.top,i.top,r)),null!=i.bottom&&null!=e.bottom&&(this.bottom=t.B.number(e.bottom,i.bottom,r)),null!=i.left&&null!=e.left&&(this.left=t.B.number(e.left,i.left,r)),null!=i.right&&null!=e.right&&(this.right=t.B.number(e.right,i.right,r)),this}getCenter(e,i){const r=t.ad((this.left+e-this.right)/2,0,e),n=t.ad((this.top+i-this.bottom)/2,0,i);return new t.P(r,n)}equals(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}clone(){return new ar(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class or{constructor(e,i,r,n,a){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=void 0===a||!!a,this._minZoom=e||0,this._maxZoom=i||22,this._minPitch=null==r?0:r,this._maxPitch=null==n?60:n,this.setMaxBounds(),this.width=0,this.height=0,this._center=new t.L(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new ar,this._posMatrixCache={},this._alignedPosMatrixCache={},this._minEleveationForCurrentTile=0}clone(){const t=new or(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return t.apply(this),t}apply(t){this.tileSize=t.tileSize,this.latRange=t.latRange,this.width=t.width,this.height=t.height,this._center=t._center,this._elevation=t._elevation,this._minEleveationForCurrentTile=t._minEleveationForCurrentTile,this.zoom=t.zoom,this.angle=t.angle,this._fov=t._fov,this._pitch=t._pitch,this._unmodified=t._unmodified,this._edgeInsets=t._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))}get maxZoom(){return this._maxZoom}set maxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))}get minPitch(){return this._minPitch}set minPitch(t){this._minPitch!==t&&(this._minPitch=t,this.pitch=Math.max(this.pitch,t))}get maxPitch(){return this._maxPitch}set maxPitch(t){this._maxPitch!==t&&(this._maxPitch=t,this.pitch=Math.min(this.pitch,t))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(t){void 0===t?t=!0:null===t&&(t=!1),this._renderWorldCopies=t}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new t.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(e){const i=-t.b5(e,-180,180)*Math.PI/180;this.angle!==i&&(this._unmodified=!1,this.angle=i,this._calcMatrices(),this.rotationMatrix=function(){var e=new t.A(4);return t.A!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e}(),function(t,e,i){var r=e[0],n=e[1],a=e[2],o=e[3],s=Math.sin(i),l=Math.cos(i);t[0]=r*l+a*s,t[1]=n*l+o*s,t[2]=r*-s+a*l,t[3]=n*-s+o*l}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(e){const i=t.ad(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==i&&(this._unmodified=!1,this._pitch=i,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=t/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(t){const e=Math.min(Math.max(t,this.minZoom),this.maxZoom);this._zoom!==e&&(this._unmodified=!1,this._zoom=e,this.tileZoom=Math.max(0,Math.floor(e)),this.scale=this.zoomScale(e),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(t){t!==this._elevation&&(this._elevation=t,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(t){return this._edgeInsets.equals(t)}interpolatePadding(t,e,i){this._unmodified=!1,this._edgeInsets.interpolate(t,e,i),this._constrain(),this._calcMatrices()}coveringZoomLevel(t){const e=(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize));return Math.max(0,e)}getVisibleUnwrappedCoordinates(e){const i=[new t.b6(0,e)];if(this._renderWorldCopies){const r=this.pointCoordinate(new t.P(0,0)),n=this.pointCoordinate(new t.P(this.width,0)),a=this.pointCoordinate(new t.P(this.width,this.height)),o=this.pointCoordinate(new t.P(0,this.height)),s=Math.floor(Math.min(r.x,n.x,a.x,o.x)),l=Math.floor(Math.max(r.x,n.x,a.x,o.x)),c=1;for(let r=s-c;r<=l+c;r++)0!==r&&i.push(new t.b6(r,e))}return i}coveringTiles(e){var i,r;let n=this.coveringZoomLevel(e);const a=n;if(void 0!==e.minzoom&&n<e.minzoom)return[];void 0!==e.maxzoom&&n>e.maxzoom&&(n=e.maxzoom);const o=this.pointCoordinate(this.getCameraPoint()),s=t.U.fromLngLat(this.center),l=Math.pow(2,n),c=[l*o.x,l*o.y,0],h=[l*s.x,l*s.y,0],u=rr.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,n);let d=e.minzoom||0;!e.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(d=n);const p=e.terrain?2/Math.min(this.tileSize,e.tileSize)*this.tileSize:3,m=t=>({aabb:new nr([t*l,0,0],[(t+1)*l,l,0]),zoom:0,x:0,y:0,wrap:t,fullyVisible:!1}),f=[],y=[],_=n,v=e.reparseOverscaled?a:n;if(this._renderWorldCopies)for(let t=1;t<=3;t++)f.push(m(-t)),f.push(m(t));for(f.push(m(0));f.length>0;){const n=f.pop(),a=n.x,o=n.y;let s=n.fullyVisible;if(!s){const t=n.aabb.intersects(u);if(0===t)continue;s=2===t}const l=e.terrain?c:h,m=n.aabb.distanceX(l),b=n.aabb.distanceY(l),x=Math.max(Math.abs(m),Math.abs(b));if(n.zoom===_||x>p+(1<<_-n.zoom)-2&&n.zoom>=d){const e=_-n.zoom,i=c[0]-.5-(a<<e),r=c[1]-.5-(o<<e);y.push({tileID:new t.O(n.zoom===_?v:n.zoom,n.wrap,n.zoom,a,o),distanceSq:g([h[0]-.5-a,h[1]-.5-o]),tileDistanceToCamera:Math.sqrt(i*i+r*r)})}else for(let l=0;l<4;l++){const c=(a<<1)+l%2,h=(o<<1)+(l>>1),u=n.zoom+1;let d=n.aabb.quadrant(l);if(e.terrain){const a=new t.O(u,n.wrap,u,c,h),o=e.terrain.getMinMaxElevation(a),s=null!==(i=o.minElevation)&&void 0!==i?i:this.elevation,l=null!==(r=o.maxElevation)&&void 0!==r?r:this.elevation;d=new nr([d.min[0],d.min[1],s],[d.max[0],d.max[1],l])}f.push({aabb:d,zoom:u,x:c,y:h,wrap:n.wrap,fullyVisible:s})}}return y.sort(((t,e)=>t.distanceSq-e.distanceSq)).map((t=>t.tileID))}resize(t,e){this.width=t,this.height=e,this.pixelsToGLUnits=[2/t,-2/e],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(t){return Math.pow(2,t)}scaleZoom(t){return Math.log(t)/Math.LN2}project(e){const i=t.ad(e.lat,-this.maxValidLatitude,this.maxValidLatitude);return new t.P(t.G(e.lng)*this.worldSize,t.H(i)*this.worldSize)}unproject(e){return new t.U(e.x/this.worldSize,e.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(e){const i=this.pointLocation(this.centerPoint,e),r=e.getElevationForLngLatZoom(i,this.tileZoom);if(!(this.elevation-r))return;const n=this.getCameraPosition(),a=t.U.fromLngLat(n.lngLat,n.altitude),o=t.U.fromLngLat(i,r),s=a.x-o.x,l=a.y-o.y,c=a.z-o.z,h=Math.sqrt(s*s+l*l+c*c),u=this.scaleZoom(this.cameraToCenterDistance/h/this.tileSize);this._elevation=r,this._center=i,this.zoom=u}setLocationAtPoint(e,i){const r=this.pointCoordinate(i),n=this.pointCoordinate(this.centerPoint),a=this.locationCoordinate(e),o=new t.U(a.x-(r.x-n.x),a.y-(r.y-n.y));this.center=this.coordinateLocation(o),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(t,e){return e?this.coordinatePoint(this.locationCoordinate(t),e.getElevationForLngLatZoom(t,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(t))}pointLocation(t,e){return this.coordinateLocation(this.pointCoordinate(t,e))}locationCoordinate(e){return t.U.fromLngLat(e)}coordinateLocation(t){return t&&t.toLngLat()}pointCoordinate(e,i){if(i){const t=i.pointCoordinate(e);if(null!=t)return t}const r=[e.x,e.y,0,1],n=[e.x,e.y,1,1];t.ag(r,r,this.pixelMatrixInverse),t.ag(n,n,this.pixelMatrixInverse);const a=r[3],o=n[3],s=r[1]/a,l=n[1]/o,c=r[2]/a,h=n[2]/o,u=c===h?0:(0-c)/(h-c);return new t.U(t.B.number(r[0]/a,n[0]/o,u)/this.worldSize,t.B.number(s,l,u)/this.worldSize)}coordinatePoint(e,i=0,r=this.pixelMatrix){const n=[e.x*this.worldSize,e.y*this.worldSize,i,1];return t.ag(n,n,r),new t.P(n[0]/n[3],n[1]/n[3])}getBounds(){const e=Math.max(0,this.height/2-this.getHorizon());return(new P).extend(this.pointLocation(new t.P(0,e))).extend(this.pointLocation(new t.P(this.width,e))).extend(this.pointLocation(new t.P(this.width,this.height))).extend(this.pointLocation(new t.P(0,this.height)))}getMaxBounds(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new P([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(t){t?(this.lngRange=[t.getWest(),t.getEast()],this.latRange=[t.getSouth(),t.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(e,i=!1){const r=e.key,n=i?this._alignedPosMatrixCache:this._posMatrixCache;if(n[r])return n[r];const a=e.canonical,o=this.worldSize/this.zoomScale(a.z),s=a.x+Math.pow(2,a.z)*e.wrap,l=t.ao(new Float64Array(16));return t.$(l,l,[s*o,a.y*o,0]),t.a0(l,l,[o/t.N,o/t.N,1]),t.a1(l,i?this.alignedProjMatrix:this.projMatrix,l),n[r]=new Float32Array(l),n[r]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let e,i,r,n,a=-90,o=90,s=-180,l=180;const c=this.size,h=this._unmodified;if(this.latRange){const i=this.latRange;a=t.H(i[1])*this.worldSize,o=t.H(i[0])*this.worldSize,e=o-a<c.y?c.y/(o-a):0}if(this.lngRange){const e=this.lngRange;s=t.b5(t.G(e[0])*this.worldSize,0,this.worldSize),l=t.b5(t.G(e[1])*this.worldSize,0,this.worldSize),l<s&&(l+=this.worldSize),i=l-s<c.x?c.x/(l-s):0}const u=this.point,d=Math.max(i||0,e||0);if(d)return this.center=this.unproject(new t.P(i?(l+s)/2:u.x,e?(o+a)/2:u.y)),this.zoom+=this.scaleZoom(d),this._unmodified=h,void(this._constraining=!1);if(this.latRange){const t=u.y,e=c.y/2;t-e<a&&(n=a+e),t+e>o&&(n=o-e)}if(this.lngRange){const e=(s+l)/2,i=t.b5(u.x,e-this.worldSize/2,e+this.worldSize/2),n=c.x/2;i-n<s&&(r=s+n),i+n>l&&(r=l-n)}void 0===r&&void 0===n||(this.center=this.unproject(new t.P(void 0!==r?r:u.x,void 0!==n?n:u.y)).wrap()),this._unmodified=h,this._constraining=!1}_calcMatrices(){if(!this.height)return;const e=this.centerOffset,i=this.point.x,r=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=t.b7(1,this.center.lat)*this.worldSize;let n=t.ao(new Float64Array(16));t.a0(n,n,[this.width/2,-this.height/2,1]),t.$(n,n,[1,-1,0]),this.labelPlaneMatrix=n,n=t.ao(new Float64Array(16)),t.a0(n,n,[1,-1,1]),t.$(n,n,[-1,-1,0]),t.a0(n,n,[2/this.width,2/this.height,1]),this.glCoordMatrix=n;const a=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),o=Math.min(this.elevation,this._minEleveationForCurrentTile),s=a-o*this._pixelPerMeter/Math.cos(this._pitch),l=o<0?s:a,c=Math.PI/2+this._pitch,h=this._fov*(.5+e.y/this.height),u=Math.sin(h)*l/Math.sin(t.ad(Math.PI-c-h,.01,Math.PI-.01)),d=this.getHorizon(),p=2*Math.atan(d/this.cameraToCenterDistance)*(.5+e.y/(2*d)),m=Math.sin(p)*l/Math.sin(t.ad(Math.PI-c-p,.01,Math.PI-.01)),f=Math.min(u,m),g=1.01*(Math.cos(Math.PI/2-this._pitch)*f+l),y=this.height/50;n=new Float64Array(16),t.b8(n,this._fov,this.width/this.height,y,g),n[8]=2*-e.x/this.width,n[9]=2*e.y/this.height,t.a0(n,n,[1,-1,1]),t.$(n,n,[0,0,-this.cameraToCenterDistance]),t.b9(n,n,this._pitch),t.ae(n,n,this.angle),t.$(n,n,[-i,-r,0]),this.mercatorMatrix=t.a0([],n,[this.worldSize,this.worldSize,this.worldSize]),t.a0(n,n,[1,1,this._pixelPerMeter]),this.pixelMatrix=t.a1(new Float64Array(16),this.labelPlaneMatrix,n),t.$(n,n,[0,0,-this.elevation]),this.projMatrix=n,this.invProjMatrix=t.as([],n),this.pixelMatrix3D=t.a1(new Float64Array(16),this.labelPlaneMatrix,n);const _=this.width%2/2,v=this.height%2/2,b=Math.cos(this.angle),x=Math.sin(this.angle),w=i-Math.round(i)+b*_+x*v,S=r-Math.round(r)+b*v+x*_,k=new Float64Array(n);if(t.$(k,k,[w>.5?w-1:w,S>.5?S-1:S,0]),this.alignedProjMatrix=k,n=t.as(new Float64Array(16),this.pixelMatrix),!n)throw new Error("failed to invert matrix");this.pixelMatrixInverse=n,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const e=this.pointCoordinate(new t.P(0,0)),i=[e.x*this.worldSize,e.y*this.worldSize,0,1];return t.ag(i,i,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const e=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new t.P(0,e))}getCameraQueryGeometry(e){const i=this.getCameraPoint();if(1===e.length)return[e[0],i];{let r=i.x,n=i.y,a=i.x,o=i.y;for(const t of e)r=Math.min(r,t.x),n=Math.min(n,t.y),a=Math.max(a,t.x),o=Math.max(o,t.y);return[new t.P(r,n),new t.P(a,n),new t.P(a,o),new t.P(r,o),new t.P(r,n)]}}}function sr(t,e){let i,r=!1,n=null,a=null;const o=()=>{n=null,r&&(t.apply(a,i),n=setTimeout(o,e),r=!1)};return(...t)=>(r=!0,a=this,i=t,n||o(),n)}class lr{constructor(t){this._getCurrentHash=()=>{const t=window.location.hash.replace("#","");if(this._hashName){let e;return t.split("&").map((t=>t.split("="))).forEach((t=>{t[0]===this._hashName&&(e=t)})),(e&&e[1]||"").split("/")}return t.split("/")},this._onHashChange=()=>{const t=this._getCurrentHash();if(t.length>=3&&!t.some((t=>isNaN(t)))){const e=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(t[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+t[2],+t[1]],zoom:+t[0],bearing:e,pitch:+(t[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const t=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,t)}catch(t){}},this._updateHash=sr(this._updateHashUnthrottled,300),this._hashName=t&&encodeURIComponent(t)}addTo(t){return this._map=t,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(t){const e=this._map.getCenter(),i=Math.round(100*this._map.getZoom())/100,r=Math.ceil((i*Math.LN2+Math.log(512/360/.5))/Math.LN10),n=Math.pow(10,r),a=Math.round(e.lng*n)/n,o=Math.round(e.lat*n)/n,s=this._map.getBearing(),l=this._map.getPitch();let c="";if(c+=t?`/${a}/${o}/${i}`:`${i}/${o}/${a}`,(s||l)&&(c+="/"+Math.round(10*s)/10),l&&(c+=`/${Math.round(l)}`),this._hashName){const t=this._hashName;let e=!1;const i=window.location.hash.slice(1).split("&").map((i=>{const r=i.split("=")[0];return r===t?(e=!0,`${r}=${c}`):i})).filter((t=>t));return e||i.push(`${t}=${c}`),`#${i.join("&")}`}return`#${c}`}}const cr={linearity:.3,easing:t.ba(0,0,.3,1)},hr=t.e({deceleration:2500,maxSpeed:1400},cr),ur=t.e({deceleration:20,maxSpeed:1400},cr),dr=t.e({deceleration:1e3,maxSpeed:360},cr),pr=t.e({deceleration:1e3,maxSpeed:90},cr);class mr{constructor(t){this._map=t,this.clear()}clear(){this._inertiaBuffer=[]}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:t.h.now(),settings:e})}_drainInertiaBuffer(){const e=this._inertiaBuffer,i=t.h.now();for(;e.length>0&&i-e[0].time>160;)e.shift()}_onMoveEnd(e){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const i={zoom:0,bearing:0,pitch:0,pan:new t.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:t}of this._inertiaBuffer)i.zoom+=t.zoomDelta||0,i.bearing+=t.bearingDelta||0,i.pitch+=t.pitchDelta||0,t.panDelta&&i.pan._add(t.panDelta),t.around&&(i.around=t.around),t.pinchAround&&(i.pinchAround=t.pinchAround);const r=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,n={};if(i.pan.mag()){const a=gr(i.pan.mag(),r,t.e({},hr,e||{}));n.offset=i.pan.mult(a.amount/i.pan.mag()),n.center=this._map.transform.center,fr(n,a)}if(i.zoom){const t=gr(i.zoom,r,ur);n.zoom=this._map.transform.zoom+t.amount,fr(n,t)}if(i.bearing){const e=gr(i.bearing,r,dr);n.bearing=this._map.transform.bearing+t.ad(e.amount,-179,179),fr(n,e)}if(i.pitch){const t=gr(i.pitch,r,pr);n.pitch=this._map.transform.pitch+t.amount,fr(n,t)}if(n.zoom||n.bearing){const t=void 0===i.pinchAround?i.around:i.pinchAround;n.around=t?this._map.unproject(t):this._map.getCenter()}return this.clear(),t.e(n,{noMoveStart:!0})}}function fr(t,e){(!t.duration||t.duration<e.duration)&&(t.duration=e.duration,t.easing=e.easing)}function gr(e,i,r){const{maxSpeed:n,linearity:a,deceleration:o}=r,s=t.ad(e*a/(i/1e3),-n,n),l=Math.abs(s)/(o*a);return{easing:r.easing,duration:1e3*l,amount:s*(l/2)}}class yr extends t.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,r,n,a={}){const o=i.mousePos(r.getCanvasContainer(),n),s=r.unproject(o);super(e,t.e({point:o,lngLat:s,originalEvent:n},a)),this._defaultPrevented=!1,this.target=r}}class _r extends t.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,r,n){const a="touchend"===e?n.changedTouches:n.touches,o=i.touchPos(r.getCanvasContainer(),a),s=o.map((t=>r.unproject(t))),l=o.reduce(((t,e,i,r)=>t.add(e.div(r.length))),new t.P(0,0));super(e,{points:o,point:l,lngLats:s,lngLat:r.unproject(l),originalEvent:n}),this._defaultPrevented=!1}}class vr extends t.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,e,i){super(t,{originalEvent:i}),this._defaultPrevented=!1}}class br{constructor(t,e){this._map=t,this._clickTolerance=e.clickTolerance}reset(){delete this._mousedownPos}wheel(t){return this._firePreventable(new vr(t.type,this._map,t))}mousedown(t,e){return this._mousedownPos=e,this._firePreventable(new yr(t.type,this._map,t))}mouseup(t){this._map.fire(new yr(t.type,this._map,t))}click(t,e){this._mousedownPos&&this._mousedownPos.dist(e)>=this._clickTolerance||this._map.fire(new yr(t.type,this._map,t))}dblclick(t){return this._firePreventable(new yr(t.type,this._map,t))}mouseover(t){this._map.fire(new yr(t.type,this._map,t))}mouseout(t){this._map.fire(new yr(t.type,this._map,t))}touchstart(t){return this._firePreventable(new _r(t.type,this._map,t))}touchmove(t){this._map.fire(new _r(t.type,this._map,t))}touchend(t){this._map.fire(new _r(t.type,this._map,t))}touchcancel(t){this._map.fire(new _r(t.type,this._map,t))}_firePreventable(t){if(this._map.fire(t),t.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class xr{constructor(t){this._map=t}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(t){this._map.fire(new yr(t.type,this._map,t))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new yr("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(t){this._delayContextMenu?this._contextMenuEvent=t:this._ignoreContextMenu||this._map.fire(new yr(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class wr{constructor(t){this._map=t}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(e){return this.transform.pointLocation(t.P.convert(e),this._map.terrain)}}class Sr{constructor(t,e){this._map=t,this._tr=new wr(t),this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=e.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(t,e){this.isEnabled()&&t.shiftKey&&0===t.button&&(i.disableDrag(),this._startPos=this._lastPos=e,this._active=!0)}mousemoveWindow(t,e){if(!this._active)return;const r=e;if(this._lastPos.equals(r)||!this._box&&r.dist(this._startPos)<this._clickTolerance)return;const n=this._startPos;this._lastPos=r,this._box||(this._box=i.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",t));const a=Math.min(n.x,r.x),o=Math.max(n.x,r.x),s=Math.min(n.y,r.y),l=Math.max(n.y,r.y);i.setTransform(this._box,`translate(${a}px,${s}px)`),this._box.style.width=o-a+"px",this._box.style.height=l-s+"px"}mouseupWindow(e,r){if(!this._active)return;if(0!==e.button)return;const n=this._startPos,a=r;if(this.reset(),i.suppressClick(),n.x!==a.x||n.y!==a.y)return this._map.fire(new t.k("boxzoomend",{originalEvent:e})),{cameraAnimation:t=>t.fitScreenCoordinates(n,a,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",e)}keydown(t){this._active&&27===t.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",t))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(i.remove(this._box),this._box=null),i.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(e,i){return this._map.fire(new t.k(e,{originalEvent:i}))}}function kr(t,e){if(t.length!==e.length)throw new Error(`The number of touches and points are not equal - touches ${t.length}, points ${e.length}`);const i={};for(let r=0;r<t.length;r++)i[t[r].identifier]=e[r];return i}class Cr{constructor(t){this.reset(),this.numTouches=t.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(e,i,r){(this.centroid||r.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=e.timeStamp),r.length===this.numTouches&&(this.centroid=function(e){const i=new t.P(0,0);for(const t of e)i._add(t);return i.div(e.length)}(i),this.touches=kr(r,i)))}touchmove(t,e,i){if(this.aborted||!this.centroid)return;const r=kr(i,e);for(const t in this.touches){const e=r[t];(!e||e.dist(this.touches[t])>30)&&(this.aborted=!0)}}touchend(t,e,i){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),0===i.length){const t=!this.aborted&&this.centroid;if(this.reset(),t)return t}}}class Ar{constructor(t){this.singleTap=new Cr(t),this.numTaps=t.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(t,e,i){this.singleTap.touchstart(t,e,i)}touchmove(t,e,i){this.singleTap.touchmove(t,e,i)}touchend(t,e,i){const r=this.singleTap.touchend(t,e,i);if(r){const e=t.timeStamp-this.lastTime<500,i=!this.lastTap||this.lastTap.dist(r)<30;if(e&&i||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=r,this.count===this.numTaps)return this.reset(),r}}}class Tr{constructor(t){this._tr=new wr(t),this._zoomIn=new Ar({numTouches:1,numTaps:2}),this._zoomOut=new Ar({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(t,e,i){this._zoomIn.touchstart(t,e,i),this._zoomOut.touchstart(t,e,i)}touchmove(t,e,i){this._zoomIn.touchmove(t,e,i),this._zoomOut.touchmove(t,e,i)}touchend(t,e,i){const r=this._zoomIn.touchend(t,e,i),n=this._zoomOut.touchend(t,e,i),a=this._tr;return r?(this._active=!0,t.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:e=>e.easeTo({duration:300,zoom:a.zoom+1,around:a.unproject(r)},{originalEvent:t})}):n?(this._active=!0,t.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:e=>e.easeTo({duration:300,zoom:a.zoom-1,around:a.unproject(n)},{originalEvent:t})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Er{constructor(t){this._enabled=!!t.enable,this._moveStateManager=t.moveStateManager,this._clickTolerance=t.clickTolerance||1,this._moveFunction=t.move,this._activateOnStart=!!t.activateOnStart,t.assignEvents(this),this.reset()}reset(t){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(t)}_move(...t){const e=this._moveFunction(...t);if(e.bearingDelta||e.pitchDelta||e.around||e.panDelta)return this._active=!0,e}dragStart(t,e){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(t)&&(this._moveStateManager.startMove(t),this._lastPoint=e.length?e[0]:e,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(t,e){if(!this.isEnabled())return;const i=this._lastPoint;if(!i)return;if(t.preventDefault(),!this._moveStateManager.isValidMoveEvent(t))return void this.reset(t);const r=e.length?e[0]:e;return!this._moved&&r.dist(i)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=r,this._move(i,r))}dragEnd(t){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(t)&&(this._moved&&i.suppressClick(),this.reset(t))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Mr={0:1,2:2};class Ir{constructor(t){this._correctEvent=t.checkCorrectEvent}startMove(t){const e=i.mouseButton(t);this._eventButton=e}endMove(t){delete this._eventButton}isValidStartEvent(t){return this._correctEvent(t)}isValidMoveEvent(t){return!function(t,e){const i=Mr[e];return void 0===t.buttons||(t.buttons&i)!==i}(t,this._eventButton)}isValidEndEvent(t){return i.mouseButton(t)===this._eventButton}}class zr{constructor(){this._firstTouch=void 0}_isOneFingerTouch(t){return 1===t.targetTouches.length}_isSameTouchEvent(t){return t.targetTouches[0].identifier===this._firstTouch}startMove(t){this._firstTouch=t.targetTouches[0].identifier}endMove(t){delete this._firstTouch}isValidStartEvent(t){return this._isOneFingerTouch(t)}isValidMoveEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}isValidEndEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}}const Pr=t=>{t.mousedown=t.dragStart,t.mousemoveWindow=t.dragMove,t.mouseup=t.dragEnd,t.contextmenu=function(t){t.preventDefault()}},Lr=({enable:t,clickTolerance:e,bearingDegreesPerPixelMoved:r=.8})=>{const n=new Ir({checkCorrectEvent:t=>0===i.mouseButton(t)&&t.ctrlKey||2===i.mouseButton(t)});return new Er({clickTolerance:e,move:(t,e)=>({bearingDelta:(e.x-t.x)*r}),moveStateManager:n,enable:t,assignEvents:Pr})},Dr=({enable:t,clickTolerance:e,pitchDegreesPerPixelMoved:r=-.5})=>{const n=new Ir({checkCorrectEvent:t=>0===i.mouseButton(t)&&t.ctrlKey||2===i.mouseButton(t)});return new Er({clickTolerance:e,move:(t,e)=>({pitchDelta:(e.y-t.y)*r}),moveStateManager:n,enable:t,assignEvents:Pr})};class Rr{constructor(t,e){this._minTouches=t.cooperativeGestures?2:1,this._clickTolerance=t.clickTolerance||1,this._map=e,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new t.P(0,0),setTimeout((()=>{this._cancelCooperativeMessage=!1}),200)}touchstart(t,e,i){return this._calculateTransform(t,e,i)}touchmove(t,e,i){if(this._map._cooperativeGestures&&(2===this._minTouches&&i.length<2&&!this._cancelCooperativeMessage?this._map._onCooperativeGesture(t,!1,i.length):this._cancelCooperativeMessage||(this._cancelCooperativeMessage=!0)),this._active&&!(i.length<this._minTouches))return t.preventDefault(),this._calculateTransform(t,e,i)}touchend(t,e,i){this._calculateTransform(t,e,i),this._active&&i.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(e,i,r){r.length>0&&(this._active=!0);const n=kr(r,i),a=new t.P(0,0),o=new t.P(0,0);let s=0;for(const t in n){const e=n[t],i=this._touches[t];i&&(a._add(e),o._add(e.sub(i)),s++,n[t]=e)}if(this._touches=n,s<this._minTouches||!o.mag())return;const l=o.div(s);return this._sum._add(l),this._sum.mag()<this._clickTolerance?void 0:{around:a.div(s),panDelta:l}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Br{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(t,e,i){this._firstTwoTouches||i.length<2||(this._firstTwoTouches=[i[0].identifier,i[1].identifier],this._start([e[0],e[1]]))}touchmove(t,e,i){if(!this._firstTwoTouches)return;t.preventDefault();const[r,n]=this._firstTwoTouches,a=Fr(i,e,r),o=Fr(i,e,n);if(!a||!o)return;const s=this._aroundCenter?null:a.add(o).div(2);return this._move([a,o],s,t)}touchend(t,e,r){if(!this._firstTwoTouches)return;const[n,a]=this._firstTwoTouches,o=Fr(r,e,n),s=Fr(r,e,a);o&&s||(this._active&&i.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(t){this._enabled=!0,this._aroundCenter=!!t&&"center"===t.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Fr(t,e,i){for(let r=0;r<t.length;r++)if(t[r].identifier===i)return e[r]}function Or(t,e){return Math.log(t/e)/Math.LN2}class $r extends Br{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(t){this._startDistance=this._distance=t[0].dist(t[1])}_move(t,e){const i=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(Or(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Or(this._distance,i),pinchAround:e}}}function Vr(t,e){return 180*t.angleWith(e)/Math.PI}class Nr extends Br{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])}_move(t,e){const i=this._vector;if(this._vector=t[0].sub(t[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Vr(this._vector,i),pinchAround:e}}_isBelowThreshold(t){this._minDiameter=Math.min(this._minDiameter,t.mag());const e=25/(Math.PI*this._minDiameter)*360,i=Vr(t,this._startVector);return Math.abs(i)<e}}function jr(t){return Math.abs(t.y)>Math.abs(t.x)}class Ur extends Br{constructor(t){super(),this._map=t}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(t,e,i){super.touchstart(t,e,i),this._currentTouchCount=i.length}_start(t){this._lastPoints=t,jr(t[0].sub(t[1]))&&(this._valid=!1)}_move(t,e,i){if(this._map._cooperativeGestures&&this._currentTouchCount<3)return;const r=t[0].sub(this._lastPoints[0]),n=t[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(r,n,i.timeStamp),this._valid?(this._lastPoints=t,this._active=!0,{pitchDelta:(r.y+n.y)/2*-.5}):void 0}gestureBeginsVertically(t,e,i){if(void 0!==this._valid)return this._valid;const r=t.mag()>=2,n=e.mag()>=2;if(!r&&!n)return;if(!r||!n)return void 0===this._firstMove&&(this._firstMove=i),i-this._firstMove<100&&void 0;const a=t.y>0==e.y>0;return jr(t)&&jr(e)&&a}}const Zr={panStep:100,bearingStep:15,pitchStep:10};class Hr{constructor(t){this._tr=new wr(t);const e=Zr;this._panStep=e.panStep,this._bearingStep=e.bearingStep,this._pitchStep=e.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(t){if(t.altKey||t.ctrlKey||t.metaKey)return;let e=0,i=0,r=0,n=0,a=0;switch(t.keyCode){case 61:case 107:case 171:case 187:e=1;break;case 189:case 109:case 173:e=-1;break;case 37:t.shiftKey?i=-1:(t.preventDefault(),n=-1);break;case 39:t.shiftKey?i=1:(t.preventDefault(),n=1);break;case 38:t.shiftKey?r=1:(t.preventDefault(),a=-1);break;case 40:t.shiftKey?r=-1:(t.preventDefault(),a=1);break;default:return}return this._rotationDisabled&&(i=0,r=0),{cameraAnimation:o=>{const s=this._tr;o.easeTo({duration:300,easeId:"keyboardHandler",easing:qr,zoom:e?Math.round(s.zoom)+e*(t.shiftKey?2:1):s.zoom,bearing:s.bearing+i*this._bearingStep,pitch:s.pitch+r*this._pitchStep,offset:[-n*this._panStep,-a*this._panStep],center:s.center},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function qr(t){return t*(2-t)}const Gr=4.000244140625;class Wr{constructor(t,e){this._onTimeout=t=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(t)},this._map=t,this._tr=new wr(t),this._el=t.getCanvasContainer(),this._triggerRenderFrame=e,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(t){this._defaultZoomRate=t}setWheelZoomRate(t){this._wheelZoomRate=t}isEnabled(){return!!this._enabled}isActive(){return!!this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!t&&"center"===t.around)}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(e){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!e[this._map._metaKey])return;e.preventDefault()}let i=e.deltaMode===WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY;const r=t.h.now(),n=r-(this._lastWheelEventTime||0);this._lastWheelEventTime=r,0!==i&&i%Gr==0?this._type="wheel":0!==i&&Math.abs(i)<4?this._type="trackpad":n>400?(this._type=null,this._lastValue=i,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(n*i)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,i+=this._lastValue)),e.shiftKey&&i&&(i/=4),this._type&&(this._lastWheelEvent=e,this._delta-=i,this._active||this._start(e)),e.preventDefault()}_start(e){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const r=i.mousePos(this._el,e),n=this._tr;this._around=t.L.convert(this._aroundCenter?n.center:n.unproject(r)),this._aroundPoint=n.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId)return;if(this._frameId=null,!this.isActive())return;const e=this._tr.transform;if(0!==this._delta){const t="wheel"===this._type&&Math.abs(this._delta)>Gr?this._wheelZoomRate:this._defaultZoomRate;let i=2/(1+Math.exp(-Math.abs(this._delta*t)));this._delta<0&&0!==i&&(i=1/i);const r="number"==typeof this._targetZoom?e.zoomScale(this._targetZoom):e.scale;this._targetZoom=Math.min(e.maxZoom,Math.max(e.minZoom,e.scaleZoom(r*i))),"wheel"===this._type&&(this._startZoom=e.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const i="number"==typeof this._targetZoom?this._targetZoom:e.zoom,r=this._startZoom,n=this._easing;let a,o=!1;if("wheel"===this._type&&r&&n){const e=Math.min((t.h.now()-this._lastWheelEventTime)/200,1),s=n(e);a=t.B.number(r,i,s),e<1?this._frameId||(this._frameId=!0):o=!0}else a=i,o=!0;return this._active=!0,o&&(this._active=!1,this._finishTimeout=setTimeout((()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout}),200)),{noInertia:!0,needsRenderFrame:!o,zoomDelta:a-e.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(e){let i=t.bb;if(this._prevEase){const e=this._prevEase,r=(t.h.now()-e.start)/e.duration,n=e.easing(r+.01)-e.easing(r),a=.27/Math.sqrt(n*n+1e-4)*.01,o=Math.sqrt(.0729-a*a);i=t.ba(a,o,.25,1)}return this._prevEase={start:t.h.now(),duration:e,easing:i},i}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Xr{constructor(t,e){this._clickZoom=t,this._tapZoom=e}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Kr{constructor(t){this._tr=new wr(t),this.reset()}reset(){this._active=!1}dblclick(t,e){return t.preventDefault(),{cameraAnimation:i=>{i.easeTo({duration:300,zoom:this._tr.zoom+(t.shiftKey?-1:1),around:this._tr.unproject(e)},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Jr{constructor(){this._tap=new Ar({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(t,e,i){if(!this._swipePoint)if(this._tapTime){const r=e[0],n=t.timeStamp-this._tapTime<500,a=this._tapPoint.dist(r)<30;n&&a?i.length>0&&(this._swipePoint=r,this._swipeTouch=i[0].identifier):this.reset()}else this._tap.touchstart(t,e,i)}touchmove(t,e,i){if(this._tapTime){if(this._swipePoint){if(i[0].identifier!==this._swipeTouch)return;const r=e[0],n=r.y-this._swipePoint.y;return this._swipePoint=r,t.preventDefault(),this._active=!0,{zoomDelta:n/128}}}else this._tap.touchmove(t,e,i)}touchend(t,e,i){if(this._tapTime)this._swipePoint&&0===i.length&&this.reset();else{const r=this._tap.touchend(t,e,i);r&&(this._tapTime=t.timeStamp,this._tapPoint=r)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Yr{constructor(t,e,i){this._el=t,this._mousePan=e,this._touchPan=i}enable(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Qr{constructor(t,e,i){this._pitchWithRotate=t.pitchWithRotate,this._mouseRotate=e,this._mousePitch=i}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class tn{constructor(t,e,i,r){this._el=t,this._touchZoom=e,this._touchRotate=i,this._tapDragZoom=r,this._rotationDisabled=!1,this._enabled=!0}enable(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const en=t=>t.zoom||t.drag||t.pitch||t.rotate;class rn extends t.k{}function nn(t){return t.panDelta&&t.panDelta.mag()||t.zoomDelta||t.bearingDelta||t.pitchDelta}class an{constructor(t,e){this.handleWindowEvent=t=>{this.handleEvent(t,`${t.type}Window`)},this.handleEvent=(t,e)=>{if("blur"===t.type)return void this.stop(!0);this._updatingCamera=!0;const r="renderFrame"===t.type?void 0:t,n={needsRenderFrame:!1},a={},o={},s=t.touches,l=s?this._getMapTouches(s):void 0,c=l?i.touchPos(this._el,l):i.mousePos(this._el,t);for(const{handlerName:i,handler:s,allowed:h}of this._handlers){if(!s.isEnabled())continue;let u;this._blockedByActive(o,h,i)?s.reset():s[e||t.type]&&(u=s[e||t.type](t,c,l),this.mergeHandlerResult(n,a,u,i,r),u&&u.needsRenderFrame&&this._triggerRenderFrame()),(u||s.isActive())&&(o[i]=s)}const h={};for(const t in this._previousActiveHandlers)o[t]||(h[t]=r);this._previousActiveHandlers=o,(Object.keys(h).length||nn(n))&&(this._changes.push([n,a,h]),this._triggerRenderFrame()),(Object.keys(o).length||nn(n))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:u}=n;u&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],u(this._map))},this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new mr(t),this._bearingSnap=e.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(e);const r=this._el;this._listeners=[[r,"touchstart",{passive:!0}],[r,"touchmove",{passive:!1}],[r,"touchend",void 0],[r,"touchcancel",void 0],[r,"mousedown",void 0],[r,"mousemove",void 0],[r,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[r,"mouseover",void 0],[r,"mouseout",void 0],[r,"dblclick",void 0],[r,"click",void 0],[r,"keydown",{capture:!1}],[r,"keyup",void 0],[r,"wheel",{passive:!1}],[r,"contextmenu",void 0],[window,"blur",void 0]];for(const[t,e,r]of this._listeners)i.addEventListener(t,e,t===document?this.handleWindowEvent:this.handleEvent,r)}destroy(){for(const[t,e,r]of this._listeners)i.removeEventListener(t,e,t===document?this.handleWindowEvent:this.handleEvent,r)}_addDefaultHandlers(t){const e=this._map,r=e.getCanvasContainer();this._add("mapEvent",new br(e,t));const n=e.boxZoom=new Sr(e,t);this._add("boxZoom",n),t.interactive&&t.boxZoom&&n.enable();const a=new Tr(e),o=new Kr(e);e.doubleClickZoom=new Xr(o,a),this._add("tapZoom",a),this._add("clickZoom",o),t.interactive&&t.doubleClickZoom&&e.doubleClickZoom.enable();const s=new Jr;this._add("tapDragZoom",s);const l=e.touchPitch=new Ur(e);this._add("touchPitch",l),t.interactive&&t.touchPitch&&e.touchPitch.enable(t.touchPitch);const c=Lr(t),h=Dr(t);e.dragRotate=new Qr(t,c,h),this._add("mouseRotate",c,["mousePitch"]),this._add("mousePitch",h,["mouseRotate"]),t.interactive&&t.dragRotate&&e.dragRotate.enable();const u=(({enable:t,clickTolerance:e})=>{const r=new Ir({checkCorrectEvent:t=>0===i.mouseButton(t)&&!t.ctrlKey});return new Er({clickTolerance:e,move:(t,e)=>({around:e,panDelta:e.sub(t)}),activateOnStart:!0,moveStateManager:r,enable:t,assignEvents:Pr})})(t),d=new Rr(t,e);e.dragPan=new Yr(r,u,d),this._add("mousePan",u),this._add("touchPan",d,["touchZoom","touchRotate"]),t.interactive&&t.dragPan&&e.dragPan.enable(t.dragPan);const p=new Nr,m=new $r;e.touchZoomRotate=new tn(r,m,p,s),this._add("touchRotate",p,["touchPan","touchZoom"]),this._add("touchZoom",m,["touchPan","touchRotate"]),t.interactive&&t.touchZoomRotate&&e.touchZoomRotate.enable(t.touchZoomRotate);const f=e.scrollZoom=new Wr(e,(()=>this._triggerRenderFrame()));this._add("scrollZoom",f,["mousePan"]),t.interactive&&t.scrollZoom&&e.scrollZoom.enable(t.scrollZoom);const g=e.keyboard=new Hr(e);this._add("keyboard",g),t.interactive&&t.keyboard&&e.keyboard.enable(),this._add("blockableMapEvent",new xr(e))}_add(t,e,i){this._handlers.push({handlerName:t,handler:e,allowed:i}),this._handlersById[t]=e}stop(t){if(!this._updatingCamera){for(const{handler:t}of this._handlers)t.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[]}}isActive(){for(const{handler:t}of this._handlers)if(t.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return Boolean(en(this._eventsInProgress))||this.isZooming()}_blockedByActive(t,e,i){for(const r in t)if(r!==i&&(!e||e.indexOf(r)<0))return!0;return!1}_getMapTouches(t){const e=[];for(const i of t)this._el.contains(i.target)&&e.push(i);return e}mergeHandlerResult(e,i,r,n,a){if(!r)return;t.e(e,r);const o={handlerName:n,originalEvent:r.originalEvent||a};void 0!==r.zoomDelta&&(i.zoom=o),void 0!==r.panDelta&&(i.drag=o),void 0!==r.pitchDelta&&(i.pitch=o),void 0!==r.bearingDelta&&(i.rotate=o)}_applyChanges(){const e={},i={},r={};for(const[n,a,o]of this._changes)n.panDelta&&(e.panDelta=(e.panDelta||new t.P(0,0))._add(n.panDelta)),n.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+n.zoomDelta),n.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+n.bearingDelta),n.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+n.pitchDelta),void 0!==n.around&&(e.around=n.around),void 0!==n.pinchAround&&(e.pinchAround=n.pinchAround),n.noInertia&&(e.noInertia=n.noInertia),t.e(i,a),t.e(r,o);this._updateMapTransform(e,i,r),this._changes=[]}_updateMapTransform(t,e,i){const r=this._map,n=r._getTransformForUpdate(),a=r.terrain;if(!(nn(t)||a&&this._terrainMovement))return this._fireEvents(e,i,!0);let{panDelta:o,zoomDelta:s,bearingDelta:l,pitchDelta:c,around:h,pinchAround:u}=t;void 0!==u&&(h=u),r._stop(!0),h=h||r.transform.centerPoint;const d=n.pointLocation(o?h.sub(o):h);l&&(n.bearing+=l),c&&(n.pitch+=c),s&&(n.zoom+=s),a?this._terrainMovement||!e.drag&&!e.zoom?e.drag&&this._terrainMovement?n.center=n.pointLocation(n.centerPoint.sub(o)):n.setLocationAtPoint(d,h):(this._terrainMovement=!0,this._map._elevationFreeze=!0,n.setLocationAtPoint(d,h),this._map.once("moveend",(()=>{this._map._elevationFreeze=!1,this._terrainMovement=!1,n.recalculateZoom(r.terrain)}))):n.setLocationAtPoint(d,h),r._applyUpdatedTransform(n),this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(e,i,!0)}_fireEvents(e,i,r){const n=en(this._eventsInProgress),a=en(e),o={};for(const t in e){const{originalEvent:i}=e[t];this._eventsInProgress[t]||(o[`${t}start`]=i),this._eventsInProgress[t]=e[t]}!n&&a&&this._fireEvent("movestart",a.originalEvent);for(const t in o)this._fireEvent(t,o[t]);a&&this._fireEvent("move",a.originalEvent);for(const t in e){const{originalEvent:i}=e[t];this._fireEvent(t,i)}const s={};let l;for(const t in this._eventsInProgress){const{handlerName:e,originalEvent:r}=this._eventsInProgress[t];this._handlersById[e].isActive()||(delete this._eventsInProgress[t],l=i[e]||r,s[`${t}end`]=l)}for(const t in s)this._fireEvent(t,s[t]);const c=en(this._eventsInProgress);if(r&&(n||a)&&!c){this._updatingCamera=!0;const e=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),i=t=>0!==t&&-this._bearingSnap<t&&t<this._bearingSnap;!e||!e.essential&&t.h.prefersReducedMotion?(this._map.fire(new t.k("moveend",{originalEvent:l})),i(this._map.getBearing())&&this._map.resetNorth()):(i(e.bearing||this._map.getBearing())&&(e.bearing=0),e.freezeElevation=!0,this._map.easeTo(e,{originalEvent:l})),this._updatingCamera=!1}}_fireEvent(e,i){this._map.fire(new t.k(e,i?{originalEvent:i}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((t=>{delete this._frameId,this.handleEvent(new rn("renderFrame",{timeStamp:t})),this._applyChanges()}))}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}class on extends t.E{constructor(e,i){super(),this._renderFrameCallback=()=>{const e=Math.min((t.h.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(e)),e<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=i.bearingSnap,this.on("moveend",(()=>{delete this._requestedCameraState}))}getCenter(){return new t.L(this.transform.center.lng,this.transform.center.lat)}setCenter(t,e){return this.jumpTo({center:t},e)}panBy(e,i,r){return e=t.P.convert(e).mult(-1),this.panTo(this.transform.center,t.e({offset:e},i),r)}panTo(e,i,r){return this.easeTo(t.e({center:e},i),r)}getZoom(){return this.transform.zoom}setZoom(t,e){return this.jumpTo({zoom:t},e),this}zoomTo(e,i,r){return this.easeTo(t.e({zoom:e},i),r)}zoomIn(t,e){return this.zoomTo(this.getZoom()+1,t,e),this}zoomOut(t,e){return this.zoomTo(this.getZoom()-1,t,e),this}getBearing(){return this.transform.bearing}setBearing(t,e){return this.jumpTo({bearing:t},e),this}getPadding(){return this.transform.padding}setPadding(t,e){return this.jumpTo({padding:t},e),this}rotateTo(e,i,r){return this.easeTo(t.e({bearing:e},i),r)}resetNorth(e,i){return this.rotateTo(0,t.e({duration:1e3},e),i),this}resetNorthPitch(e,i){return this.easeTo(t.e({bearing:0,pitch:0,duration:1e3},e),i),this}snapToNorth(t,e){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,e):this}getPitch(){return this.transform.pitch}setPitch(t,e){return this.jumpTo({pitch:t},e),this}cameraForBounds(t,e){t=P.convert(t);const i=e&&e.bearing||0;return this._cameraForBoxAndBearing(t.getNorthWest(),t.getSouthEast(),i,e)}_cameraForBoxAndBearing(e,i,r,n){const a={top:0,bottom:0,right:0,left:0};if("number"==typeof(n=t.e({padding:a,offset:[0,0],maxZoom:this.transform.maxZoom},n)).padding){const t=n.padding;n.padding={top:t,bottom:t,right:t,left:t}}n.padding=t.e(a,n.padding);const o=this.transform,s=o.padding,l=o.project(t.L.convert(e)),c=o.project(t.L.convert(i)),h=l.rotate(-r*Math.PI/180),u=c.rotate(-r*Math.PI/180),d=new t.P(Math.max(h.x,u.x),Math.max(h.y,u.y)),p=new t.P(Math.min(h.x,u.x),Math.min(h.y,u.y)),m=d.sub(p),f=(o.width-(s.left+s.right+n.padding.left+n.padding.right))/m.x,g=(o.height-(s.top+s.bottom+n.padding.top+n.padding.bottom))/m.y;if(g<0||f<0)return void t.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const y=Math.min(o.scaleZoom(o.scale*Math.min(f,g)),n.maxZoom),_=t.P.convert(n.offset),v=new t.P((n.padding.left-n.padding.right)/2,(n.padding.top-n.padding.bottom)/2).rotate(r*Math.PI/180),b=_.add(v).mult(o.scale/o.zoomScale(y));return{center:o.unproject(l.add(c).div(2).sub(b)),zoom:y,bearing:r}}fitBounds(t,e,i){return this._fitInternal(this.cameraForBounds(t,e),e,i)}fitScreenCoordinates(e,i,r,n,a){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(t.P.convert(e)),this.transform.pointLocation(t.P.convert(i)),r,n),n,a)}_fitInternal(e,i,r){return e?(delete(i=t.e(e,i)).padding,i.linear?this.easeTo(i,r):this.flyTo(i,r)):this}jumpTo(e,i){this.stop();const r=this._getTransformForUpdate();let n=!1,a=!1,o=!1;return"zoom"in e&&r.zoom!==+e.zoom&&(n=!0,r.zoom=+e.zoom),void 0!==e.center&&(r.center=t.L.convert(e.center)),"bearing"in e&&r.bearing!==+e.bearing&&(a=!0,r.bearing=+e.bearing),"pitch"in e&&r.pitch!==+e.pitch&&(o=!0,r.pitch=+e.pitch),null==e.padding||r.isPaddingEqual(e.padding)||(r.padding=e.padding),this._applyUpdatedTransform(r),this.fire(new t.k("movestart",i)).fire(new t.k("move",i)),n&&this.fire(new t.k("zoomstart",i)).fire(new t.k("zoom",i)).fire(new t.k("zoomend",i)),a&&this.fire(new t.k("rotatestart",i)).fire(new t.k("rotate",i)).fire(new t.k("rotateend",i)),o&&this.fire(new t.k("pitchstart",i)).fire(new t.k("pitch",i)).fire(new t.k("pitchend",i)),this.fire(new t.k("moveend",i))}calculateCameraOptionsFromTo(e,i,r,n=0){const a=t.U.fromLngLat(e,i),o=t.U.fromLngLat(r,n),s=o.x-a.x,l=o.y-a.y,c=o.z-a.z,h=Math.hypot(s,l,c);if(0===h)throw new Error("Can't calculate camera options with same From and To");const u=Math.hypot(s,l),d=this.transform.scaleZoom(this.transform.cameraToCenterDistance/h/this.transform.tileSize),p=180*Math.atan2(s,-l)/Math.PI;let m=180*Math.acos(u/h)/Math.PI;return m=c<0?90-m:90+m,{center:o.toLngLat(),zoom:d,pitch:m,bearing:p}}easeTo(e,i){this._stop(!1,e.easeId),(!1===(e=t.e({offset:[0,0],duration:500,easing:t.bb},e)).animate||!e.essential&&t.h.prefersReducedMotion)&&(e.duration=0);const r=this._getTransformForUpdate(),n=this.getZoom(),a=this.getBearing(),o=this.getPitch(),s=this.getPadding(),l="zoom"in e?+e.zoom:n,c="bearing"in e?this._normalizeBearing(e.bearing,a):a,h="pitch"in e?+e.pitch:o,u="padding"in e?e.padding:r.padding,d=t.P.convert(e.offset);let p=r.centerPoint.add(d);const m=r.pointLocation(p),f=t.L.convert(e.center||m);this._normalizeCenter(f);const g=r.project(m),y=r.project(f).sub(g),_=r.zoomScale(l-n);let v,b;e.around&&(v=t.L.convert(e.around),b=r.locationPoint(v));const x={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||l!==n,this._rotating=this._rotating||a!==c,this._pitching=this._pitching||h!==o,this._padding=!r.isPaddingEqual(u),this._easeId=e.easeId,this._prepareEase(i,e.noMoveStart,x),this.terrain&&this._prepareElevation(f),this._ease((m=>{if(this._zooming&&(r.zoom=t.B.number(n,l,m)),this._rotating&&(r.bearing=t.B.number(a,c,m)),this._pitching&&(r.pitch=t.B.number(o,h,m)),this._padding&&(r.interpolatePadding(s,u,m),p=r.centerPoint.add(d)),this.terrain&&!e.freezeElevation&&this._updateElevation(m),v)r.setLocationAtPoint(v,b);else{const t=r.zoomScale(r.zoom-n),e=l>n?Math.min(2,_):Math.max(.5,_),i=Math.pow(e,1-m),a=r.unproject(g.add(y.mult(m*i)).mult(t));r.setLocationAtPoint(r.renderWorldCopies?a.wrap():a,p)}this._applyUpdatedTransform(r),this._fireMoveEvents(i)}),(t=>{this.terrain&&this._finalizeElevation(),this._afterEase(i,t)}),e),this}_prepareEase(e,i,r={}){this._moving=!0,i||r.moving||this.fire(new t.k("movestart",e)),this._zooming&&!r.zooming&&this.fire(new t.k("zoomstart",e)),this._rotating&&!r.rotating&&this.fire(new t.k("rotatestart",e)),this._pitching&&!r.pitching&&this.fire(new t.k("pitchstart",e))}_prepareElevation(t){this._elevationCenter=t,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(t,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(e){this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const i=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(e<1&&i!==this._elevationTarget){const t=this._elevationTarget-this._elevationStart;this._elevationStart+=e*(t-(i-(t*e+this._elevationStart))/(1-e)),this._elevationTarget=i}this.transform.elevation=t.B.number(this._elevationStart,this._elevationTarget,e)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(t){if(!this.transformCameraUpdate)return;const e=t.clone(),{center:i,zoom:r,pitch:n,bearing:a,elevation:o}=this.transformCameraUpdate(e);i&&(e.center=i),void 0!==r&&(e.zoom=r),void 0!==n&&(e.pitch=n),void 0!==a&&(e.bearing=a),void 0!==o&&(e.elevation=o),this.transform.apply(e)}_fireMoveEvents(e){this.fire(new t.k("move",e)),this._zooming&&this.fire(new t.k("zoom",e)),this._rotating&&this.fire(new t.k("rotate",e)),this._pitching&&this.fire(new t.k("pitch",e))}_afterEase(e,i){if(this._easeId&&i&&this._easeId===i)return;delete this._easeId;const r=this._zooming,n=this._rotating,a=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,r&&this.fire(new t.k("zoomend",e)),n&&this.fire(new t.k("rotateend",e)),a&&this.fire(new t.k("pitchend",e)),this.fire(new t.k("moveend",e))}flyTo(e,i){if(!e.essential&&t.h.prefersReducedMotion){const r=t.F(e,["center","zoom","bearing","pitch","around"]);return this.jumpTo(r,i)}this.stop(),e=t.e({offset:[0,0],speed:1.2,curve:1.42,easing:t.bb},e);const r=this._getTransformForUpdate(),n=this.getZoom(),a=this.getBearing(),o=this.getPitch(),s=this.getPadding(),l="zoom"in e?t.ad(+e.zoom,r.minZoom,r.maxZoom):n,c="bearing"in e?this._normalizeBearing(e.bearing,a):a,h="pitch"in e?+e.pitch:o,u="padding"in e?e.padding:r.padding,d=r.zoomScale(l-n),p=t.P.convert(e.offset);let m=r.centerPoint.add(p);const f=r.pointLocation(m),g=t.L.convert(e.center||f);this._normalizeCenter(g);const y=r.project(f),_=r.project(g).sub(y);let v=e.curve;const b=Math.max(r.width,r.height),x=b/d,w=_.mag();if("minZoom"in e){const i=t.ad(Math.min(e.minZoom,n,l),r.minZoom,r.maxZoom),a=b/r.zoomScale(i-n);v=Math.sqrt(a/w*2)}const S=v*v;function k(t){const e=(x*x-b*b+(t?-1:1)*S*S*w*w)/(2*(t?x:b)*S*w);return Math.log(Math.sqrt(e*e+1)-e)}function C(t){return(Math.exp(t)-Math.exp(-t))/2}function A(t){return(Math.exp(t)+Math.exp(-t))/2}const T=k(!1);let E=function(t){return A(T)/A(T+v*t)},M=function(t){return b*((A(T)*(C(e=T+v*t)/A(e))-C(T))/S)/w;var e},I=(k(!0)-T)/v;if(Math.abs(w)<1e-6||!isFinite(I)){if(Math.abs(b-x)<1e-6)return this.easeTo(e,i);const t=x<b?-1:1;I=Math.abs(Math.log(x/b))/v,M=function(){return 0},E=function(e){return Math.exp(t*v*e)}}return e.duration="duration"in e?+e.duration:1e3*I/("screenSpeed"in e?+e.screenSpeed/v:+e.speed),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=a!==c,this._pitching=h!==o,this._padding=!r.isPaddingEqual(u),this._prepareEase(i,!1),this.terrain&&this._prepareElevation(g),this._ease((d=>{const f=d*I,v=1/E(f);r.zoom=1===d?l:n+r.scaleZoom(v),this._rotating&&(r.bearing=t.B.number(a,c,d)),this._pitching&&(r.pitch=t.B.number(o,h,d)),this._padding&&(r.interpolatePadding(s,u,d),m=r.centerPoint.add(p)),this.terrain&&!e.freezeElevation&&this._updateElevation(d);const b=1===d?g:r.unproject(y.add(_.mult(M(f))).mult(v));r.setLocationAtPoint(r.renderWorldCopies?b.wrap():b,m),this._applyUpdatedTransform(r),this._fireMoveEvents(i)}),(()=>{this.terrain&&this._finalizeElevation(),this._afterEase(i)}),e),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(t,e){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const t=this._onEaseEnd;delete this._onEaseEnd,t.call(this,e)}if(!t){const t=this.handlers;t&&t.stop(!1)}return this}_ease(e,i,r){!1===r.animate||0===r.duration?(e(1),i()):(this._easeStart=t.h.now(),this._easeOptions=r,this._onEaseFrame=e,this._onEaseEnd=i,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(e,i){e=t.b5(e,-180,180);const r=Math.abs(e-i);return Math.abs(e-360-i)<r&&(e-=360),Math.abs(e+360-i)<r&&(e+=360),e}_normalizeCenter(t){const e=this.transform;if(!e.renderWorldCopies||e.lngRange)return;const i=t.lng-e.center.lng;t.lng+=i>180?-360:i<-180?360:0}queryTerrainElevation(e){return this.terrain?this.terrain.getElevationForLngLatZoom(t.L.convert(e),this.transform.tileZoom)-this.transform.elevation:null}}class sn{constructor(t={}){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=t=>{!t||"metadata"!==t.sourceDataType&&"visibility"!==t.sourceDataType&&"style"!==t.dataType&&"terrain"!==t.type||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?!1===this._compact?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=t}getDefaultPosition(){return"bottom-right"}onAdd(t){return this._map=t,this._compact=this.options&&this.options.compact,this._container=i.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=i.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=i.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){i.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(t,e){const i=this._map._getUIString(`AttributionControl.${e}`);t.title=i,t.setAttribute("aria-label",i)}_updateAttributions(){if(!this._map.style)return;let t=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=t.concat(this.options.customAttribution.map((t=>"string"!=typeof t?"":t))):"string"==typeof this.options.customAttribution&&t.push(this.options.customAttribution)),this._map.style.stylesheet){const t=this._map.style.stylesheet;this.styleOwner=t.owner,this.styleId=t.id}const e=this._map.style.sourceCaches;for(const i in e){const r=e[i];if(r.used||r.usedForTerrain){const e=r.getSource();e.attribution&&t.indexOf(e.attribution)<0&&t.push(e.attribution)}}t=t.filter((t=>String(t).trim())),t.sort(((t,e)=>t.length-e.length)),t=t.filter(((e,i)=>{for(let r=i+1;r<t.length;r++)if(t[r].indexOf(e)>=0)return!1;return!0}));const i=t.join(" | ");i!==this._attribHTML&&(this._attribHTML=i,t.length?(this._innerContainer.innerHTML=i,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class ln{constructor(t={}){this._updateCompact=()=>{const t=this._container.children;if(t.length){const e=t[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?!1!==this._compact&&e.classList.add("maplibregl-compact"):e.classList.remove("maplibregl-compact")}},this.options=t}getDefaultPosition(){return"bottom-left"}onAdd(t){this._map=t,this._compact=this.options&&this.options.compact,this._container=i.create("div","maplibregl-ctrl");const e=i.create("a","maplibregl-ctrl-logo");return e.target="_blank",e.rel="noopener nofollow",e.href="https://maplibre.org/",e.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),e.setAttribute("rel","noopener nofollow"),this._container.appendChild(e),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){i.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class cn{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(t){const e=++this._id;return this._queue.push({callback:t,id:e,cancelled:!1}),e}remove(t){const e=this._currentlyRunning,i=e?this._queue.concat(e):this._queue;for(const e of i)if(e.id===t)return void(e.cancelled=!0)}run(t=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const e=this._currentlyRunning=this._queue;this._queue=[];for(const i of e)if(!i.cancelled&&(i.callback(t),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}const hn={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.enableTerrain":"Enable terrain","TerrainControl.disableTerrain":"Disable terrain"};var un=t.Q([{name:"a_pos3d",type:"Int16",components:3}]);class dn extends t.E{constructor(t){super(),this.sourceCache=t,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,t.usedForTerrain=!0,t.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(e,i){this.sourceCache.update(e,i),this._renderableTilesKeys=[];const r={};for(const n of e.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:i}))r[n.key]=!0,this._renderableTilesKeys.push(n.key),this._tiles[n.key]||(n.posMatrix=new Float64Array(16),t.aS(n.posMatrix,0,t.N,0,t.N,0,1),this._tiles[n.key]=new G(n,this.tileSize));for(const t in this._tiles)r[t]||delete this._tiles[t]}freeRtt(t){for(const e in this._tiles){const i=this._tiles[e];(!t||i.tileID.equals(t)||i.tileID.isChildOf(t)||t.isChildOf(i.tileID))&&(i.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map((t=>this.getTileByID(t)))}getTileByID(t){return this._tiles[t]}getTerrainCoords(e){const i={};for(const r of this._renderableTilesKeys){const n=this._tiles[r].tileID;if(n.canonical.equals(e.canonical)){const n=e.clone();n.posMatrix=new Float64Array(16),t.aS(n.posMatrix,0,t.N,0,t.N,0,1),i[r]=n}else if(n.canonical.isChildOf(e.canonical)){const a=e.clone();a.posMatrix=new Float64Array(16);const o=n.canonical.z-e.canonical.z,s=n.canonical.x-(n.canonical.x>>o<<o),l=n.canonical.y-(n.canonical.y>>o<<o),c=t.N>>o;t.aS(a.posMatrix,0,c,0,c,0,1),t.$(a.posMatrix,a.posMatrix,[-s*c,-l*c,0]),i[r]=a}else if(e.canonical.isChildOf(n.canonical)){const a=e.clone();a.posMatrix=new Float64Array(16);const o=e.canonical.z-n.canonical.z,s=e.canonical.x-(e.canonical.x>>o<<o),l=e.canonical.y-(e.canonical.y>>o<<o),c=t.N>>o;t.aS(a.posMatrix,0,t.N,0,t.N,0,1),t.$(a.posMatrix,a.posMatrix,[s*c,l*c,0]),t.a0(a.posMatrix,a.posMatrix,[1/2**o,1/2**o,0]),i[r]=a}}return i}getSourceTile(t,e){const i=this.sourceCache._source;let r=t.overscaledZ-this.deltaZoom;if(r>i.maxzoom&&(r=i.maxzoom),r<i.minzoom)return null;this._sourceTileCache[t.key]||(this._sourceTileCache[t.key]=t.scaledTo(r).key);let n=this.sourceCache.getTileByID(this._sourceTileCache[t.key]);if((!n||!n.dem)&&e)for(;r>=i.minzoom&&(!n||!n.dem);)n=this.sourceCache.getTileByID(t.scaledTo(r--).key);return n}tilesAfterTime(t=Date.now()){return Object.values(this._tiles).filter((e=>e.timeAdded>=t))}}class pn{constructor(t,e,i){this.painter=t,this.sourceCache=new dn(e),this.options=i,this.exaggeration="number"==typeof i.exaggeration?i.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(e,i,r,n=t.N){var a;if(!(i>=0&&i<n&&r>=0&&r<n))return 0;const o=this.getTerrainData(e),s=null===(a=o.tile)||void 0===a?void 0:a.dem;if(!s)return 0;const l=function(t,e,i){var r=e[0],n=e[1];return t[0]=i[0]*r+i[4]*n+i[12],t[1]=i[1]*r+i[5]*n+i[13],t}([],[i/n*t.N,r/n*t.N],o.u_terrain_matrix),c=[l[0]*s.dim,l[1]*s.dim],h=Math.floor(c[0]),u=Math.floor(c[1]),d=c[0]-h,p=c[1]-u;return s.get(h,u)*(1-d)*(1-p)+s.get(h+1,u)*d*(1-p)+s.get(h,u+1)*(1-d)*p+s.get(h+1,u+1)*d*p}getElevationForLngLatZoom(e,i){const{tileID:r,mercatorX:n,mercatorY:a}=this._getOverscaledTileIDFromLngLatZoom(e,i);return this.getElevation(r,n%t.N,a%t.N,t.N)}getElevation(e,i,r,n=t.N){return this.getDEMElevation(e,i,r,n)*this.exaggeration}getTerrainData(e){if(!this._emptyDemTexture){const e=this.painter.context,i=new t.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new v(e,i,e.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new v(e,new t.R({width:1,height:1}),e.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=t.ao([])}const i=this.sourceCache.getSourceTile(e,!0);if(i&&i.dem&&(!i.demTexture||i.needsTerrainPrepare)){const t=this.painter.context;i.demTexture=this.painter.getTileTexture(i.dem.stride),i.demTexture?i.demTexture.update(i.dem.getPixels(),{premultiply:!1}):i.demTexture=new v(t,i.dem.getPixels(),t.gl.RGBA,{premultiply:!1}),i.demTexture.bind(t.gl.NEAREST,t.gl.CLAMP_TO_EDGE),i.needsTerrainPrepare=!1}const r=i&&i+i.tileID.key+e.key;if(r&&!this._demMatrixCache[r]){const r=this.sourceCache.sourceCache._source.maxzoom;let n=e.canonical.z-i.tileID.canonical.z;e.overscaledZ>e.canonical.z&&(e.canonical.z>=r?n=e.canonical.z-r:t.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const a=e.canonical.x-(e.canonical.x>>n<<n),o=e.canonical.y-(e.canonical.y>>n<<n),s=t.bc(new Float64Array(16),[1/(t.N<<n),1/(t.N<<n),0]);t.$(s,s,[a*t.N,o*t.N,0]),this._demMatrixCache[e.key]={matrix:s,coord:e}}return{u_depth:2,u_terrain:3,u_terrain_dim:i&&i.dem&&i.dem.dim||1,u_terrain_matrix:r?this._demMatrixCache[e.key].matrix:this._emptyDemMatrix,u_terrain_unpack:i&&i.dem&&i.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(i&&i.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:i}}getFramebuffer(t){const e=this.painter,i=e.width/devicePixelRatio,r=e.height/devicePixelRatio;return!this._fbo||this._fbo.width===i&&this._fbo.height===r||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new v(e.context,{width:i,height:r,data:null},e.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(e.context.gl.NEAREST,e.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new v(e.context,{width:i,height:r,data:null},e.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(e.context.gl.NEAREST,e.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=e.context.createFramebuffer(i,r,!0,!1),this._fbo.depthAttachment.set(e.context.createRenderbuffer(e.context.gl.DEPTH_COMPONENT16,i,r))),this._fbo.colorAttachment.set("coords"===t?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const e=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const i=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let t=0,e=0;t<this._coordsTextureSize;t++)for(let r=0;r<this._coordsTextureSize;r++,e+=4)i[e+0]=255&r,i[e+1]=255&t,i[e+2]=r>>8<<4|t>>8,i[e+3]=0;const r=new t.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(i.buffer)),n=new v(e,r,e.gl.RGBA,{premultiply:!1});return n.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),this._coordsTexture=n,n}pointCoordinate(e){const i=new Uint8Array(4),r=this.painter.context,n=r.gl;r.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),n.readPixels(e.x,this.painter.height/devicePixelRatio-e.y-1,1,1,n.RGBA,n.UNSIGNED_BYTE,i),r.bindFramebuffer.set(null);const a=i[0]+(i[2]>>4<<8),o=i[1]+((15&i[2])<<8),s=this.coordsIndex[255-i[3]],l=s&&this.sourceCache.getTileByID(s);if(!l)return null;const c=this._coordsTextureSize,h=(1<<l.tileID.canonical.z)*c;return new t.U(this._allowMercatorOverflow(e,(l.tileID.canonical.x*c+a)/h),(l.tileID.canonical.y*c+o)/h,this.getElevation(l.tileID,a,o,c))}getTerrainMesh(){if(this._mesh)return this._mesh;const e=this.painter.context,i=new t.bd,r=new t.b0,n=this.meshSize,a=t.N/n,o=n*n;for(let t=0;t<=n;t++)for(let e=0;e<=n;e++)i.emplaceBack(e*a,t*a,0);for(let t=0;t<o;t+=n+1)for(let e=0;e<n;e++)r.emplaceBack(e+t,n+e+t+1,n+e+t+2),r.emplaceBack(e+t,n+e+t+2,e+t+1);const s=i.length,l=s+2*(n+1);for(const e of[0,1])for(let r=0;r<=n;r++)for(const n of[0,1])i.emplaceBack(r*a,e*t.N,n);for(let t=0;t<2*n;t+=2)r.emplaceBack(l+t,l+t+1,l+t+3),r.emplaceBack(l+t,l+t+3,l+t+2),r.emplaceBack(s+t,s+t+3,s+t+1),r.emplaceBack(s+t,s+t+2,s+t+3);const c=i.length,h=c+2*(n+1);for(const e of[0,1])for(let r=0;r<=n;r++)for(const n of[0,1])i.emplaceBack(e*t.N,r*a,n);for(let t=0;t<2*n;t+=2)r.emplaceBack(c+t,c+t+1,c+t+3),r.emplaceBack(c+t,c+t+3,c+t+2),r.emplaceBack(h+t,h+t+3,h+t+1),r.emplaceBack(h+t,h+t+2,h+t+3);return this._mesh={indexBuffer:e.createIndexBuffer(r),vertexBuffer:e.createVertexBuffer(i,un.members),segments:t.S.simpleSegment(0,0,i.length,r.length)},this._mesh}getMeshFrameDelta(e){return 2*Math.PI*t.be/Math.pow(2,e)/5}getMinTileElevationForLngLatZoom(t,e){var i;const{tileID:r}=this._getOverscaledTileIDFromLngLatZoom(t,e);return null!==(i=this.getMinMaxElevation(r).minElevation)&&void 0!==i?i:0}getMinMaxElevation(t){const e=this.getTerrainData(t).tile,i={minElevation:null,maxElevation:null};return e&&e.dem&&(i.minElevation=e.dem.min*this.exaggeration,i.maxElevation=e.dem.max*this.exaggeration),i}_getOverscaledTileIDFromLngLatZoom(e,i){const r=t.U.fromLngLat(e.wrap()),n=(1<<i)*t.N,a=r.x*n,o=r.y*n,s=Math.floor(a/t.N),l=Math.floor(o/t.N);return{tileID:new t.O(i,0,i,s,l),mercatorX:a,mercatorY:o}}_allowMercatorOverflow(e,i){const r=e.x<this.painter.width/2;let n=t.bf(i);const a=this.painter.transform.center.lng;return r&&Math.sign(n)>0&&Math.sign(a)<0||!r&&Math.sign(n)<0&&Math.sign(a)>0?(n=360*Math.sign(a)+n,t.G(n)):i}}class mn{constructor(t,e,i){this._context=t,this._size=e,this._tileSize=i,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const t of this._objects)t.texture.destroy(),t.fbo.destroy()}_createObject(t){const e=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),i=new v(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return i.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),e.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),e.colorAttachment.set(i.texture),{id:t,fbo:e,texture:i,stamp:-1,inUse:!1}}getObjectForId(t){return this._objects[t]}useObject(t){t.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter((e=>t.id!==e)),this._recentlyUsed.push(t.id)}stampObject(t){t.stamp=++this._stamp}getOrCreateFreeObject(){for(const t of this._recentlyUsed)if(!this._objects[t].inUse)return this._objects[t];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const t=this._createObject(this._objects.length);return this._objects.push(t),t}freeObject(t){t.inUse=!1}freeAllObjects(){for(const t of this._objects)this.freeObject(t)}isFull(){return!(this._objects.length<this._size)&&!1===this._objects.some((t=>!t.inUse))}}const fn={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class gn{constructor(t,e){this.painter=t,this.terrain=e,this.pool=new mn(t.context,30,e.sourceCache.tileSize*e.qualityFactor)}destruct(){this.pool.destruct()}getTexture(t){return this.pool.getObjectForId(t.rtt[this._stacks.length-1].id).texture}prepareForRender(t,e){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=t._order.filter((i=>!t._layers[i].isHidden(e))),this._coordsDescendingInv={};for(const e in t.sourceCaches){this._coordsDescendingInv[e]={};const i=t.sourceCaches[e].getVisibleCoordinates();for(const t of i){const i=this.terrain.sourceCache.getTerrainCoords(t);for(const t in i)this._coordsDescendingInv[e][t]||(this._coordsDescendingInv[e][t]=[]),this._coordsDescendingInv[e][t].push(i[t])}}this._coordsDescendingInvStr={};for(const e of t._order){const i=t._layers[e],r=i.source;if(fn[i.type]&&!this._coordsDescendingInvStr[r]){this._coordsDescendingInvStr[r]={};for(const t in this._coordsDescendingInv[r])this._coordsDescendingInvStr[r][t]=this._coordsDescendingInv[r][t].map((t=>t.key)).sort().join()}}for(const t of this._renderableTiles)for(const e in this._coordsDescendingInvStr){const i=this._coordsDescendingInvStr[e][t.tileID.key];i&&i!==t.rttCoords[e]&&(t.rtt=[])}}renderLayer(e){if(e.isHidden(this.painter.transform.zoom))return!1;const i=e.type,r=this.painter,n=this._renderableLayerIds[this._renderableLayerIds.length-1]===e.id;if(fn[i]&&(this._prevType&&fn[this._prevType]||this._stacks.push([]),this._prevType=i,this._stacks[this._stacks.length-1].push(e.id),!n))return!0;if(fn[this._prevType]||fn[i]&&n){this._prevType=i;const e=this._stacks.length-1,n=this._stacks[e]||[];for(const i of this._renderableTiles){if(this.pool.isFull()&&(er(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(i),i.rtt[e]){const t=this.pool.getObjectForId(i.rtt[e].id);if(t.stamp===i.rtt[e].stamp){this.pool.useObject(t);continue}}const a=this.pool.getOrCreateFreeObject();this.pool.useObject(a),this.pool.stampObject(a),i.rtt[e]={id:a.id,stamp:a.stamp},r.context.bindFramebuffer.set(a.fbo.framebuffer),r.context.clear({color:t.aT.transparent,stencil:0}),r.currentStencilSource=void 0;for(let t=0;t<n.length;t++){const e=r.style._layers[n[t]],o=e.source?this._coordsDescendingInv[e.source][i.tileID.key]:[i.tileID];r.context.viewport.set([0,0,a.fbo.width,a.fbo.height]),r._renderTileClippingMasks(e,o),r.renderLayer(r,r.style.sourceCaches[e.source],e,o),e.source&&(i.rttCoords[e.source]=this._coordsDescendingInvStr[e.source][i.tileID.key])}}return er(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),fn[i]}return!1}}const yn=e,_n={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:void 0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:t.c.MAX_TILE_CACHE_ZOOM_LEVELS,localIdeographFontFamily:"sans-serif",transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,validateStyle:!0,maxCanvasSize:[4096,4096]},vn=t=>{t.touchstart=t.dragStart,t.touchmoveWindow=t.dragMove,t.touchend=t.dragEnd},bn={showCompass:!0,showZoom:!0,visualizePitch:!1};class xn{constructor(e,r,n=!1){this.mousedown=e=>{this.startMouse(t.e({},e,{ctrlKey:!0,preventDefault:()=>e.preventDefault()}),i.mousePos(this.element,e)),i.addEventListener(window,"mousemove",this.mousemove),i.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=t=>{this.moveMouse(t,i.mousePos(this.element,t))},this.mouseup=t=>{this.mouseRotate.dragEnd(t),this.mousePitch&&this.mousePitch.dragEnd(t),this.offTemp()},this.touchstart=t=>{1!==t.targetTouches.length?this.reset():(this._startPos=this._lastPos=i.touchPos(this.element,t.targetTouches)[0],this.startTouch(t,this._startPos),i.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),i.addEventListener(window,"touchend",this.touchend))},this.touchmove=t=>{1!==t.targetTouches.length?this.reset():(this._lastPos=i.touchPos(this.element,t.targetTouches)[0],this.moveTouch(t,this._lastPos))},this.touchend=t=>{0===t.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const a=e.dragRotate._mouseRotate.getClickTolerance(),o=e.dragRotate._mousePitch.getClickTolerance();this.element=r,this.mouseRotate=Lr({clickTolerance:a,enable:!0}),this.touchRotate=(({enable:t,clickTolerance:e,bearingDegreesPerPixelMoved:i=.8})=>{const r=new zr;return new Er({clickTolerance:e,move:(t,e)=>({bearingDelta:(e.x-t.x)*i}),moveStateManager:r,enable:t,assignEvents:vn})})({clickTolerance:a,enable:!0}),this.map=e,n&&(this.mousePitch=Dr({clickTolerance:o,enable:!0}),this.touchPitch=(({enable:t,clickTolerance:e,pitchDegreesPerPixelMoved:i=-.5})=>{const r=new zr;return new Er({clickTolerance:e,move:(t,e)=>({pitchDelta:(e.y-t.y)*i}),moveStateManager:r,enable:t,assignEvents:vn})})({clickTolerance:o,enable:!0})),i.addEventListener(r,"mousedown",this.mousedown),i.addEventListener(r,"touchstart",this.touchstart,{passive:!1}),i.addEventListener(r,"touchcancel",this.reset)}startMouse(t,e){this.mouseRotate.dragStart(t,e),this.mousePitch&&this.mousePitch.dragStart(t,e),i.disableDrag()}startTouch(t,e){this.touchRotate.dragStart(t,e),this.touchPitch&&this.touchPitch.dragStart(t,e),i.disableDrag()}moveMouse(t,e){const i=this.map,{bearingDelta:r}=this.mouseRotate.dragMove(t,e)||{};if(r&&i.setBearing(i.getBearing()+r),this.mousePitch){const{pitchDelta:r}=this.mousePitch.dragMove(t,e)||{};r&&i.setPitch(i.getPitch()+r)}}moveTouch(t,e){const i=this.map,{bearingDelta:r}=this.touchRotate.dragMove(t,e)||{};if(r&&i.setBearing(i.getBearing()+r),this.touchPitch){const{pitchDelta:r}=this.touchPitch.dragMove(t,e)||{};r&&i.setPitch(i.getPitch()+r)}}off(){const t=this.element;i.removeEventListener(t,"mousedown",this.mousedown),i.removeEventListener(t,"touchstart",this.touchstart,{passive:!1}),i.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),i.removeEventListener(window,"touchend",this.touchend),i.removeEventListener(t,"touchcancel",this.reset),this.offTemp()}offTemp(){i.enableDrag(),i.removeEventListener(window,"mousemove",this.mousemove),i.removeEventListener(window,"mouseup",this.mouseup),i.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),i.removeEventListener(window,"touchend",this.touchend)}}let wn;function Sn(e,i,r){if(e=new t.L(e.lng,e.lat),i){const n=new t.L(e.lng-360,e.lat),a=new t.L(e.lng+360,e.lat),o=r.locationPoint(e).distSqr(i);r.locationPoint(n).distSqr(i)<o?e=n:r.locationPoint(a).distSqr(i)<o&&(e=a)}for(;Math.abs(e.lng-r.center.lng)>180;){const t=r.locationPoint(e);if(t.x>=0&&t.y>=0&&t.x<=r.width&&t.y<=r.height)break;e.lng>r.center.lng?e.lng-=360:e.lng+=360}return e}const kn={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Cn(t,e,i){const r=t.classList;for(const t in kn)r.remove(`maplibregl-${i}-anchor-${t}`);r.add(`maplibregl-${i}-anchor-${e}`)}class An extends t.E{constructor(e){if(super(),this._onKeyPress=t=>{const e=t.code,i=t.charCode||t.keyCode;"Space"!==e&&"Enter"!==e&&32!==i&&13!==i||this.togglePopup()},this._onMapClick=t=>{const e=t.originalEvent.target,i=this._element;this._popup&&(e===i||i.contains(e))&&this.togglePopup()},this._update=t=>{if(!this._map)return;const e=this._map.loaded()&&!this._map.isMoving();("terrain"===(null==t?void 0:t.type)||"render"===(null==t?void 0:t.type)&&!e)&&this._map.once("render",this._update),this._map.transform.renderWorldCopies&&(this._lngLat=Sn(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let r="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?r=`rotateZ(${this._rotation}deg)`:"map"===this._rotationAlignment&&(r=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let n="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?n="rotateX(0deg)":"map"===this._pitchAlignment&&(n=`rotateX(${this._map.getPitch()}deg)`),t&&"moveend"!==t.type||(this._pos=this._pos.round()),i.setTransform(this._element,`${kn[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${n} ${r}`),this._map.terrain&&!this._opacityTimeout&&(this._opacityTimeout=setTimeout((()=>{const t=this._map.unproject(this._pos),e=40075016.686*Math.abs(Math.cos(this._lngLat.lat*Math.PI/180))/Math.pow(2,this._map.transform.tileZoom+8);this._element.style.opacity=t.distanceTo(this._lngLat)>20*e?"0.2":"1.0",this._opacityTimeout=null}),100))},this._onMove=e=>{if(!this._isDragging){const t=this._clickTolerance||this._map._clickTolerance;this._isDragging=e.point.dist(this._pointerdownPos)>=t}this._isDragging&&(this._pos=e.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new t.k("dragstart"))),this.fire(new t.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new t.k("dragend")),this._state="inactive"},this._addDragHandler=t=>{this._element.contains(t.originalEvent.target)&&(t.preventDefault(),this._positionDelta=t.point.sub(this._pos).add(this._offset),this._pointerdownPos=t.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._scale=e&&e.scale||1,this._draggable=e&&e.draggable||!1,this._clickTolerance=e&&e.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&"auto"!==e.pitchAlignment?e.pitchAlignment:this._rotationAlignment,e&&e.element)this._element=e.element,this._offset=t.P.convert(e&&e.offset||[0,0]);else{this._defaultMarker=!0,this._element=i.create("div"),this._element.setAttribute("aria-label","Map marker");const r=i.createNS("http://www.w3.org/2000/svg","svg"),n=41,a=27;r.setAttributeNS(null,"display","block"),r.setAttributeNS(null,"height",`${n}px`),r.setAttributeNS(null,"width",`${a}px`),r.setAttributeNS(null,"viewBox",`0 0 ${a} ${n}`);const o=i.createNS("http://www.w3.org/2000/svg","g");o.setAttributeNS(null,"stroke","none"),o.setAttributeNS(null,"stroke-width","1"),o.setAttributeNS(null,"fill","none"),o.setAttributeNS(null,"fill-rule","evenodd");const s=i.createNS("http://www.w3.org/2000/svg","g");s.setAttributeNS(null,"fill-rule","nonzero");const l=i.createNS("http://www.w3.org/2000/svg","g");l.setAttributeNS(null,"transform","translate(3.0, 29.0)"),l.setAttributeNS(null,"fill","#000000");const c=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const t of c){const e=i.createNS("http://www.w3.org/2000/svg","ellipse");e.setAttributeNS(null,"opacity","0.04"),e.setAttributeNS(null,"cx","10.5"),e.setAttributeNS(null,"cy","5.80029008"),e.setAttributeNS(null,"rx",t.rx),e.setAttributeNS(null,"ry",t.ry),l.appendChild(e)}const h=i.createNS("http://www.w3.org/2000/svg","g");h.setAttributeNS(null,"fill",this._color);const u=i.createNS("http://www.w3.org/2000/svg","path");u.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),h.appendChild(u);const d=i.createNS("http://www.w3.org/2000/svg","g");d.setAttributeNS(null,"opacity","0.25"),d.setAttributeNS(null,"fill","#000000");const p=i.createNS("http://www.w3.org/2000/svg","path");p.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),d.appendChild(p);const m=i.createNS("http://www.w3.org/2000/svg","g");m.setAttributeNS(null,"transform","translate(6.0, 7.0)"),m.setAttributeNS(null,"fill","#FFFFFF");const f=i.createNS("http://www.w3.org/2000/svg","g");f.setAttributeNS(null,"transform","translate(8.0, 8.0)");const g=i.createNS("http://www.w3.org/2000/svg","circle");g.setAttributeNS(null,"fill","#000000"),g.setAttributeNS(null,"opacity","0.25"),g.setAttributeNS(null,"cx","5.5"),g.setAttributeNS(null,"cy","5.5"),g.setAttributeNS(null,"r","5.4999962");const y=i.createNS("http://www.w3.org/2000/svg","circle");y.setAttributeNS(null,"fill","#FFFFFF"),y.setAttributeNS(null,"cx","5.5"),y.setAttributeNS(null,"cy","5.5"),y.setAttributeNS(null,"r","5.4999962"),f.appendChild(g),f.appendChild(y),s.appendChild(l),s.appendChild(h),s.appendChild(d),s.appendChild(m),s.appendChild(f),r.appendChild(s),r.setAttributeNS(null,"height",n*this._scale+"px"),r.setAttributeNS(null,"width",a*this._scale+"px"),this._element.appendChild(r),this._offset=t.P.convert(e&&e.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",(t=>{t.preventDefault()})),this._element.addEventListener("mousedown",(t=>{t.preventDefault()})),Cn(this._element,this._anchor,"marker"),e&&e.className)for(const t of e.className.split(" "))this._element.classList.add(t);this._popup=null}addTo(t){return this.remove(),this._map=t,t.getCanvasContainer().appendChild(this._element),t.on("move",this._update),t.on("moveend",this._update),t.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),i.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=t.L.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){const e=38.1,i=13.5,r=Math.abs(i)/Math.SQRT2;t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-e],"bottom-left":[r,-1*(e-i+r)],"bottom-right":[-r,-1*(e-i+r)],left:[i,-1*(e-i)],right:[-i,-1*(e-i)]}:this._offset}this._popup=t,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}getPopup(){return this._popup}togglePopup(){const t=this._popup;return t?(t.isOpen()?t.remove():t.addTo(this._map),this):this}getOffset(){return this._offset}setOffset(e){return this._offset=t.P.convert(e),this._update(),this}addClassName(t){this._element.classList.add(t)}removeClassName(t){this._element.classList.remove(t)}toggleClassName(t){return this._element.classList.toggle(t)}setDraggable(t){return this._draggable=!!t,this._map&&(t?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(t){return this._rotation=t||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(t){return this._rotationAlignment=t||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(t){return this._pitchAlignment=t&&"auto"!==t?t:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}const Tn={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let En=0,Mn=!1;const In={maxWidth:100,unit:"metric"};function zn(t,e,i){const r=i&&i.maxWidth||100,n=t._container.clientHeight/2,a=t.unproject([0,n]),o=t.unproject([r,n]),s=a.distanceTo(o);if(i&&"imperial"===i.unit){const i=3.2808*s;i>5280?Pn(e,r,i/5280,t._getUIString("ScaleControl.Miles")):Pn(e,r,i,t._getUIString("ScaleControl.Feet"))}else i&&"nautical"===i.unit?Pn(e,r,s/1852,t._getUIString("ScaleControl.NauticalMiles")):s>=1e3?Pn(e,r,s/1e3,t._getUIString("ScaleControl.Kilometers")):Pn(e,r,s,t._getUIString("ScaleControl.Meters"))}function Pn(t,e,i,r){const n=function(t){const e=Math.pow(10,`${Math.floor(t)}`.length-1);let i=t/e;return i=i>=10?10:i>=5?5:i>=3?3:i>=2?2:i>=1?1:function(t){const e=Math.pow(10,Math.ceil(-Math.log(t)/Math.LN10));return Math.round(t*e)/e}(i),e*i}(i);t.style.width=e*(n/i)+"px",t.innerHTML=`${n}&nbsp;${r}`}const Ln={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Dn=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Rn(e){if(e){if("number"==typeof e){const i=Math.round(Math.abs(e)/Math.SQRT2);return{center:new t.P(0,0),top:new t.P(0,e),"top-left":new t.P(i,i),"top-right":new t.P(-i,i),bottom:new t.P(0,-e),"bottom-left":new t.P(i,-i),"bottom-right":new t.P(-i,-i),left:new t.P(e,0),right:new t.P(-e,0)}}if(e instanceof t.P||Array.isArray(e)){const i=t.P.convert(e);return{center:i,top:i,"top-left":i,"top-right":i,bottom:i,"bottom-left":i,"bottom-right":i,left:i,right:i}}return{center:t.P.convert(e.center||[0,0]),top:t.P.convert(e.top||[0,0]),"top-left":t.P.convert(e["top-left"]||[0,0]),"top-right":t.P.convert(e["top-right"]||[0,0]),bottom:t.P.convert(e.bottom||[0,0]),"bottom-left":t.P.convert(e["bottom-left"]||[0,0]),"bottom-right":t.P.convert(e["bottom-right"]||[0,0]),left:t.P.convert(e.left||[0,0]),right:t.P.convert(e.right||[0,0])}}return Rn(new t.P(0,0))}const Bn={extend:(e,...i)=>t.e(e,...i),run(t){t()},logToElement(t,e=!1,i="log"){const r=window.document.getElementById(i);r&&(e&&(r.innerHTML=""),r.innerHTML+=`<br>${t}`)}},Fn=e;class On{static get version(){return Fn}static get workerCount(){return tt.workerCount}static set workerCount(t){tt.workerCount=t}static get maxParallelImageRequests(){return t.c.MAX_PARALLEL_IMAGE_REQUESTS}static set maxParallelImageRequests(e){t.c.MAX_PARALLEL_IMAGE_REQUESTS=e}static get workerUrl(){return t.c.WORKER_URL}static set workerUrl(e){t.c.WORKER_URL=e}static addProtocol(e,i){t.c.REGISTERED_PROTOCOLS[e]=i}static removeProtocol(e){delete t.c.REGISTERED_PROTOCOLS[e]}}return On.Map=class extends on{constructor(e){if(t.bg.mark(t.bh.create),null!=(e=t.e({},_n,e)).minZoom&&null!=e.maxZoom&&e.minZoom>e.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=e.minPitch&&null!=e.maxPitch&&e.minPitch>e.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=e.minPitch&&e.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=e.maxPitch&&e.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new or(e.minZoom,e.maxZoom,e.minPitch,e.maxPitch,e.renderWorldCopies),{bearingSnap:e.bearingSnap}),this._cooperativeGesturesOnWheel=t=>{this._onCooperativeGesture(t,t[this._metaKey],1)},this._contextLost=e=>{e.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new t.k("webglcontextlost",{originalEvent:e}))},this._contextRestored=e=>{this._setupPainter(),this.resize(),this._update(),this.fire(new t.k("webglcontextrestored",{originalEvent:e}))},this._onMapScroll=t=>{if(t.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=e.interactive,this._cooperativeGestures=e.cooperativeGestures,this._metaKey=0===navigator.platform.indexOf("Mac")?"metaKey":"ctrlKey",this._maxTileCacheSize=e.maxTileCacheSize,this._maxTileCacheZoomLevels=e.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=e.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=e.preserveDrawingBuffer,this._antialias=e.antialias,this._trackResize=e.trackResize,this._bearingSnap=e.bearingSnap,this._refreshExpiredTiles=e.refreshExpiredTiles,this._fadeDuration=e.fadeDuration,this._crossSourceCollisions=e.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=e.collectResourceTiming,this._renderTaskQueue=new cn,this._controls=[],this._mapId=t.a2(),this._locale=t.e({},hn,e.locale),this._clickTolerance=e.clickTolerance,this._overridePixelRatio=e.pixelRatio,this._maxCanvasSize=e.maxCanvasSize,this.transformCameraUpdate=e.transformCameraUpdate,this._imageQueueHandle=c.addThrottleControl((()=>this.isMoving())),this._requestManager=new u(e.transformRequest),"string"==typeof e.container){if(this._container=document.getElementById(e.container),!this._container)throw new Error(`Container '${e.container}' not found.`)}else{if(!(e.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=e.container}if(e.maxBounds&&this.setMaxBounds(e.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",(()=>this._update(!1))),this.on("moveend",(()=>this._update(!1))),this.on("zoom",(()=>this._update(!0))),this.on("terrain",(()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)})),this.once("idle",(()=>{this._idleTriggered=!0})),"undefined"!=typeof window){addEventListener("online",this._onWindowOnline,!1);let t=!1;const e=sr((t=>{this._trackResize&&!this._removed&&this.resize(t)._update()}),50);this._resizeObserver=new ResizeObserver((i=>{t?e(i):t=!0})),this._resizeObserver.observe(this._container)}this.handlers=new an(this,e),this._cooperativeGestures&&this._setupCooperativeGestures(),this._hash=e.hash&&new lr("string"==typeof e.hash&&e.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:e.center,zoom:e.zoom,bearing:e.bearing,pitch:e.pitch}),e.bounds&&(this.resize(),this.fitBounds(e.bounds,t.e({},e.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=e.localIdeographFontFamily,this._validateStyle=e.validateStyle,e.style&&this.setStyle(e.style,{localIdeographFontFamily:e.localIdeographFontFamily}),e.attributionControl&&this.addControl(new sn({customAttribution:e.customAttribution})),e.maplibreLogo&&this.addControl(new ln,e.logoPosition),this.on("style.load",(()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)})),this.on("data",(e=>{this._update("style"===e.dataType),this.fire(new t.k(`${e.dataType}data`,e))})),this.on("dataloading",(e=>{this.fire(new t.k(`${e.dataType}dataloading`,e))})),this.on("dataabort",(e=>{this.fire(new t.k("sourcedataabort",e))}))}_getMapId(){return this._mapId}addControl(e,i){if(void 0===i&&(i=e.getDefaultPosition?e.getDefaultPosition():"top-right"),!e||!e.onAdd)return this.fire(new t.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const r=e.onAdd(this);this._controls.push(e);const n=this._controlPositions[i];return-1!==i.indexOf("bottom")?n.insertBefore(r,n.firstChild):n.appendChild(r),this}removeControl(e){if(!e||!e.onRemove)return this.fire(new t.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const i=this._controls.indexOf(e);return i>-1&&this._controls.splice(i,1),e.onRemove(this),this}hasControl(t){return this._controls.indexOf(t)>-1}calculateCameraOptionsFromTo(t,e,i,r){return null==r&&this.terrain&&(r=this.terrain.getElevationForLngLatZoom(i,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(t,e,i,r)}resize(e){var i;const r=this._containerDimensions(),n=r[0],a=r[1],o=this._getClampedPixelRatio(n,a);if(this._resizeCanvas(n,a,o),this.painter.resize(n,a,o),this.painter.overLimit()){const t=this.painter.context.gl;this._maxCanvasSize=[t.drawingBufferWidth,t.drawingBufferHeight];const e=this._getClampedPixelRatio(n,a);this._resizeCanvas(n,a,e),this.painter.resize(n,a,e)}this.transform.resize(n,a),null===(i=this._requestedCameraState)||void 0===i||i.resize(n,a);const s=!this._moving;return s&&(this.stop(),this.fire(new t.k("movestart",e)).fire(new t.k("move",e))),this.fire(new t.k("resize",e)),s&&this.fire(new t.k("moveend",e)),this}_getClampedPixelRatio(t,e){const{0:i,1:r}=this._maxCanvasSize,n=this.getPixelRatio(),a=t*n,o=e*n;return Math.min(a>i?i/a:1,o>r?r/o:1)*n}getPixelRatio(){var t;return null!==(t=this._overridePixelRatio)&&void 0!==t?t:devicePixelRatio}setPixelRatio(t){this._overridePixelRatio=t,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(t){return this.transform.setMaxBounds(P.convert(t)),this._update()}setMinZoom(t){if((t=null==t?-2:t)>=-2&&t<=this.transform.maxZoom)return this.transform.minZoom=t,this._update(),this.getZoom()<t&&this.setZoom(t),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(t){if((t=null==t?22:t)>=this.transform.minZoom)return this.transform.maxZoom=t,this._update(),this.getZoom()>t&&this.setZoom(t),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(t){if((t=null==t?0:t)<0)throw new Error("minPitch must be greater than or equal to 0");if(t>=0&&t<=this.transform.maxPitch)return this.transform.minPitch=t,this._update(),this.getPitch()<t&&this.setPitch(t),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(t){if((t=null==t?60:t)>85)throw new Error("maxPitch must be less than or equal to 85");if(t>=this.transform.minPitch)return this.transform.maxPitch=t,this._update(),this.getPitch()>t&&this.setPitch(t),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(t){return this.transform.renderWorldCopies=t,this._update()}getCooperativeGestures(){return this._cooperativeGestures}setCooperativeGestures(t){return this._cooperativeGestures=t,this._cooperativeGestures?this._setupCooperativeGestures():this._destroyCooperativeGestures(),this}project(e){return this.transform.locationPoint(t.L.convert(e),this.style&&this.terrain)}unproject(e){return this.transform.pointLocation(t.P.convert(e),this.terrain)}isMoving(){var t;return this._moving||(null===(t=this.handlers)||void 0===t?void 0:t.isMoving())}isZooming(){var t;return this._zooming||(null===(t=this.handlers)||void 0===t?void 0:t.isZooming())}isRotating(){var t;return this._rotating||(null===(t=this.handlers)||void 0===t?void 0:t.isRotating())}_createDelegatedListener(t,e,i){if("mouseenter"===t||"mouseover"===t){let r=!1;const n=n=>{const a=this.getLayer(e)?this.queryRenderedFeatures(n.point,{layers:[e]}):[];a.length?r||(r=!0,i.call(this,new yr(t,this,n.originalEvent,{features:a}))):r=!1};return{layer:e,listener:i,delegates:{mousemove:n,mouseout:()=>{r=!1}}}}if("mouseleave"===t||"mouseout"===t){let r=!1;const n=n=>{(this.getLayer(e)?this.queryRenderedFeatures(n.point,{layers:[e]}):[]).length?r=!0:r&&(r=!1,i.call(this,new yr(t,this,n.originalEvent)))},a=e=>{r&&(r=!1,i.call(this,new yr(t,this,e.originalEvent)))};return{layer:e,listener:i,delegates:{mousemove:n,mouseout:a}}}{const r=t=>{const r=this.getLayer(e)?this.queryRenderedFeatures(t.point,{layers:[e]}):[];r.length&&(t.features=r,i.call(this,t),delete t.features)};return{layer:e,listener:i,delegates:{[t]:r}}}}on(t,e,i){if(void 0===i)return super.on(t,e);const r=this._createDelegatedListener(t,e,i);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[t]=this._delegatedListeners[t]||[],this._delegatedListeners[t].push(r);for(const t in r.delegates)this.on(t,r.delegates[t]);return this}once(t,e,i){if(void 0===i)return super.once(t,e);const r=this._createDelegatedListener(t,e,i);for(const t in r.delegates)this.once(t,r.delegates[t]);return this}off(t,e,i){return void 0===i?super.off(t,e):(this._delegatedListeners&&this._delegatedListeners[t]&&(r=>{const n=this._delegatedListeners[t];for(let t=0;t<n.length;t++){const r=n[t];if(r.layer===e&&r.listener===i){for(const t in r.delegates)this.off(t,r.delegates[t]);return n.splice(t,1),this}}})(),this)}queryRenderedFeatures(e,i){if(!this.style)return[];let r;const n=e instanceof t.P||Array.isArray(e),a=n?e:[[0,0],[this.transform.width,this.transform.height]];if(i=i||(n?{}:e)||{},a instanceof t.P||"number"==typeof a[0])r=[t.P.convert(a)];else{const e=t.P.convert(a[0]),i=t.P.convert(a[1]);r=[e,new t.P(i.x,e.y),i,new t.P(e.x,i.y),e]}return this.style.queryRenderedFeatures(r,i,this.transform)}querySourceFeatures(t,e){return this.style.querySourceFeatures(t,e)}setStyle(e,i){return!1!==(i=t.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},i)).diff&&i.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&e?(this._diffStyle(e,i),this):(this._localIdeographFontFamily=i.localIdeographFontFamily,this._updateStyle(e,i))}setTransformRequest(t){return this._requestManager.setTransformRequest(t),this}_getUIString(t){const e=this._locale[t];if(null==e)throw new Error(`Missing UI string '${t}'`);return e}_updateStyle(t,e){if(e.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",(()=>this._updateStyle(t,e)));const i=this.style&&e.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!t)),t?(this.style=new re(this,e||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof t?this.style.loadURL(t,e,i):this.style.loadJSON(t,e,i),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new re(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(e,i){if("string"==typeof e){const r=this._requestManager.transformRequest(e,h.Style);t.f(r,((e,r)=>{e?this.fire(new t.j(e)):r&&this._updateDiff(r,i)}))}else"object"==typeof e&&this._updateDiff(e,i)}_updateDiff(e,i){try{this.style.setState(e,i)&&this._update(!0)}catch(r){t.w(`Unable to perform style diff: ${r.message||r.error||r}.  Rebuilding the style from scratch.`),this._updateStyle(e,i)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():t.w("There is no style added to the map.")}addSource(t,e){return this._lazyInitEmptyStyle(),this.style.addSource(t,e),this._update(!0)}isSourceLoaded(e){const i=this.style&&this.style.sourceCaches[e];if(void 0!==i)return i.loaded();this.fire(new t.j(new Error(`There is no source with ID '${e}'`)))}setTerrain(e){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),e){const i=this.style.sourceCaches[e.source];if(!i)throw new Error(`cannot load terrain, because there exists no source with ID: ${e.source}`);for(const i in this.style._layers){const r=this.style._layers[i];"hillshade"===r.type&&r.source===e.source&&t.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new pn(this.painter,i,e),this.painter.renderToTexture=new gn(this.painter,this.terrain),this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=t=>{"style"===t.dataType?this.terrain.sourceCache.freeRtt():"source"===t.dataType&&t.tile&&(t.sourceId!==e.source||this._elevationFreeze||(this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(t.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform._minEleveationForCurrentTile=0,this.transform.elevation=0;return this.fire(new t.k("terrain",{terrain:e})),this}getTerrain(){var t,e;return null!==(e=null===(t=this.terrain)||void 0===t?void 0:t.options)&&void 0!==e?e:null}areTilesLoaded(){const t=this.style&&this.style.sourceCaches;for(const e in t){const i=t[e]._tiles;for(const t in i){const e=i[t];if("loaded"!==e.state&&"errored"!==e.state)return!1}}return!0}addSourceType(t,e,i){return this._lazyInitEmptyStyle(),this.style.addSourceType(t,e,i)}removeSource(t){return this.style.removeSource(t),this._update(!0)}getSource(t){return this.style.getSource(t)}addImage(e,i,r={}){const{pixelRatio:n=1,sdf:a=!1,stretchX:o,stretchY:s,content:l}=r;if(this._lazyInitEmptyStyle(),!(i instanceof HTMLImageElement||t.a(i))){if(void 0===i.width||void 0===i.height)return this.fire(new t.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:r,height:c,data:h}=i,u=i;return this.style.addImage(e,{data:new t.R({width:r,height:c},new Uint8Array(h)),pixelRatio:n,stretchX:o,stretchY:s,content:l,sdf:a,version:0,userImage:u}),u.onAdd&&u.onAdd(this,e),this}}{const{width:r,height:c,data:h}=t.h.getImageData(i);this.style.addImage(e,{data:new t.R({width:r,height:c},h),pixelRatio:n,stretchX:o,stretchY:s,content:l,sdf:a,version:0})}}updateImage(e,i){const r=this.style.getImage(e);if(!r)return this.fire(new t.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const n=i instanceof HTMLImageElement||t.a(i)?t.h.getImageData(i):i,{width:a,height:o,data:s}=n;if(void 0===a||void 0===o)return this.fire(new t.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(a!==r.data.width||o!==r.data.height)return this.fire(new t.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const l=!(i instanceof HTMLImageElement||t.a(i));return r.data.replace(s,l),this.style.updateImage(e,r),this}getImage(t){return this.style.getImage(t)}hasImage(e){return e?!!this.style.getImage(e):(this.fire(new t.j(new Error("Missing required image id"))),!1)}removeImage(t){this.style.removeImage(t)}loadImage(t,e){c.getImage(this._requestManager.transformRequest(t,h.Image),e)}listImages(){return this.style.listImages()}addLayer(t,e){return this._lazyInitEmptyStyle(),this.style.addLayer(t,e),this._update(!0)}moveLayer(t,e){return this.style.moveLayer(t,e),this._update(!0)}removeLayer(t){return this.style.removeLayer(t),this._update(!0)}getLayer(t){return this.style.getLayer(t)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(t,e,i){return this.style.setLayerZoomRange(t,e,i),this._update(!0)}setFilter(t,e,i={}){return this.style.setFilter(t,e,i),this._update(!0)}getFilter(t){return this.style.getFilter(t)}setPaintProperty(t,e,i,r={}){return this.style.setPaintProperty(t,e,i,r),this._update(!0)}getPaintProperty(t,e){return this.style.getPaintProperty(t,e)}setLayoutProperty(t,e,i,r={}){return this.style.setLayoutProperty(t,e,i,r),this._update(!0)}getLayoutProperty(t,e){return this.style.getLayoutProperty(t,e)}setGlyphs(t,e={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(t,e),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(t,e,i={}){return this._lazyInitEmptyStyle(),this.style.addSprite(t,e,i,(t=>{t||this._update(!0)})),this}removeSprite(t){return this._lazyInitEmptyStyle(),this.style.removeSprite(t),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(t,e={}){return this._lazyInitEmptyStyle(),this.style.setSprite(t,e,(t=>{t||this._update(!0)})),this}setLight(t,e={}){return this._lazyInitEmptyStyle(),this.style.setLight(t,e),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(t,e){return this.style.setFeatureState(t,e),this._update()}removeFeatureState(t,e){return this.style.removeFeatureState(t,e),this._update()}getFeatureState(t){return this.style.getFeatureState(t)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let t=0,e=0;return this._container&&(t=this._container.clientWidth||400,e=this._container.clientHeight||300),[t,e]}_setupContainer(){const t=this._container;t.classList.add("maplibregl-map");const e=this._canvasContainer=i.create("div","maplibregl-canvas-container",t);this._interactive&&e.classList.add("maplibregl-interactive"),this._canvas=i.create("canvas","maplibregl-canvas",e),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const r=this._containerDimensions(),n=this._getClampedPixelRatio(r[0],r[1]);this._resizeCanvas(r[0],r[1],n);const a=this._controlContainer=i.create("div","maplibregl-control-container",t),o=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((t=>{o[t]=i.create("div",`maplibregl-ctrl-${t} `,a)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}_setupCooperativeGestures(){this._cooperativeGesturesScreen=i.create("div","maplibregl-cooperative-gesture-screen",this._container);let t="boolean"!=typeof this._cooperativeGestures&&this._cooperativeGestures.windowsHelpText?this._cooperativeGestures.windowsHelpText:"Use Ctrl + scroll to zoom the map";0===navigator.platform.indexOf("Mac")&&(t="boolean"!=typeof this._cooperativeGestures&&this._cooperativeGestures.macHelpText?this._cooperativeGestures.macHelpText:"Use  + scroll to zoom the map"),this._cooperativeGesturesScreen.innerHTML=`\n            <div class="maplibregl-desktop-message">${t}</div>\n            <div class="maplibregl-mobile-message">${"boolean"!=typeof this._cooperativeGestures&&this._cooperativeGestures.mobileHelpText?this._cooperativeGestures.mobileHelpText:"Use two fingers to move the map"}</div>\n        `,this._cooperativeGesturesScreen.setAttribute("aria-hidden","true"),this._canvasContainer.addEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.add("maplibregl-cooperative-gestures")}_destroyCooperativeGestures(){i.remove(this._cooperativeGesturesScreen),this._canvasContainer.removeEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.remove("maplibregl-cooperative-gestures")}_resizeCanvas(t,e,i){this._canvas.width=Math.floor(i*t),this._canvas.height=Math.floor(i*e),this._canvas.style.width=`${t}px`,this._canvas.style.height=`${e}px`}_setupPainter(){const t={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let e=null;this._canvas.addEventListener("webglcontextcreationerror",(i=>{e={requestedAttributes:t},i&&(e.statusMessage=i.statusMessage,e.type=i.type)}),{once:!0});const i=this._canvas.getContext("webgl2",t)||this._canvas.getContext("webgl",t);if(!i){const t="Failed to initialize WebGL";throw e?(e.message=t,new Error(JSON.stringify(e))):new Error(t)}this.painter=new ir(i,this.transform),r.testSupport(i)}_onCooperativeGesture(t,e,i){return!e&&i<2&&(this._cooperativeGesturesScreen.classList.add("maplibregl-show"),setTimeout((()=>{this._cooperativeGesturesScreen.classList.remove("maplibregl-show")}),100)),!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(t){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||t,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(t){return this._update(),this._renderTaskQueue.add(t)}_cancelRenderFrame(t){this._renderTaskQueue.remove(t)}_render(e){const i=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(e),this._removed)return;let r=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const e=this.transform.zoom,n=t.h.now();this.style.zoomHistory.update(e,n);const a=new t.a8(e,{now:n,fadeDuration:i,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),o=a.crossFadingFactor();1===o&&o===this._crossFadingFactor||(r=!0,this._crossFadingFactor=o),this.style.update(a)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform._minEleveationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,i,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:i,showPadding:this.showPadding}),this.fire(new t.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,t.bg.mark(t.bh.load),this.fire(new t.k("load"))),this.style&&(this.style.hasTransitions()||r)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const n=this._sourcesDirty||this._styleDirty||this._placementDirty;return n||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new t.k("idle")),!this._loaded||this._fullyLoaded||n||(this._fullyLoaded=!0,t.bg.mark(t.bh.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){var e;this._hash&&this._hash.remove();for(const t of this._controls)t.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),"undefined"!=typeof window&&removeEventListener("online",this._onWindowOnline,!1),c.removeThrottleControl(this._imageQueueHandle),null===(e=this._resizeObserver)||void 0===e||e.disconnect();const r=this.painter.context.gl.getExtension("WEBGL_lose_context");r&&r.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),i.remove(this._canvasContainer),i.remove(this._controlContainer),this._cooperativeGestures&&this._destroyCooperativeGestures(),this._container.classList.remove("maplibregl-map"),t.bg.clearMetrics(),this._removed=!0,this.fire(new t.k("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=t.h.frame((e=>{t.bg.frame(e),this._frame=null,this._render(e)})))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(t){this._showTileBoundaries!==t&&(this._showTileBoundaries=t,this._update())}get showPadding(){return!!this._showPadding}set showPadding(t){this._showPadding!==t&&(this._showPadding=t,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(t){this._showCollisionBoxes!==t&&(this._showCollisionBoxes=t,t?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(t){this._showOverdrawInspector!==t&&(this._showOverdrawInspector=t,this._update())}get repaint(){return!!this._repaint}set repaint(t){this._repaint!==t&&(this._repaint=t,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(t){this._vertices=t,this._update()}get version(){return yn}getCameraTargetElevation(){return this.transform.elevation}},On.NavigationControl=class{constructor(e){this._updateZoomButtons=()=>{const t=this._map.getZoom(),e=t===this._map.getMaxZoom(),i=t===this._map.getMinZoom();this._zoomInButton.disabled=e,this._zoomOutButton.disabled=i,this._zoomInButton.setAttribute("aria-disabled",e.toString()),this._zoomOutButton.setAttribute("aria-disabled",i.toString())},this._rotateCompassArrow=()=>{const t=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=t},this._setButtonTitle=(t,e)=>{const i=this._map._getUIString(`NavigationControl.${e}`);t.title=i,t.setAttribute("aria-label",i)},this.options=t.e({},bn,e),this._container=i.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",(t=>t.preventDefault())),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",(t=>this._map.zoomIn({},{originalEvent:t}))),i.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",(t=>this._map.zoomOut({},{originalEvent:t}))),i.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",(t=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:t}):this._map.resetNorth({},{originalEvent:t})})),this._compassIcon=i.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(t){return this._map=t,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new xn(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){i.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(t,e){const r=i.create("button",t,this._container);return r.type="button",r.addEventListener("click",e),r}},On.GeolocateControl=class extends t.E{constructor(e){super(),this._onSuccess=e=>{if(this._map){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new t.k("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(e),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new t.k("geolocate",e)),this._finish()}},this._updateCamera=e=>{const i=new t.L(e.coords.longitude,e.coords.latitude),r=e.coords.accuracy,n=this._map.getBearing(),a=t.e({bearing:n},this.options.fitBoundsOptions),o=P.fromLngLat(i,r);this._map.fitBounds(o,a,{geolocateSource:!0})},this._updateMarker=e=>{if(e){const i=new t.L(e.coords.longitude,e.coords.latitude);this._accuracyCircleMarker.setLngLat(i).addTo(this._map),this._userLocationDotMarker.setLngLat(i).addTo(this._map),this._accuracy=e.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=e=>{if(this._map){if(this.options.trackUserLocation)if(1===e.code){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=t,this._geolocateButton.setAttribute("aria-label",t),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===e.code&&Mn)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new t.k("error",e)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=e=>{if(this._map){if(this._container.addEventListener("contextmenu",(t=>t.preventDefault())),this._geolocateButton=i.create("button","maplibregl-ctrl-geolocate",this._container),i.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===e){t.w("Geolocation support is not available so the GeolocateControl will be disabled.");const e=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=e,this._geolocateButton.setAttribute("aria-label",e)}else{const t=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=t,this._geolocateButton.setAttribute("aria-label",t)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=i.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new An({element:this._dotElement}),this._circleElement=i.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new An({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(e=>{e.geolocateSource||"ACTIVE_LOCK"!==this._watchState||e.originalEvent&&"resize"===e.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new t.k("trackuserlocationend")))}))}},this.options=t.e({},Tn,e)}onAdd(t){return this._map=t,this._container=i.create("div","maplibregl-ctrl maplibregl-ctrl-group"),function(t,e=!1){void 0===wn||e?void 0!==window.navigator.permissions?window.navigator.permissions.query({name:"geolocation"}).then((e=>{wn="denied"!==e.state,t(wn)})).catch((()=>{wn=!!window.navigator.geolocation,t(wn)})):(wn=!!window.navigator.geolocation,t(wn)):t(wn)}(this._setupUI),this._container}onRemove(){void 0!==this._geolocationWatchID&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),i.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,En=0,Mn=!1}_isOutOfMapMaxBounds(t){const e=this._map.getMaxBounds(),i=t.coords;return e&&(i.longitude<e.getWest()||i.longitude>e.getEast()||i.latitude<e.getSouth()||i.latitude>e.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const t=this._map.getBounds(),e=t.getSouthEast(),i=t.getNorthEast(),r=e.distanceTo(i),n=Math.ceil(this._accuracy/(r/this._map._container.clientHeight)*2);this._circleElement.style.width=`${n}px`,this._circleElement.style.height=`${n}px`}trigger(){if(!this._setup)return t.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new t.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":En--,Mn=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new t.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new t.k("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let t;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),En++,En>1?(t={maximumAge:6e5,timeout:0},Mn=!0):(t=this.options.positionOptions,Mn=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,t)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},On.AttributionControl=sn,On.LogoControl=ln,On.ScaleControl=class{constructor(e){this._onMove=()=>{zn(this._map,this._container,this.options)},this.setUnit=t=>{this.options.unit=t,zn(this._map,this._container,this.options)},this.options=t.e({},In,e)}getDefaultPosition(){return"bottom-left"}onAdd(t){return this._map=t,this._container=i.create("div","maplibregl-ctrl maplibregl-ctrl-scale",t.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){i.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},On.FullscreenControl=class extends t.E{constructor(e={}){super(),this._onFullscreenChange=()=>{(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,e&&e.container&&(e.container instanceof HTMLElement?this._container=e.container:t.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(t){return this._map=t,this._container||(this._container=this._map.getContainer()),this._controlContainer=i.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){i.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const t=this._fullscreenButton=i.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);i.create("span","maplibregl-ctrl-icon",t).setAttribute("aria-hidden","true"),t.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const t=this._getTitle();this._fullscreenButton.setAttribute("aria-label",t),this._fullscreenButton.title=t}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new t.k("fullscreenstart")),this._map._cooperativeGestures&&(this._prevCooperativeGestures=this._map._cooperativeGestures,this._map.setCooperativeGestures())):(this.fire(new t.k("fullscreenend")),this._prevCooperativeGestures&&(this._map.setCooperativeGestures(this._prevCooperativeGestures),delete this._prevCooperativeGestures))}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},On.TerrainControl=class{constructor(t){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))},this.options=t}onAdd(t){return this._map=t,this._container=i.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=i.create("button","maplibregl-ctrl-terrain",this._container),i.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){i.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},On.Popup=class extends t.E{constructor(e){super(),this.remove=()=>(this._content&&i.remove(this._content),this._container&&(i.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new t.k("close")),this),this._onMouseUp=t=>{this._update(t.point)},this._onMouseMove=t=>{this._update(t.point)},this._onDrag=t=>{this._update(t.point)},this._update=t=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=i.create("div","maplibregl-popup",this._map.getContainer()),this._tip=i.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const t of this.options.className.split(" "))this._container.classList.add(t);this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Sn(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!t)return;const e=this._pos=this._trackPointer&&t?t:this._map.project(this._lngLat);let r=this.options.anchor;const n=Rn(this.options.offset);if(!r){const t=this._container.offsetWidth,i=this._container.offsetHeight;let a;a=e.y+n.bottom.y<i?["top"]:e.y>this._map.transform.height-i?["bottom"]:[],e.x<t/2?a.push("left"):e.x>this._map.transform.width-t/2&&a.push("right"),r=0===a.length?"bottom":a.join("-")}const a=e.add(n[r]).round();i.setTransform(this._container,`${kn[r]} translate(${a.x}px,${a.y}px)`),Cn(this._container,r,"popup")},this._onClose=()=>{this.remove()},this.options=t.e(Object.create(Ln),e)}addTo(e){return this._map&&this.remove(),this._map=e,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new t.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=t.L.convert(e),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(t){return this.setDOMContent(document.createTextNode(t))}setHTML(t){const e=document.createDocumentFragment(),i=document.createElement("body");let r;for(i.innerHTML=t;r=i.firstChild,r;)e.appendChild(r);return this.setDOMContent(e)}getMaxWidth(){var t;return null===(t=this._container)||void 0===t?void 0:t.style.maxWidth}setMaxWidth(t){return this.options.maxWidth=t,this._update(),this}setDOMContent(t){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=i.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(t),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(t){this._container&&this._container.classList.add(t)}removeClassName(t){this._container&&this._container.classList.remove(t)}setOffset(t){return this.options.offset=t,this._update(),this}toggleClassName(t){if(this._container)return this._container.classList.toggle(t)}_createCloseButton(){this.options.closeButton&&(this._closeButton=i.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const t=this._container.querySelector(Dn);t&&t.focus()}},On.Marker=An,On.Style=re,On.LngLat=t.L,On.LngLatBounds=P,On.Point=t.P,On.MercatorCoordinate=t.U,On.Evented=t.E,On.AJAXError=t.bi,On.config=t.c,On.CanvasSource=N,On.GeoJSONSource=F,On.ImageSource=$,On.RasterDEMTileSource=B,On.RasterTileSource=R,On.VectorTileSource=D,On.VideoSource=V,On.setRTLTextPlugin=t.bj,On.getRTLTextPluginStatus=t.bk,On.prewarm=function(){rt().acquire(Q)},On.clearPrewarmedResources=function(){const t=it;t&&(t.isPreloaded()&&1===t.numActive()?(t.release(Q),it=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},Bn.extend(On,{isSafari:t.ac,getPerformanceMetrics:t.bg.getPerformanceMetrics}),On})),i}()}},r={};function n(t){var e=r[t];if(void 0!==e)return e.exports;var a=r[t]={exports:{}};return i[t].call(a.exports,a,a.exports,n),a.exports}n.m=i,n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.f={},n.e=t=>Promise.all(Object.keys(n.f).reduce(((e,i)=>(n.f[i](t,e),e)),[])),n.u=t=>"chunks/"+t+".js",n.miniCssF=t=>{},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),t={},e="onx-www:",n.l=(i,r,a,o)=>{if(t[i])t[i].push(r);else{var s,l;if(void 0!==a)for(var c=document.getElementsByTagName("script"),h=0;h<c.length;h++){var u=c[h];if(u.getAttribute("src")==i||u.getAttribute("data-webpack")==e+a){s=u;break}}s||(l=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,n.nc&&s.setAttribute("nonce",n.nc),s.setAttribute("data-webpack",e+a),s.src=i),t[i]=[r];var d=(e,r)=>{s.onerror=s.onload=null,clearTimeout(p);var n=t[i];if(delete t[i],s.parentNode&&s.parentNode.removeChild(s),n&&n.forEach((t=>t(r))),e)return e(r)},p=setTimeout(d.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=d.bind(null,s.onerror),s.onload=d.bind(null,s.onload),l&&document.head.appendChild(s)}},n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.p="/dist/",(()=>{var t={8172:0};n.f.j=(e,i)=>{var r=n.o(t,e)?t[e]:void 0;if(0!==r)if(r)i.push(r[2]);else{var a=new Promise(((i,n)=>r=t[e]=[i,n]));i.push(r[2]=a);var o=n.p+n.u(e),s=new Error;n.l(o,(i=>{if(n.o(t,e)&&(0!==(r=t[e])&&(t[e]=void 0),r)){var a=i&&("load"===i.type?"missing":i.type),o=i&&i.target&&i.target.src;s.message="Loading chunk "+e+" failed.\n("+a+": "+o+")",s.name="ChunkLoadError",s.type=a,s.request=o,r[1](s)}}),"chunk-"+e,e)}};var e=(e,i)=>{var r,a,[o,s,l]=i,c=0;if(o.some((e=>0!==t[e]))){for(r in s)n.o(s,r)&&(n.m[r]=s[r]);if(l)l(n)}for(e&&e(i);c<o.length;c++)a=o[c],n.o(t,a)&&t[a]&&t[a][0](),t[a]=0},i=globalThis.webpackChunkonx_www=globalThis.webpackChunkonx_www||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))})(),n.nc=void 0,(()=>{"use strict";var t=n(28352);const e=window.React;var i=n.n(e);const r=(t,e)=>{const i=t[e];return i?"function"==typeof i?i():Promise.resolve(i):new Promise(((t,i)=>{("function"==typeof queueMicrotask?queueMicrotask:setTimeout)(i.bind(null,new Error("Unknown variable dynamic import: "+e)))}))},a={"add-circle":"","add-line":"","add-photo":"","add-route":"","add-shape":"","add-to-collection":"","add-waypoint":"",airplane:"",archive:"","arrow-down":"","arrow-up":"",asterisk:"","basemap-2d":"","basemap-3d":"",battery:"","book-closed":"",book:"",bookmark:"",calendar:"","check-circle":"",check:"","chevron-down":"","chevron-left":"","chevron-right":"","chevron-up":"",clock:"",close:"","collapse-full-screen":"",collapse:"",coordinate:"",copy:"","delete-action":"","dirt-bike":"",download:"",edit:"",elevation:"",ellipsis:"","expand-full-screen":"",expand:"",export:"","external-link":"","eye-slash":"",feedback:"","fifty-inch":"",filter:"",home:"",import:"",info:"",lightbulb:"",link:"",location:"",lock:"","map-layers":"","map-move":"",map:"",minus:"",modified:"",onx:"",pin:"",plus:"","point-to-point":"",print:"",profile:"","sixty-inch":"",sort:"",stats:"",suv:"",sync:"",time:"",times:"",track:"","trash-can":"",user:"","view-only":""};async function o(t){if(Object.keys(a).includes(t))return(await r(Object.assign({"./icons/add-circle.svg":()=>n.e(19312).then(n.bind(n,19312)),"./icons/add-line.svg":()=>n.e(73028).then(n.bind(n,73028)),"./icons/add-photo.svg":()=>n.e(57128).then(n.bind(n,57128)),"./icons/add-route.svg":()=>n.e(15808).then(n.bind(n,15808)),"./icons/add-shape.svg":()=>n.e(77188).then(n.bind(n,54808)),"./icons/add-to-collection.svg":()=>n.e(63548).then(n.bind(n,63548)),"./icons/add-waypoint.svg":()=>n.e(4312).then(n.bind(n,4312)),"./icons/airplane.svg":()=>n.e(77632).then(n.bind(n,77632)),"./icons/archive.svg":()=>n.e(7704).then(n.bind(n,7704)),"./icons/arrow-down.svg":()=>n.e(45604).then(n.bind(n,67984)),"./icons/arrow-up.svg":()=>n.e(20092).then(n.bind(n,20092)),"./icons/asterisk.svg":()=>n.e(44776).then(n.bind(n,22396)),"./icons/basemap-2d.svg":()=>n.e(62e3).then(n.bind(n,62e3)),"./icons/basemap-3d.svg":()=>n.e(29512).then(n.bind(n,29512)),"./icons/battery.svg":()=>n.e(75780).then(n.bind(n,75780)),"./icons/book-closed.svg":()=>n.e(79052).then(n.bind(n,79052)),"./icons/book.svg":()=>n.e(54560).then(n.bind(n,54560)),"./icons/bookmark.svg":()=>n.e(99408).then(n.bind(n,99408)),"./icons/calendar.svg":()=>n.e(70971).then(n.bind(n,70971)),"./icons/check-circle.svg":()=>n.e(84712).then(n.bind(n,84712)),"./icons/check.svg":()=>n.e(38580).then(n.bind(n,38580)),"./icons/chevron-down.svg":()=>n.e(16488).then(n.bind(n,16488)),"./icons/chevron-left.svg":()=>n.e(11776).then(n.bind(n,11776)),"./icons/chevron-right.svg":()=>n.e(82168).then(n.bind(n,82168)),"./icons/chevron-up.svg":()=>n.e(66700).then(n.bind(n,66700)),"./icons/clock.svg":()=>n.e(22660).then(n.bind(n,22660)),"./icons/close.svg":()=>n.e(41624).then(n.bind(n,41624)),"./icons/collapse-full-screen.svg":()=>n.e(70128).then(n.bind(n,70128)),"./icons/collapse.svg":()=>n.e(52876).then(n.bind(n,52876)),"./icons/coordinate.svg":()=>n.e(96968).then(n.bind(n,74584)),"./icons/copy.svg":()=>n.e(55136).then(n.bind(n,55136)),"./icons/delete-action.svg":()=>n.e(52100).then(n.bind(n,52100)),"./icons/dirt-bike.svg":()=>n.e(59224).then(n.bind(n,36844)),"./icons/download.svg":()=>n.e(69656).then(n.bind(n,69656)),"./icons/edit.svg":()=>n.e(23920).then(n.bind(n,23920)),"./icons/elevation.svg":()=>n.e(6936).then(n.bind(n,6936)),"./icons/ellipsis.svg":()=>n.e(19716).then(n.bind(n,19716)),"./icons/expand-full-screen.svg":()=>n.e(36160).then(n.bind(n,36160)),"./icons/expand.svg":()=>n.e(68608).then(n.bind(n,68608)),"./icons/export.svg":()=>n.e(14804).then(n.bind(n,37184)),"./icons/external-link.svg":()=>n.e(37064).then(n.bind(n,37064)),"./icons/eye-slash.svg":()=>n.e(83668).then(n.bind(n,83668)),"./icons/feedback.svg":()=>n.e(40555).then(n.bind(n,40555)),"./icons/fifty-inch.svg":()=>n.e(56536).then(n.bind(n,34155)),"./icons/filter.svg":()=>n.e(3308).then(n.bind(n,3308)),"./icons/home.svg":()=>n.e(76444).then(n.bind(n,76444)),"./icons/import.svg":()=>n.e(65448).then(n.bind(n,65448)),"./icons/info.svg":()=>n.e(59840).then(n.bind(n,59840)),"./icons/lightbulb.svg":()=>n.e(91492).then(n.bind(n,91492)),"./icons/link.svg":()=>n.e(60840).then(n.bind(n,60840)),"./icons/location.svg":()=>n.e(50552).then(n.bind(n,50552)),"./icons/lock.svg":()=>n.e(18712).then(n.bind(n,18712)),"./icons/map-layers.svg":()=>n.e(11472).then(n.bind(n,11472)),"./icons/map-move.svg":()=>n.e(17240).then(n.bind(n,17240)),"./icons/map.svg":()=>n.e(49036).then(n.bind(n,49036)),"./icons/minus.svg":()=>n.e(67168).then(n.bind(n,67168)),"./icons/modified.svg":()=>n.e(74408).then(n.bind(n,74408)),"./icons/onx.svg":()=>n.e(93720).then(n.bind(n,93720)),"./icons/pin.svg":()=>n.e(35208).then(n.bind(n,12828)),"./icons/plus.svg":()=>n.e(82140).then(n.bind(n,82140)),"./icons/point-to-point.svg":()=>n.e(50016).then(n.bind(n,50016)),"./icons/print.svg":()=>n.e(10544).then(n.bind(n,10544)),"./icons/profile.svg":()=>n.e(7080).then(n.bind(n,7080)),"./icons/sixty-inch.svg":()=>n.e(57896).then(n.bind(n,57896)),"./icons/sort.svg":()=>n.e(85036).then(n.bind(n,85036)),"./icons/stats.svg":()=>n.e(59376).then(n.bind(n,59376)),"./icons/suv.svg":()=>n.e(46324).then(n.bind(n,46324)),"./icons/sync.svg":()=>n.e(43272).then(n.bind(n,43272)),"./icons/time.svg":()=>n.e(25988).then(n.bind(n,25988)),"./icons/times.svg":()=>n.e(1664).then(n.bind(n,1664)),"./icons/track.svg":()=>n.e(82552).then(n.bind(n,82552)),"./icons/trash-can.svg":()=>n.e(28572).then(n.bind(n,28572)),"./icons/user.svg":()=>n.e(80216).then(n.bind(n,80216)),"./icons/view-only.svg":()=>n.e(35084).then(n.bind(n,35084))}),`./icons/${String(t)}.svg`)).default}var s=n(62168),l=n(21072),c=n.n(l);const h=function(t){function e(t,r,l,c,d){for(var p,m,f,g,b,w=0,S=0,k=0,C=0,A=0,P=0,D=f=p=0,B=0,F=0,O=0,$=0,V=l.length,N=V-1,j="",U="",Z="",H="";B<V;){if(m=l.charCodeAt(B),B===N&&0!==S+C+k+w&&(0!==S&&(m=47===S?10:47),C=k=w=0,V++,N++),0===S+C+k+w){if(B===N&&(0<F&&(j=j.replace(u,"")),0<j.trim().length)){switch(m){case 32:case 9:case 59:case 13:case 10:break;default:j+=l.charAt(B)}m=59}switch(m){case 123:for(p=(j=j.trim()).charCodeAt(0),f=1,$=++B;B<V;){switch(m=l.charCodeAt(B)){case 123:f++;break;case 125:f--;break;case 47:switch(m=l.charCodeAt(B+1)){case 42:case 47:t:{for(D=B+1;D<N;++D)switch(l.charCodeAt(D)){case 47:if(42===m&&42===l.charCodeAt(D-1)&&B+2!==D){B=D+1;break t}break;case 10:if(47===m){B=D+1;break t}}B=D}}break;case 91:m++;case 40:m++;case 34:case 39:for(;B++<N&&l.charCodeAt(B)!==m;);}if(0===f)break;B++}if(f=l.substring($,B),0===p&&(p=(j=j.replace(h,"").trim()).charCodeAt(0)),64===p){switch(0<F&&(j=j.replace(u,"")),m=j.charCodeAt(1)){case 100:case 109:case 115:case 45:F=r;break;default:F=z}if($=(f=e(r,F,f,m,d+1)).length,0<L&&(b=s(3,f,F=i(z,j,O),r,E,T,$,m,d,c),j=F.join(""),void 0!==b&&0===($=(f=b.trim()).length)&&(m=0,f="")),0<$)switch(m){case 115:j=j.replace(x,o);case 100:case 109:case 45:f=j+"{"+f+"}";break;case 107:f=(j=j.replace(y,"$1 $2"))+"{"+f+"}",f=1===I||2===I&&a("@"+f,3)?"@-webkit-"+f+"@"+f:"@"+f;break;default:f=j+f,112===c&&(U+=f,f="")}else f=""}else f=e(r,i(r,j,O),f,c,d+1);Z+=f,f=O=F=D=p=0,j="",m=l.charCodeAt(++B);break;case 125:case 59:if(1<($=(j=(0<F?j.replace(u,""):j).trim()).length))switch(0===D&&(p=j.charCodeAt(0),45===p||96<p&&123>p)&&($=(j=j.replace(" ",":")).length),0<L&&void 0!==(b=s(1,j,r,t,E,T,U.length,c,d,c))&&0===($=(j=b.trim()).length)&&(j="\0\0"),p=j.charCodeAt(0),m=j.charCodeAt(1),p){case 0:break;case 64:if(105===m||99===m){H+=j+l.charAt(B);break}default:58!==j.charCodeAt($-1)&&(U+=n(j,p,m,j.charCodeAt(2)))}O=F=D=p=0,j="",m=l.charCodeAt(++B)}}switch(m){case 13:case 10:47===S?S=0:0===1+p&&107!==c&&0<j.length&&(F=1,j+="\0"),0<L*R&&s(0,j,r,t,E,T,U.length,c,d,c),T=1,E++;break;case 59:case 125:if(0===S+C+k+w){T++;break}default:switch(T++,g=l.charAt(B),m){case 9:case 32:if(0===C+w+S)switch(A){case 44:case 58:case 9:case 32:g="";break;default:32!==m&&(g=" ")}break;case 0:g="\\0";break;case 12:g="\\f";break;case 11:g="\\v";break;case 38:0===C+S+w&&(F=O=1,g="\f"+g);break;case 108:if(0===C+S+w+M&&0<D)switch(B-D){case 2:112===A&&58===l.charCodeAt(B-3)&&(M=A);case 8:111===P&&(M=P)}break;case 58:0===C+S+w&&(D=B);break;case 44:0===S+k+C+w&&(F=1,g+="\r");break;case 34:case 39:0===S&&(C=C===m?0:0===C?m:C);break;case 91:0===C+S+k&&w++;break;case 93:0===C+S+k&&w--;break;case 41:0===C+S+w&&k--;break;case 40:if(0===C+S+w){if(0===p)if(2*A+3*P==533);else p=1;k++}break;case 64:0===S+k+C+w+D+f&&(f=1);break;case 42:case 47:if(!(0<C+w+k))switch(S){case 0:switch(2*m+3*l.charCodeAt(B+1)){case 235:S=47;break;case 220:$=B,S=42}break;case 42:47===m&&42===A&&$+2!==B&&(33===l.charCodeAt($+2)&&(U+=l.substring($,B+1)),g="",S=0)}}0===S&&(j+=g)}P=A,A=m,B++}if(0<($=U.length)){if(F=r,0<L&&(void 0!==(b=s(2,U,F,t,E,T,$,c,d,c))&&0===(U=b).length))return H+U+Z;if(U=F.join(",")+"{"+U+"}",0!=I*M){switch(2!==I||a(U,2)||(M=0),M){case 111:U=U.replace(v,":-moz-$1")+U;break;case 112:U=U.replace(_,"::-webkit-input-$1")+U.replace(_,"::-moz-$1")+U.replace(_,":-ms-input-$1")+U}M=0}}return H+U+Z}function i(t,e,i){var n=e.trim().split(f);e=n;var a=n.length,o=t.length;switch(o){case 0:case 1:var s=0;for(t=0===o?"":t[0]+" ";s<a;++s)e[s]=r(t,e[s],i).trim();break;default:var l=s=0;for(e=[];s<a;++s)for(var c=0;c<o;++c)e[l++]=r(t[c]+" ",n[s],i).trim()}return e}function r(t,e,i){var r=e.charCodeAt(0);switch(33>r&&(r=(e=e.trim()).charCodeAt(0)),r){case 38:return e.replace(g,"$1"+t.trim());case 58:return t.trim()+e.replace(g,"$1"+t.trim());default:if(0<1*i&&0<e.indexOf("\f"))return e.replace(g,(58===t.charCodeAt(0)?"":"$1")+t.trim())}return t+e}function n(t,e,i,r){var o=t+";",s=2*e+3*i+4*r;if(944===s){t=o.indexOf(":",9)+1;var l=o.substring(t,o.length-1).trim();return l=o.substring(0,t).trim()+l+";",1===I||2===I&&a(l,1)?"-webkit-"+l+l:l}if(0===I||2===I&&!a(o,1))return o;switch(s){case 1015:return 97===o.charCodeAt(10)?"-webkit-"+o+o:o;case 951:return 116===o.charCodeAt(3)?"-webkit-"+o+o:o;case 963:return 110===o.charCodeAt(5)?"-webkit-"+o+o:o;case 1009:if(100!==o.charCodeAt(4))break;case 969:case 942:return"-webkit-"+o+o;case 978:return"-webkit-"+o+"-moz-"+o+o;case 1019:case 983:return"-webkit-"+o+"-moz-"+o+"-ms-"+o+o;case 883:if(45===o.charCodeAt(8))return"-webkit-"+o+o;if(0<o.indexOf("image-set(",11))return o.replace(A,"$1-webkit-$2")+o;break;case 932:if(45===o.charCodeAt(4))switch(o.charCodeAt(5)){case 103:return"-webkit-box-"+o.replace("-grow","")+"-webkit-"+o+"-ms-"+o.replace("grow","positive")+o;case 115:return"-webkit-"+o+"-ms-"+o.replace("shrink","negative")+o;case 98:return"-webkit-"+o+"-ms-"+o.replace("basis","preferred-size")+o}return"-webkit-"+o+"-ms-"+o+o;case 964:return"-webkit-"+o+"-ms-flex-"+o+o;case 1023:if(99!==o.charCodeAt(8))break;return"-webkit-box-pack"+(l=o.substring(o.indexOf(":",15)).replace("flex-","").replace("space-between","justify"))+"-webkit-"+o+"-ms-flex-pack"+l+o;case 1005:return p.test(o)?o.replace(d,":-webkit-")+o.replace(d,":-moz-")+o:o;case 1e3:switch(e=(l=o.substring(13).trim()).indexOf("-")+1,l.charCodeAt(0)+l.charCodeAt(e)){case 226:l=o.replace(b,"tb");break;case 232:l=o.replace(b,"tb-rl");break;case 220:l=o.replace(b,"lr");break;default:return o}return"-webkit-"+o+"-ms-"+l+o;case 1017:if(-1===o.indexOf("sticky",9))break;case 975:switch(e=(o=t).length-10,s=(l=(33===o.charCodeAt(e)?o.substring(0,e):o).substring(t.indexOf(":",7)+1).trim()).charCodeAt(0)+(0|l.charCodeAt(7))){case 203:if(111>l.charCodeAt(8))break;case 115:o=o.replace(l,"-webkit-"+l)+";"+o;break;case 207:case 102:o=o.replace(l,"-webkit-"+(102<s?"inline-":"")+"box")+";"+o.replace(l,"-webkit-"+l)+";"+o.replace(l,"-ms-"+l+"box")+";"+o}return o+";";case 938:if(45===o.charCodeAt(5))switch(o.charCodeAt(6)){case 105:return l=o.replace("-items",""),"-webkit-"+o+"-webkit-box-"+l+"-ms-flex-"+l+o;case 115:return"-webkit-"+o+"-ms-flex-item-"+o.replace(S,"")+o;default:return"-webkit-"+o+"-ms-flex-line-pack"+o.replace("align-content","").replace(S,"")+o}break;case 973:case 989:if(45!==o.charCodeAt(3)||122===o.charCodeAt(4))break;case 931:case 953:if(!0===C.test(t))return 115===(l=t.substring(t.indexOf(":")+1)).charCodeAt(0)?n(t.replace("stretch","fill-available"),e,i,r).replace(":fill-available",":stretch"):o.replace(l,"-webkit-"+l)+o.replace(l,"-moz-"+l.replace("fill-",""))+o;break;case 962:if(o="-webkit-"+o+(102===o.charCodeAt(5)?"-ms-"+o:"")+o,211===i+r&&105===o.charCodeAt(13)&&0<o.indexOf("transform",10))return o.substring(0,o.indexOf(";",27)+1).replace(m,"$1-webkit-$2")+o}return o}function a(t,e){var i=t.indexOf(1===e?":":"{"),r=t.substring(0,3!==e?i:10);return i=t.substring(i+1,t.length-1),D(2!==e?r:r.replace(k,"$1"),i,e)}function o(t,e){var i=n(e,e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2));return i!==e+";"?i.replace(w," or ($1)").substring(4):"("+e+")"}function s(t,e,i,r,n,a,o,s,l,h){for(var u,d=0,p=e;d<L;++d)switch(u=P[d].call(c,t,p,i,r,n,a,o,s,l,h)){case void 0:case!1:case!0:case null:break;default:p=u}if(p!==e)return p}function l(t){return void 0!==(t=t.prefix)&&(D=null,t?"function"!=typeof t?I=1:(I=2,D=t):I=0),l}function c(t,i){var r=t;if(33>r.charCodeAt(0)&&(r=r.trim()),r=[r],0<L){var n=s(-1,i,r,r,E,T,0,0,0,0);void 0!==n&&"string"==typeof n&&(i=n)}var a=e(z,r,i,0,0);return 0<L&&(void 0!==(n=s(-2,a,r,r,E,T,a.length,0,0,0))&&(a=n)),"",M=0,T=E=1,a}var h=/^\0+/g,u=/[\0\r\f]/g,d=/: */g,p=/zoo|gra/,m=/([,: ])(transform)/g,f=/,\r+?/g,g=/([\t\r\n ])*\f?&/g,y=/@(k\w+)\s*(\S*)\s*/,_=/::(place)/g,v=/:(read-only)/g,b=/[svh]\w+-[tblr]{2}/,x=/\(\s*(.*)\s*\)/g,w=/([\s\S]*?);/g,S=/-self|flex-/g,k=/[^]*?(:[rp][el]a[\w-]+)[^]*/,C=/stretch|:\s*\w+\-(?:conte|avail)/,A=/([^-])(image-set\()/,T=1,E=1,M=0,I=1,z=[],P=[],L=0,D=null,R=0;return c.use=function t(e){switch(e){case void 0:case null:L=P.length=0;break;default:if("function"==typeof e)P[L++]=e;else if("object"==typeof e)for(var i=0,r=e.length;i<r;++i)t(e[i]);else R=0|!!e}return t},c.set=l,void 0!==t&&l(t),c};const u={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1};function d(t){var e=Object.create(null);return function(i){return void 0===e[i]&&(e[i]=t(i)),e[i]}}var p=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,m=d((function(t){return p.test(t)||111===t.charCodeAt(0)&&110===t.charCodeAt(1)&&t.charCodeAt(2)<91})),f=n(84792),g=n.n(f);function y(){return(y=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t}).apply(this,arguments)}var _=function(t,e){for(var i=[t[0]],r=0,n=e.length;r<n;r+=1)i.push(e[r],t[r+1]);return i},v=function(t){return null!==t&&"object"==typeof t&&"[object Object]"===(t.toString?t.toString():Object.prototype.toString.call(t))&&!(0,s.typeOf)(t)},b=Object.freeze([]),x=Object.freeze({});function w(t){return"function"==typeof t}function S(t){return t.displayName||t.name||"Component"}function k(t){return t&&"string"==typeof t.styledComponentId}var C="undefined"!=typeof process&&void 0!==process.env&&(process.env.REACT_APP_SC_ATTR||process.env.SC_ATTR)||"data-styled",A="undefined"!=typeof window&&"HTMLElement"in window,T=Boolean("boolean"==typeof SC_DISABLE_SPEEDY?SC_DISABLE_SPEEDY:"undefined"!=typeof process&&void 0!==process.env&&(void 0!==process.env.REACT_APP_SC_DISABLE_SPEEDY&&""!==process.env.REACT_APP_SC_DISABLE_SPEEDY?"false"!==process.env.REACT_APP_SC_DISABLE_SPEEDY&&process.env.REACT_APP_SC_DISABLE_SPEEDY:void 0!==process.env.SC_DISABLE_SPEEDY&&""!==process.env.SC_DISABLE_SPEEDY&&("false"!==process.env.SC_DISABLE_SPEEDY&&process.env.SC_DISABLE_SPEEDY)));function E(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),r=1;r<e;r++)i[r-1]=arguments[r];throw new Error("An error occurred. See https://git.io/JUIaE#"+t+" for more information."+(i.length>0?" Args: "+i.join(", "):""))}var M=function(){function t(t){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=t}var e=t.prototype;return e.indexOfGroup=function(t){for(var e=0,i=0;i<t;i++)e+=this.groupSizes[i];return e},e.insertRules=function(t,e){if(t>=this.groupSizes.length){for(var i=this.groupSizes,r=i.length,n=r;t>=n;)(n<<=1)<0&&E(16,""+t);this.groupSizes=new Uint32Array(n),this.groupSizes.set(i),this.length=n;for(var a=r;a<n;a++)this.groupSizes[a]=0}for(var o=this.indexOfGroup(t+1),s=0,l=e.length;s<l;s++)this.tag.insertRule(o,e[s])&&(this.groupSizes[t]++,o++)},e.clearGroup=function(t){if(t<this.length){var e=this.groupSizes[t],i=this.indexOfGroup(t),r=i+e;this.groupSizes[t]=0;for(var n=i;n<r;n++)this.tag.deleteRule(i)}},e.getGroup=function(t){var e="";if(t>=this.length||0===this.groupSizes[t])return e;for(var i=this.groupSizes[t],r=this.indexOfGroup(t),n=r+i,a=r;a<n;a++)e+=this.tag.getRule(a)+"/*!sc*/\n";return e},t}(),I=new Map,z=new Map,P=1,L=function(t){if(I.has(t))return I.get(t);for(;z.has(P);)P++;var e=P++;return I.set(t,e),z.set(e,t),e},D=function(t){return z.get(t)},R=function(t,e){e>=P&&(P=e+1),I.set(t,e),z.set(e,t)},B="style["+C+'][data-styled-version="5.3.11"]',F=new RegExp("^"+C+'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)'),O=function(t,e,i){for(var r,n=i.split(","),a=0,o=n.length;a<o;a++)(r=n[a])&&t.registerName(e,r)},$=function(t,e){for(var i=(e.textContent||"").split("/*!sc*/\n"),r=[],n=0,a=i.length;n<a;n++){var o=i[n].trim();if(o){var s=o.match(F);if(s){var l=0|parseInt(s[1],10),c=s[2];0!==l&&(R(c,l),O(t,c,s[3]),t.getTag().insertRules(l,r)),r.length=0}else r.push(o)}}},V=function(){return n.nc},N=function(t){var e=document.head,i=t||e,r=document.createElement("style"),n=function(t){for(var e=t.childNodes,i=e.length;i>=0;i--){var r=e[i];if(r&&1===r.nodeType&&r.hasAttribute(C))return r}}(i),a=void 0!==n?n.nextSibling:null;r.setAttribute(C,"active"),r.setAttribute("data-styled-version","5.3.11");var o=V();return o&&r.setAttribute("nonce",o),i.insertBefore(r,a),r},j=function(){function t(t){var e=this.element=N(t);e.appendChild(document.createTextNode("")),this.sheet=function(t){if(t.sheet)return t.sheet;for(var e=document.styleSheets,i=0,r=e.length;i<r;i++){var n=e[i];if(n.ownerNode===t)return n}E(17)}(e),this.length=0}var e=t.prototype;return e.insertRule=function(t,e){try{return this.sheet.insertRule(e,t),this.length++,!0}catch(t){return!1}},e.deleteRule=function(t){this.sheet.deleteRule(t),this.length--},e.getRule=function(t){var e=this.sheet.cssRules[t];return void 0!==e&&"string"==typeof e.cssText?e.cssText:""},t}(),U=function(){function t(t){var e=this.element=N(t);this.nodes=e.childNodes,this.length=0}var e=t.prototype;return e.insertRule=function(t,e){if(t<=this.length&&t>=0){var i=document.createTextNode(e),r=this.nodes[t];return this.element.insertBefore(i,r||null),this.length++,!0}return!1},e.deleteRule=function(t){this.element.removeChild(this.nodes[t]),this.length--},e.getRule=function(t){return t<this.length?this.nodes[t].textContent:""},t}(),Z=function(){function t(t){this.rules=[],this.length=0}var e=t.prototype;return e.insertRule=function(t,e){return t<=this.length&&(this.rules.splice(t,0,e),this.length++,!0)},e.deleteRule=function(t){this.rules.splice(t,1),this.length--},e.getRule=function(t){return t<this.length?this.rules[t]:""},t}(),H=A,q={isServer:!A,useCSSOMInjection:!T},G=function(){function t(t,e,i){void 0===t&&(t=x),void 0===e&&(e={}),this.options=y({},q,{},t),this.gs=e,this.names=new Map(i),this.server=!!t.isServer,!this.server&&A&&H&&(H=!1,function(t){for(var e=document.querySelectorAll(B),i=0,r=e.length;i<r;i++){var n=e[i];n&&"active"!==n.getAttribute(C)&&($(t,n),n.parentNode&&n.parentNode.removeChild(n))}}(this))}t.registerId=function(t){return L(t)};var e=t.prototype;return e.reconstructWithOptions=function(e,i){return void 0===i&&(i=!0),new t(y({},this.options,{},e),this.gs,i&&this.names||void 0)},e.allocateGSInstance=function(t){return this.gs[t]=(this.gs[t]||0)+1},e.getTag=function(){return this.tag||(this.tag=(i=(e=this.options).isServer,r=e.useCSSOMInjection,n=e.target,t=i?new Z(n):r?new j(n):new U(n),new M(t)));var t,e,i,r,n},e.hasNameForId=function(t,e){return this.names.has(t)&&this.names.get(t).has(e)},e.registerName=function(t,e){if(L(t),this.names.has(t))this.names.get(t).add(e);else{var i=new Set;i.add(e),this.names.set(t,i)}},e.insertRules=function(t,e,i){this.registerName(t,e),this.getTag().insertRules(L(t),i)},e.clearNames=function(t){this.names.has(t)&&this.names.get(t).clear()},e.clearRules=function(t){this.getTag().clearGroup(L(t)),this.clearNames(t)},e.clearTag=function(){this.tag=void 0},e.toString=function(){return function(t){for(var e=t.getTag(),i=e.length,r="",n=0;n<i;n++){var a=D(n);if(void 0!==a){var o=t.names.get(a),s=e.getGroup(n);if(o&&s&&o.size){var l=C+".g"+n+'[id="'+a+'"]',c="";void 0!==o&&o.forEach((function(t){t.length>0&&(c+=t+",")})),r+=""+s+l+'{content:"'+c+'"}/*!sc*/\n'}}}return r}(this)},t}(),W=/(a)(d)/gi,X=function(t){return String.fromCharCode(t+(t>25?39:97))};function K(t){var e,i="";for(e=Math.abs(t);e>52;e=e/52|0)i=X(e%52)+i;return(X(e%52)+i).replace(W,"$1-$2")}var J=function(t,e){for(var i=e.length;i;)t=33*t^e.charCodeAt(--i);return t},Y=function(t){return J(5381,t)};function Q(t){for(var e=0;e<t.length;e+=1){var i=t[e];if(w(i)&&!k(i))return!1}return!0}var tt=Y("5.3.11"),et=function(){function t(t,e,i){this.rules=t,this.staticRulesId="",this.isStatic=(void 0===i||i.isStatic)&&Q(t),this.componentId=e,this.baseHash=J(tt,e),this.baseStyle=i,G.registerId(e)}return t.prototype.generateAndInjectStyles=function(t,e,i){var r=this.componentId,n=[];if(this.baseStyle&&n.push(this.baseStyle.generateAndInjectStyles(t,e,i)),this.isStatic&&!i.hash)if(this.staticRulesId&&e.hasNameForId(r,this.staticRulesId))n.push(this.staticRulesId);else{var a=vt(this.rules,t,e,i).join(""),o=K(J(this.baseHash,a)>>>0);if(!e.hasNameForId(r,o)){var s=i(a,"."+o,void 0,r);e.insertRules(r,o,s)}n.push(o),this.staticRulesId=o}else{for(var l=this.rules.length,c=J(this.baseHash,i.hash),h="",u=0;u<l;u++){var d=this.rules[u];if("string"==typeof d)h+=d;else if(d){var p=vt(d,t,e,i),m=Array.isArray(p)?p.join(""):p;c=J(c,m+u),h+=m}}if(h){var f=K(c>>>0);if(!e.hasNameForId(r,f)){var g=i(h,"."+f,void 0,r);e.insertRules(r,f,g)}n.push(f)}}return n.join(" ")},t}(),it=/^\s*\/\/.*$/gm,rt=[":","[",".","#"];function nt(t){var e,i,r,n,a=void 0===t?x:t,o=a.options,s=void 0===o?x:o,l=a.plugins,c=void 0===l?b:l,u=new h(s),d=[],p=function(t){function e(e){if(e)try{t(e+"}")}catch(t){}}return function(i,r,n,a,o,s,l,c,h,u){switch(i){case 1:if(0===h&&64===r.charCodeAt(0))return t(r+";"),"";break;case 2:if(0===c)return r+"/*|*/";break;case 3:switch(c){case 102:case 112:return t(n[0]+r),"";default:return r+(0===u?"/*|*/":"")}case-2:r.split("/*|*/}").forEach(e)}}}((function(t){d.push(t)})),m=function(t,r,a){return 0===r&&-1!==rt.indexOf(a[i.length])||a.match(n)?t:"."+e};function f(t,a,o,s){void 0===s&&(s="&");var l=t.replace(it,""),c=a&&o?o+" "+a+" { "+l+" }":l;return e=s,i=a,r=new RegExp("\\"+i+"\\b","g"),n=new RegExp("(\\"+i+"\\b){2,}"),u(o||!a?"":a,c)}return u.use([].concat(c,[function(t,e,n){2===t&&n.length&&n[0].lastIndexOf(i)>0&&(n[0]=n[0].replace(r,m))},p,function(t){if(-2===t){var e=d;return d=[],e}}])),f.hash=c.length?c.reduce((function(t,e){return e.name||E(15),J(t,e.name)}),5381).toString():"",f}var at=i().createContext(),ot=(at.Consumer,i().createContext()),st=(ot.Consumer,new G),lt=nt();function ct(){return(0,e.useContext)(at)||st}function ht(){return(0,e.useContext)(ot)||lt}function ut(t){var r=(0,e.useState)(t.stylisPlugins),n=r[0],a=r[1],o=ct(),s=(0,e.useMemo)((function(){var e=o;return t.sheet?e=t.sheet:t.target&&(e=e.reconstructWithOptions({target:t.target},!1)),t.disableCSSOMInjection&&(e=e.reconstructWithOptions({useCSSOMInjection:!1})),e}),[t.disableCSSOMInjection,t.sheet,t.target]),l=(0,e.useMemo)((function(){return nt({options:{prefix:!t.disableVendorPrefixes},plugins:n})}),[t.disableVendorPrefixes,n]);return(0,e.useEffect)((function(){c()(n,t.stylisPlugins)||a(t.stylisPlugins)}),[t.stylisPlugins]),i().createElement(at.Provider,{value:s},i().createElement(ot.Provider,{value:l},t.children))}var dt=function(){function t(t,e){var i=this;this.inject=function(t,e){void 0===e&&(e=lt);var r=i.name+e.hash;t.hasNameForId(i.id,r)||t.insertRules(i.id,r,e(i.rules,r,"@keyframes"))},this.toString=function(){return E(12,String(i.name))},this.name=t,this.id="sc-keyframes-"+t,this.rules=e}return t.prototype.getName=function(t){return void 0===t&&(t=lt),this.name+t.hash},t}(),pt=/([A-Z])/,mt=/([A-Z])/g,ft=/^ms-/,gt=function(t){return"-"+t.toLowerCase()};function yt(t){return pt.test(t)?t.replace(mt,gt).replace(ft,"-ms-"):t}var _t=function(t){return null==t||!1===t||""===t};function vt(t,e,i,r){if(Array.isArray(t)){for(var n,a=[],o=0,s=t.length;o<s;o+=1)""!==(n=vt(t[o],e,i,r))&&(Array.isArray(n)?a.push.apply(a,n):a.push(n));return a}return _t(t)?"":k(t)?"."+t.styledComponentId:w(t)?"function"!=typeof(l=t)||l.prototype&&l.prototype.isReactComponent||!e?t:vt(t(e),e,i,r):t instanceof dt?i?(t.inject(i,r),t.getName(r)):t:v(t)?function t(e,i){var r,n,a=[];for(var o in e)e.hasOwnProperty(o)&&!_t(e[o])&&(Array.isArray(e[o])&&e[o].isCss||w(e[o])?a.push(yt(o)+":",e[o],";"):v(e[o])?a.push.apply(a,t(e[o],o)):a.push(yt(o)+": "+(r=o,(null==(n=e[o])||"boolean"==typeof n||""===n?"":"number"!=typeof n||0===n||r in u||r.startsWith("--")?String(n).trim():n+"px")+";")));return i?[i+" {"].concat(a,["}"]):a}(t):t.toString();var l}var bt=function(t){return Array.isArray(t)&&(t.isCss=!0),t};function xt(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),r=1;r<e;r++)i[r-1]=arguments[r];return w(t)||v(t)?bt(vt(_(b,[t].concat(i)))):0===i.length&&1===t.length&&"string"==typeof t[0]?t:bt(vt(_(t,i)))}new Set;var wt=function(t,e,i){return void 0===i&&(i=x),t.theme!==i.theme&&t.theme||e||i.theme},St=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,kt=/(^-|-$)/g;function Ct(t){return t.replace(St,"-").replace(kt,"")}var At=function(t){return K(Y(t)>>>0)};function Tt(t){return"string"==typeof t&&!0}var Et=function(t){return"function"==typeof t||"object"==typeof t&&null!==t&&!Array.isArray(t)},Mt=function(t){return"__proto__"!==t&&"constructor"!==t&&"prototype"!==t};function It(t,e,i){var r=t[i];Et(e)&&Et(r)?zt(r,e):t[i]=e}function zt(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),r=1;r<e;r++)i[r-1]=arguments[r];for(var n=0,a=i;n<a.length;n++){var o=a[n];if(Et(o))for(var s in o)Mt(s)&&It(t,o[s],s)}return t}var Pt=i().createContext();Pt.Consumer;var Lt={};function Dt(t,r,n){var a=k(t),o=!Tt(t),s=r.attrs,l=void 0===s?b:s,c=r.componentId,h=void 0===c?function(t,e){var i="string"!=typeof t?"sc":Ct(t);Lt[i]=(Lt[i]||0)+1;var r=i+"-"+At("5.3.11"+i+Lt[i]);return e?e+"-"+r:r}(r.displayName,r.parentComponentId):c,u=r.displayName,d=void 0===u?function(t){return Tt(t)?"styled."+t:"Styled("+S(t)+")"}(t):u,p=r.displayName&&r.componentId?Ct(r.displayName)+"-"+r.componentId:r.componentId||h,f=a&&t.attrs?Array.prototype.concat(t.attrs,l).filter(Boolean):l,_=r.shouldForwardProp;a&&t.shouldForwardProp&&(_=r.shouldForwardProp?function(e,i,n){return t.shouldForwardProp(e,i,n)&&r.shouldForwardProp(e,i,n)}:t.shouldForwardProp);var v,C=new et(n,p,a?t.componentStyle:void 0),A=C.isStatic&&0===l.length,T=function(t,i){return function(t,i,r,n){var a=t.attrs,o=t.componentStyle,s=t.defaultProps,l=t.foldedComponentIds,c=t.shouldForwardProp,h=t.styledComponentId,u=t.target,d=function(t,e,i){void 0===t&&(t=x);var r=y({},e,{theme:t}),n={};return i.forEach((function(t){var e,i,a,o=t;for(e in w(o)&&(o=o(r)),o)r[e]=n[e]="className"===e?(i=n[e],a=o[e],i&&a?i+" "+a:i||a):o[e]})),[r,n]}(wt(i,(0,e.useContext)(Pt),s)||x,i,a),p=d[0],f=d[1],g=function(t,e,i,r){var n=ct(),a=ht();return e?t.generateAndInjectStyles(x,n,a):t.generateAndInjectStyles(i,n,a)}(o,n,p),_=r,v=f.$as||i.$as||f.as||i.as||u,b=Tt(v),S=f!==i?y({},i,{},f):i,k={};for(var C in S)"$"!==C[0]&&"as"!==C&&("forwardedAs"===C?k.as=S[C]:(c?c(C,m,v):!b||m(C))&&(k[C]=S[C]));return i.style&&f.style!==i.style&&(k.style=y({},i.style,{},f.style)),k.className=Array.prototype.concat(l,h,g!==h?g:null,i.className,f.className).filter(Boolean).join(" "),k.ref=_,(0,e.createElement)(v,k)}(v,t,i,A)};return T.displayName=d,(v=i().forwardRef(T)).attrs=f,v.componentStyle=C,v.displayName=d,v.shouldForwardProp=_,v.foldedComponentIds=a?Array.prototype.concat(t.foldedComponentIds,t.styledComponentId):b,v.styledComponentId=p,v.target=a?t.target:t,v.withComponent=function(t){var e=r.componentId,i=function(t,e){if(null==t)return{};var i,r,n={},a=Object.keys(t);for(r=0;r<a.length;r++)i=a[r],e.indexOf(i)>=0||(n[i]=t[i]);return n}(r,["componentId"]),a=e&&e+"-"+(Tt(t)?t:Ct(S(t)));return Dt(t,y({},i,{attrs:f,componentId:a}),n)},Object.defineProperty(v,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(e){this._foldedDefaultProps=a?zt({},t.defaultProps,e):e}}),Object.defineProperty(v,"toString",{value:function(){return"."+v.styledComponentId}}),o&&g()(v,t,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0,withComponent:!0}),v}var Rt=function(t){return function t(e,i,r){if(void 0===r&&(r=x),!(0,s.isValidElementType)(i))return E(1,String(i));var n=function(){return e(i,r,xt.apply(void 0,arguments))};return n.withConfig=function(n){return t(e,i,y({},r,{},n))},n.attrs=function(n){return t(e,i,y({},r,{attrs:Array.prototype.concat(r.attrs,n).filter(Boolean)}))},n}(Dt,t)};["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","textPath","tspan"].forEach((function(t){Rt[t]=Rt(t)}));!function(){function t(t,e){this.rules=t,this.componentId=e,this.isStatic=Q(t),G.registerId(this.componentId+1)}var e=t.prototype;e.createStyles=function(t,e,i,r){var n=r(vt(this.rules,e,i,r).join(""),""),a=this.componentId+t;i.insertRules(a,a,n)},e.removeStyles=function(t,e){e.clearRules(this.componentId+t)},e.renderStyles=function(t,e,i,r){t>2&&G.registerId(this.componentId+t),this.removeStyles(t,i),this.createStyles(t,e,i,r)}}();function Bt(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),r=1;r<e;r++)i[r-1]=arguments[r];var n=xt.apply(void 0,[t].concat(i)).join(""),a=At(n);return new dt(a,n)}!function(){function t(){var t=this;this._emitSheetCSS=function(){var e=t.instance.toString();if(!e)return"";var i=V();return"<style "+[i&&'nonce="'+i+'"',C+'="true"','data-styled-version="5.3.11"'].filter(Boolean).join(" ")+">"+e+"</style>"},this.getStyleTags=function(){return t.sealed?E(2):t._emitSheetCSS()},this.getStyleElement=function(){var e;if(t.sealed)return E(2);var r=((e={})[C]="",e["data-styled-version"]="5.3.11",e.dangerouslySetInnerHTML={__html:t.instance.toString()},e),n=V();return n&&(r.nonce=n),[i().createElement("style",y({},r,{key:"sc-0-0"}))]},this.seal=function(){t.sealed=!0},this.instance=new G({isServer:!0}),this.sealed=!1}var e=t.prototype;e.collectStyles=function(t){return this.sealed?E(2):i().createElement(ut,{sheet:this.instance},t)},e.interleaveWithNodeStream=function(t){return E(3)}}();const Ft=Rt;var Ot=6371008.8,$t={centimeters:637100880,centimetres:637100880,degrees:57.22891354143274,feet:20902260.511392,inches:39.37*Ot,kilometers:6371.0088,kilometres:6371.0088,meters:Ot,metres:Ot,miles:3958.761333810546,millimeters:6371008800,millimetres:6371008800,nauticalmiles:Ot/1852,radians:1,yards:6967335.223679999};function Vt(t,e,i){void 0===i&&(i={});var r={type:"Feature"};return(0===i.id||i.id)&&(r.id=i.id),i.bbox&&(r.bbox=i.bbox),r.properties=e||{},r.geometry=t,r}function Nt(t,e,i){if(void 0===i&&(i={}),!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Gt(t[0])||!Gt(t[1]))throw new Error("coordinates must contain numbers");return Vt({type:"Point",coordinates:t},e,i)}function jt(t,e,i){if(void 0===i&&(i={}),t.length<2)throw new Error("coordinates must be an array of two or more positions");return Vt({type:"LineString",coordinates:t},e,i)}function Ut(t,e){void 0===e&&(e="kilometers");var i=$t[e];if(!i)throw new Error(e+" units is invalid");return t*i}function Zt(t,e){void 0===e&&(e="kilometers");var i=$t[e];if(!i)throw new Error(e+" units is invalid");return t/i}function Ht(t){return 180*(t%(2*Math.PI))/Math.PI}function qt(t){return t%360*Math.PI/180}function Gt(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}function Wt(t,e,i){if(null!==t)for(var r,n,a,o,s,l,c,h,u=0,d=0,p=t.type,m="FeatureCollection"===p,f="Feature"===p,g=m?t.features.length:1,y=0;y<g;y++){s=(h=!!(c=m?t.features[y].geometry:f?t.geometry:t)&&"GeometryCollection"===c.type)?c.geometries.length:1;for(var _=0;_<s;_++){var v=0,b=0;if(null!==(o=h?c.geometries[_]:c)){l=o.coordinates;var x=o.type;switch(u=!i||"Polygon"!==x&&"MultiPolygon"!==x?0:1,x){case null:break;case"Point":if(!1===e(l,d,y,v,b))return!1;d++,v++;break;case"LineString":case"MultiPoint":for(r=0;r<l.length;r++){if(!1===e(l[r],d,y,v,b))return!1;d++,"MultiPoint"===x&&v++}"LineString"===x&&v++;break;case"Polygon":case"MultiLineString":for(r=0;r<l.length;r++){for(n=0;n<l[r].length-u;n++){if(!1===e(l[r][n],d,y,v,b))return!1;d++}"MultiLineString"===x&&v++,"Polygon"===x&&b++}"Polygon"===x&&v++;break;case"MultiPolygon":for(r=0;r<l.length;r++){for(b=0,n=0;n<l[r].length;n++){for(a=0;a<l[r][n].length-u;a++){if(!1===e(l[r][n][a],d,y,v,b))return!1;d++}b++}v++}break;case"GeometryCollection":for(r=0;r<o.geometries.length;r++)if(!1===Wt(o.geometries[r],e,i))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function Xt(t,e){var i,r,n,a,o,s,l,c,h,u,d=0,p="FeatureCollection"===t.type,m="Feature"===t.type,f=p?t.features.length:1;for(i=0;i<f;i++){for(s=p?t.features[i].geometry:m?t.geometry:t,c=p?t.features[i].properties:m?t.properties:{},h=p?t.features[i].bbox:m?t.bbox:void 0,u=p?t.features[i].id:m?t.id:void 0,o=(l=!!s&&"GeometryCollection"===s.type)?s.geometries.length:1,n=0;n<o;n++)if(null!==(a=l?s.geometries[n]:s))switch(a.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(a,d,c,h,u))return!1;break;case"GeometryCollection":for(r=0;r<a.geometries.length;r++)if(!1===e(a.geometries[r],d,c,h,u))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===e(null,d,c,h,u))return!1;d++}}function Kt(t,e){Xt(t,(function(t,i,r,n,a){var o,s=null===t?null:t.type;switch(s){case null:case"Point":case"LineString":case"Polygon":return!1!==e(Vt(t,r,{bbox:n,id:a}),i,0)&&void 0}switch(s){case"MultiPoint":o="Point";break;case"MultiLineString":o="LineString";break;case"MultiPolygon":o="Polygon"}for(var l=0;l<t.coordinates.length;l++){var c=t.coordinates[l];if(!1===e(Vt({type:o,coordinates:c},r),i,l))return!1}}))}function Jt(t,e,i){var r=i,n=!1;return function(t,e){Kt(t,(function(t,i,r){var n=0;if(t.geometry){var a=t.geometry.type;if("Point"!==a&&"MultiPoint"!==a){var o,s=0,l=0,c=0;return!1!==Wt(t,(function(a,h,u,d,p){if(void 0===o||i>s||d>l||p>c)return o=a,s=i,l=d,c=p,void(n=0);var m=jt([o,a],t.properties);if(!1===e(m,i,r,p,n))return!1;n++,o=a}))&&void 0}}}))}(t,(function(t,a,o,s,l){r=!1===n&&void 0===i?t:e(r,t,a,o,s,l),n=!0})),r}function Yt(t){var e=[1/0,1/0,-1/0,-1/0];return Wt(t,(function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])})),e}Yt.default=Yt;const Qt=Yt;function te(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if("Feature"===t.type&&null!==t.geometry&&"Point"===t.geometry.type)return t.geometry.coordinates;if("Point"===t.type)return t.coordinates}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function ee(t){return"Feature"===t.type?t.geometry:t}const ie=function(t,e,i){void 0===i&&(i={});var r=te(t),n=te(e),a=qt(n[1]-r[1]),o=qt(n[0]-r[0]),s=qt(r[1]),l=qt(n[1]),c=Math.pow(Math.sin(a/2),2)+Math.pow(Math.sin(o/2),2)*Math.cos(s)*Math.cos(l);return Ut(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)),i.units)};class re{constructor(t){this.emitter=t||document.createElement("div"),this.subscribe=this.subscribe.bind(this),this.unsubscribe=this.unsubscribe.bind(this),this.emit=this.emit.bind(this)}subscribe(t,e){"function"==typeof e&&this.emitter.addEventListener(t,e)}unsubscribe(t,e){this.emitter.removeEventListener(t,e)}emit(t,e){const i=new CustomEvent(t,{detail:e});this.emitter.dispatchEvent(i)}once(t,e){if("function"==typeof e){const i=r=>{e(r),this.unsubscribe(t,i)};this.subscribe(t,i)}}}const ne=["default","orange","blue","cyan","green","black","black-2","black-3","white","purple","yellow","red","brown","magenta","yorange"],ae={default:{key:"default",label:"Default",color:"#ff3300",circleColor:"#b5342b"},orange:{key:"orange",label:"Orange",color:"#ff3300",circleColor:"#b5342b"},blue:{key:"blue",label:"Blue",color:"#087aff",circleColor:"#0056bb"},cyan:{key:"cyan",label:"Cyan",color:"#00ffff",circleColor:"#009999"},green:{key:"green",label:"Green",color:"#84d400",circleColor:"#65b604"},black:{key:"black",label:"Black",color:"#000000",circleColor:"#666666"},"black-2":{key:"black-2",label:"Black-2",color:"#333333",circleColor:"#333333"},"black-3":{key:"black-3",label:"Black-3",color:"#333333",circleColor:"#222222"},white:{key:"white",label:"White",color:"#ffffff",circleColor:"#333333"},purple:{key:"purple",label:"Purple",color:"#800080",circleColor:"#ff00ff"},yellow:{key:"yellow",label:"Yellow",color:"#ffff00",circleColor:"#666633"},red:{key:"red",label:"Red",color:"#ff0000",circleColor:"#7f0000"},brown:{key:"brown",label:"Brown",color:"#8b4513",circleColor:"#53290b"},magenta:{key:"magenta",label:"Magenta",color:"#ff00ff",circleColor:"#800080"},yorange:{key:"yorange",label:"Yorange",color:"#ff9f0e",circleColor:"#d07d00"}};function oe(t){return function(t){return!("string"!=typeof t||!ne.includes(t))}(t)?ae[t]:ae.default}function se(t){switch(t){case"hunt":return{color:"#ff3300",darkColor:"#AD2300",logoColor:"#ff3300",waypointColor:"default",link:new URL("https://webmap.onxmaps.com/hunt/login")};case"offroad":return{color:"#FF9F0E",darkColor:"#AD6C0A",logoColor:"#333333",waypointColor:"yorange",link:new URL("https://webmap.onxmaps.com/offroad/login")};case"backcountry":return{color:"#087AFF",darkColor:"#0553AD",logoColor:"#087AFF",waypointColor:"blue",link:new URL("https://webmap.onxmaps.com/backcountry/login")};default:return{color:"#333333",darkColor:"#222222",logoColor:"#333333",waypointColor:"black",link:new URL("https://webmap.onxmaps.com/hunt/login")}}}function le(t){const e=se(t.brand).link,[i,r]=t.center,n=t.zoom,a="onx"===t.brand?"hunt":t.brand;return e.pathname=`/${a}/map/query/${r},${i},${n}`,ce(e),e}function ce(t){const e=function(){var t;try{let e=document.referrer;return e||(e=null==(t=null==window?void 0:window.location)?void 0:t.host),e}catch{return""}}();return t.searchParams.set("utm_id","bwo"),t.searchParams.set("utm_source",e),t.searchParams.set("utm_campaign","bwo-map-viewer"),t.searchParams.set("utm_medium","embed"),t}function he(t,e,i){const r=se(t),a=i.sources.custom;if(a&&"geojson"!==a.type)return;const o=a.data;if("object"!=typeof o||null===o||"FeatureCollection"!==o.type)return;const{features:s}=o;s.forEach((async t=>{if("Point"!==t.geometry.type||!t.properties||!t.properties.hasOwnProperty("waypoint-icon"))return;const i=t.properties["waypoint-icon"],a=(await((t,e)=>{const i=t[e];return i?"function"==typeof i?i():Promise.resolve(i):new Promise(((t,i)=>{("function"==typeof queueMicrotask?queueMicrotask:setTimeout)(i.bind(null,new Error("Unknown variable dynamic import: "+e)))}))})(Object.assign({"./icons/4x4.svg":()=>n.e(86912).then(n.bind(n,86912)),"./icons/ATV.svg":()=>n.e(70908).then(n.bind(n,70908)),"./icons/Access.svg":()=>n.e(57192).then(n.bind(n,57192)),"./icons/AccessPoint.svg":()=>n.e(36240).then(n.bind(n,13860)),"./icons/AirUpDown.svg":()=>n.e(67596).then(n.bind(n,67596)),"./icons/Antelope.svg":()=>n.e(996).then(n.bind(n,23376)),"./icons/Arrow.svg":()=>n.e(47584).then(n.bind(n,47584)),"./icons/Backpacker.svg":()=>n.e(62300).then(n.bind(n,62300)),"./icons/Bait.svg":()=>n.e(79132).then(n.bind(n,79132)),"./icons/Barrier.svg":()=>n.e(30320).then(n.bind(n,30320)),"./icons/BeachCombing.svg":()=>n.e(99042).then(n.bind(n,99042)),"./icons/Bear.svg":()=>n.e(4284).then(n.bind(n,4284)),"./icons/BeddingArea.svg":()=>n.e(60160).then(n.bind(n,37780)),"./icons/Bike.svg":()=>n.e(36260).then(n.bind(n,91496)),"./icons/Blind.svg":()=>n.e(58469).then(n.bind(n,58469)),"./icons/Blood.svg":()=>n.e(3476).then(n.bind(n,3476)),"./icons/BoatRamp.svg":()=>n.e(40147).then(n.bind(n,40147)),"./icons/Bobcat.svg":()=>n.e(63292).then(n.bind(n,63292)),"./icons/Buck.svg":()=>n.e(74040).then(n.bind(n,74040)),"./icons/BuckMuleDeer.svg":()=>n.e(67843).then(n.bind(n,90224)),"./icons/BuckWhitetail.svg":()=>n.e(81800).then(n.bind(n,81800)),"./icons/Cabin.svg":()=>n.e(16552).then(n.bind(n,16552)),"./icons/Camp.svg":()=>n.e(68284).then(n.bind(n,45904)),"./icons/CampArea.svg":()=>n.e(62716).then(n.bind(n,40336)),"./icons/CampBackcountry.svg":()=>n.e(73716).then(n.bind(n,73716)),"./icons/Campground.svg":()=>n.e(10660).then(n.bind(n,10660)),"./icons/Canoe.svg":()=>n.e(64376).then(n.bind(n,64376)),"./icons/Cave.svg":()=>n.e(17056).then(n.bind(n,94676)),"./icons/Caving.svg":()=>n.e(40716).then(n.bind(n,40716)),"./icons/Chukar.svg":()=>n.e(20240).then(n.bind(n,20240)),"./icons/Climbing.svg":()=>n.e(36).then(n.bind(n,36)),"./icons/ClosedGate.svg":()=>n.e(57328).then(n.bind(n,57328)),"./icons/Cornice.svg":()=>n.e(48784).then(n.bind(n,48784)),"./icons/Couloir.svg":()=>n.e(66556).then(n.bind(n,66556)),"./icons/CowElk.svg":()=>n.e(90168).then(n.bind(n,90168)),"./icons/Coyote.svg":()=>n.e(60732).then(n.bind(n,60732)),"./icons/Crossing.svg":()=>n.e(32176).then(n.bind(n,32176)),"./icons/Deadhead.svg":()=>n.e(75532).then(n.bind(n,75532)),"./icons/DeerFeeder.svg":()=>n.e(40068).then(n.bind(n,40068)),"./icons/DirtBike.svg":()=>n.e(48152).then(n.bind(n,48152)),"./icons/Doe.svg":()=>n.e(97952).then(n.bind(n,97952)),"./icons/Dog.svg":()=>n.e(95512).then(n.bind(n,95512)),"./icons/DogSledding.svg":()=>n.e(75904).then(n.bind(n,75904)),"./icons/Dove.svg":()=>n.e(11896).then(n.bind(n,11896)),"./icons/Ducks.svg":()=>n.e(5592).then(n.bind(n,5592)),"./icons/Eagle.svg":()=>n.e(71908).then(n.bind(n,49528)),"./icons/Elk.svg":()=>n.e(59257).then(n.bind(n,59257)),"./icons/ElkShed.svg":()=>n.e(81176).then(n.bind(n,58795)),"./icons/EmergencyPhone.svg":()=>n.e(1216).then(n.bind(n,1216)),"./icons/FeedingArea.svg":()=>n.e(86012).then(n.bind(n,86012)),"./icons/Firewood.svg":()=>n.e(26444).then(n.bind(n,48826)),"./icons/Fish.svg":()=>n.e(87344).then(n.bind(n,64964)),"./icons/Fishing.svg":()=>n.e(62816).then(n.bind(n,62816)),"./icons/FoodPlot.svg":()=>n.e(40144).then(n.bind(n,40144)),"./icons/FoodSource.svg":()=>n.e(90588).then(n.bind(n,90588)),"./icons/FoodStorage.svg":()=>n.e(93344).then(n.bind(n,93344)),"./icons/Footbridge.svg":()=>n.e(4988).then(n.bind(n,82608)),"./icons/Foraging.svg":()=>n.e(32768).then(n.bind(n,32768)),"./icons/Fox.svg":()=>n.e(25172).then(n.bind(n,25172)),"./icons/Fuel.svg":()=>n.e(1604).then(n.bind(n,1604)),"./icons/Gate.svg":()=>n.e(52588).then(n.bind(n,52588)),"./icons/Gear.svg":()=>n.e(63208).then(n.bind(n,63208)),"./icons/Geese.svg":()=>n.e(18960).then(n.bind(n,18960)),"./icons/GeneralRidingArea.svg":()=>n.e(72568).then(n.bind(n,72568)),"./icons/Geyser.svg":()=>n.e(26792).then(n.bind(n,4412)),"./icons/GlassingArea.svg":()=>n.e(64828).then(n.bind(n,87208)),"./icons/Grocery.svg":()=>n.e(19180).then(n.bind(n,19180)),"./icons/HandLaunch.svg":()=>n.e(60476).then(n.bind(n,60476)),"./icons/HangGliding.svg":()=>n.e(15392).then(n.bind(n,15392)),"./icons/Hazard.svg":()=>n.e(33264).then(n.bind(n,33264)),"./icons/Hike.svg":()=>n.e(88760).then(n.bind(n,88760)),"./icons/Hiker.svg":()=>n.e(40820).then(n.bind(n,40820)),"./icons/Hog.svg":()=>n.e(92312).then(n.bind(n,92312)),"./icons/Horseback.svg":()=>n.e(87496).then(n.bind(n,87496)),"./icons/HotSpring.svg":()=>n.e(88437).then(n.bind(n,88437)),"./icons/House.svg":()=>n.e(12760).then(n.bind(n,12760)),"./icons/Junction.svg":()=>n.e(58832).then(n.bind(n,58832)),"./icons/Kayak.svg":()=>n.e(11872).then(n.bind(n,11872)),"./icons/Kennels.svg":()=>n.e(34852).then(n.bind(n,34852)),"./icons/LadderStand.svg":()=>n.e(36644).then(n.bind(n,36644)),"./icons/LicenseStation.svg":()=>n.e(56008).then(n.bind(n,56008)),"./icons/Lighthouses.svg":()=>n.e(36892).then(n.bind(n,36892)),"./icons/Location.svg":()=>n.e(47616).then(n.bind(n,47616)),"./icons/LogObstacle.svg":()=>n.e(62952).then(n.bind(n,62952)),"./icons/Lookout.svg":()=>n.e(48656).then(n.bind(n,48656)),"./icons/Marina.svg":()=>n.e(75474).then(n.bind(n,75474)),"./icons/Meat.svg":()=>n.e(50704).then(n.bind(n,50704)),"./icons/MineralSite.svg":()=>n.e(23152).then(n.bind(n,23152)),"./icons/Moose.svg":()=>n.e(656).then(n.bind(n,656)),"./icons/MountainBiking.svg":()=>n.e(6704).then(n.bind(n,6704)),"./icons/MountainGoat.svg":()=>n.e(41492).then(n.bind(n,41492)),"./icons/MountainLion.svg":()=>n.e(21856).then(n.bind(n,21856)),"./icons/Mountaineer.svg":()=>n.e(78812).then(n.bind(n,1192)),"./icons/MudPit.svg":()=>n.e(61752).then(n.bind(n,61752)),"./icons/Mushroom.svg":()=>n.e(31688).then(n.bind(n,31688)),"./icons/NonEthanol.svg":()=>n.e(31216).then(n.bind(n,31216)),"./icons/ObservationTowers.svg":()=>n.e(88192).then(n.bind(n,88192)),"./icons/OffRoadVehicle.svg":()=>n.e(48488).then(n.bind(n,48488)),"./icons/OpenGate.svg":()=>n.e(788).then(n.bind(n,788)),"./icons/Overland.svg":()=>n.e(74136).then(n.bind(n,74136)),"./icons/Pack.svg":()=>n.e(85892).then(n.bind(n,85892)),"./icons/Parking.svg":()=>n.e(70864).then(n.bind(n,26104)),"./icons/Pheasant.svg":()=>n.e(32165).then(n.bind(n,32165)),"./icons/Photo.svg":()=>n.e(98160).then(n.bind(n,98160)),"./icons/Picnic.svg":()=>n.e(58286).then(n.bind(n,58286)),"./icons/PicnicArea.svg":()=>n.e(55128).then(n.bind(n,55128)),"./icons/PinchPoint.svg":()=>n.e(37516).then(n.bind(n,37516)),"./icons/PointofInterest.svg":()=>n.e(91296).then(n.bind(n,91296)),"./icons/PotableWater.svg":()=>n.e(4212).then(n.bind(n,4212)),"./icons/PutIn.svg":()=>n.e(24624).then(n.bind(n,24624)),"./icons/Quail.svg":()=>n.e(31405).then(n.bind(n,31405)),"./icons/RV.svg":()=>n.e(15480).then(n.bind(n,15480)),"./icons/Rabbit.svg":()=>n.e(21528).then(n.bind(n,21528)),"./icons/Raccoon.svg":()=>n.e(30627).then(n.bind(n,30627)),"./icons/Raft.svg":()=>n.e(89512).then(n.bind(n,89512)),"./icons/Rapids.svg":()=>n.e(85816).then(n.bind(n,85816)),"./icons/Rappel.svg":()=>n.e(43812).then(n.bind(n,43812)),"./icons/Restroom.svg":()=>n.e(10488).then(n.bind(n,10488)),"./icons/RoadBarrier.svg":()=>n.e(51744).then(n.bind(n,51744)),"./icons/RockCrawlArea.svg":()=>n.e(9772).then(n.bind(n,87391)),"./icons/RockObstacle.svg":()=>n.e(67916).then(n.bind(n,67916)),"./icons/RoostTree.svg":()=>n.e(35856).then(n.bind(n,35856)),"./icons/Rub.svg":()=>n.e(96836).then(n.bind(n,96836)),"./icons/Ruins.svg":()=>n.e(73644).then(n.bind(n,73644)),"./icons/SUV.svg":()=>n.e(44572).then(n.bind(n,66952)),"./icons/Sasquatch.svg":()=>n.e(16207).then(n.bind(n,16207)),"./icons/Scat.svg":()=>n.e(30384).then(n.bind(n,30384)),"./icons/Scenic.svg":()=>n.e(98784).then(n.bind(n,98784)),"./icons/Scrape.svg":()=>n.e(79804).then(n.bind(n,79804)),"./icons/ShedAntler.svg":()=>n.e(24072).then(n.bind(n,24072)),"./icons/Sheep.svg":()=>n.e(68765).then(n.bind(n,68765)),"./icons/Shelter.svg":()=>n.e(48536).then(n.bind(n,48536)),"./icons/ShootingArea.svg":()=>n.e(35620).then(n.bind(n,35620)),"./icons/Shot.svg":()=>n.e(33424).then(n.bind(n,33424)),"./icons/Ski.svg":()=>n.e(52932).then(n.bind(n,52932)),"./icons/SkiAreas.svg":()=>n.e(8044).then(n.bind(n,8044)),"./icons/SkiTouring.svg":()=>n.e(15880).then(n.bind(n,15880)),"./icons/SkinTrack.svg":()=>n.e(35519).then(n.bind(n,57900)),"./icons/SlidePath.svg":()=>n.e(17428).then(n.bind(n,17428)),"./icons/SnowPit.svg":()=>n.e(6488).then(n.bind(n,6488)),"./icons/Snowboarder.svg":()=>n.e(19328).then(n.bind(n,19328)),"./icons/Snowmobile.svg":()=>n.e(39456).then(n.bind(n,39456)),"./icons/Snowpark.svg":()=>n.e(84008).then(n.bind(n,84008)),"./icons/Squirrel.svg":()=>n.e(6768).then(n.bind(n,6768)),"./icons/SteepTrail.svg":()=>n.e(84576).then(n.bind(n,84576)),"./icons/StockTank.svg":()=>n.e(79416).then(n.bind(n,79416)),"./icons/Summit.svg":()=>n.e(36204).then(n.bind(n,36204)),"./icons/SurfingArea.svg":()=>n.e(17400).then(n.bind(n,17400)),"./icons/Swimming.svg":()=>n.e(9884).then(n.bind(n,9884)),"./icons/SxS.svg":()=>n.e(43108).then(n.bind(n,43108)),"./icons/TakeOut.svg":()=>n.e(19996).then(n.bind(n,19996)),"./icons/Tracks.svg":()=>n.e(52064).then(n.bind(n,52064)),"./icons/Trail.svg":()=>n.e(62640).then(n.bind(n,62640)),"./icons/TrailCam.svg":()=>n.e(17280).then(n.bind(n,17280)),"./icons/TrailRating1.svg":()=>n.e(50936).then(n.bind(n,50936)),"./icons/TrailRating10.svg":()=>n.e(62792).then(n.bind(n,62792)),"./icons/TrailRating2.svg":()=>n.e(76396).then(n.bind(n,76396)),"./icons/TrailRating3.svg":()=>n.e(7888).then(n.bind(n,7888)),"./icons/TrailRating4.svg":()=>n.e(70568).then(n.bind(n,70568)),"./icons/TrailRating5.svg":()=>n.e(66120).then(n.bind(n,66120)),"./icons/TrailRating6.svg":()=>n.e(49800).then(n.bind(n,49800)),"./icons/TrailRating7.svg":()=>n.e(37144).then(n.bind(n,37144)),"./icons/TrailRating8.svg":()=>n.e(64456).then(n.bind(n,64456)),"./icons/TrailRating9.svg":()=>n.e(82800).then(n.bind(n,82800)),"./icons/Trailhead.svg":()=>n.e(89140).then(n.bind(n,11520)),"./icons/Trap.svg":()=>n.e(69140).then(n.bind(n,46760)),"./icons/TreeStand.svg":()=>n.e(45168).then(n.bind(n,45168)),"./icons/Truck.svg":()=>n.e(63664).then(n.bind(n,63664)),"./icons/Turkey.svg":()=>n.e(20992).then(n.bind(n,20992)),"./icons/TurkeyGobbler.svg":()=>n.e(25016).then(n.bind(n,25016)),"./icons/TurkeyHen.svg":()=>n.e(51244).then(n.bind(n,51244)),"./icons/TurkeyJake.svg":()=>n.e(81236).then(n.bind(n,81236)),"./icons/TurkeyStrutZone.svg":()=>n.e(14072).then(n.bind(n,14072)),"./icons/TurnHere.svg":()=>n.e(19004).then(n.bind(n,19004)),"./icons/TurnLeft.svg":()=>n.e(41424).then(n.bind(n,41424)),"./icons/TurnRight.svg":()=>n.e(36653).then(n.bind(n,36653)),"./icons/Upland.svg":()=>n.e(76080).then(n.bind(n,76080)),"./icons/View.svg":()=>n.e(42844).then(n.bind(n,42844)),"./icons/VisitorCenter.svg":()=>n.e(7576).then(n.bind(n,7576)),"./icons/Wallow.svg":()=>n.e(56408).then(n.bind(n,56408)),"./icons/Washout.svg":()=>n.e(65244).then(n.bind(n,65244)),"./icons/WaterCrossing.svg":()=>n.e(59563).then(n.bind(n,59563)),"./icons/WaterSource.svg":()=>n.e(58248).then(n.bind(n,58248)),"./icons/WatercraftInspection.svg":()=>n.e(99328).then(n.bind(n,99328)),"./icons/Waterfall.svg":()=>n.e(80504).then(n.bind(n,80504)),"./icons/Webcam.svg":()=>n.e(87464).then(n.bind(n,87464)),"./icons/Wetland.svg":()=>n.e(2764).then(n.bind(n,2764)),"./icons/Wildflower.svg":()=>n.e(49400).then(n.bind(n,49400)),"./icons/Windsurfing.svg":()=>n.e(46632).then(n.bind(n,46632)),"./icons/Wolf.svg":()=>n.e(90252).then(n.bind(n,90252)),"./icons/XCSkiing.svg":()=>n.e(73076).then(n.bind(n,73076))}),`./icons/${i}.svg`)).default;if(!a)return;const o=oe((t.properties["waypoint-color"]??r.waypointColor).toLowerCase()),s=await async function(t,e="#f30",i="#b5342b"){const r=document.createElement("canvas"),n=r.getContext("2d");if(!n)return;const a=t=>`data:image/svg+xml;utf8,${encodeURIComponent(t)}`,o=document.createElement("img");await new Promise((t=>{o.onload=function(){r.width=o.width,r.height=o.height,n.drawImage(o,0,0),t(o)},o.src=a(`<svg xmlns="http://www.w3.org/2000/svg" width="58pt" height="104" viewBox="0 0 58 78">\n      <path\n        style="stroke:none;fill-Rule:nonzero;fill: ${e};fill-opacity: 1"\n        d="M28.844 0C12.926 0 0 12.828 0 28.617c0 6.598 2.418 12.496 5.977 17.453C28.844 77.86 24.55 77.86 28.844 77.86c4.293 0 0 0 22.87-31.797 3.556-4.95 5.97-10.868 5.97-17.446C57.688 12.828 44.777 0 28.844 0Zm0 0"\n      />\n      <path\n        style="stroke:none;fill-Rule:nonzero;fill: ${i};fill-opacity: 1"\n        d="M49.648 28.707c0 11.348-9.253 20.508-20.687 20.508-11.418 0-20.688-9.16-20.688-20.508 0-11.32 9.27-20.504 20.688-20.504 11.434 0 20.687 9.184 20.687 20.504Zm0 0"\n      /></svg>`)}));const s=await(await fetch(t)).text(),l=document.createElement("img");return await new Promise((t=>{l.onload=function(){const e=r.width/4;n.drawImage(l,e,e,2*e,2*e),t(l)},l.src=a(s)})),{src:r.toDataURL(),width:r.width,height:r.height}}(a,o.color,o.circleColor);if(!s)return;const l=document.createElement("div");l.style.backgroundImage=`url(${s.src})`,l.style.width="50px",l.style.height="50px",l.style.backgroundSize="contain",l.style.backgroundRepeat="no-repeat",l.style.backgroundPosition="center",l.style.pointerEvents="none",l.classList.add("marker"),t.id&&l.setAttribute("data-mid",`${t.id}`);const[c,h]=t.geometry.coordinates;e.addMarker({location:[c,h],element:l})}))}const ue={admin_bounds$country:["topo","aerial","hybrid"],admin_bounds$country$dark:["topo"],admin_bounds$country$light:["aerial","hybrid"],admin_bounds$county_border_label:["topo","aerial","hybrid"],admin_bounds$county_border_label$dark:["topo"],admin_bounds$county_border_label$light:["aerial","hybrid"],admin_bounds$county_dash:["topo","aerial","hybrid"],admin_bounds$county_dash$dark:["topo"],admin_bounds$county_dash$light:["aerial","hybrid"],admin_bounds$county_highlight:["topo","aerial","hybrid"],admin_bounds$county_highlight$dark:["topo"],admin_bounds$county_highlight$light:["aerial","hybrid"],admin_bounds$state_border_label:["topo","aerial","hybrid"],admin_bounds$state_border_label$dark:["topo"],admin_bounds$state_border_label$light:["aerial","hybrid"],admin_bounds$state_centroid_label$dark:["topo"],admin_bounds$state_centroid_label$light:["aerial","hybrid"],admin_bounds$state_highlight:["topo","aerial","hybrid"],admin_bounds$state_highlight$dark:["topo"],admin_bounds$state_highlight$light:["aerial","hybrid"],admin_bounds$state:["topo","aerial","hybrid"],admin_bounds$state$dark:["topo"],admin_bounds$state$light:["aerial","hybrid"],background:["topo"],background$dark:["topo"],"background-legacy":["topo"],"background-legacy$dark":["topo"],"contour$line-offset$light":["hybrid"],hillshade$:["topo"],hillshade$dark:["topo"],land_cover$fill:["topo"],land_cover$fill$dark:["topo"],natural_glacier$label$dark:["topo"],natural_glacier$label$light:["aerial","hybrid"],natural_lake$label$dark:["topo"],natural_lake$label$light:["aerial","hybrid"],natural_places$geo_features$dark:["topo"],natural_places$geo_features$light:["aerial","hybrid"],natural_places$label$dark:["topo"],natural_places$label$light:["aerial","hybrid"],natural_places$mountain_ranges$dark:["topo"],natural_places$mountain_ranges$light:["aerial","hybrid"],natural_places$water_features$dark:["topo"],natural_places$water_features$light:["aerial","hybrid"],ocean$area_border$dark:["topo"],ocean$area_fill$dark:["topo"],ocean$area_inner_border1$dark:["topo"],ocean$area_inner_border2$dark:["topo"],path$line_casing$light:["aerial","hybrid"],path$line_dash$dark:["topo"],path$line_dash$light:["aerial","hybrid"],path$line_label$dark:["topo"],path$line_label$light:["aerial","hybrid"],path$line_selected_casing:["topo","aerial","hybrid"],path$line_selected:["topo","aerial","hybrid"],path$urban_line_dash$dark:["topo"],path$urban_line_dash$light:["aerial","hybrid"],pois$circle$dark:["topo"],pois$circle$light:["aerial","hybrid"],pois$icon$dark:["topo"],pois$icon$light:["aerial","hybrid"],pois$square$dark:["topo"],pois$square$light:["aerial","hybrid"],populated_places_capitals$dark:["topo"],populated_places_capitals$light:["aerial","hybrid"],populated_places$dark:["topo"],populated_places$light:["aerial","hybrid"],rec_point$tier_1$dark:["topo"],rec_point$tier_1$light:["aerial","hybrid"],rec_point$tier_2$dark:["topo"],rec_point$tier_2$light:["aerial","hybrid"],rec_point$tier_3$dark:["topo"],rec_point$tier_3$light:["aerial","hybrid"],rec_point$tier_4$dark:["topo"],rec_point$tier_4$light:["aerial","hybrid"],river$area_border$dark:["topo"],river$area_fill$dark:["topo"],river$area_inner_border1$dark:["topo"],river$area_inner_border2$dark:["topo"],tileserver_aerial:["aerial","hybrid"],transportation_roads$bridge_casing$dark:["topo"],transportation_roads$bridge_fill$dark:["topo"],transportation_roads$closed$dark:["topo"],transportation_roads$closed$light:["aerial","hybrid"],transportation_roads$exits$dark:["topo"],transportation_roads$exits$light:["aerial","hybrid"],transportation_roads$ferry_label$dark:["topo"],transportation_roads$ferry_label$light:["aerial","hybrid"],transportation_roads$ferry_private_labels$dark:["topo"],transportation_roads$ferry_private_labels$light:["aerial","hybrid"],transportation_roads$ferry_private$dark:["topo"],transportation_roads$ferry_private$light:["aerial","hybrid"],transportation_roads$ferry$dark:["topo"],transportation_roads$ferry$light:["aerial","hybrid"],transportation_roads$hwy_shields$dark:["topo"],transportation_roads$hwy_shields$light:["aerial","hybrid"],transportation_roads$minor_road_bridge_casing$dark:["topo"],transportation_roads$minor_road_bridge_casing$light:["aerial","hybrid"],transportation_roads$minor_road_bridge_fill$dark:["topo"],transportation_roads$minor_road_bridge_fill$light:["aerial","hybrid"],transportation_roads$minor_road_casing$dark:["topo"],transportation_roads$minor_road_casing$light:["aerial","hybrid"],transportation_roads$minor_road_fill$dark:["topo"],transportation_roads$minor_road_fill$light:["aerial","hybrid"],transportation_roads$minor_road_tunnel_casing$dark:["topo"],transportation_roads$minor_road_tunnel_casing$light:["aerial","hybrid"],transportation_roads$minor_road_tunnel_fill$dark:["topo"],transportation_roads$minor_road_tunnel_fill$light:["aerial","hybrid"],transportation_roads$minor_road_urban_bridge_casing$dark:["topo"],transportation_roads$minor_road_urban_bridge_casing$light:["aerial","hybrid"],transportation_roads$minor_road_urban_bridge_fill$dark:["topo"],transportation_roads$minor_road_urban_bridge_fill$light:["aerial","hybrid"],transportation_roads$minor_road_urban_casing$dark:["topo"],transportation_roads$minor_road_urban_casing$light:["aerial","hybrid"],transportation_roads$minor_road_urban_fill$dark:["topo"],transportation_roads$minor_road_urban_fill$light:["aerial","hybrid"],transportation_roads$minor_road_urban_tunnel_casing$dark:["topo"],transportation_roads$minor_road_urban_tunnel_casing$light:["aerial","hybrid"],transportation_roads$minor_road_urban_tunnel_fill$dark:["topo"],transportation_roads$minor_road_urban_tunnel_fill$light:["aerial","hybrid"],transportation_roads$motorway_bridge_casing$dark:["topo"],transportation_roads$motorway_bridge_casing$light:["aerial","hybrid"],transportation_roads$motorway_bridge_fill$dark:["topo"],transportation_roads$motorway_bridge_fill$light:["aerial","hybrid"],transportation_roads$motorway_bridge_shadow$dark:["topo"],transportation_roads$motorway_casing$dark:["topo"],transportation_roads$motorway_casing$light:["aerial","hybrid"],transportation_roads$motorway_fill$dark:["topo"],transportation_roads$motorway_fill$light:["aerial","hybrid"],transportation_roads$motorway_trunk_casing$dark:["topo"],transportation_roads$motorway_trunk_fill$dark:["topo"],transportation_roads$motorway_trunk_fill$light:["aerial","hybrid"],transportation_roads$motorway_trunk_link_bridge_casing$dark:["topo"],transportation_roads$motorway_trunk_link_bridge_casing$light:["aerial","hybrid"],transportation_roads$motorway_trunk_link_bridge_fill$dark:["topo"],transportation_roads$motorway_trunk_link_bridge_fill$light:["aerial","hybrid"],transportation_roads$motorway_trunk_link_bridge_shadow$dark:["topo"],transportation_roads$motorway_trunk_link_casing$dark:["topo"],transportation_roads$motorway_trunk_link_casing$light:["aerial","hybrid"],transportation_roads$motorway_trunk_link_fill$dark:["topo"],transportation_roads$motorway_trunk_link_fill$light:["aerial","hybrid"],transportation_roads$motorway_trunk_link_tunnel_casing$dark:["topo"],transportation_roads$motorway_trunk_link_tunnel_casing$light:["aerial","hybrid"],transportation_roads$motorway_trunk_link_tunnel_fill$dark:["topo"],transportation_roads$motorway_trunk_link_tunnel_fill$light:["aerial","hybrid"],transportation_roads$motorway_tunnel_casing$dark:["topo"],transportation_roads$motorway_tunnel_casing$light:["aerial","hybrid"],transportation_roads$motorway_tunnel_fill$dark:["topo"],transportation_roads$motorway_tunnel_fill$light:["aerial","hybrid"],transportation_roads$oneway_icons$dark:["topo"],transportation_roads$oneway_icons$light:["aerial","hybrid"],transportation_roads$primary_bridge_casing$dark:["topo"],transportation_roads$primary_bridge_casing$light:["aerial","hybrid"],transportation_roads$primary_bridge_fill$dark:["topo"],transportation_roads$primary_bridge_fill$light:["aerial","hybrid"],transportation_roads$primary_bridge_shadow$dark:["topo"],transportation_roads$primary_casing$dark:["topo"],transportation_roads$primary_casing$light:["aerial","hybrid"],transportation_roads$primary_fill$dark:["topo"],transportation_roads$primary_fill$light:["aerial","hybrid"],transportation_roads$primary_tunnel_casing$dark:["topo"],transportation_roads$primary_tunnel_casing$light:["aerial","hybrid"],transportation_roads$primary_tunnel_fill$dark:["topo"],transportation_roads$primary_tunnel_fill$light:["aerial","hybrid"],transportation_roads$private_bridge_casing$dark:["topo"],transportation_roads$private_bridge_casing$light:["aerial","hybrid"],transportation_roads$private_bridge_fill$dark:["topo"],transportation_roads$private_bridge_fill$light:["aerial","hybrid"],transportation_roads$private_casing$dark:["topo"],transportation_roads$private_casing$light:["aerial","hybrid"],transportation_roads$private_fill$dark:["topo"],transportation_roads$private_fill$light:["aerial","hybrid"],transportation_roads$private_service_track_path_urban_bridge_fill$dark:["topo"],transportation_roads$private_service_track_path_urban_bridge_fill$light:["aerial","hybrid"],transportation_roads$private_service_track_path_urban_fill$dark:["topo"],transportation_roads$private_service_track_path_urban_fill$light:["aerial","hybrid"],transportation_roads$private_service_urban_bridge_casing$dark:["topo"],transportation_roads$private_service_urban_bridge_casing$light:["aerial","hybrid"],transportation_roads$private_service_urban_casing$dark:["topo"],transportation_roads$private_service_urban_casing$light:["aerial","hybrid"],transportation_roads$private_track_bridge_casing$dark:["topo"],transportation_roads$private_track_bridge_casing$light:["aerial","hybrid"],transportation_roads$private_track_casing$dark:["topo"],transportation_roads$private_track_casing$light:["aerial","hybrid"],transportation_roads$private_track_urban_bridge_casing$dark:["topo"],transportation_roads$private_track_urban_bridge_casing$light:["aerial","hybrid"],transportation_roads$private_track_urban_casing$dark:["topo"],transportation_roads$private_track_urban_casing$light:["aerial","hybrid"],transportation_roads$private_tunnel_casing$dark:["topo"],transportation_roads$private_tunnel_casing$light:["aerial","hybrid"],transportation_roads$private_tunnel_fill$dark:["topo"],transportation_roads$private_tunnel_fill$light:["aerial","hybrid"],transportation_roads$private_urban_bridge_casing$dark:["topo"],transportation_roads$private_urban_bridge_casing$light:["aerial","hybrid"],transportation_roads$private_urban_bridge_fill$dark:["topo"],transportation_roads$private_urban_bridge_fill$light:["aerial","hybrid"],transportation_roads$private_urban_casing$dark:["topo"],transportation_roads$private_urban_casing$light:["aerial","hybrid"],transportation_roads$private_urban_fill$dark:["topo"],transportation_roads$private_urban_fill$light:["aerial","hybrid"],transportation_roads$railroad_hash$dark:["topo"],transportation_roads$railroad_hash$light:["aerial","hybrid"],transportation_roads$railroad$dark:["topo"],transportation_roads$railroad$light:["aerial","hybrid"],transportation_roads$road_labels_tunnel$dark:["topo"],transportation_roads$road_labels_tunnel$light:["aerial","hybrid"],transportation_roads$road_labels$dark:["topo"],transportation_roads$road_labels$light:["aerial","hybrid"],transportation_roads$road_private_labels$dark:["topo"],transportation_roads$road_private_labels$light:["aerial","hybrid"],transportation_roads$secondary_road_bridge_casing$dark:["topo"],transportation_roads$secondary_road_bridge_casing$light:["aerial","hybrid"],transportation_roads$secondary_road_bridge_fill$dark:["topo"],transportation_roads$secondary_road_bridge_fill$light:["aerial","hybrid"],transportation_roads$secondary_road_bridge_shadow$dark:["topo"],transportation_roads$secondary_road_casing$dark:["topo"],transportation_roads$secondary_road_casing$light:["aerial","hybrid"],transportation_roads$secondary_road_fill$dark:["topo"],transportation_roads$secondary_road_fill$light:["aerial","hybrid"],transportation_roads$secondary_road_tunnel_casing$dark:["topo"],transportation_roads$secondary_road_tunnel_casing$light:["aerial","hybrid"],transportation_roads$secondary_road_tunnel_fill$dark:["topo"],transportation_roads$secondary_road_tunnel_fill$light:["aerial","hybrid"],transportation_roads$service_track_path_urban_bridge_casing$dark:["topo"],transportation_roads$service_track_path_urban_bridge_casing$light:["aerial","hybrid"],transportation_roads$service_track_path_urban_bridge_fill$dark:["topo"],transportation_roads$service_track_path_urban_bridge_fill$light:["aerial","hybrid"],transportation_roads$service_track_path_urban_casing$dark:["topo"],transportation_roads$service_track_path_urban_casing$light:["aerial","hybrid"],transportation_roads$service_track_path_urban_fill$dark:["topo"],transportation_roads$service_track_path_urban_fill$light:["aerial","hybrid"],transportation_roads$track_path_bridge_casing$dark:["topo"],transportation_roads$track_path_bridge_casing$light:["aerial","hybrid"],transportation_roads$track_path_casing$dark:["topo"],transportation_roads$track_path_casing$light:["aerial","hybrid"],transportation_roads$unclassified_casing$dark:["topo"],transportation_roads$unclassified_casing$light:["aerial","hybrid"],water$area_border:["topo"],water$area_border$dark:["topo"],water$area_fill:["topo"],water$area_fill$dark:["topo"],water$area_fill$light:["hybrid"],water$area_inner_border:["topo"],water$area_inner_border1$dark:["topo"],water$area_inner_border1$light:["hybrid"],water$area_inner_border2$dark:["topo"],water$area_inner_border2$light:["hybrid"],water$area_label$dark:["topo"],water$area_label$light:["aerial","hybrid"],water$area_pattern:["topo"],"water$area_pattern-basin$dark":["topo"],"water$area_pattern-basin$light":["hybrid"],"water$area_pattern-intermittent$dark":["topo"],"water$area_pattern-intermittent$light":["hybrid"],"water$area_pattern-wetland$dark":["topo"],"water$area_pattern-wetland$light":["hybrid"],"water$area-intermittent$dark":["topo"],"water$area-wetland-basin-dam$dark":["topo"],"water$glacier_border-innerglow1$dark":["topo"],"water$glacier_border-innerglow2$dark":["topo"],water$glacier_border:["topo"],water$glacier_border$dark:["topo"],water$glacier_fill:["topo"],water$glacier_fill$dark:["topo"],water$glacier_label$dark:["topo"],water$glacier_label$light:["aerial","hybrid"],water$intermittent_line$dark:["topo"],water$intermittent_line$light:["hybrid"],water$river_label$dark:["topo"],water$river_label$light:["aerial","hybrid"],water$river_line$dark:["topo"],water$river_line$light:["hybrid"]};function de(t,e){let i=t;return i=function(t,e){return t.layers.forEach(((e,i)=>{if(!e.id.includes("client_style")||"custom"===e.type)return;const r=new Date,n=new Date(r.getFullYear(),0,0),a=r.valueOf()-n.valueOf()+60*(n.getTimezoneOffset()-r.getTimezoneOffset())*1e3,o=Math.floor(a/864e5),s=["any",["has",`data:open:${o}`],["has","data:open:all_year"]],l=["!",["any",["has",`data:open:${o}`],["has","data:open:all_year"]]],c=e.id.includes("client_style_open")?s:l,h={...e,filter:["all",["all",e.filter,c]]};t.layers[i]=h})),t}(i),i}function pe(t,e){let i=t;return i=function(t){if(!t.sources.mask||"geojson"!==t.sources.mask.type)return t;const e=t.sources.mask;if(!e.data||"string"==typeof e.data||"Feature"!==e.data.type||"Polygon"!==e.data.geometry.type||2!==e.data.geometry.coordinates.length)return t;const i={type:"Polygon",coordinates:[e.data.geometry.coordinates[1]]},r=Qt(i);return r&&t.layers.forEach((e=>{if(ue.hasOwnProperty(e.id)||"custom"===e.type)return;const i=e.source;if("string"==typeof i&&!["mask","custom"].includes(i)){const e=t.sources[i];("vector"===e.type||"raster"===e.type)&&(e.bounds=r)}})),t}(i),i}class me{constructor({brand:t,layers:e,baseMap:i,styleUrl:r,style:n,events:a,disableBuiltInStyleLayerManagement:o}){this.brand="onx",this.layers=[],this.baseMap="aerial",this.styleUrl=void 0,this.style=void 0,this.hasTerrain=!1,this.initialized=!1,this.disableBuiltInStyleLayerManagement=!1,t&&(this.brand=t),e&&(this.layers=e),i&&(this.baseMap=i),o&&(this.disableBuiltInStyleLayerManagement=!0),n&&(this.style=JSON.parse(JSON.stringify(n)),this.stylesheetProvider="Raw"),r&&(this.styleUrl=r,this.stylesheetProvider="Remote"),this.stylesheetProvider||(this.setMapMakerUrl(),this.stylesheetProvider="MapMaker"),this.events=a||new re}setMapMakerUrl(){const t=new URL("https://www.onxmaps.com/api/v2/map-maker/stylesheet");t.searchParams.append("app",this.brand),t.searchParams.append("layers",this.layers.join()),this.styleUrl=t}emitStyleUpdated(){clearTimeout(this.timeoutStyleUpdated),this.timeoutStyleUpdated=setTimeout((()=>{this.events.emit("map-x-style-updated",this.style)}),200)}async process({brand:t,layers:e,baseMap:i}){let r=this.style,n=!1;const a={brand:t,baseMap:i,layers:e};return(t!==this.brand||e!==this.layers)&&(n=!0),this.baseMap=i,this.brand=t,this.layers=e,"MapMaker"===this.stylesheetProvider&&n&&(this.setMapMakerUrl(),this.initialized=!1),this.styleUrl&&!this.initialized&&(r=await(await fetch(this.styleUrl)).json()),r&&!this.disableBuiltInStyleLayerManagement&&(this.initialized||(r=function(t){return Object.keys(t.sources).forEach((e=>{const i=t.sources[e];"vector"===i.type&&(null==i||!i.promoteId)&&!["custom"].includes(e)&&(i.promoteId="id")})),t}(r),r=pe(r),r=de(r)),r=function(t,e){var i;return null==(i=null==t?void 0:t.layers)||i.forEach((t=>{if("custom"===t.type||!t.layout||!t.layout.visibility)return;let i=t.id;ue.hasOwnProperty(i)?ue[i].includes(e)?t.layout.visibility="visible":t.layout.visibility="none":(i.includes("$")&&([i]=t.id.split("$")),t.layout.visibility="none")})),t}(r,a.baseMap),r=function(t,e){return t.layers.forEach(((t,i)=>{if("custom"===t.type||!t.layout||!t.layout.visibility)return;let r=t.id;ue[r]||(r.includes("$")&&([r]=t.id.split("$")),e.some((t=>t===r))||"custom"===r||"mask"===r?t.layout.visibility="visible":t.layout.visibility="none")})),t}(r,e)),r&&this.setStyle(r),this.initialized=!0,r}getStyle(){return this.style}setStyle(t){this.style=JSON.parse(JSON.stringify(t)),this.addTerrain(),this.emitStyleUpdated()}setHasTerrain(t){this.hasTerrain=t,this.addTerrain(),this.emitStyleUpdated()}addTerrain(){this.hasTerrain&&this.style&&this.style.sources["elevation-dem"]&&(this.setTerrain("elevation-dem",1.5),this.setFog())}setTerrain(t,e){this.style&&(this.style.terrain={source:t,exaggeration:e})}setFog(){this.style&&(this.style.fog={range:[-1,20],color:"white","horizon-blend":.05})}setTerrainExaggeration(t){this.style&&this.style.terrain&&(this.style.terrain.exaggeration=t),this.emitStyleUpdated()}addSource(t,e){this.style&&(Object.assign(this.style.sources,{[t]:e}),this.emitStyleUpdated())}addLayer(t){if(!this.style||this.style.layers.includes(t))return;const e=this.style.layers.filter((e=>e.id!==t.id));e.push(t),this.style.layers=e,this.emitStyleUpdated()}getSourceData(t){if(!this.style)return;const e=this.style.sources[t];return e&&"geojson"===e.type&&e.data&&"string"!=typeof e.data&&"FeatureCollection"===e.data.type?e.data:void 0}}class fe{constructor(t){this.events=t.events||new re}}class ge{constructor(t){this.setLonLat=t.setLonLat,this.destroy=t.destroy}}class ye extends fe{constructor(t){super(t)}setStyle(t){}triggerRepaint(){}destroy(){}queryRenderedFeatures(t){return[]}queryTerrainElevation(t){return null}getSource(t){}setCenter(t){}getCenter(){return[0,0]}setPitch(t){}getPitch(){return 0}setZoom(t){}getZoom(){return 0}setBearing(t){}getBearing(){return 0}setFeatureState(t,e){}getBounds(){return[0,0,0,0]}fitBounds(t,e){}flyTo(t,e){}easeTo(t,e){}rotateTo(t,e){}addImage(t,e){}addMarker(t){return new ge({setLonLat:()=>{},destroy:()=>{}})}followCam(t,e){}}class _e{constructor({brand:t,zoom:e,center:i,pitch:r,bearing:n,baseMap:a,layers:o,maxBounds:s,minZoom:l,maxZoom:c,bounds:h,styleUrl:u,style:d,engine:p,transformRequest:m,disableBuiltInStyleLayerManagement:f,isAutoSelectFeatureOnClickEnabled:g=!0}){this.ready=!1,this.disableBuiltInStyleLayerManagement=!1,this.brand="onx",this.baseMap="aerial",this.layers=[],this.center=[-98.5855,39.8333],this.pitch=0,this.bearing=0,this.zoom=4,this.minZoom=0,this.maxZoom=22,this.bounds=void 0,this.maxBounds=void 0,this.loaded=!1,this.progress=0,this.feature=void 0,this.baseEngine=ye,this.onStyleUpdated=()=>{const t=this.stylesheet.getStyle();t&&(this.engine.setStyle(t),t.sources.custom&&he(this.brand,this.engine,t))},t&&(this.brand=t),i&&(this.center=i),"number"==typeof e&&(this.zoom=e),"number"==typeof r&&(this.pitch=r),"number"==typeof n&&(this.bearing=n),"number"==typeof l&&(this.minZoom=l),"number"==typeof c&&(this.maxZoom=c),s&&(this.maxBounds=s),h&&(this.bounds=h),a&&(this.baseMap=a),o&&(this.layers=o),p&&(this.baseEngine=p),f&&(this.disableBuiltInStyleLayerManagement=f),this.isAutoSelectFeatureOnClickEnabled=g,this.transformRequest=m,this.container=document.createElement("div"),this.container.setAttribute("aria-label","map"),this.container.setAttribute("style","position: absolute; height: 100%; width: 100%; top: 0; left: 0;z-index: 0;"),this.events=new re(this.container),this.stylesheet=new me({brand:this.brand,layers:this.layers,baseMap:this.baseMap,styleUrl:u,style:d,events:this.events,disableBuiltInStyleLayerManagement:this.disableBuiltInStyleLayerManagement}),this.stylesheet.setHasTerrain(!0),this.events.subscribe("map-x-style-updated",this.onStyleUpdated),this.engine=new ye({container:this.container,center:this.center,bounds:this.bounds,minZoom:this.minZoom,maxZoom:this.maxZoom,zoom:this.zoom,bearing:this.bearing,maxBounds:this.maxBounds,events:this.events,testMode:!1,transformRequest:m}),this.state={brand:this.brand,feature:this.feature,loaded:this.loaded,progress:this.progress,pitch:this.pitch,bearing:this.bearing,zoom:this.zoom,center:this.center}}makeReady(){this.baseEngine!==ye&&(this.engine=new this.baseEngine({container:this.container,center:this.center,bounds:this.bounds,minZoom:this.minZoom,maxZoom:this.maxZoom,zoom:this.zoom,bearing:this.bearing,maxBounds:this.maxBounds,events:this.events,transformRequest:this.transformRequest,testMode:!1})),this.ready=!0,this.events.emit("map-x-ready",void 0),this.load()}destroy(){this.engine.destroy()}async processStyleSheet(){await this.stylesheet.process({brand:this.brand,layers:this.layers,baseMap:this.baseMap})}async load(){this.progress=.25;const t=()=>{this.timeoutFalseProgress=setTimeout(t,1500),this.progress+=.1,this.progress>=1?(this.loaded=!0,this.events.emit("map-x-loaded",void 0)):this.engine.triggerRepaint()};this.timeoutFalseProgress=setTimeout(t,1500),this.events.once("map-x-load",(async()=>{this.engine.addImage("PIN",function(t){let e="";switch(t){case"hunt":e="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACEAAAAsCAYAAADretGxAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAQkSURBVHgBrVjNahRBEP56Z/wFwwqK0QWJnhQ8xF88rk+geQL1JiioT5Ddk1cDenb1BdSbt6xX/xJB9CDIKsQf8LAmELMxs2NVz85uT093T8+QDyY7PV1d/XV1VXV1BDwRz6JOP7MIcRkxmvTUITAz6u7T05NPjOcYoiuWZdsLokhATl7DbZK8Q806/NFBhMdEplsk6CQRn8F8hclNZNouyxhJ0OpnEOARvTaxPeiRNefEayzDh8SIwCK9zsCCrRjYpGd9mLR3kZaAnr01FOGaeIvHThJFBH5vJc9qBCOYzL4AaOygdzuhOSLyzE7iHJbIu2f1UWs06ZcBMIjhjcbOhIwBffKR06qPjPlKJzQQ+EUr/7RRjgBjZRP48JfGDXNd9ZG/IUNCboNAK6foH/B1MGlPnW+iCKoM+8znQeJDGpq06GsZEsRsXpdiBbyaFI2b8zjxZFH+2mCSYT3fNg3CYjJnwH9aR3AfWi74SKaMFOWNWy35PnWhKX/XXr/MEbDJMJGpIOes9VYDL9vf0Qvis7hCH26ovWkUpAqP3+tkRuuTqARUGe4frPRkm0P6QIgsYvxp/8CLoHWYCAhcVPvYfKkjSiVCjCfWifCvToCx8rCN30874zbry1lDYJpILAiyBOeFZvo9IuG36zmdciKXP+gEVh60ct+PUthO62EbYT/zyoTl+hBmxaSUlVcl4NA9wyQyDunKB0VEXAQYmyYSIerF2V5HHFfrc4BJ9NUPoUPYFAWZ/hJ+o5PoqR/2BKhEwIeI8ZTdwnKNSrH36rf0WPYhIH3A4CM2IlP5BfbpIOuHFKtdalxVe6bD5NyQAx15QHVCfVIew8lq9VVXtnfSwur5vZbZji3BZ3vGLziWU2uwEn21OgFT1HA7JcA4aHK2OKkrgvZPbNDZwRnzRNpXE4mjr41Cao2VjbKmLQxdMmyF47sSvQqBnniH6/wqP1MxwyX8oq6Y6wE1wfAE6upMMMmc2mNwSkHF75ukfBhzo/TdgeYbnMK5oLFlUR+wBQwHF1vhWNqc8ItkaZ/xDfaLk7sNSjzAW8AWsIzNOFC2xkyO9aemUXy0/6TTdb0gKTJxjq5D5Nyh+VazQIXuHSuJEREucG7DAt4aLny54o7iycS88v1hsveh7UpF20DRyEVu300iufYtKffM7UOEY6abWC6RSpa1JHS2FcJ+FbTeRYu2pRS0aPAmMSKyBOTvIqVh2YYU7npiO7ZFuG/kyTSu8XyLjlFc09nRTbOicx54oPK2FGxDCr/yrsq2eGzDRNQTdHdsqVc3t7A7GnT4F7pDCtnY859hQ1xCCXiTKJHEFsr8564UCUnkjSwFn1kF2FKRTHKlUP7eEeEutCNfQbusFSqRkJPEWDB0LZMzdlAB5S3BMDlphDlURCUSYydNiYhq25DiP2v5rGkhWFSCAAAAAElFTkSuQmCC";break;case"backcountry":e="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACEAAAAsCAYAAADretGxAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAR6SURBVHgBrVi9jxtFFP/Nrn3eSwjyRRAEKMhJgRDXJEqTBsn8BXAS1CQdoonpyFGct7mLRHP5C7jUIBE6unMkCihQTEGKFCeLU3JREiXOp+2zvZP3Zr2+/ZjZL/knrb078/bNb+a9ee/NCuREvSXrQwfnhMAXEGhKaqLmBvdJgb4l0fOAngB+h4fO8Jro5dUtsgTU4MdwhQZqCakGzosdInODyHSyBFNJOOtyo8TgOjJu2spoSTg/yAZs/AyJJhaD3nSMtfFPoos8JBQBC7uY2VsH6U0gxwPI0QtfSXUZsCqwaieQColLwy1xI5VEFoHp8wNMX9yHN3iq64aoOLCOnUTl5Fl1rwM58NrrLXHTSGJ5Xd4mrz8Xf5EHHT/8j2Y/RF4wEb7iIP194eF82Ees4EY5oYbAtP8/Du/9U4gAY/JkD6P9vyAn0fcEb21B/haCIqHMALR1isaP786fm5+uIAthGTl6icODrvKhGJMmTfpShAT9bsSVsQImEWDj67PY3big/k3QySg9j+5qxaMkkNyKhw+6EeXtr3zF/K8jkiZjcOYGWaDJN/bSVfklheJvw73+Ljjw2dHy7ny3GnlbLTkZ99adpwkCYRnu7z3yfYJ9w377g4gMBcFnkz/dPypEoBmnyMwDdEiR+8teYvbhQeMEGPxO587R7Hkl+LKWQz5jUR4CRWTnR7kbjozsRKO9TkKpyQw6MIH2r3uJ9so7H6NS/yjS5rzGihXflkEUTJAgpay8LAGl+/Blou1VFQ0rnpw4HJuQRSSNgEm3baNuoSCkKNeXBosLkkiLXTUK63ZBGEX8JkKCrl6kwZAJswjkISJqbyXanCG6FiWTfyOClP2EVc1FgH1A5yMmIvZyNOxzMutvi75FQaeTEK6fnt9z0DERYCc0OSu/E84jKs0fPxUV8nCL/6zhEm7G/cKmvRysRhCsdATmA2qIxINVPFoqYoCqK2x03OHSZ+2LdP/JvFNYHLXm8Z6VseM3V1eM2zBNhleh+t6qrzcAVedUU1yekVGpvDmrqCIY7f8dCV68vOHZ6aCTqZ2+qHNKd7gp2nMSishVuUNP34SlOISrgsYQRfOgemqVTPF+tJFXYUucCR7n6zOsoRX3DUHF69KHF7T2zAKbgFcgQcAn4UZkww+c1i2B33RKp8/vY/JsP3NVmDg7tu/clWS/h+uDa6JlJMGorcttarwCA7hS8gZP6OqTucazgWknVR3Yx98l25/QDu6/jJ4zwHmODakk0JZ1Z4Tb1NPAouHhjO4klkxgbWIpcRmLh/EoaMx7WWYphNhuiMOYykebokWxvYvFkPg8rTu1nqDvDYswi5v1rSKVxHhTnaJdlAUlxyAqlibBYCWlzTLNt5K5yruSZnHzfjLKXRXS2bENJI+LWmTshjhyF7pUd2yz8lzCGbuhNIm8QYxzQ5Evd8VIEPhLnJxVQ1rQSlH/Ngqi8LmDZvp94phwRMItugqlSPAgdGq7Hm8nD+9S3w5KoDAJRUTjpFSSrqEkSpGYO+kRkVJmCPAGk6wPOnzrGZcAAAAASUVORK5CYII=";break;case"offroad":e="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACIAAAAuCAYAAABNhcu5AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAW8SURBVHgBtVlfTFtVGP/OuaUroUgnTgg4KJsBss3JyBIXDJHKHyVRNxKNJjOmmOhUjPCixidaH+beBi/EB6fwYGL0AUzMMAPSJov6ooONzAUm7DJk448phYEUaO/xfldvvb3/e52/pGnPPd/5zu98f8757ikBBxgcHPTl5+c3EEJ8giD48RmlNM4Y48U239LSMgFZgtgVxMmLH9jpzAU++KAw7t8L18AFG+Bhy1J/EvIgQYogAQ9DjNTwa6Q6uiYcHGhubo7a0W9JZHh42J/v3uwuYReD+4Vvxck3wS7ukiZYJvX8CqtttyJkSiQSiXRWpD4PlQoXfdkQ0CN0lz7bs04PhwOBQByyIfLz2KdfHBQuBH1sEu4HElAE1+mH/MpuRaC1tZUHO0SQxOHU2aAHlg0Vp5IMdhIMtjaZ1HbvIcC5AHK9FMwwTd/iZ3ef0ZDREPllrO/8odS5LiMSsaUUrIqfjTVBt9/tIeAtoFBU7pLI6eFX+j6/zD19TOkml1IAY6Jyt0OXxEZcgPnpXdjZZmAGtFIskZIIF5e5JEJqVAp9/ntwYFD8GZCfpe2I2YGB6YVZzcA/FlIwM7ljSUKNxdtJmL6yrRmHgV/F+hrGxsaCGiKF7rnucuEbn1rZ0lwSFmZ30+08fwNYQSmDMcRf35FiSglMglL2/XnRC740EbTGI8J3QbVCVIKrklEU6IZHX49I30bQk0E9d2aTGtly4WtfMpkMponk5OR07WXXNIK4EuUExYGQ9Bu/9ciYycR0AtwDS1BMfjiZJlICI0+pAxQHyr71iqaWJ5ChnkhJQinjVbgJ3axGAbuBsVLOSW6h0XMFMJUhgKaUiezEeTHPxbSsaMiQkdv4rSYhTRwJQ2yiP91GfV4flVJcxh6IA8+eu+oS4c9XZQoGltqMi5EQyCtXr1oPSEIeo8TWhiDtMzLQPbk0VoNParxsViWsn6aoGCewghEJSfemVncem/cjEc2BZrZfWJExIyHpTmh155DNAvODwQAMmKM+MyCROBY1SnAu4wF62aGEUWpbEsESD49oJXLzqCMSdsjk5mkPwjU4wiOR6D1yIKMD04tzEVskMCb0YsaIjNfHZbTRG1us4CoVj2J+nVRrqqaHSv4doLehySQwMI0CWL2h4QILCjOtvUoeA7HojkpPV+D4gDpO9pVyaats8FHNROrs0CODbRwrY29RpjX+JlIjVf0SkQQrHFolRzMEkITSKsqJjFLUTAatsa8kkwjG5u/k+V78nQ6EydFw5IjwSYNaOdYTyk0ITa1cpR70ZCpr92gCdZ6+wM9wbwcwPNIOW2R1Yay21Th41J2hwIqEnsz+yhwNCbTGFHtjAElgO6P38uhXPSeEjk71Totnz4J4CGKtmg3QHf5Dbt2UxSK6qqmnQm5nhHCSKwpNc+/w6kEYL2XiqnBlnjzrl0OUx1q18pg+iXlyCu5wJwPKZxqpkZGRhiq4ENnPhsAIGDNYTOMJLZeAOLnbI9YXhZw0uXofkoEuuULOhp9sPh0yJYJAFx0XPug0e69xip+4z/i6xlcr1M919/L6ple6pumZrN/orTBHX4pv09KAXp/h6Rvj6toWaGsc7hPQJTfZa2E5S2wTwQFT5N2w+hxyikn6Ub94I9Bj1G9ajzQ2Nvb8xr0Zhf8I3Lg2uSrT0s6yMFojj7fP0Rcdu2gDDsBNcsbQJbaJoIIZ0u7YRTfoe/2iZfut5GyVik5dZMclWRFBZOuif86SXiuXZE0EFc6z1l68rLODcfrxhFmWOCaCqBe35Smug7eSw7NkmytrgyyQ9evEilDbvkJOGPajS1bgibBdlzgmgteUt8jLmtJSxm3axq+7amy7xDERxJ9cdUhv+8c9Qyz9DK8w/xdcHvkytHWpjLFLnvTnx9GBcXAIRxZBJF0lPRi4chbdIqezDlAlbN/F60G8//KLfwKcEj8+8XpjSHSJ49LhLx7LrF2ctinyAAAAAElFTkSuQmCC";break;default:e="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACIAAAAuCAMAAAB6WzuLAAACeVBMVEUAAAD///+AgIDMzMyqqqq2trazs7O/v7/ExMS2tra8vLzCwsK5ubm/v7/CwsK6urq9vb2/v7+5ubm7u7u9vb25ubm/v7+8vLy+vr6/v7+7u7u7u7u+vr6+vr69vb29vb28vLy8vLy8vLy6urq6urq6urq+vr65ubm8vLy7u7u+vr68vLy8vLy7u7u5ubm8vLy6urq7u7u5ubm6urq4uLi2tra4uLi3t7e3t7e2tra1tbW1tbW0tLSzs7OxsbGzs7O1tbWzs7OwsLCysrK1tbWwsLC1tbWzs7O0tLSxsbG0tLS0tLSxsbGxsbG1tbWxsbG0tLS1tbWzs7O0tLS0tLS1tbW1tbWzs7O1tbW2trazs7O2tra2tra3t7e1tbW2traRkZGSkpKPj4+QkJC2tra3t7eQkJCUlJSWlpaXl5eenp6jo6OkpKSlpaWpqamurq63t7eLi4uRkZGSkpKenp6goKCjo6OkpKSoqKivr6+2tra3t7eFhYWKioqxsbGysrKzs7O0tLS1tbW2traAgICCgoK1tbW3t7e2tra4uLi5ubl1dXV+fn54eHhsbGxycnJ0dHRra2ttbW1wcHBjY2O7u7tcXFxeXl5hYWFjY2NnZ2dubm67u7tTU1NWVlZbW1tfX19gYGBsbGwiIiIjIyMkJCQlJSUmJiYnJycoKCgpKSkqKiosLCwtLS0uLi4vLy8xMTEyMjI0NDQ2NjY3Nzc4ODg7Ozs9PT0/Pz9CQkJDQ0NERERFRUVHR0dKSkpLS0tNTU1QUFBSUlJUVFRXV1dYWFhZWVlbW1teXl5gYGBmZmZpaWl6enp/f3+AgIChoaGnp6f+/v7///9u995qAAAAo3RSTlMAAQIFBgcKDA0OExUWGBkaGxwdHh8hKCorLC0xMzs+QkhQWFlcXV5fX2JiY2dtbm5vcXV9hImJjY6PmJyqq62xsrO1tru8vb+/wMTGx8jJy8zP0tPX2drc39/h5ens7+/x8fLy8vLz8/Pz8/Pz8/Pz8/T09PT09PT09PT09fX19fX19fX29vb29/f3+Pj5+vr6+/v7/Pz9/f39/f39/v7+/v7+3MTMOAAAAAFiS0dE0uDYrrAAAAIVSURBVDjLY2BAAnxKZk6+/q5WOuIMWAGLdlBHwqKjB/YfPlWTH2PCg6GAUSU24+DSxTCwo6fdnA1VBYdLzq7FKGBjbbQEsgqhsNZli9HBvCpFhAqx+CmLsYDd9eowFdwx0xZjBdsa5aEu9ehejAPsi4d4TCV3KS4li3ttweERuwfKX3IUJnN0CZSxqk4aqEQzE6bi/MVzENaZixdgamY5ApUEHYSpuHQJoubMxUuXYGpWd3Ix8HZAXXIMKHHp4tnFi8+CGcegxiSrMSglwhxwBix1DkrBRE/aMJjNhjsfoh1mGBTsDGdwPoLwItgAFDMWL17TxeBzYDG6GmQVi5fMIaxkKoPdcfwWrU9lsDyN37nboxjUkvB7+oQ9A3/HErxBV6jFwBCxF18ErGgTYmDQTcMXjQvcgdHIXr0Zd2JYkgdOd8bpOFPU4pkBkDwWOReXig3N0HwpW78Oh5JiU1gWsCjCrmJhKAtMCXPIdGwqNjdJIvKaeNtWTBVLSw2Qc6xRFmZGmezNiKyEya8PXcXOFAHUokG4ahuqiuUVyugFjE42qlUT3DDLIK+JyCp2FAhgFmQizUhWLS1XxVbY6ZcsgSuZ5I61PGQKng9TsalZFHuZKdOwFhY3xgw4gHULRMWBaFZcSjjjdoNUrKxUYMAJNLJBLu53wK2CgSlwxuLFW6oF8ShhkKo6fqjMkAEvkHP21EMTAgAanp5QvgXe6gAAAABJRU5ErkJggg=="}return e}(this.brand)),this.engine.addImage("mask","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAAECAYAAACp8Z5+AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAzSURBVHgBTcpBDQAgDEPR4gAJWEEJVnCIBOak+9lpTd7hJ5Xti4kHqwf76oE16iYFNk4CgW0xQmFCEacAAAAASUVORK5CYII="),this.progress=1,setTimeout((()=>{clearTimeout(this.timeoutFalseProgress),this.pitch&&this.zoom&&this.engine.easeTo({pitch:this.pitch,zoom:this.zoom,bearing:this.bearing,duration:3e3}),this.loaded=!0,this.engine.triggerRepaint()}),1500)})),this.isAutoSelectFeatureOnClickEnabled&&this.events.subscribe("map-x-click",(t=>{const[e,i]=t.detail.point,r=[e-10,i-10,e+10,i+10],n=this.engine.queryRenderedFeatures(r);if(n.length){const[t]=n;this.setFeature(t)}else this.setFeature(void 0)})),this.events.subscribe("map-x-render",(()=>{const[t,e]=this.engine.getCenter(),i={brand:this.brand,feature:this.feature,loaded:this.loaded,progress:this.progress,pitch:this.engine.getPitch(),bearing:this.engine.getBearing(),zoom:this.engine.getZoom(),center:[t,e]};i!==this.state&&(this.state=i,this.events.emit("map-x-state-changed",i))})),await this.processStyleSheet()}setFeature(t){if(t&&this.events.emit("map-x-feature-clicked",t),t&&this.feature&&this.feature.id===t.id)return;this.feature&&this.engine.setFeatureState(this.feature,{selected:!1});let e=!1;(function(t){return!!(t&&"object"==typeof t&&null!==t&&"Feature"===t.type&&t.hasOwnProperty("id")&&t.hasOwnProperty("geometry")&&t.hasOwnProperty("properties")&&t.hasOwnProperty("source"))})(t)&&(this.feature=t,this.engine.setFeatureState(t,{selected:!0}),e=!0),void 0===t&&(this.feature=void 0,e=!0),e&&(this.events.emit("map-x-feature-changed",this.feature),this.engine.triggerRepaint())}setBounds(t,e={duration:1e3}){this.bounds=t,this.engine.fitBounds(t,e);const i=e.duration||1e3;setTimeout((()=>{this.zoom=this.engine.getZoom()}),i+200)}setCenter(t){this.center=t,this.engine.flyTo({center:t})}getMetersPerPixel(){const t=this.engine.getBounds();return function(t,e){const{offsetWidth:i,offsetHeight:r}=t,n=Math.sqrt(i*i+r*r),[a,o,s,l]=e;return ie([a,o],[s,l],{units:"meters"})/n}(this.container,t)}async setLayers(t=[]){t!==this.layers&&(this.layers=t,this.processStyleSheet())}async setBrand(t){t!==this.brand&&(this.brand=t,this.processStyleSheet())}async setBaseMap(t){t!==this.baseMap&&(this.baseMap=t,this.processStyleSheet())}reset(){this.events.emit("map-x-animation-cancel",void 0),this.engine.flyTo({center:this.center,bearing:this.bearing,zoom:this.zoom,pitch:this.pitch,duration:3e3})}}class ve{constructor(t){this.emitter=t||document.createElement("div"),this.subscribe=this.subscribe.bind(this),this.unsubscribe=this.unsubscribe.bind(this),this.emit=this.emit.bind(this)}subscribe(t,e){"function"==typeof e&&this.emitter.addEventListener(t,e)}unsubscribe(t,e){this.emitter.removeEventListener(t,e)}emit(t,e){const i=new CustomEvent(t,{detail:e});this.emitter.dispatchEvent(i)}once(t,e){if("function"==typeof e){const i=r=>{e(r),this.unsubscribe(t,i)};this.subscribe(t,i)}}}function be(){const t=document.createElement("div"),e=document.createElementNS("http://www.w3.org/2000/svg","svg");e.setAttribute("width","20"),e.setAttribute("height","20"),e.setAttribute("fill","none"),e.setAttribute("viewBox","0 0 20 20"),e.setAttribute("style","filter: drop-shadow(0 0 10px rgba(0,0,0,0.5));");const i=document.createElementNS("http://www.w3.org/2000/svg","path");return i.setAttribute("d","M10 19C14.9706 19 19 14.9706 19 10C19 5.02944 14.9706 1 10 1C5.02944 1 1 5.02944 1 10C1 14.9706 5.02944 19 10 19Z"),i.setAttribute("fill","#087AFF"),i.setAttribute("stroke","white"),i.setAttribute("stroke-width","2"),e.appendChild(i),t.appendChild(e),t}function xe(t,e,i){return t*(1-i)+e*i}class we{constructor(t){this.events=t.events||new ve}}class Se{constructor(t){this.setLonLat=t.setLonLat,this.destroy=t.destroy}}var ke=n(49416),Ce=n.n(ke);function Ae(t,e,i){if(void 0===i&&(i={}),!0===i.final)return function(t,e){var i=Ae(e,t);return i=(i+180)%360}(t,e);var r=te(t),n=te(e),a=qt(r[0]),o=qt(n[0]),s=qt(r[1]),l=qt(n[1]),c=Math.sin(o-a)*Math.cos(l),h=Math.cos(s)*Math.sin(l)-Math.sin(s)*Math.cos(l)*Math.cos(o-a);return Ht(Math.atan2(c,h))}function Te(t,e,i,r){void 0===r&&(r={});var n=te(t),a=qt(n[0]),o=qt(n[1]),s=qt(i),l=Zt(e,r.units),c=Math.asin(Math.sin(o)*Math.cos(l)+Math.cos(o)*Math.sin(l)*Math.cos(s));return Nt([Ht(a+Math.atan2(Math.sin(s)*Math.sin(l)*Math.cos(o),Math.cos(l)-Math.sin(o)*Math.sin(c))),Ht(c)],r.properties)}function Ee(t,e,i){void 0===i&&(i={});for(var r=ee(t).coordinates,n=0,a=0;a<r.length&&!(e>=n&&a===r.length-1);a++){if(n>=e){var o=e-n;if(o){var s=Ae(r[a],r[a-1])-180;return Te(r[a],o,s,i)}return Nt(r[a])}n+=ie(r[a],r[a+1],i)}return Nt(r[r.length-1])}var Me=function(){function t(t){this.points=t.points||[],this.duration=t.duration||1e4,this.sharpness=t.sharpness||.85,this.centers=[],this.controls=[],this.stepLength=t.stepLength||60,this.length=this.points.length,this.delay=0;for(var e=0;e<this.length;e++)this.points[e].z=this.points[e].z||0;for(e=0;e<this.length-1;e++){var i=this.points[e],r=this.points[e+1];this.centers.push({x:(i.x+r.x)/2,y:(i.y+r.y)/2,z:(i.z+r.z)/2})}this.controls.push([this.points[0],this.points[0]]);for(e=0;e<this.centers.length-1;e++){var n=this.points[e+1].x-(this.centers[e].x+this.centers[e+1].x)/2,a=this.points[e+1].y-(this.centers[e].y+this.centers[e+1].y)/2,o=this.points[e+1].z-(this.centers[e].y+this.centers[e+1].z)/2;this.controls.push([{x:(1-this.sharpness)*this.points[e+1].x+this.sharpness*(this.centers[e].x+n),y:(1-this.sharpness)*this.points[e+1].y+this.sharpness*(this.centers[e].y+a),z:(1-this.sharpness)*this.points[e+1].z+this.sharpness*(this.centers[e].z+o)},{x:(1-this.sharpness)*this.points[e+1].x+this.sharpness*(this.centers[e+1].x+n),y:(1-this.sharpness)*this.points[e+1].y+this.sharpness*(this.centers[e+1].y+a),z:(1-this.sharpness)*this.points[e+1].z+this.sharpness*(this.centers[e+1].z+o)}])}return this.controls.push([this.points[this.length-1],this.points[this.length-1]]),this.steps=this.cacheSteps(this.stepLength),this}return t.prototype.cacheSteps=function(t){var e=[],i=this.pos(0);e.push(0);for(var r=0;r<this.duration;r+=10){var n=this.pos(r);Math.sqrt((n.x-i.x)*(n.x-i.x)+(n.y-i.y)*(n.y-i.y)+(n.z-i.z)*(n.z-i.z))>t&&(e.push(r),i=n)}return e},t.prototype.vector=function(t){var e=this.pos(t+10),i=this.pos(t-10);return{angle:180*Math.atan2(e.y-i.y,e.x-i.x)/3.14,speed:Math.sqrt((i.x-e.x)*(i.x-e.x)+(i.y-e.y)*(i.y-e.y)+(i.z-e.z)*(i.z-e.z))}},t.prototype.pos=function(t){var e=t-this.delay;e<0&&(e=0),e>this.duration&&(e=this.duration-1);var i=e/this.duration;if(i>=1)return this.points[this.length-1];var r=Math.floor((this.points.length-1)*i);return function(t,e,i,r,n){var a=function(t){var e=t*t,i=e*t;return[i,3*e*(1-t),3*t*(1-t)*(1-t),(1-t)*(1-t)*(1-t)]}(t),o={x:n.x*a[0]+r.x*a[1]+i.x*a[2]+e.x*a[3],y:n.y*a[0]+r.y*a[1]+i.y*a[2]+e.y*a[3],z:n.z*a[0]+r.z*a[1]+i.z*a[2]+e.z*a[3]};return o}((this.length-1)*i-r,this.points[r],this.controls[r][1],this.controls[r+1][0],this.points[r+1])},t}();const Ie=Me;const ze=function(t,e){void 0===e&&(e={});for(var i=e.resolution||1e4,r=e.sharpness||.85,n=[],a=ee(t).coordinates.map((function(t){return{x:t[0],y:t[1]}})),o=new Ie({duration:i,points:a,sharpness:r}),s=function(t){var e=o.pos(t);Math.floor(t/100)%2==0&&n.push([e.x,e.y])},l=0;l<o.duration;l+=10)s(l);return s(o.duration),jt(n,e.properties)};function Pe(t,e){return void 0===e&&(e={}),Jt(t,(function(t,i){var r=i.geometry.coordinates;return t+ie(r[0],r[1],e)}),0)}!function(){try{if(typeof document<"u"){var t=document.createElement("style");t.appendChild(document.createTextNode(".maplibregl-map{-webkit-tap-highlight-color:rgb(0 0 0/0);font:12px/20px Helvetica Neue,Arial,Helvetica,sans-serif;overflow:hidden;position:relative}.maplibregl-canvas{left:0;position:absolute;top:0}.maplibregl-map:fullscreen{height:100%;width:100%}.maplibregl-ctrl-group button.maplibregl-ctrl-compass{touch-action:none}.maplibregl-canvas-container.maplibregl-interactive,.maplibregl-ctrl-group button.maplibregl-ctrl-compass{cursor:grab;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.maplibregl-canvas-container.maplibregl-interactive.maplibregl-track-pointer{cursor:pointer}.maplibregl-canvas-container.maplibregl-interactive:active,.maplibregl-ctrl-group button.maplibregl-ctrl-compass:active{cursor:grabbing}.maplibregl-canvas-container.maplibregl-touch-zoom-rotate,.maplibregl-canvas-container.maplibregl-touch-zoom-rotate .maplibregl-canvas{touch-action:pan-x pan-y}.maplibregl-canvas-container.maplibregl-touch-drag-pan,.maplibregl-canvas-container.maplibregl-touch-drag-pan .maplibregl-canvas{touch-action:pinch-zoom}.maplibregl-canvas-container.maplibregl-touch-zoom-rotate.maplibregl-touch-drag-pan,.maplibregl-canvas-container.maplibregl-touch-zoom-rotate.maplibregl-touch-drag-pan .maplibregl-canvas{touch-action:none}.maplibregl-canvas-container.maplibregl-touch-drag-pan.maplibregl-cooperative-gestures,.maplibregl-canvas-container.maplibregl-touch-drag-pan.maplibregl-cooperative-gestures .maplibregl-canvas{touch-action:pan-x pan-y}.maplibregl-ctrl-bottom-left,.maplibregl-ctrl-bottom-right,.maplibregl-ctrl-top-left,.maplibregl-ctrl-top-right{pointer-events:none;position:absolute;z-index:2}.maplibregl-ctrl-top-left{left:0;top:0}.maplibregl-ctrl-top-right{right:0;top:0}.maplibregl-ctrl-bottom-left{bottom:0;left:0}.maplibregl-ctrl-bottom-right{bottom:0;right:0}.maplibregl-ctrl{clear:both;pointer-events:auto;transform:translate(0)}.maplibregl-ctrl-top-left .maplibregl-ctrl{float:left;margin:10px 0 0 10px}.maplibregl-ctrl-top-right .maplibregl-ctrl{float:right;margin:10px 10px 0 0}.maplibregl-ctrl-bottom-left .maplibregl-ctrl{float:left;margin:0 0 10px 10px}.maplibregl-ctrl-bottom-right .maplibregl-ctrl{float:right;margin:0 10px 10px 0}.maplibregl-ctrl-group{background:#fff;border-radius:4px}.maplibregl-ctrl-group:not(:empty){box-shadow:0 0 0 2px #0000001a}@media (-ms-high-contrast:active){.maplibregl-ctrl-group:not(:empty){box-shadow:0 0 0 2px ButtonText}}.maplibregl-ctrl-group button{background-color:transparent;border:0;box-sizing:border-box;cursor:pointer;display:block;height:29px;outline:none;padding:0;width:29px}.maplibregl-ctrl-group button+button{border-top:1px solid #ddd}.maplibregl-ctrl button .maplibregl-ctrl-icon{background-position:50%;background-repeat:no-repeat;display:block;height:100%;width:100%}@media (-ms-high-contrast:active){.maplibregl-ctrl-icon{background-color:transparent}.maplibregl-ctrl-group button+button{border-top:1px solid ButtonText}}.maplibregl-ctrl button::-moz-focus-inner{border:0;padding:0}.maplibregl-ctrl-attrib-button:focus,.maplibregl-ctrl-group button:focus{box-shadow:0 0 2px 2px #0096ff}.maplibregl-ctrl button:disabled{cursor:not-allowed}.maplibregl-ctrl button:disabled .maplibregl-ctrl-icon{opacity:.25}.maplibregl-ctrl button:not(:disabled):hover{background-color:#0000000d}.maplibregl-ctrl-group button:focus:focus-visible{box-shadow:0 0 2px 2px #0096ff}.maplibregl-ctrl-group button:focus:not(:focus-visible){box-shadow:none}.maplibregl-ctrl-group button:focus:first-child{border-radius:4px 4px 0 0}.maplibregl-ctrl-group button:focus:last-child{border-radius:0 0 4px 4px}.maplibregl-ctrl-group button:focus:only-child{border-radius:inherit}.maplibregl-ctrl button.maplibregl-ctrl-zoom-out .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23333' viewBox='0 0 29 29'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-zoom-in .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23333' viewBox='0 0 29 29'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E\")}@media (-ms-high-contrast:active){.maplibregl-ctrl button.maplibregl-ctrl-zoom-out .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23fff' viewBox='0 0 29 29'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-zoom-in .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23fff' viewBox='0 0 29 29'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){.maplibregl-ctrl button.maplibregl-ctrl-zoom-out .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' viewBox='0 0 29 29'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-zoom-in .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' viewBox='0 0 29 29'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E\")}}.maplibregl-ctrl button.maplibregl-ctrl-fullscreen .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23333' viewBox='0 0 29 29'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-shrink .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' viewBox='0 0 29 29'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E\")}@media (-ms-high-contrast:active){.maplibregl-ctrl button.maplibregl-ctrl-fullscreen .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23fff' viewBox='0 0 29 29'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-shrink .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23fff' viewBox='0 0 29 29'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){.maplibregl-ctrl button.maplibregl-ctrl-fullscreen .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' viewBox='0 0 29 29'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-shrink .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' viewBox='0 0 29 29'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E\")}}.maplibregl-ctrl button.maplibregl-ctrl-compass .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23333' viewBox='0 0 29 29'%3E%3Cpath d='m10.5 14 4-8 4 8h-8z'/%3E%3Cpath fill='%23ccc' d='m10.5 16 4 8 4-8h-8z'/%3E%3C/svg%3E\")}@media (-ms-high-contrast:active){.maplibregl-ctrl button.maplibregl-ctrl-compass .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23fff' viewBox='0 0 29 29'%3E%3Cpath d='m10.5 14 4-8 4 8h-8z'/%3E%3Cpath fill='%23999' d='m10.5 16 4 8 4-8h-8z'/%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){.maplibregl-ctrl button.maplibregl-ctrl-compass .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' viewBox='0 0 29 29'%3E%3Cpath d='m10.5 14 4-8 4 8h-8z'/%3E%3Cpath fill='%23ccc' d='m10.5 16 4 8 4-8h-8z'/%3E%3C/svg%3E\")}}.maplibregl-ctrl button.maplibregl-ctrl-terrain .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='22' height='22' fill='%23333' viewBox='0 0 22 22'%3E%3Cpath d='m1.754 13.406 4.453-4.851 3.09 3.09 3.281 3.277.969-.969-3.309-3.312 3.844-4.121 6.148 6.886h1.082v-.855l-7.207-8.07-4.84 5.187L6.169 6.57l-5.48 5.965v.871ZM.688 16.844h20.625v1.375H.688Zm0 0'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-terrain-enabled .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='22' height='22' fill='%2333b5e5' viewBox='0 0 22 22'%3E%3Cpath d='m1.754 13.406 4.453-4.851 3.09 3.09 3.281 3.277.969-.969-3.309-3.312 3.844-4.121 6.148 6.886h1.082v-.855l-7.207-8.07-4.84 5.187L6.169 6.57l-5.48 5.965v.871ZM.688 16.844h20.625v1.375H.688Zm0 0'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23333' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate:disabled .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23aaa' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath fill='red' d='m14 5 1 1-9 9-1-1 9-9z'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-active .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%2333b5e5' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-active-error .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23e58978' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-background .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%2333b5e5' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-background-error .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23e54e33' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-waiting .maplibregl-ctrl-icon{animation:maplibregl-spin 2s linear infinite}@media (-ms-high-contrast:active){.maplibregl-ctrl button.maplibregl-ctrl-geolocate .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23fff' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate:disabled .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23999' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath fill='red' d='m14 5 1 1-9 9-1-1 9-9z'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-active .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%2333b5e5' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-active-error .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23e58978' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-background .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%2333b5e5' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-background-error .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23e54e33' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){.maplibregl-ctrl button.maplibregl-ctrl-geolocate .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate:disabled .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23666' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath fill='red' d='m14 5 1 1-9 9-1-1 9-9z'/%3E%3C/svg%3E\")}}@keyframes maplibregl-spin{0%{transform:rotate(0)}to{transform:rotate(1turn)}}a.maplibregl-ctrl-logo{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='88' height='23' fill='none'%3E%3Cpath fill='%23000' fill-opacity='.4' fill-rule='evenodd' d='M17.408 16.796h-1.827l2.501-12.095h.198l3.324 6.533.988 2.19.988-2.19 3.258-6.533h.181l2.6 12.095h-1.81l-1.218-5.644-.362-1.71-.658 1.71-2.929 5.644h-.098l-2.914-5.644-.757-1.71-.345 1.71zm1.958-3.42-.726 3.663a1.255 1.255 0 0 1-1.232 1.011h-1.827a1.255 1.255 0 0 1-1.229-1.509l2.501-12.095a1.255 1.255 0 0 1 1.23-1.001h.197a1.255 1.255 0 0 1 1.12.685l3.19 6.273 3.125-6.263a1.255 1.255 0 0 1 1.123-.695h.181a1.255 1.255 0 0 1 1.227.991l1.443 6.71a5.11 5.11 0 0 1 .314-.787l.009-.016a4.623 4.623 0 0 1 1.777-1.887c.782-.46 1.668-.667 2.611-.667a4.548 4.548 0 0 1 1.7.32l.306.134c.21-.16.474-.256.759-.256h1.694a1.255 1.255 0 0 1 1.212.925 1.255 1.255 0 0 1 1.212-.925h1.711c.284 0 .545.094.755.252.613-.3 1.312-.45 2.075-.45 1.356 0 2.557.445 3.482 1.4.314.319.566.676.763 1.064V4.701a1.255 1.255 0 0 1 1.255-1.255h1.86A1.255 1.255 0 0 1 54.44 4.7v9.194h2.217c.19 0 .37.043.532.118v-4.77c0-.356.147-.678.385-.906a2.416 2.416 0 0 1-.682-1.71c0-.665.267-1.253.735-1.7a2.448 2.448 0 0 1 1.722-.674 2.43 2.43 0 0 1 1.705.675c.211.2.381.43.504.683V4.7a1.255 1.255 0 0 1 1.255-1.255h1.744A1.255 1.255 0 0 1 65.812 4.7v3.335a4.76 4.76 0 0 1 1.526-.246c.938 0 1.817.214 2.59.69a4.47 4.47 0 0 1 1.67 1.743v-.98a1.255 1.255 0 0 1 1.256-1.256h1.777c.233 0 .451.064.639.174a3.407 3.407 0 0 1 1.567-.372c.346 0 .861.02 1.285.232a1.255 1.255 0 0 1 .689 1.004 4.73 4.73 0 0 1 .853-.588c.795-.44 1.675-.647 2.61-.647 1.385 0 2.65.39 3.525 1.396.836.938 1.168 2.173 1.168 3.528 0 .343-.02.694-.056 1.051a1.255 1.255 0 0 1-.947 1.09l.408.952a1.255 1.255 0 0 1-.477 1.552c-.418.268-.92.463-1.458.612-.613.171-1.304.244-2.049.244-1.06 0-2.043-.207-2.886-.698l-.015-.008c-.798-.48-1.419-1.135-1.818-1.963l-.004-.008a5.815 5.815 0 0 1-.548-2.512c0-.286.017-.567.053-.843a1.255 1.255 0 0 1-.333-.086l-.166-.004c-.223 0-.426.062-.643.228-.03.024-.142.139-.142.59v3.883a1.255 1.255 0 0 1-1.256 1.256h-1.777a1.255 1.255 0 0 1-1.256-1.256V15.69l-.032.057a4.778 4.778 0 0 1-1.86 1.833 5.04 5.04 0 0 1-2.484.634 4.47 4.47 0 0 1-1.935-.424 1.252 1.252 0 0 1-.764.258h-1.71a1.255 1.255 0 0 1-1.256-1.255V7.687a2.402 2.402 0 0 1-.428.625c.253.23.412.561.412.93v7.553a1.255 1.255 0 0 1-1.256 1.255h-1.843a1.25 1.25 0 0 1-.894-.373c-.228.23-.544.373-.894.373H51.32a1.255 1.255 0 0 1-1.256-1.255v-1.251l-.061.117a4.703 4.703 0 0 1-1.782 1.884 4.767 4.767 0 0 1-2.485.67 5.6 5.6 0 0 1-1.485-.188l.009 2.764a1.255 1.255 0 0 1-1.255 1.259h-1.729a1.255 1.255 0 0 1-1.255-1.255v-3.537a1.255 1.255 0 0 1-1.167.793h-1.679a1.25 1.25 0 0 1-.77-.263 4.47 4.47 0 0 1-1.945.429c-.885 0-1.724-.21-2.495-.632l-.017-.01a4.983 4.983 0 0 1-1.081-.836 1.255 1.255 0 0 1-1.254 1.312h-1.81a1.255 1.255 0 0 1-1.228-.99l-.782-3.625-2.044 3.939a1.255 1.255 0 0 1-1.115.676h-.098a1.255 1.255 0 0 1-1.116-.68l-2.061-3.994zM35.92 16.63l.207-.114.223-.15c.329-.237.574-.499.735-.785l.061-.118.033 1.332h1.678V9.242h-1.694l-.033 1.267c-.088-.22-.264-.438-.526-.658l-.032-.028a3.16 3.16 0 0 0-.668-.428l-.27-.12a3.293 3.293 0 0 0-1.235-.23c-.757 0-1.415.163-1.974.493a3.36 3.36 0 0 0-1.3 1.382c-.297.593-.444 1.284-.444 2.074 0 .8.17 1.503.51 2.107a3.795 3.795 0 0 0 1.382 1.381 3.883 3.883 0 0 0 1.893.477c.53 0 1.015-.11 1.455-.33zm-2.789-5.38c-.384.45-.575 1.038-.575 1.762 0 .735.186 1.332.559 1.794.384.45.933.675 1.645.675a2.25 2.25 0 0 0 .934-.19 2.17 2.17 0 0 0 .468-.29l.178-.161a2.163 2.163 0 0 0 .397-.561c.163-.333.244-.717.244-1.15v-.115c0-.472-.098-.894-.296-1.267l-.043-.077a2.211 2.211 0 0 0-.633-.709l-.13-.086-.047-.028a2.099 2.099 0 0 0-1.073-.285c-.702 0-1.244.231-1.629.692zm2.316 2.706c.163-.17.28-.407.28-.83v-.114c0-.292-.06-.508-.15-.68a.958.958 0 0 0-.353-.389.851.851 0 0 0-.464-.127c-.4 0-.56.114-.664.239l-.01.012c-.148.174-.275.45-.275.945 0 .506.122.801.27.99.097.11.266.224.68.224.303 0 .504-.09.687-.269zm7.545 1.705a2.626 2.626 0 0 0 .331.423c.213.22.464.402.755.548l.173.074c.433.17.93.255 1.49.255.68 0 1.295-.165 1.844-.493a3.447 3.447 0 0 0 1.316-1.4c.329-.603.493-1.299.493-2.089 0-1.273-.33-2.243-.988-2.913-.658-.68-1.52-1.02-2.584-1.02-.598 0-1.124.115-1.575.347a2.807 2.807 0 0 0-.415.262l-.199.166a3.35 3.35 0 0 0-.64.82V9.242h-1.712v11.553h1.729l-.017-5.134zm.53-1.138c.137.193.297.36.48.5l.155.11.053.034c.34.197.713.297 1.119.297.714 0 1.262-.225 1.645-.675.385-.46.576-1.048.576-1.762 0-.746-.192-1.338-.576-1.777-.372-.45-.92-.675-1.645-.675-.29 0-.569.053-.835.16a2.366 2.366 0 0 0-.284.136 1.99 1.99 0 0 0-.363.254 2.237 2.237 0 0 0-.46.569l-.082.162a2.56 2.56 0 0 0-.213 1.072v.115c0 .471.098.894.296 1.267l.135.211zm.964-.818a1.11 1.11 0 0 0 .367.385.937.937 0 0 0 .476.118c.423 0 .59-.117.687-.23.159-.194.28-.478.28-.95 0-.53-.133-.8-.266-.952l-.021-.025c-.078-.094-.231-.221-.68-.221a.995.995 0 0 0-.503.135l-.012.007a.859.859 0 0 0-.335.343c-.073.133-.132.324-.132.614v.115a1.43 1.43 0 0 0 .14.66zm15.7-6.222c.232-.23.346-.516.346-.856a1.053 1.053 0 0 0-.345-.79 1.175 1.175 0 0 0-.84-.329c-.34 0-.625.11-.855.33a1.053 1.053 0 0 0-.346.79c0 .34.115.625.346.855.23.23.516.346.856.346.34 0 .62-.115.839-.346zm4.337 9.314.033-1.332c.128.269.324.518.59.747l.098.081a3.727 3.727 0 0 0 .316.224l.223.122a3.21 3.21 0 0 0 1.44.322 3.785 3.785 0 0 0 1.875-.477 3.52 3.52 0 0 0 1.382-1.366c.352-.593.526-1.29.526-2.09 0-.79-.147-1.48-.444-2.073a3.235 3.235 0 0 0-1.283-1.399c-.549-.34-1.195-.51-1.942-.51a3.476 3.476 0 0 0-1.527.344l-.086.043-.165.09a3.412 3.412 0 0 0-.33.214c-.288.21-.507.446-.656.707a1.893 1.893 0 0 0-.099.198l.082-1.283V4.701h-1.744v12.095zm.473-2.509a2.482 2.482 0 0 0 .566.7c.078.065.159.125.245.18l.144.08a2.105 2.105 0 0 0 .975.232c.713 0 1.262-.225 1.645-.675.384-.46.576-1.053.576-1.778 0-.734-.192-1.327-.576-1.777-.373-.46-.921-.692-1.645-.692a2.18 2.18 0 0 0-1.015.235c-.147.075-.285.17-.415.282l-.15.142a2.086 2.086 0 0 0-.42.594c-.149.32-.223.685-.223 1.1v.115c0 .47.097.89.293 1.26zm2.616-.293c.157-.191.28-.479.28-.967 0-.51-.13-.79-.276-.961l-.021-.026c-.082-.1-.232-.225-.67-.225a.868.868 0 0 0-.681.279l-.012.011c-.154.155-.274.38-.274.807v.115c0 .285.057.499.144.669a1.13 1.13 0 0 0 .367.405c.137.082.28.123.455.123.423 0 .59-.118.686-.23zm8.266-3.013c.23-.087.472-.134.724-.14l.069-.002c.329 0 .542.033.642.099l.247-1.794c-.13-.066-.37-.099-.717-.099a2.3 2.3 0 0 0-.545.063 2.086 2.086 0 0 0-.411.148 2.18 2.18 0 0 0-.4.249 2.482 2.482 0 0 0-.485.499 2.659 2.659 0 0 0-.32.581l-.05.137v-1.48h-1.778v7.553h1.777v-3.884c0-.364.053-.678.159-.943a1.49 1.49 0 0 1 .466-.636 2.52 2.52 0 0 1 .399-.253 2.19 2.19 0 0 1 .224-.099zm9.784 2.656.05-.922c0-1.162-.285-2.062-.856-2.698-.559-.647-1.42-.97-2.584-.97-.746 0-1.415.163-2.007.493a3.462 3.462 0 0 0-1.4 1.382c-.329.604-.493 1.306-.493 2.106 0 .714.143 1.371.428 1.975.285.593.73 1.07 1.332 1.432.604.351 1.355.526 2.255.526.649 0 1.204-.062 1.668-.185l.044-.012.135-.04c.409-.122.736-.263.984-.421l-.542-1.267c-.2.108-.415.199-.642.274l-.297.087c-.34.088-.773.131-1.3.131-.636 0-1.135-.147-1.497-.444a1.573 1.573 0 0 1-.192-.193c-.244-.294-.415-.705-.512-1.234l-.004-.021h5.43zm-5.427-1.256-.003.022h3.752v-.138c-.007-.485-.104-.857-.288-1.118a1.056 1.056 0 0 0-.156-.176c-.307-.285-.746-.428-1.316-.428-.657 0-1.155.202-1.494.604-.253.3-.417.712-.494 1.234zm-27.053 2.77V4.7h-1.86v12.095h5.333V15.15zm7.103-5.908v7.553h-1.843V9.242h1.843z'/%3E%3Cpath fill='%23fff' d='m19.63 11.151-.757-1.71-.345 1.71-1.12 5.644h-1.827L18.083 4.7h.197l3.325 6.533.988 2.19.988-2.19L26.839 4.7h.181l2.6 12.095h-1.81l-1.218-5.644-.362-1.71-.658 1.71-2.93 5.644h-.098l-2.913-5.644zm14.836 5.81c-.68 0-1.311-.16-1.893-.478a3.795 3.795 0 0 1-1.381-1.382c-.34-.604-.51-1.306-.51-2.106 0-.79.147-1.482.444-2.074a3.364 3.364 0 0 1 1.3-1.382c.559-.33 1.217-.494 1.974-.494a3.293 3.293 0 0 1 1.234.231 3.341 3.341 0 0 1 .97.575c.264.22.44.439.527.659l.033-1.267h1.694v7.553H37.18l-.033-1.332c-.186.395-.526.746-1.02 1.053a3.167 3.167 0 0 1-1.662.444zm.296-1.482c.626 0 1.152-.214 1.58-.642.428-.44.642-1.01.642-1.711v-.115c0-.472-.098-.894-.296-1.267a2.211 2.211 0 0 0-.807-.872 2.098 2.098 0 0 0-1.119-.313c-.702 0-1.245.231-1.629.692-.384.45-.575 1.037-.575 1.76 0 .736.186 1.333.559 1.795.384.45.933.675 1.645.675zm6.521-6.237h1.711v1.4c.604-1.065 1.547-1.597 2.83-1.597 1.064 0 1.926.34 2.584 1.02.659.67.988 1.641.988 2.914 0 .79-.164 1.487-.493 2.09a3.456 3.456 0 0 1-1.316 1.399 3.51 3.51 0 0 1-1.844.493c-.636 0-1.19-.11-1.662-.329a2.665 2.665 0 0 1-1.086-.97l.017 5.134h-1.728V9.242zm4.048 6.22c.714 0 1.262-.224 1.645-.674.385-.46.576-1.048.576-1.762 0-.746-.192-1.338-.576-1.777-.372-.45-.92-.675-1.645-.675-.395 0-.768.098-1.12.296-.34.187-.613.46-.822.823-.197.351-.296.763-.296 1.234v.115c0 .472.098.894.296 1.267.209.362.483.647.823.855.34.197.713.297 1.119.297z'/%3E%3Cpath fill='%23e1e3e9' d='M51.325 4.7h1.86v10.45h3.473v1.646h-5.333zm7.12 4.542h1.843v7.553h-1.843zm.905-1.415a1.159 1.159 0 0 1-.856-.346 1.165 1.165 0 0 1-.346-.856 1.053 1.053 0 0 1 .346-.79c.23-.219.516-.329.856-.329.329 0 .609.11.839.33a1.053 1.053 0 0 1 .345.79 1.159 1.159 0 0 1-.345.855c-.22.23-.5.346-.84.346zm7.875 9.133a3.167 3.167 0 0 1-1.662-.444c-.482-.307-.817-.658-1.004-1.053l-.033 1.332h-1.71V4.701h1.743v4.657l-.082 1.283c.186-.438.548-.812 1.086-1.119a3.486 3.486 0 0 1 1.778-.477c.746 0 1.393.17 1.942.51a3.235 3.235 0 0 1 1.283 1.4c.297.592.444 1.282.444 2.072 0 .8-.175 1.498-.526 2.09a3.52 3.52 0 0 1-1.382 1.366 3.785 3.785 0 0 1-1.876.477zm-.296-1.481c.713 0 1.26-.225 1.645-.675.384-.46.577-1.053.577-1.778 0-.734-.193-1.327-.577-1.776-.373-.46-.921-.692-1.645-.692a2.115 2.115 0 0 0-1.58.659c-.428.428-.642.992-.642 1.694v.115c0 .473.098.895.296 1.267a2.385 2.385 0 0 0 .807.872 2.1 2.1 0 0 0 1.119.313zm5.927-6.237h1.777v1.481c.176-.505.46-.91.856-1.217a2.14 2.14 0 0 1 1.349-.46c.351 0 .593.032.724.098l-.247 1.794c-.099-.066-.313-.099-.642-.099-.516 0-.988.164-1.416.494-.417.329-.626.855-.626 1.58v3.883h-1.777V9.242zm9.534 7.718c-.9 0-1.651-.175-2.255-.526-.603-.362-1.047-.84-1.332-1.432a4.567 4.567 0 0 1-.428-1.975c0-.8.164-1.502.493-2.106a3.462 3.462 0 0 1 1.4-1.382c.592-.33 1.262-.494 2.007-.494 1.163 0 2.024.324 2.584.97.57.637.856 1.537.856 2.7 0 .296-.017.603-.05.92h-5.43c.12.67.356 1.153.708 1.45.362.296.86.443 1.497.443.526 0 .96-.044 1.3-.131a4.123 4.123 0 0 0 .938-.362l.542 1.267c-.274.175-.647.329-1.119.46-.472.132-1.042.197-1.711.197zm1.596-4.558c.01-.68-.137-1.158-.444-1.432-.307-.285-.746-.428-1.316-.428-1.152 0-1.815.62-1.991 1.86h3.752z'/%3E%3Cg fill-rule='evenodd' stroke-width='1.036'%3E%3Cpath fill='%23000' fill-opacity='.4' d='m8.166 16.146-.002.002a1.54 1.54 0 0 1-2.009 0l-.002-.002-.043-.034-.002-.002-.199-.162H4.377a.657.657 0 0 0-.659.659v1.84a.657.657 0 0 0 .659.659h5.565a.657.657 0 0 0 .659-.659v-1.84a.657.657 0 0 0-.659-.659H8.411l-.202.164zm-1.121-.905a.29.29 0 0 0 .113.023.286.286 0 0 0 .189-.07l.077-.063c.634-.508 4.672-3.743 4.672-7.575 0-2.55-2.215-4.625-4.938-4.625S2.221 5.006 2.221 7.556c0 3.225 2.86 6.027 4.144 7.137h.004l.04.038.484.4.077.063a.628.628 0 0 0 .074.047zm-2.52-.548a16.898 16.898 0 0 1-1.183-1.315C2.187 11.942.967 9.897.967 7.555c0-3.319 2.855-5.88 6.192-5.88 3.338 0 6.193 2.561 6.193 5.881 0 2.34-1.22 4.387-2.376 5.822a16.898 16.898 0 0 1-1.182 1.315h.15a1.912 1.912 0 0 1 1.914 1.914v1.84a1.912 1.912 0 0 1-1.914 1.914H4.377a1.912 1.912 0 0 1-1.914-1.914v-1.84a1.912 1.912 0 0 1 1.914-1.914zm3.82-6.935c0 .692-.55 1.222-1.187 1.222s-1.185-.529-1.185-1.222.548-1.222 1.185-1.222c.638 0 1.186.529 1.186 1.222zm-1.186 2.477c1.348 0 2.442-1.11 2.442-2.478S8.507 5.28 7.159 5.28 4.72 6.39 4.72 7.758s1.092 2.477 2.44 2.477zm2.048 7.71H5.114v-.838h4.093z'/%3E%3Cpath fill='%23e1e3e9' d='M2.222 7.555c0-2.55 2.214-4.625 4.937-4.625 2.723 0 4.938 2.075 4.938 4.625 0 3.832-4.038 7.068-4.672 7.575l-.077.063a.286.286 0 0 1-.189.07.286.286 0 0 1-.188-.07l-.077-.063c-.634-.507-4.672-3.743-4.672-7.575zm4.937 2.68c1.348 0 2.442-1.11 2.442-2.478S8.507 5.28 7.159 5.28 4.72 6.39 4.72 7.758s1.092 2.477 2.44 2.477z'/%3E%3Cpath fill='%23fff' d='M4.377 15.948a.657.657 0 0 0-.659.659v1.84a.657.657 0 0 0 .659.659h5.565a.657.657 0 0 0 .659-.659v-1.84a.657.657 0 0 0-.659-.659zm4.83 1.16H5.114v.838h4.093z'/%3E%3C/g%3E%3C/svg%3E\");background-repeat:no-repeat;cursor:pointer;display:block;height:23px;margin:0 0 -4px -4px;overflow:hidden;width:88px}a.maplibregl-ctrl-logo.maplibregl-compact{width:14px}@media (-ms-high-contrast:active){a.maplibregl-ctrl-logo{background-color:transparent;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='88' height='23' fill='none'%3E%3Cpath fill='%23000' fill-opacity='.4' fill-rule='evenodd' d='M17.408 16.796h-1.827l2.501-12.095h.198l3.324 6.533.988 2.19.988-2.19 3.258-6.533h.181l2.6 12.095h-1.81l-1.218-5.644-.362-1.71-.658 1.71-2.929 5.644h-.098l-2.914-5.644-.757-1.71-.345 1.71zm1.958-3.42-.726 3.663a1.255 1.255 0 0 1-1.232 1.011h-1.827a1.255 1.255 0 0 1-1.229-1.509l2.501-12.095a1.255 1.255 0 0 1 1.23-1.001h.197a1.255 1.255 0 0 1 1.12.685l3.19 6.273 3.125-6.263a1.255 1.255 0 0 1 1.123-.695h.181a1.255 1.255 0 0 1 1.227.991l1.443 6.71a5.11 5.11 0 0 1 .314-.787l.009-.016a4.623 4.623 0 0 1 1.777-1.887c.782-.46 1.668-.667 2.611-.667a4.548 4.548 0 0 1 1.7.32l.306.134c.21-.16.474-.256.759-.256h1.694a1.255 1.255 0 0 1 1.212.925 1.255 1.255 0 0 1 1.212-.925h1.711c.284 0 .545.094.755.252.613-.3 1.312-.45 2.075-.45 1.356 0 2.557.445 3.482 1.4.314.319.566.676.763 1.064V4.701a1.255 1.255 0 0 1 1.255-1.255h1.86A1.255 1.255 0 0 1 54.44 4.7v9.194h2.217c.19 0 .37.043.532.118v-4.77c0-.356.147-.678.385-.906a2.416 2.416 0 0 1-.682-1.71c0-.665.267-1.253.735-1.7a2.448 2.448 0 0 1 1.722-.674 2.43 2.43 0 0 1 1.705.675c.211.2.381.43.504.683V4.7a1.255 1.255 0 0 1 1.255-1.255h1.744A1.255 1.255 0 0 1 65.812 4.7v3.335a4.76 4.76 0 0 1 1.526-.246c.938 0 1.817.214 2.59.69a4.47 4.47 0 0 1 1.67 1.743v-.98a1.255 1.255 0 0 1 1.256-1.256h1.777c.233 0 .451.064.639.174a3.407 3.407 0 0 1 1.567-.372c.346 0 .861.02 1.285.232a1.255 1.255 0 0 1 .689 1.004 4.73 4.73 0 0 1 .853-.588c.795-.44 1.675-.647 2.61-.647 1.385 0 2.65.39 3.525 1.396.836.938 1.168 2.173 1.168 3.528 0 .343-.02.694-.056 1.051a1.255 1.255 0 0 1-.947 1.09l.408.952a1.255 1.255 0 0 1-.477 1.552c-.418.268-.92.463-1.458.612-.613.171-1.304.244-2.049.244-1.06 0-2.043-.207-2.886-.698l-.015-.008c-.798-.48-1.419-1.135-1.818-1.963l-.004-.008a5.815 5.815 0 0 1-.548-2.512c0-.286.017-.567.053-.843a1.255 1.255 0 0 1-.333-.086l-.166-.004c-.223 0-.426.062-.643.228-.03.024-.142.139-.142.59v3.883a1.255 1.255 0 0 1-1.256 1.256h-1.777a1.255 1.255 0 0 1-1.256-1.256V15.69l-.032.057a4.778 4.778 0 0 1-1.86 1.833 5.04 5.04 0 0 1-2.484.634 4.47 4.47 0 0 1-1.935-.424 1.252 1.252 0 0 1-.764.258h-1.71a1.255 1.255 0 0 1-1.256-1.255V7.687a2.402 2.402 0 0 1-.428.625c.253.23.412.561.412.93v7.553a1.255 1.255 0 0 1-1.256 1.255h-1.843a1.25 1.25 0 0 1-.894-.373c-.228.23-.544.373-.894.373H51.32a1.255 1.255 0 0 1-1.256-1.255v-1.251l-.061.117a4.703 4.703 0 0 1-1.782 1.884 4.767 4.767 0 0 1-2.485.67 5.6 5.6 0 0 1-1.485-.188l.009 2.764a1.255 1.255 0 0 1-1.255 1.259h-1.729a1.255 1.255 0 0 1-1.255-1.255v-3.537a1.255 1.255 0 0 1-1.167.793h-1.679a1.25 1.25 0 0 1-.77-.263 4.47 4.47 0 0 1-1.945.429c-.885 0-1.724-.21-2.495-.632l-.017-.01a4.983 4.983 0 0 1-1.081-.836 1.255 1.255 0 0 1-1.254 1.312h-1.81a1.255 1.255 0 0 1-1.228-.99l-.782-3.625-2.044 3.939a1.255 1.255 0 0 1-1.115.676h-.098a1.255 1.255 0 0 1-1.116-.68l-2.061-3.994zM35.92 16.63l.207-.114.223-.15c.329-.237.574-.499.735-.785l.061-.118.033 1.332h1.678V9.242h-1.694l-.033 1.267c-.088-.22-.264-.438-.526-.658l-.032-.028a3.16 3.16 0 0 0-.668-.428l-.27-.12a3.293 3.293 0 0 0-1.235-.23c-.757 0-1.415.163-1.974.493a3.36 3.36 0 0 0-1.3 1.382c-.297.593-.444 1.284-.444 2.074 0 .8.17 1.503.51 2.107a3.795 3.795 0 0 0 1.382 1.381 3.883 3.883 0 0 0 1.893.477c.53 0 1.015-.11 1.455-.33zm-2.789-5.38c-.384.45-.575 1.038-.575 1.762 0 .735.186 1.332.559 1.794.384.45.933.675 1.645.675a2.25 2.25 0 0 0 .934-.19 2.17 2.17 0 0 0 .468-.29l.178-.161a2.163 2.163 0 0 0 .397-.561c.163-.333.244-.717.244-1.15v-.115c0-.472-.098-.894-.296-1.267l-.043-.077a2.211 2.211 0 0 0-.633-.709l-.13-.086-.047-.028a2.099 2.099 0 0 0-1.073-.285c-.702 0-1.244.231-1.629.692zm2.316 2.706c.163-.17.28-.407.28-.83v-.114c0-.292-.06-.508-.15-.68a.958.958 0 0 0-.353-.389.851.851 0 0 0-.464-.127c-.4 0-.56.114-.664.239l-.01.012c-.148.174-.275.45-.275.945 0 .506.122.801.27.99.097.11.266.224.68.224.303 0 .504-.09.687-.269zm7.545 1.705a2.626 2.626 0 0 0 .331.423c.213.22.464.402.755.548l.173.074c.433.17.93.255 1.49.255.68 0 1.295-.165 1.844-.493a3.447 3.447 0 0 0 1.316-1.4c.329-.603.493-1.299.493-2.089 0-1.273-.33-2.243-.988-2.913-.658-.68-1.52-1.02-2.584-1.02-.598 0-1.124.115-1.575.347a2.807 2.807 0 0 0-.415.262l-.199.166a3.35 3.35 0 0 0-.64.82V9.242h-1.712v11.553h1.729l-.017-5.134zm.53-1.138c.137.193.297.36.48.5l.155.11.053.034c.34.197.713.297 1.119.297.714 0 1.262-.225 1.645-.675.385-.46.576-1.048.576-1.762 0-.746-.192-1.338-.576-1.777-.372-.45-.92-.675-1.645-.675-.29 0-.569.053-.835.16a2.366 2.366 0 0 0-.284.136 1.99 1.99 0 0 0-.363.254 2.237 2.237 0 0 0-.46.569l-.082.162a2.56 2.56 0 0 0-.213 1.072v.115c0 .471.098.894.296 1.267l.135.211zm.964-.818a1.11 1.11 0 0 0 .367.385.937.937 0 0 0 .476.118c.423 0 .59-.117.687-.23.159-.194.28-.478.28-.95 0-.53-.133-.8-.266-.952l-.021-.025c-.078-.094-.231-.221-.68-.221a.995.995 0 0 0-.503.135l-.012.007a.859.859 0 0 0-.335.343c-.073.133-.132.324-.132.614v.115a1.43 1.43 0 0 0 .14.66zm15.7-6.222c.232-.23.346-.516.346-.856a1.053 1.053 0 0 0-.345-.79 1.175 1.175 0 0 0-.84-.329c-.34 0-.625.11-.855.33a1.053 1.053 0 0 0-.346.79c0 .34.115.625.346.855.23.23.516.346.856.346.34 0 .62-.115.839-.346zm4.337 9.314.033-1.332c.128.269.324.518.59.747l.098.081a3.727 3.727 0 0 0 .316.224l.223.122a3.21 3.21 0 0 0 1.44.322 3.785 3.785 0 0 0 1.875-.477 3.52 3.52 0 0 0 1.382-1.366c.352-.593.526-1.29.526-2.09 0-.79-.147-1.48-.444-2.073a3.235 3.235 0 0 0-1.283-1.399c-.549-.34-1.195-.51-1.942-.51a3.476 3.476 0 0 0-1.527.344l-.086.043-.165.09a3.412 3.412 0 0 0-.33.214c-.288.21-.507.446-.656.707a1.893 1.893 0 0 0-.099.198l.082-1.283V4.701h-1.744v12.095zm.473-2.509a2.482 2.482 0 0 0 .566.7c.078.065.159.125.245.18l.144.08a2.105 2.105 0 0 0 .975.232c.713 0 1.262-.225 1.645-.675.384-.46.576-1.053.576-1.778 0-.734-.192-1.327-.576-1.777-.373-.46-.921-.692-1.645-.692a2.18 2.18 0 0 0-1.015.235c-.147.075-.285.17-.415.282l-.15.142a2.086 2.086 0 0 0-.42.594c-.149.32-.223.685-.223 1.1v.115c0 .47.097.89.293 1.26zm2.616-.293c.157-.191.28-.479.28-.967 0-.51-.13-.79-.276-.961l-.021-.026c-.082-.1-.232-.225-.67-.225a.868.868 0 0 0-.681.279l-.012.011c-.154.155-.274.38-.274.807v.115c0 .285.057.499.144.669a1.13 1.13 0 0 0 .367.405c.137.082.28.123.455.123.423 0 .59-.118.686-.23zm8.266-3.013c.23-.087.472-.134.724-.14l.069-.002c.329 0 .542.033.642.099l.247-1.794c-.13-.066-.37-.099-.717-.099a2.3 2.3 0 0 0-.545.063 2.086 2.086 0 0 0-.411.148 2.18 2.18 0 0 0-.4.249 2.482 2.482 0 0 0-.485.499 2.659 2.659 0 0 0-.32.581l-.05.137v-1.48h-1.778v7.553h1.777v-3.884c0-.364.053-.678.159-.943a1.49 1.49 0 0 1 .466-.636 2.52 2.52 0 0 1 .399-.253 2.19 2.19 0 0 1 .224-.099zm9.784 2.656.05-.922c0-1.162-.285-2.062-.856-2.698-.559-.647-1.42-.97-2.584-.97-.746 0-1.415.163-2.007.493a3.462 3.462 0 0 0-1.4 1.382c-.329.604-.493 1.306-.493 2.106 0 .714.143 1.371.428 1.975.285.593.73 1.07 1.332 1.432.604.351 1.355.526 2.255.526.649 0 1.204-.062 1.668-.185l.044-.012.135-.04c.409-.122.736-.263.984-.421l-.542-1.267c-.2.108-.415.199-.642.274l-.297.087c-.34.088-.773.131-1.3.131-.636 0-1.135-.147-1.497-.444a1.573 1.573 0 0 1-.192-.193c-.244-.294-.415-.705-.512-1.234l-.004-.021h5.43zm-5.427-1.256-.003.022h3.752v-.138c-.007-.485-.104-.857-.288-1.118a1.056 1.056 0 0 0-.156-.176c-.307-.285-.746-.428-1.316-.428-.657 0-1.155.202-1.494.604-.253.3-.417.712-.494 1.234zm-27.053 2.77V4.7h-1.86v12.095h5.333V15.15zm7.103-5.908v7.553h-1.843V9.242h1.843z'/%3E%3Cpath fill='%23fff' d='m19.63 11.151-.757-1.71-.345 1.71-1.12 5.644h-1.827L18.083 4.7h.197l3.325 6.533.988 2.19.988-2.19L26.839 4.7h.181l2.6 12.095h-1.81l-1.218-5.644-.362-1.71-.658 1.71-2.93 5.644h-.098l-2.913-5.644zm14.836 5.81c-.68 0-1.311-.16-1.893-.478a3.795 3.795 0 0 1-1.381-1.382c-.34-.604-.51-1.306-.51-2.106 0-.79.147-1.482.444-2.074a3.364 3.364 0 0 1 1.3-1.382c.559-.33 1.217-.494 1.974-.494a3.293 3.293 0 0 1 1.234.231 3.341 3.341 0 0 1 .97.575c.264.22.44.439.527.659l.033-1.267h1.694v7.553H37.18l-.033-1.332c-.186.395-.526.746-1.02 1.053a3.167 3.167 0 0 1-1.662.444zm.296-1.482c.626 0 1.152-.214 1.58-.642.428-.44.642-1.01.642-1.711v-.115c0-.472-.098-.894-.296-1.267a2.211 2.211 0 0 0-.807-.872 2.098 2.098 0 0 0-1.119-.313c-.702 0-1.245.231-1.629.692-.384.45-.575 1.037-.575 1.76 0 .736.186 1.333.559 1.795.384.45.933.675 1.645.675zm6.521-6.237h1.711v1.4c.604-1.065 1.547-1.597 2.83-1.597 1.064 0 1.926.34 2.584 1.02.659.67.988 1.641.988 2.914 0 .79-.164 1.487-.493 2.09a3.456 3.456 0 0 1-1.316 1.399 3.51 3.51 0 0 1-1.844.493c-.636 0-1.19-.11-1.662-.329a2.665 2.665 0 0 1-1.086-.97l.017 5.134h-1.728V9.242zm4.048 6.22c.714 0 1.262-.224 1.645-.674.385-.46.576-1.048.576-1.762 0-.746-.192-1.338-.576-1.777-.372-.45-.92-.675-1.645-.675-.395 0-.768.098-1.12.296-.34.187-.613.46-.822.823-.197.351-.296.763-.296 1.234v.115c0 .472.098.894.296 1.267.209.362.483.647.823.855.34.197.713.297 1.119.297z'/%3E%3Cpath fill='%23e1e3e9' d='M51.325 4.7h1.86v10.45h3.473v1.646h-5.333zm7.12 4.542h1.843v7.553h-1.843zm.905-1.415a1.159 1.159 0 0 1-.856-.346 1.165 1.165 0 0 1-.346-.856 1.053 1.053 0 0 1 .346-.79c.23-.219.516-.329.856-.329.329 0 .609.11.839.33a1.053 1.053 0 0 1 .345.79 1.159 1.159 0 0 1-.345.855c-.22.23-.5.346-.84.346zm7.875 9.133a3.167 3.167 0 0 1-1.662-.444c-.482-.307-.817-.658-1.004-1.053l-.033 1.332h-1.71V4.701h1.743v4.657l-.082 1.283c.186-.438.548-.812 1.086-1.119a3.486 3.486 0 0 1 1.778-.477c.746 0 1.393.17 1.942.51a3.235 3.235 0 0 1 1.283 1.4c.297.592.444 1.282.444 2.072 0 .8-.175 1.498-.526 2.09a3.52 3.52 0 0 1-1.382 1.366 3.785 3.785 0 0 1-1.876.477zm-.296-1.481c.713 0 1.26-.225 1.645-.675.384-.46.577-1.053.577-1.778 0-.734-.193-1.327-.577-1.776-.373-.46-.921-.692-1.645-.692a2.115 2.115 0 0 0-1.58.659c-.428.428-.642.992-.642 1.694v.115c0 .473.098.895.296 1.267a2.385 2.385 0 0 0 .807.872 2.1 2.1 0 0 0 1.119.313zm5.927-6.237h1.777v1.481c.176-.505.46-.91.856-1.217a2.14 2.14 0 0 1 1.349-.46c.351 0 .593.032.724.098l-.247 1.794c-.099-.066-.313-.099-.642-.099-.516 0-.988.164-1.416.494-.417.329-.626.855-.626 1.58v3.883h-1.777V9.242zm9.534 7.718c-.9 0-1.651-.175-2.255-.526-.603-.362-1.047-.84-1.332-1.432a4.567 4.567 0 0 1-.428-1.975c0-.8.164-1.502.493-2.106a3.462 3.462 0 0 1 1.4-1.382c.592-.33 1.262-.494 2.007-.494 1.163 0 2.024.324 2.584.97.57.637.856 1.537.856 2.7 0 .296-.017.603-.05.92h-5.43c.12.67.356 1.153.708 1.45.362.296.86.443 1.497.443.526 0 .96-.044 1.3-.131a4.123 4.123 0 0 0 .938-.362l.542 1.267c-.274.175-.647.329-1.119.46-.472.132-1.042.197-1.711.197zm1.596-4.558c.01-.68-.137-1.158-.444-1.432-.307-.285-.746-.428-1.316-.428-1.152 0-1.815.62-1.991 1.86h3.752z'/%3E%3Cg fill-rule='evenodd' stroke-width='1.036'%3E%3Cpath fill='%23000' fill-opacity='.4' d='m8.166 16.146-.002.002a1.54 1.54 0 0 1-2.009 0l-.002-.002-.043-.034-.002-.002-.199-.162H4.377a.657.657 0 0 0-.659.659v1.84a.657.657 0 0 0 .659.659h5.565a.657.657 0 0 0 .659-.659v-1.84a.657.657 0 0 0-.659-.659H8.411l-.202.164zm-1.121-.905a.29.29 0 0 0 .113.023.286.286 0 0 0 .189-.07l.077-.063c.634-.508 4.672-3.743 4.672-7.575 0-2.55-2.215-4.625-4.938-4.625S2.221 5.006 2.221 7.556c0 3.225 2.86 6.027 4.144 7.137h.004l.04.038.484.4.077.063a.628.628 0 0 0 .074.047zm-2.52-.548a16.898 16.898 0 0 1-1.183-1.315C2.187 11.942.967 9.897.967 7.555c0-3.319 2.855-5.88 6.192-5.88 3.338 0 6.193 2.561 6.193 5.881 0 2.34-1.22 4.387-2.376 5.822a16.898 16.898 0 0 1-1.182 1.315h.15a1.912 1.912 0 0 1 1.914 1.914v1.84a1.912 1.912 0 0 1-1.914 1.914H4.377a1.912 1.912 0 0 1-1.914-1.914v-1.84a1.912 1.912 0 0 1 1.914-1.914zm3.82-6.935c0 .692-.55 1.222-1.187 1.222s-1.185-.529-1.185-1.222.548-1.222 1.185-1.222c.638 0 1.186.529 1.186 1.222zm-1.186 2.477c1.348 0 2.442-1.11 2.442-2.478S8.507 5.28 7.159 5.28 4.72 6.39 4.72 7.758s1.092 2.477 2.44 2.477zm2.048 7.71H5.114v-.838h4.093z'/%3E%3Cpath fill='%23e1e3e9' d='M2.222 7.555c0-2.55 2.214-4.625 4.937-4.625 2.723 0 4.938 2.075 4.938 4.625 0 3.832-4.038 7.068-4.672 7.575l-.077.063a.286.286 0 0 1-.189.07.286.286 0 0 1-.188-.07l-.077-.063c-.634-.507-4.672-3.743-4.672-7.575zm4.937 2.68c1.348 0 2.442-1.11 2.442-2.478S8.507 5.28 7.159 5.28 4.72 6.39 4.72 7.758s1.092 2.477 2.44 2.477z'/%3E%3Cpath fill='%23fff' d='M4.377 15.948a.657.657 0 0 0-.659.659v1.84a.657.657 0 0 0 .659.659h5.565a.657.657 0 0 0 .659-.659v-1.84a.657.657 0 0 0-.659-.659zm4.83 1.16H5.114v.838h4.093z'/%3E%3C/g%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){a.maplibregl-ctrl-logo{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='88' height='23' fill='none'%3E%3Cpath fill='%23000' fill-opacity='.4' fill-rule='evenodd' d='M17.408 16.796h-1.827l2.501-12.095h.198l3.324 6.533.988 2.19.988-2.19 3.258-6.533h.181l2.6 12.095h-1.81l-1.218-5.644-.362-1.71-.658 1.71-2.929 5.644h-.098l-2.914-5.644-.757-1.71-.345 1.71zm1.958-3.42-.726 3.663a1.255 1.255 0 0 1-1.232 1.011h-1.827a1.255 1.255 0 0 1-1.229-1.509l2.501-12.095a1.255 1.255 0 0 1 1.23-1.001h.197a1.255 1.255 0 0 1 1.12.685l3.19 6.273 3.125-6.263a1.255 1.255 0 0 1 1.123-.695h.181a1.255 1.255 0 0 1 1.227.991l1.443 6.71a5.11 5.11 0 0 1 .314-.787l.009-.016a4.623 4.623 0 0 1 1.777-1.887c.782-.46 1.668-.667 2.611-.667a4.548 4.548 0 0 1 1.7.32l.306.134c.21-.16.474-.256.759-.256h1.694a1.255 1.255 0 0 1 1.212.925 1.255 1.255 0 0 1 1.212-.925h1.711c.284 0 .545.094.755.252.613-.3 1.312-.45 2.075-.45 1.356 0 2.557.445 3.482 1.4.314.319.566.676.763 1.064V4.701a1.255 1.255 0 0 1 1.255-1.255h1.86A1.255 1.255 0 0 1 54.44 4.7v9.194h2.217c.19 0 .37.043.532.118v-4.77c0-.356.147-.678.385-.906a2.416 2.416 0 0 1-.682-1.71c0-.665.267-1.253.735-1.7a2.448 2.448 0 0 1 1.722-.674 2.43 2.43 0 0 1 1.705.675c.211.2.381.43.504.683V4.7a1.255 1.255 0 0 1 1.255-1.255h1.744A1.255 1.255 0 0 1 65.812 4.7v3.335a4.76 4.76 0 0 1 1.526-.246c.938 0 1.817.214 2.59.69a4.47 4.47 0 0 1 1.67 1.743v-.98a1.255 1.255 0 0 1 1.256-1.256h1.777c.233 0 .451.064.639.174a3.407 3.407 0 0 1 1.567-.372c.346 0 .861.02 1.285.232a1.255 1.255 0 0 1 .689 1.004 4.73 4.73 0 0 1 .853-.588c.795-.44 1.675-.647 2.61-.647 1.385 0 2.65.39 3.525 1.396.836.938 1.168 2.173 1.168 3.528 0 .343-.02.694-.056 1.051a1.255 1.255 0 0 1-.947 1.09l.408.952a1.255 1.255 0 0 1-.477 1.552c-.418.268-.92.463-1.458.612-.613.171-1.304.244-2.049.244-1.06 0-2.043-.207-2.886-.698l-.015-.008c-.798-.48-1.419-1.135-1.818-1.963l-.004-.008a5.815 5.815 0 0 1-.548-2.512c0-.286.017-.567.053-.843a1.255 1.255 0 0 1-.333-.086l-.166-.004c-.223 0-.426.062-.643.228-.03.024-.142.139-.142.59v3.883a1.255 1.255 0 0 1-1.256 1.256h-1.777a1.255 1.255 0 0 1-1.256-1.256V15.69l-.032.057a4.778 4.778 0 0 1-1.86 1.833 5.04 5.04 0 0 1-2.484.634 4.47 4.47 0 0 1-1.935-.424 1.252 1.252 0 0 1-.764.258h-1.71a1.255 1.255 0 0 1-1.256-1.255V7.687a2.402 2.402 0 0 1-.428.625c.253.23.412.561.412.93v7.553a1.255 1.255 0 0 1-1.256 1.255h-1.843a1.25 1.25 0 0 1-.894-.373c-.228.23-.544.373-.894.373H51.32a1.255 1.255 0 0 1-1.256-1.255v-1.251l-.061.117a4.703 4.703 0 0 1-1.782 1.884 4.767 4.767 0 0 1-2.485.67 5.6 5.6 0 0 1-1.485-.188l.009 2.764a1.255 1.255 0 0 1-1.255 1.259h-1.729a1.255 1.255 0 0 1-1.255-1.255v-3.537a1.255 1.255 0 0 1-1.167.793h-1.679a1.25 1.25 0 0 1-.77-.263 4.47 4.47 0 0 1-1.945.429c-.885 0-1.724-.21-2.495-.632l-.017-.01a4.983 4.983 0 0 1-1.081-.836 1.255 1.255 0 0 1-1.254 1.312h-1.81a1.255 1.255 0 0 1-1.228-.99l-.782-3.625-2.044 3.939a1.255 1.255 0 0 1-1.115.676h-.098a1.255 1.255 0 0 1-1.116-.68l-2.061-3.994zM35.92 16.63l.207-.114.223-.15c.329-.237.574-.499.735-.785l.061-.118.033 1.332h1.678V9.242h-1.694l-.033 1.267c-.088-.22-.264-.438-.526-.658l-.032-.028a3.16 3.16 0 0 0-.668-.428l-.27-.12a3.293 3.293 0 0 0-1.235-.23c-.757 0-1.415.163-1.974.493a3.36 3.36 0 0 0-1.3 1.382c-.297.593-.444 1.284-.444 2.074 0 .8.17 1.503.51 2.107a3.795 3.795 0 0 0 1.382 1.381 3.883 3.883 0 0 0 1.893.477c.53 0 1.015-.11 1.455-.33zm-2.789-5.38c-.384.45-.575 1.038-.575 1.762 0 .735.186 1.332.559 1.794.384.45.933.675 1.645.675a2.25 2.25 0 0 0 .934-.19 2.17 2.17 0 0 0 .468-.29l.178-.161a2.163 2.163 0 0 0 .397-.561c.163-.333.244-.717.244-1.15v-.115c0-.472-.098-.894-.296-1.267l-.043-.077a2.211 2.211 0 0 0-.633-.709l-.13-.086-.047-.028a2.099 2.099 0 0 0-1.073-.285c-.702 0-1.244.231-1.629.692zm2.316 2.706c.163-.17.28-.407.28-.83v-.114c0-.292-.06-.508-.15-.68a.958.958 0 0 0-.353-.389.851.851 0 0 0-.464-.127c-.4 0-.56.114-.664.239l-.01.012c-.148.174-.275.45-.275.945 0 .506.122.801.27.99.097.11.266.224.68.224.303 0 .504-.09.687-.269zm7.545 1.705a2.626 2.626 0 0 0 .331.423c.213.22.464.402.755.548l.173.074c.433.17.93.255 1.49.255.68 0 1.295-.165 1.844-.493a3.447 3.447 0 0 0 1.316-1.4c.329-.603.493-1.299.493-2.089 0-1.273-.33-2.243-.988-2.913-.658-.68-1.52-1.02-2.584-1.02-.598 0-1.124.115-1.575.347a2.807 2.807 0 0 0-.415.262l-.199.166a3.35 3.35 0 0 0-.64.82V9.242h-1.712v11.553h1.729l-.017-5.134zm.53-1.138c.137.193.297.36.48.5l.155.11.053.034c.34.197.713.297 1.119.297.714 0 1.262-.225 1.645-.675.385-.46.576-1.048.576-1.762 0-.746-.192-1.338-.576-1.777-.372-.45-.92-.675-1.645-.675-.29 0-.569.053-.835.16a2.366 2.366 0 0 0-.284.136 1.99 1.99 0 0 0-.363.254 2.237 2.237 0 0 0-.46.569l-.082.162a2.56 2.56 0 0 0-.213 1.072v.115c0 .471.098.894.296 1.267l.135.211zm.964-.818a1.11 1.11 0 0 0 .367.385.937.937 0 0 0 .476.118c.423 0 .59-.117.687-.23.159-.194.28-.478.28-.95 0-.53-.133-.8-.266-.952l-.021-.025c-.078-.094-.231-.221-.68-.221a.995.995 0 0 0-.503.135l-.012.007a.859.859 0 0 0-.335.343c-.073.133-.132.324-.132.614v.115a1.43 1.43 0 0 0 .14.66zm15.7-6.222c.232-.23.346-.516.346-.856a1.053 1.053 0 0 0-.345-.79 1.175 1.175 0 0 0-.84-.329c-.34 0-.625.11-.855.33a1.053 1.053 0 0 0-.346.79c0 .34.115.625.346.855.23.23.516.346.856.346.34 0 .62-.115.839-.346zm4.337 9.314.033-1.332c.128.269.324.518.59.747l.098.081a3.727 3.727 0 0 0 .316.224l.223.122a3.21 3.21 0 0 0 1.44.322 3.785 3.785 0 0 0 1.875-.477 3.52 3.52 0 0 0 1.382-1.366c.352-.593.526-1.29.526-2.09 0-.79-.147-1.48-.444-2.073a3.235 3.235 0 0 0-1.283-1.399c-.549-.34-1.195-.51-1.942-.51a3.476 3.476 0 0 0-1.527.344l-.086.043-.165.09a3.412 3.412 0 0 0-.33.214c-.288.21-.507.446-.656.707a1.893 1.893 0 0 0-.099.198l.082-1.283V4.701h-1.744v12.095zm.473-2.509a2.482 2.482 0 0 0 .566.7c.078.065.159.125.245.18l.144.08a2.105 2.105 0 0 0 .975.232c.713 0 1.262-.225 1.645-.675.384-.46.576-1.053.576-1.778 0-.734-.192-1.327-.576-1.777-.373-.46-.921-.692-1.645-.692a2.18 2.18 0 0 0-1.015.235c-.147.075-.285.17-.415.282l-.15.142a2.086 2.086 0 0 0-.42.594c-.149.32-.223.685-.223 1.1v.115c0 .47.097.89.293 1.26zm2.616-.293c.157-.191.28-.479.28-.967 0-.51-.13-.79-.276-.961l-.021-.026c-.082-.1-.232-.225-.67-.225a.868.868 0 0 0-.681.279l-.012.011c-.154.155-.274.38-.274.807v.115c0 .285.057.499.144.669a1.13 1.13 0 0 0 .367.405c.137.082.28.123.455.123.423 0 .59-.118.686-.23zm8.266-3.013c.23-.087.472-.134.724-.14l.069-.002c.329 0 .542.033.642.099l.247-1.794c-.13-.066-.37-.099-.717-.099a2.3 2.3 0 0 0-.545.063 2.086 2.086 0 0 0-.411.148 2.18 2.18 0 0 0-.4.249 2.482 2.482 0 0 0-.485.499 2.659 2.659 0 0 0-.32.581l-.05.137v-1.48h-1.778v7.553h1.777v-3.884c0-.364.053-.678.159-.943a1.49 1.49 0 0 1 .466-.636 2.52 2.52 0 0 1 .399-.253 2.19 2.19 0 0 1 .224-.099zm9.784 2.656.05-.922c0-1.162-.285-2.062-.856-2.698-.559-.647-1.42-.97-2.584-.97-.746 0-1.415.163-2.007.493a3.462 3.462 0 0 0-1.4 1.382c-.329.604-.493 1.306-.493 2.106 0 .714.143 1.371.428 1.975.285.593.73 1.07 1.332 1.432.604.351 1.355.526 2.255.526.649 0 1.204-.062 1.668-.185l.044-.012.135-.04c.409-.122.736-.263.984-.421l-.542-1.267c-.2.108-.415.199-.642.274l-.297.087c-.34.088-.773.131-1.3.131-.636 0-1.135-.147-1.497-.444a1.573 1.573 0 0 1-.192-.193c-.244-.294-.415-.705-.512-1.234l-.004-.021h5.43zm-5.427-1.256-.003.022h3.752v-.138c-.007-.485-.104-.857-.288-1.118a1.056 1.056 0 0 0-.156-.176c-.307-.285-.746-.428-1.316-.428-.657 0-1.155.202-1.494.604-.253.3-.417.712-.494 1.234zm-27.053 2.77V4.7h-1.86v12.095h5.333V15.15zm7.103-5.908v7.553h-1.843V9.242h1.843z'/%3E%3Cpath fill='%23fff' d='m19.63 11.151-.757-1.71-.345 1.71-1.12 5.644h-1.827L18.083 4.7h.197l3.325 6.533.988 2.19.988-2.19L26.839 4.7h.181l2.6 12.095h-1.81l-1.218-5.644-.362-1.71-.658 1.71-2.93 5.644h-.098l-2.913-5.644zm14.836 5.81c-.68 0-1.311-.16-1.893-.478a3.795 3.795 0 0 1-1.381-1.382c-.34-.604-.51-1.306-.51-2.106 0-.79.147-1.482.444-2.074a3.364 3.364 0 0 1 1.3-1.382c.559-.33 1.217-.494 1.974-.494a3.293 3.293 0 0 1 1.234.231 3.341 3.341 0 0 1 .97.575c.264.22.44.439.527.659l.033-1.267h1.694v7.553H37.18l-.033-1.332c-.186.395-.526.746-1.02 1.053a3.167 3.167 0 0 1-1.662.444zm.296-1.482c.626 0 1.152-.214 1.58-.642.428-.44.642-1.01.642-1.711v-.115c0-.472-.098-.894-.296-1.267a2.211 2.211 0 0 0-.807-.872 2.098 2.098 0 0 0-1.119-.313c-.702 0-1.245.231-1.629.692-.384.45-.575 1.037-.575 1.76 0 .736.186 1.333.559 1.795.384.45.933.675 1.645.675zm6.521-6.237h1.711v1.4c.604-1.065 1.547-1.597 2.83-1.597 1.064 0 1.926.34 2.584 1.02.659.67.988 1.641.988 2.914 0 .79-.164 1.487-.493 2.09a3.456 3.456 0 0 1-1.316 1.399 3.51 3.51 0 0 1-1.844.493c-.636 0-1.19-.11-1.662-.329a2.665 2.665 0 0 1-1.086-.97l.017 5.134h-1.728V9.242zm4.048 6.22c.714 0 1.262-.224 1.645-.674.385-.46.576-1.048.576-1.762 0-.746-.192-1.338-.576-1.777-.372-.45-.92-.675-1.645-.675-.395 0-.768.098-1.12.296-.34.187-.613.46-.822.823-.197.351-.296.763-.296 1.234v.115c0 .472.098.894.296 1.267.209.362.483.647.823.855.34.197.713.297 1.119.297z'/%3E%3Cpath fill='%23e1e3e9' d='M51.325 4.7h1.86v10.45h3.473v1.646h-5.333zm7.12 4.542h1.843v7.553h-1.843zm.905-1.415a1.159 1.159 0 0 1-.856-.346 1.165 1.165 0 0 1-.346-.856 1.053 1.053 0 0 1 .346-.79c.23-.219.516-.329.856-.329.329 0 .609.11.839.33a1.053 1.053 0 0 1 .345.79 1.159 1.159 0 0 1-.345.855c-.22.23-.5.346-.84.346zm7.875 9.133a3.167 3.167 0 0 1-1.662-.444c-.482-.307-.817-.658-1.004-1.053l-.033 1.332h-1.71V4.701h1.743v4.657l-.082 1.283c.186-.438.548-.812 1.086-1.119a3.486 3.486 0 0 1 1.778-.477c.746 0 1.393.17 1.942.51a3.235 3.235 0 0 1 1.283 1.4c.297.592.444 1.282.444 2.072 0 .8-.175 1.498-.526 2.09a3.52 3.52 0 0 1-1.382 1.366 3.785 3.785 0 0 1-1.876.477zm-.296-1.481c.713 0 1.26-.225 1.645-.675.384-.46.577-1.053.577-1.778 0-.734-.193-1.327-.577-1.776-.373-.46-.921-.692-1.645-.692a2.115 2.115 0 0 0-1.58.659c-.428.428-.642.992-.642 1.694v.115c0 .473.098.895.296 1.267a2.385 2.385 0 0 0 .807.872 2.1 2.1 0 0 0 1.119.313zm5.927-6.237h1.777v1.481c.176-.505.46-.91.856-1.217a2.14 2.14 0 0 1 1.349-.46c.351 0 .593.032.724.098l-.247 1.794c-.099-.066-.313-.099-.642-.099-.516 0-.988.164-1.416.494-.417.329-.626.855-.626 1.58v3.883h-1.777V9.242zm9.534 7.718c-.9 0-1.651-.175-2.255-.526-.603-.362-1.047-.84-1.332-1.432a4.567 4.567 0 0 1-.428-1.975c0-.8.164-1.502.493-2.106a3.462 3.462 0 0 1 1.4-1.382c.592-.33 1.262-.494 2.007-.494 1.163 0 2.024.324 2.584.97.57.637.856 1.537.856 2.7 0 .296-.017.603-.05.92h-5.43c.12.67.356 1.153.708 1.45.362.296.86.443 1.497.443.526 0 .96-.044 1.3-.131a4.123 4.123 0 0 0 .938-.362l.542 1.267c-.274.175-.647.329-1.119.46-.472.132-1.042.197-1.711.197zm1.596-4.558c.01-.68-.137-1.158-.444-1.432-.307-.285-.746-.428-1.316-.428-1.152 0-1.815.62-1.991 1.86h3.752z'/%3E%3Cg fill-rule='evenodd' stroke-width='1.036'%3E%3Cpath fill='%23000' fill-opacity='.4' d='m8.166 16.146-.002.002a1.54 1.54 0 0 1-2.009 0l-.002-.002-.043-.034-.002-.002-.199-.162H4.377a.657.657 0 0 0-.659.659v1.84a.657.657 0 0 0 .659.659h5.565a.657.657 0 0 0 .659-.659v-1.84a.657.657 0 0 0-.659-.659H8.411l-.202.164zm-1.121-.905a.29.29 0 0 0 .113.023.286.286 0 0 0 .189-.07l.077-.063c.634-.508 4.672-3.743 4.672-7.575 0-2.55-2.215-4.625-4.938-4.625S2.221 5.006 2.221 7.556c0 3.225 2.86 6.027 4.144 7.137h.004l.04.038.484.4.077.063a.628.628 0 0 0 .074.047zm-2.52-.548a16.898 16.898 0 0 1-1.183-1.315C2.187 11.942.967 9.897.967 7.555c0-3.319 2.855-5.88 6.192-5.88 3.338 0 6.193 2.561 6.193 5.881 0 2.34-1.22 4.387-2.376 5.822a16.898 16.898 0 0 1-1.182 1.315h.15a1.912 1.912 0 0 1 1.914 1.914v1.84a1.912 1.912 0 0 1-1.914 1.914H4.377a1.912 1.912 0 0 1-1.914-1.914v-1.84a1.912 1.912 0 0 1 1.914-1.914zm3.82-6.935c0 .692-.55 1.222-1.187 1.222s-1.185-.529-1.185-1.222.548-1.222 1.185-1.222c.638 0 1.186.529 1.186 1.222zm-1.186 2.477c1.348 0 2.442-1.11 2.442-2.478S8.507 5.28 7.159 5.28 4.72 6.39 4.72 7.758s1.092 2.477 2.44 2.477zm2.048 7.71H5.114v-.838h4.093z'/%3E%3Cpath fill='%23e1e3e9' d='M2.222 7.555c0-2.55 2.214-4.625 4.937-4.625 2.723 0 4.938 2.075 4.938 4.625 0 3.832-4.038 7.068-4.672 7.575l-.077.063a.286.286 0 0 1-.189.07.286.286 0 0 1-.188-.07l-.077-.063c-.634-.507-4.672-3.743-4.672-7.575zm4.937 2.68c1.348 0 2.442-1.11 2.442-2.478S8.507 5.28 7.159 5.28 4.72 6.39 4.72 7.758s1.092 2.477 2.44 2.477z'/%3E%3Cpath fill='%23fff' d='M4.377 15.948a.657.657 0 0 0-.659.659v1.84a.657.657 0 0 0 .659.659h5.565a.657.657 0 0 0 .659-.659v-1.84a.657.657 0 0 0-.659-.659zm4.83 1.16H5.114v.838h4.093z'/%3E%3C/g%3E%3C/svg%3E\")}}.maplibregl-ctrl.maplibregl-ctrl-attrib{background-color:#ffffff80;margin:0;padding:0 5px}@media screen{.maplibregl-ctrl-attrib.maplibregl-compact{background-color:#fff;border-radius:12px;box-sizing:content-box;margin:10px;min-height:20px;padding:2px 24px 2px 0;position:relative}.maplibregl-ctrl-attrib.maplibregl-compact-show{padding:2px 28px 2px 8px;visibility:visible}.maplibregl-ctrl-bottom-left>.maplibregl-ctrl-attrib.maplibregl-compact-show,.maplibregl-ctrl-top-left>.maplibregl-ctrl-attrib.maplibregl-compact-show{border-radius:12px;padding:2px 8px 2px 28px}.maplibregl-ctrl-attrib.maplibregl-compact .maplibregl-ctrl-attrib-inner{display:none}.maplibregl-ctrl-attrib-button{background-color:#ffffff80;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' fill-rule='evenodd' viewBox='0 0 20 20'%3E%3Cpath d='M4 10a6 6 0 1 0 12 0 6 6 0 1 0-12 0m5-3a1 1 0 1 0 2 0 1 1 0 1 0-2 0m0 3a1 1 0 1 1 2 0v3a1 1 0 1 1-2 0'/%3E%3C/svg%3E\");border:0;border-radius:12px;box-sizing:border-box;cursor:pointer;display:none;height:24px;outline:none;position:absolute;right:0;top:0;width:24px}.maplibregl-ctrl-attrib summary.maplibregl-ctrl-attrib-button{-webkit-appearance:none;-moz-appearance:none;appearance:none;list-style:none}.maplibregl-ctrl-attrib summary.maplibregl-ctrl-attrib-button::-webkit-details-marker{display:none}.maplibregl-ctrl-bottom-left .maplibregl-ctrl-attrib-button,.maplibregl-ctrl-top-left .maplibregl-ctrl-attrib-button{left:0}.maplibregl-ctrl-attrib.maplibregl-compact .maplibregl-ctrl-attrib-button,.maplibregl-ctrl-attrib.maplibregl-compact-show .maplibregl-ctrl-attrib-inner{display:block}.maplibregl-ctrl-attrib.maplibregl-compact-show .maplibregl-ctrl-attrib-button{background-color:#0000000d}.maplibregl-ctrl-bottom-right>.maplibregl-ctrl-attrib.maplibregl-compact:after{bottom:0;right:0}.maplibregl-ctrl-top-right>.maplibregl-ctrl-attrib.maplibregl-compact:after{right:0;top:0}.maplibregl-ctrl-top-left>.maplibregl-ctrl-attrib.maplibregl-compact:after{left:0;top:0}.maplibregl-ctrl-bottom-left>.maplibregl-ctrl-attrib.maplibregl-compact:after{bottom:0;left:0}}@media screen and (-ms-high-contrast:active){.maplibregl-ctrl-attrib.maplibregl-compact:after{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' fill='%23fff' fill-rule='evenodd' viewBox='0 0 20 20'%3E%3Cpath d='M4 10a6 6 0 1 0 12 0 6 6 0 1 0-12 0m5-3a1 1 0 1 0 2 0 1 1 0 1 0-2 0m0 3a1 1 0 1 1 2 0v3a1 1 0 1 1-2 0'/%3E%3C/svg%3E\")}}@media screen and (-ms-high-contrast:black-on-white){.maplibregl-ctrl-attrib.maplibregl-compact:after{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' fill-rule='evenodd' viewBox='0 0 20 20'%3E%3Cpath d='M4 10a6 6 0 1 0 12 0 6 6 0 1 0-12 0m5-3a1 1 0 1 0 2 0 1 1 0 1 0-2 0m0 3a1 1 0 1 1 2 0v3a1 1 0 1 1-2 0'/%3E%3C/svg%3E\")}}.maplibregl-ctrl-attrib a{color:#000000bf;text-decoration:none}.maplibregl-ctrl-attrib a:hover{color:inherit;text-decoration:underline}.maplibregl-attrib-empty{display:none}.maplibregl-ctrl-scale{background-color:#ffffffbf;border:2px solid #333;border-top:#333;box-sizing:border-box;color:#333;font-size:10px;padding:0 5px}.maplibregl-popup{display:flex;left:0;pointer-events:none;position:absolute;top:0;will-change:transform}.maplibregl-popup-anchor-top,.maplibregl-popup-anchor-top-left,.maplibregl-popup-anchor-top-right{flex-direction:column}.maplibregl-popup-anchor-bottom,.maplibregl-popup-anchor-bottom-left,.maplibregl-popup-anchor-bottom-right{flex-direction:column-reverse}.maplibregl-popup-anchor-left{flex-direction:row}.maplibregl-popup-anchor-right{flex-direction:row-reverse}.maplibregl-popup-tip{border:10px solid transparent;height:0;width:0;z-index:1}.maplibregl-popup-anchor-top .maplibregl-popup-tip{align-self:center;border-bottom-color:#fff;border-top:none}.maplibregl-popup-anchor-top-left .maplibregl-popup-tip{align-self:flex-start;border-bottom-color:#fff;border-left:none;border-top:none}.maplibregl-popup-anchor-top-right .maplibregl-popup-tip{align-self:flex-end;border-bottom-color:#fff;border-right:none;border-top:none}.maplibregl-popup-anchor-bottom .maplibregl-popup-tip{align-self:center;border-bottom:none;border-top-color:#fff}.maplibregl-popup-anchor-bottom-left .maplibregl-popup-tip{align-self:flex-start;border-bottom:none;border-left:none;border-top-color:#fff}.maplibregl-popup-anchor-bottom-right .maplibregl-popup-tip{align-self:flex-end;border-bottom:none;border-right:none;border-top-color:#fff}.maplibregl-popup-anchor-left .maplibregl-popup-tip{align-self:center;border-left:none;border-right-color:#fff}.maplibregl-popup-anchor-right .maplibregl-popup-tip{align-self:center;border-left-color:#fff;border-right:none}.maplibregl-popup-close-button{background-color:transparent;border:0;border-radius:0 3px 0 0;cursor:pointer;position:absolute;right:0;top:0}.maplibregl-popup-close-button:hover{background-color:#0000000d}.maplibregl-popup-content{background:#fff;border-radius:3px;box-shadow:0 1px 2px #0000001a;padding:15px 10px;pointer-events:auto;position:relative}.maplibregl-popup-anchor-top-left .maplibregl-popup-content{border-top-left-radius:0}.maplibregl-popup-anchor-top-right .maplibregl-popup-content{border-top-right-radius:0}.maplibregl-popup-anchor-bottom-left .maplibregl-popup-content{border-bottom-left-radius:0}.maplibregl-popup-anchor-bottom-right .maplibregl-popup-content{border-bottom-right-radius:0}.maplibregl-popup-track-pointer{display:none}.maplibregl-popup-track-pointer *{pointer-events:none;-webkit-user-select:none;user-select:none}.maplibregl-map:hover .maplibregl-popup-track-pointer{display:flex}.maplibregl-map:active .maplibregl-popup-track-pointer{display:none}.maplibregl-marker{left:0;position:absolute;top:0;will-change:transform}.maplibregl-user-location-dot,.maplibregl-user-location-dot:before{background-color:#1da1f2;border-radius:50%;height:15px;width:15px}.maplibregl-user-location-dot:before{animation:maplibregl-user-location-dot-pulse 2s infinite;content:\"\";position:absolute}.maplibregl-user-location-dot:after{border:2px solid #fff;border-radius:50%;box-shadow:0 0 3px #00000059;box-sizing:border-box;content:\"\";height:19px;left:-2px;position:absolute;top:-2px;width:19px}@keyframes maplibregl-user-location-dot-pulse{0%{opacity:1;transform:scale(1)}70%{opacity:0;transform:scale(3)}to{opacity:0;transform:scale(1)}}.maplibregl-user-location-dot-stale{background-color:#aaa}.maplibregl-user-location-dot-stale:after{display:none}.maplibregl-user-location-accuracy-circle{background-color:#1da1f233;border-radius:100%;height:1px;width:1px}.maplibregl-crosshair,.maplibregl-crosshair .maplibregl-interactive,.maplibregl-crosshair .maplibregl-interactive:active{cursor:crosshair}.maplibregl-boxzoom{background:#fff;border:2px dotted #202020;height:0;left:0;opacity:.5;position:absolute;top:0;width:0}.maplibregl-cooperative-gesture-screen{align-items:center;background:rgba(0,0,0,.4);color:#fff;display:flex;font-size:1.4em;top:0;right:0;bottom:0;left:0;justify-content:center;line-height:1.2;opacity:0;padding:1rem;pointer-events:none;position:absolute;transition:opacity 1s ease 1s;z-index:99999}.maplibregl-cooperative-gesture-screen.maplibregl-show{opacity:1;transition:opacity .05s}.maplibregl-cooperative-gesture-screen .maplibregl-mobile-message{display:none}@media (hover:none),(width <= 480px){.maplibregl-cooperative-gesture-screen .maplibregl-desktop-message{display:none}.maplibregl-cooperative-gesture-screen .maplibregl-mobile-message{display:block}}.maplibregl-pseudo-fullscreen{height:100%!important;left:0!important;position:fixed!important;top:0!important;width:100%!important;z-index:99999}")),document.head.appendChild(t)}}catch(t){console.error("vite-plugin-css-injected-by-js",t)}}();class Le extends we{constructor(t){let e;super(t),t.transformRequest&&(e=(e,i)=>{if("function"==typeof t.transformRequest){const r=t.transformRequest(new URL(e),i);return{...r,url:r.url.toString()}}}),this.maplibre=new(Ce().Map)({...t,scrollZoom:!0,attributionControl:!1,transformRequest:e,style:{version:8,sources:{},layers:[]}}),this.maplibre.on("idle",(()=>{this.events.emit("map-x-idle",void 0)})),this.maplibre.on("render",(()=>{this.events.emit("map-x-render",void 0)})),this.maplibre.on("load",(()=>{this.events.emit("map-x-load",void 0)})),this.maplibre.on("mousemove",(t=>{if(!(t&&"object"==typeof t&&"point"in t&&t.point&&"object"==typeof t.point&&"x"in t.point&&"number"==typeof t.point.x&&"y"in t.point&&"number"==typeof t.point.y&&"lngLat"in t&&t.lngLat&&"object"==typeof t.lngLat&&"lng"in t.lngLat&&"number"==typeof t.lngLat.lng&&"lat"in t.lngLat&&"number"==typeof t.lngLat.lat))return;const e=[t.lngLat.lng,t.lngLat.lat];this.events.emit("map-x-cursor-updated",{coordinates:e,point:[t.point.x,t.point.y]})})),this.maplibre.on("click",(t=>{if(!(t&&"object"==typeof t&&"point"in t&&t.point&&"object"==typeof t.point&&"x"in t.point&&"number"==typeof t.point.x&&"y"in t.point&&"number"==typeof t.point.y&&"lngLat"in t&&t.lngLat&&"object"==typeof t.lngLat&&"lng"in t.lngLat&&"number"==typeof t.lngLat.lng&&"lat"in t.lngLat&&"number"==typeof t.lngLat.lat))return;const e=[t.lngLat.lng,t.lngLat.lat];this.events.emit("map-x-click",{coordinates:e,point:[t.point.x,t.point.y]}),this.events.emit("map-x-interaction",void 0)})),this.maplibre.on("wheel",(()=>{this.events.emit("map-x-interaction",void 0)})),this.maplibre.on("mousedown",(()=>{this.events.emit("map-x-interaction",void 0)})),this.maplibre.on("touchstart",(()=>{this.events.emit("map-x-interaction",void 0)}))}setStyle(t){if(t&&(this.maplibre.setStyle(t),!this.maplibre.getTerrain()&&t.terrain&&t.sources.hasOwnProperty("elevation-dem"))){const e="number"==typeof t.terrain.exaggeration?t.terrain.exaggeration:1;this.maplibre.setTerrain({source:t.terrain.source,exaggeration:e})}}triggerRepaint(){this.maplibre.triggerRepaint()}destroy(){this.maplibre.remove()}queryRenderedFeatures(t){let e;if(4===t.length){const[i,r,n,a]=t;e=[[i,r],[n,a]]}else e=t;const i=this.maplibre.queryRenderedFeatures(e),r=[];return i.forEach((t=>{var e,i;const n=this.maplibre.getSource(t.source),{type:a,properties:o}=t;let s=t.geometry;n&&"geojson"===n.type&&n.hasOwnProperty("_data")&&n._data.features&&(s=null==(e=n._data.features.find((e=>e.id===t.id)))?void 0:e.geometry);let l=t.id;if(l||(l=null==(i=t.properties)?void 0:i.id),!s&&t.toJSON&&"function"==typeof t.toJSON&&(s=t.toJSON().geometry),l&&"GeometryCollection"!==s.type){const e={id:l,type:a,properties:o||{},source:t.source,sourceLayer:t.sourceLayer||"",geometry:s};r.push(e)}})),r}queryTerrainElevation(t){if(!this.maplibre.getTerrain())return null;const e=ke.LngLat.convert(t),i=this.maplibre.transform.tileZoom,{tileID:r,mercatorX:n,mercatorY:a}=this.maplibre.terrain._getOverscaledTileIDFromLngLatZoom(e,i),o=8192;return this.maplibre.terrain.getDEMElevation(r,n%o,a%o,o)}getSource(t){return this.maplibre.getSource(t)}setCenter(t){this.maplibre.setCenter(t)}getCenter(){const{lng:t,lat:e}=this.maplibre.getCenter();return[t,e]}setPitch(t){this.maplibre.setPitch(t)}getPitch(){return this.maplibre.getPitch()}setZoom(t){this.maplibre.setZoom(t)}getZoom(){return this.maplibre.getZoom()}setBearing(t){this.maplibre.setBearing(t)}getBearing(){return this.maplibre.getBearing()}setFeatureState(t,e){this.maplibre.setFeatureState(t,e)}getBounds(){const t=this.maplibre.getBounds(),e=t.getSouthWest(),i=t.getNorthEast();return[e.lng,e.lat,i.lng,i.lat]}fitBounds(t,e){const[i,r,n,a]=t,o=()=>{this.maplibre.fitBounds([[i,r],[n,a]],e)};this.maplibre.getTerrain()?o():this.maplibre.once("terrain",o)}flyTo(t,e){const i=()=>{this.maplibre.flyTo(t,e)};this.maplibre.getTerrain()?i():this.maplibre.once("terrain",i)}easeTo(t,e){const i=()=>{this.maplibre.easeTo(t,e)};this.maplibre.getTerrain()?i():this.maplibre.once("terrain",i)}rotateTo(t,e){const i=()=>{this.maplibre.rotateTo(t.bearing||0,{duration:t.duration},e)};this.maplibre.getTerrain()?i():this.maplibre.once("terrain",i)}addImage(t,e){"string"==typeof e?this.maplibre.loadImage(e,((e,i)=>{i&&this.maplibre.addImage(t,i)})):this.maplibre.addImage(t,e)}addMarker(t){const e=new(Ce().Marker)({anchor:t.anchor||"bottom",draggable:!1,element:t.element}).setLngLat(t.location).addTo(this.maplibre);return new Se({setLonLat:t=>{e.setLngLat(t)},destroy:()=>{e.remove()}})}followCam(t,e){if(!t.feature||"Feature"!==t.feature.type||"LineString"!==t.feature.geometry.type)return;const i={center:this.maplibre.getCenter(),bearing:this.maplibre.getBearing(),zoom:this.maplibre.getZoom(),pitch:this.maplibre.getPitch()};this.events.emit("map-x-animation-start",{type:"follow-cam"});const r=Pe({type:t.feature.type,properties:t.feature.properties,geometry:t.feature.geometry});let n=!0,a=0,o=0;const s=new(Ce().Marker)({color:"#087AFF",element:be()}),l=ze(t.feature.geometry),c=Ee(t.feature.geometry,0).geometry.coordinates,[h,u]=c,d=Ae(l.geometry.coordinates[0],l.geometry.coordinates[1]);s.setLngLat([h,u]),s.addTo(this.maplibre),this.maplibre.flyTo({center:[h,u],bearing:d,zoom:16,duration:2e3},{flytoready:!0});const p=()=>{n=!1,this.maplibre.dragPan.enable(),s.remove(),this.events.emit("map-x-animation-end",{type:"follow-cam"})},m=()=>{cancelAnimationFrame(o),p(),this.events.unsubscribe("map-x-animation-cancel",m)},f=e=>{if(!t.feature||"Feature"!==t.feature.type||"LineString"!==t.feature.geometry.type)return;a||(a=e);const n=(e-a)/(1e4*r)||0,c=Ee(t.feature.geometry,r*n).geometry.coordinates,[h,u]=c;s.setLngLat([h,u]),s.addTo(this.maplibre);const d=Pe(l),m=Ee(l,d*((e-a)/(12e3*d)||0)).geometry.coordinates,[g,y]=m,_=this.maplibre.getCenter(),v=this.maplibre.getCameraTargetElevation();if(v){const t=function(t,e,i=.1){return{x:xe(t.x,e.x,i),y:xe(t.y,e.y,i),z:xe(t.z,e.z,i)}}({x:g,y,z:v||0},{x:_.lng,y:_.lat,z:v||0},.005),e=this.maplibre._getTransformForUpdate();e.center=ke.LngLat.convert([t.x,t.y]),this.maplibre._applyUpdatedTransform(e),this.maplibre._fireMoveEvents()}this.maplibre.triggerRepaint(),n<1?o=requestAnimationFrame(f):(p(),this.maplibre.flyTo({...i,duration:3e3},{reset:!0}))};this.maplibre.once("moveend",(t=>{t&&t.hasOwnProperty("flytoready")&&n&&(f(0),this.maplibre.dragPan.disable())})),this.events.subscribe("map-x-animation-cancel",m)}}var De,Re=n(10916),Be={exports:{}},Fe={};Be.exports=function(){if(De)return Fe;De=1;var t=i(),e=Symbol.for("react.element"),r=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,a=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function s(t,i,r){var s,l={},c=null,h=null;for(s in void 0!==r&&(c=""+r),void 0!==i.key&&(c=""+i.key),void 0!==i.ref&&(h=i.ref),i)n.call(i,s)&&!o.hasOwnProperty(s)&&(l[s]=i[s]);if(t&&t.defaultProps)for(s in i=t.defaultProps)void 0===l[s]&&(l[s]=i[s]);return{$$typeof:e,type:t,key:c,ref:h,props:l,_owner:a.current}}return Fe.Fragment=r,Fe.jsx=s,Fe.jsxs=s,Fe}();var Oe=Be.exports;function $e({name:t,style:i}){const[r,n]=(0,e.useState)();return(0,e.useEffect)((()=>{(async()=>{const e=await o(t);n(e)})()}),[t]),r?Oe.jsx("span",{dangerouslySetInnerHTML:{__html:r},style:{...i,padding:0,margin:0,lineHeight:0}}):null}const Ve=new _e({}),Ne=(0,e.createContext)({controller:Ve});function je({options:t,children:r}){const n=t||{},a=(0,e.useMemo)((()=>new _e({...n,engine:Le})),[]);return(0,e.useEffect)((()=>{const t=new IntersectionObserver((e=>{const[i]=e;i.isIntersecting&&!a.ready&&(a.makeReady(),t.unobserve(a.container))}),{root:null,rootMargin:"-50px",threshold:0});return t.observe(a.container),()=>{t.unobserve(a.container),a.destroy()}}),[]),(0,e.useMemo)((()=>{if(t){const{brand:e,baseMap:i,layers:r,center:n,zoom:o,pitch:s,bearing:l}=t;a.ready&&(i&&a.setBaseMap(i),r!==a.layers&&a.setLayers(r),e&&e!==a.brand&&a.setBrand(e),n&&a.engine.setCenter(n),"number"==typeof o&&a.engine.setZoom(o),"number"==typeof s&&a.engine.setPitch(s),"number"==typeof l&&a.engine.setBearing(l))}}),[t]),Oe.jsx(i().StrictMode,{children:Oe.jsx(Ne.Provider,{value:{controller:a},children:r})})}const Ue=()=>(0,e.useContext)(Ne);function Ze(){const{controller:t}=Ue();return Oe.jsxs(Oe.Fragment,{children:[Oe.jsx("div",{ref:e=>null==e?void 0:e.append(t.container)}),Oe.jsx(Xe,{})]})}const He=Ft.div`
  position: absolute;
  bottom: 0;
  left: ${({left:t})=>t?t+"px":"0px"};
  z-index: 1;
  padding: 8px;
`,qe=Ft.button`
  display: flex;
  align-items: center;
  justify-content: center;
  color: #ffffff;
  background: transparent;
  border: none;
  padding: none;
  svg {
    height: 1rem;
  }
  &:hover {
    cursor: pointer;
  }
`,Ge=Ft.div`
  position: absolute;
  bottom: 1rem;
  border-radius: 8px;
  left: "80px";
  padding: 0.5rem;
  display: flex;
  flex-direction: column;
  width: 280px;
  max-width: calc(100vw - 10px);
  font-size: 0.75rem;
  color: #ffffff;
  margin-bottom: 1rem;
  background: rgba(0, 0, 0, 0.75);
`,We=Ft.div`
  font-family: "Roboto", "Open Sans", sans-serif;
  a {
    display: block;
    padding: 0.25rem 0.5rem;
    color: #fff;
    text-decoration: none;
    &:hover {
      text-decoration: underline;
    }
  }
`;function Xe(){const[t,i]=(0,e.useState)(!1),{controller:r}=Ue(),[n,a]=(0,e.useState)([]);(0,e.useEffect)((()=>{const t=t=>{const e=t.detail;if(e){const t=[];Object.entries(e.sources).forEach((([e,i])=>{"object"==typeof i&&"video"!==i.type&&"image"!==i.type&&"canvas"!==i.type&&i.attribution&&t.push(i.attribution)})),a(t)}};return r.events.subscribe("map-x-style-updated",t),()=>{r.events.unsubscribe("map-x-style-updated",t)}}),[]);const o=(0,e.useMemo)((()=>{let t=0;return r.engine.constructor.name.includes("EngineMapBox")&&(t=80),t}),[r.engine]);return 0===n.length?null:Oe.jsxs(He,{left:o,children:[Oe.jsx(qe,{"aria-label":"Open Attribution Information",name:"Attribution Information",onClick:()=>i(!t),children:Oe.jsx($e,{name:"info"})}),t&&Oe.jsx(Ge,{children:n.map(((t,e)=>Oe.jsx(We,{dangerouslySetInnerHTML:{__html:t}},e)))})]})}const Ke=Ft.button`
  box-sizing: "border-box";
  border: none;
  width: 45px;
  height: 45px;
  padding: 4px 5px 5px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 11px;
  font-weight: 700;
  line-height: 16.5px;
  text-align: center;
  cursor: pointer;
  background: #fff;
  border-radius: 10px;
  user-select: none;
  box-shadow: 0 0.125rem 0.3125rem 0 rgb(0 0 0 / 14%),
    0 0.0625rem 0.375rem 0 rgb(0 0 0 / 12%);
  margin: 0.25rem;
  &:hover {
    background-color: #f0f0f0;
  }
  svg {
    width: 100%;
    height: 100%;
  }
  @media screen and (max-width: 480px) {
    width: 40px;
    height: 40px;
    font-size: 8px;
    line-height: 14.5px;
    padding: 2px 3px 3px;
  }
`;function Je({children:t,...e}){return Oe.jsx(Ke,{...e,children:t})}Ft.div`
  display: flex;
  flex-direction: column;
  width: 100%;
  height: 100%;
`,Ft.div`
  margin-right: 2px;
  svg {
    height: 9px;
  }
  @media screen and (max-width: 480px) {
    display: none;
  }
`,Ft.div`
  white-space: nowrap;
  flex-grow: 1;
  display: flex;
  justify-content: center;
  align-items: center;
`,Ft.div`
  background-color: #333;
  color: #fff;
  width: 100%;
  border-radius: 2px 2px 7px 7px;
  flex-shrink: 0;
`;const Ye=Ft.button`
  border: none;
  position: relative;
  transform: rotate(0deg);
  width: 45px;
  height: 45px;
  border-radius: 50%;
  background-color: #333;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 3px;
  margin: 0.25rem;
  box-shadow: 0 0.125rem 0.3125rem 0 rgb(0 0 0 / 14%),
    0 0.0625rem 0.375rem 0 rgb(0 0 0 / 12%);
  cursor: pointer;
  @media screen and (max-width: 480px) {
    width: 40px;
    height: 40px;
  }
  svg {
    width: 100%;
    height: 100%;
  }
`;function Qe(t){const{controller:i}=Ue(),[r,n]=(0,e.useState)(t.bearing||i.bearing);(0,e.useEffect)((()=>{const t=t=>{n(t.detail.bearing)};return i.events.subscribe("map-x-state-changed",t),()=>i.events.unsubscribe("map-x-state-changed",t)}),[]);const a=(0,e.useMemo)((()=>{const t=r||0;return Number.isNaN(t)?"rotate(0deg)":`rotate(${360-t}deg)`}),[r]);return Oe.jsx(Ye,{onClick:()=>{i.engine.rotateTo({bearing:0,duration:2500})},role:"button",title:"Rotate map with north up","aria-label":"Rotate map with north up",style:{transform:a},children:Oe.jsxs("svg",{width:"40",height:"39",viewBox:"0 0 40 39",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[Oe.jsx("path",{d:"M23.9942 8.94076L20.8659 7.45171L17.719 8.94076C17.2365 9.169 16.7241 8.69964 16.9325 8.22108L20.376 0.345114C20.5766 -0.115038 21.2498 -0.115038 21.4466 0.345114L24.7898 8.22108C24.9921 8.6978 24.4739 9.169 23.9942 8.94076Z",fill:"white"}),Oe.jsx("rect",{x:"-0.49999",y:"0.496836",width:"1",height:"2.97502",rx:"0.5",transform:"matrix(-4.36236e-08 1 -0.99998 -0.0063289 39.7341 19.0251)",fill:"currentColor",stroke:"#777777"}),Oe.jsx("rect",{x:"-0.49999",y:"0.496836",width:"1",height:"2.97502",rx:"0.5",transform:"matrix(-4.36236e-08 1 -0.99998 -0.0063289 4.95289 19.0251)",fill:"currentColor",stroke:"#777777"}),Oe.jsx("path",{d:"M24.95 24H22.6683L19.2948 17.7775L19.2948 24H17L17 14H19.2948L22.6618 20.2225L22.6618 14H24.95L24.95 24Z",fill:"white"}),Oe.jsx("path",{d:"M17.7744 30.0595L20.9026 31.5485L24.0495 30.0595C24.532 29.8312 25.0444 30.3006 24.8361 30.7792L21.3926 38.6551C21.1919 39.1153 20.5188 39.1153 20.322 38.6551L16.9788 30.7792C16.7764 30.3024 17.2947 29.8312 17.7744 30.0595Z",fill:"#777777"})]})})}function ti(){const{controller:t}=Ue(),[i,r]=(0,e.useState)(t.pitch);(0,e.useEffect)((()=>{const e=t=>{r(t.detail.pitch)};return t.events.subscribe("map-x-state-changed",e),()=>t.events.unsubscribe("map-x-state-changed",e)}),[]);const n=(0,e.useMemo)((()=>i>1?"3D":"2D"),[i]);return Oe.jsx(Je,{onClick:()=>{t&&(t.events.emit("map-x-animation-cancel",void 0),t.engine.easeTo({pitch:t.engine.getPitch()<1?65:0,duration:1e3}))},title:"Change Dimension","aria-label":"Change Dimension",style:{fontSize:"16px"},children:n})}function ei(){const{controller:t}=Ue(),[i,r]=(0,e.useState)(t.feature),[n,a]=(0,e.useState)(!1),[o,s]=(0,e.useState)(!1);(0,e.useEffect)((()=>{t&&(t.events.subscribe("map-x-animation-start",(t=>{"follow-cam"===t.detail.type&&s(!0)})),t.events.subscribe("map-x-animation-end",(t=>{"follow-cam"===t.detail.type&&s(!1)})))}),[t]),(0,e.useEffect)((()=>{var t;if(i){const e=!(null==(t=i.geometry)||!t.type||"LineString"!==i.geometry.type);a(e)}}),[i]),(0,e.useEffect)((()=>{const e=t=>{r(t.detail)};return t.events.subscribe("map-x-feature-changed",e),()=>t.events.unsubscribe("map-x-feature-changed",e)}),[]);return n?Oe.jsx(Je,{onClick:()=>{i&&(!o&&t.feature?t.engine.followCam({feature:i,showTracker:!0}):t.reset())},title:"Fly camera along path","aria-label":"Fly camera along path",style:{opacity:o?.5:1},disabled:!n,children:Oe.jsx($e,{name:"airplane"})}):null}const ii=Ft.div`
  display: flex;
  flex-direction: column;
  width: 100%;
  height: 100%;
`,ri=Ft.div`
  white-space: nowrap;
  flex-grow: 1;
  display: flex;
  justify-content: center;
  align-items: center;
  svg {
    height: 1rem;
    width: 1rem;
  }
`,ni=Ft.div`
  background-color: #333;
  color: #fff;
  width: 100%;
  border-radius: 2px 2px 7px 7px;
  flex-shrink: 0;
`;function ai({exportFilename:t="export",gpxTitle:e="onX Maps",gpxDescription:i="",gpxLink:r="",geoJson:n}){return n?Oe.jsx(Je,{onClick:()=>{if(n){const a=function(t,e){var i=document.implementation.createDocument("http://www.topografix.com/GPX/1/1",""),r=i.createProcessingInstruction("xml",'version="1.0" encoding="UTF-8"');i.appendChild(r);var n=(null==e?void 0:e.creator)||"@dwayneparton/geojson-to-gpx",a=function(t){return i.createElementNS("http://www.topografix.com/GPX/1/1",t)},o=a("gpx");o.setAttribute("version","1.1"),o.setAttribute("creator",n);var s=[],l=[];function c(t,e,r){if(void 0!==r){var n=a(e),o=i.createTextNode(String(r));n.appendChild(o),t.appendChild(n)}}function h(t,e,i){i&&"object"==typeof i&&e.forEach((function(r){var n=i[r];n&&"string"==typeof n&&e.includes(r)&&c(t,r,n)}))}function u(t,e){var i=e.href;if(i){var r=a("link");r.setAttribute("href",i),h(r,["text","type"],e),t.appendChild(r)}}function d(t){var e=a("trk");return h(e,["name","desc","src","type"],t),e}function p(t,e,i){var r=e[0],n=e[1],o=e[2],s=e[3],l=a(t);return l.setAttribute("lat",String(n)),l.setAttribute("lon",String(r)),c(l,"ele",o),c(l,"time",s),h(l,["name","desc","src","type"],i),l}function m(t){var e=a("trkseg");return t.forEach((function(t){e.appendChild(p("trkpt",t))})),e}function f(t){var e=t.geometry,i=t.properties;switch(e.type){case"Polygon":default:break;case"Point":s.push(p("wpt",e.coordinates,i));break;case"MultiPoint":e.coordinates.forEach((function(t){s.push(p("wpt",t,i))}));break;case"LineString":var r=d(i),n=m(e.coordinates);r.appendChild(n),l.push(r);break;case"MultiLineString":var a=d(i);e.coordinates.forEach((function(t){var e=m(t);a.appendChild(e)})),l.push(a)}}if(e&&"object"==typeof e.metadata){var g=e.metadata,y=a("metadata");if(c(y,"name",g.name),c(y,"desc",g.desc),g.author&&"object"==typeof g.author){var _=a("author");c(_,"name",g.author.name),c(_,"email",g.author.email),g.author.link&&"object"==typeof g.author.link&&u(_,g.author.link),y.appendChild(_)}if("object"==typeof g.copyright){var v=a("copyright");g.copyright.author&&v.setAttribute("author",g.copyright.author),c(v,"year",g.copyright.year),c(v,"license",g.copyright.license),y.appendChild(v)}"object"==typeof g.link&&u(y,g.link),c(y,"time",g.time),c(y,"keywords",g.keywords),o.appendChild(y)}switch(t.type){case"Feature":f(t);break;case"FeatureCollection":t.features.forEach((function(t){f(t)}))}return s.forEach((function(t){return o.appendChild(t)})),l.forEach((function(t){return o.appendChild(t)})),i.appendChild(o),i}(n,{metadata:{name:e,desc:i?`${i} - Built with onX.`:"Built with onX.",link:{href:r},author:{name:"onX Maps"}}}),o=(new XMLSerializer).serializeToString(a);((t,e)=>{const i=document.createElement("a");if(i.setAttribute("href",`data:text/json;charset=utf-8,${encodeURIComponent(e)}`),i.setAttribute("download",t),document.createEvent){const t=document.createEvent("MouseEvents");t.initEvent("click",!0,!0),i.dispatchEvent(t)}else i.click()})(`${t}.gpx`,o)}},title:"Download GPX","aria-label":"Download GPX",children:Oe.jsxs(ii,{children:[Oe.jsx(ri,{children:Oe.jsx($e,{name:"download"})}),Oe.jsx(ni,{children:"GPX"})]})}):null}function oi(){const{controller:t}=Ue();return Oe.jsx(Je,{onClick:()=>{t.reset()},title:"Return Home","aria-label":"Return Home",children:Oe.jsx($e,{name:"home"})})}Ft.div`
  box-sizing: "border-box";
  overflow: hidden;
  border: none;
  width: 45px;
  background: #fff;
  border-radius: 10px;
  user-select: none;
  box-shadow: 0 0.125rem 0.3125rem 0 rgb(0 0 0 / 14%),
    0 0.0625rem 0.375rem 0 rgb(0 0 0 / 12%);
  margin: 0.25rem;
  @media screen and (max-width: 480px) {
    width: 40px;
  }
`,Ft.div`
  height: 1px;
  width: 75%;
  background-color: #e2e2e2;
  margin: -1px auto 0;
`;function si(){const[t,i]=(0,e.useState)(!1),r=(0,e.useMemo)((()=>t?"Collapse full screen":"Expand to full screen"),[t]);return Oe.jsxs(Je,{onClick:()=>{document.fullscreenElement?document.exitFullscreen().then((()=>{i(!1)})):document.documentElement.requestFullscreen({navigationUI:"show"}).then((()=>{i(!0)})).catch((()=>{i(!1)}))},title:r,"aria-label":r,children:[!t&&Oe.jsx($e,{name:"expand-full-screen"}),t&&Oe.jsx($e,{name:"collapse-full-screen"})]})}const li=Ft.div``;function ci({style:t,children:i}){return Oe.jsx("div",{style:{position:"absolute",top:"1rem",right:"1rem",display:"flex",flexDirection:"column",...t},children:e.Children.map(i,((t,e)=>Oe.jsx(li,{children:t},e)))})}function hi(){return Oe.jsxs("svg",{width:"88",height:"23",viewBox:"0 0 88 23",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[Oe.jsxs("g",{className:"logo-x",children:[Oe.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M23.8691 23H46.8257V0H23.8691V23Z",fill:"#FF3300"}),Oe.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M40.6096 14.7192L38.5619 16.7709L35.3489 13.5517L32.1356 16.7709L30.0879 14.7192L33.3009 11.5L30.0879 8.28054L32.1356 6.22919L35.3489 9.44807L38.5619 6.22919L40.6096 8.28054L37.3966 11.5L40.6096 14.7192Z",fill:"white"})]}),Oe.jsx("path",{className:"letters",fillRule:"evenodd",clipRule:"evenodd",d:"M17.6954 15.3334H15.695L12.5757 11.0239V15.3334H10.5215V7.66675H12.5216L15.6412 11.9766V7.66675H17.6954V15.3334ZM57.7927 10.5034H55.0787V7.66675H53.0879V15.3334H55.0787V12.4145H57.7927V15.3334H59.7835V7.66675H57.7927V10.5034ZM66.4784 15.3334C68.6493 15.3334 69.8265 14.1718 69.8265 12.1235V7.66675H67.7692V12.0642C67.7692 12.9301 67.2726 13.3762 66.4784 13.3762C65.6848 13.3762 65.1879 12.9301 65.1879 12.0642V7.66675H63.1309V12.1235C63.1309 14.1718 64.308 15.3334 66.4784 15.3334ZM79.8692 15.3334H77.8688L74.7495 11.0239V15.3334H72.6953V7.66675H74.6954L77.815 11.9766V7.66675H79.8692V15.3334ZM85.8964 9.58341H88.0006V7.66675H81.7832V9.58341H83.8874V15.3334H85.8964V9.58341ZM3.82898 13.4101C2.77341 13.4101 2.04463 12.6301 2.04463 11.4986C2.04463 10.3671 2.77341 9.58711 3.82898 9.58711C4.88455 9.58711 5.61333 10.37 5.61333 11.4986C5.61333 12.6272 4.88455 13.4101 3.82898 13.4101ZM3.82609 15.3334C6.06448 15.3334 7.65217 13.7055 7.65217 11.4986C7.65217 9.29167 6.06448 7.6638 3.82609 7.66675C1.5877 7.66675 0 9.29167 0 11.4986C0 13.7055 1.5877 15.3334 3.82609 15.3334Z",fill:"white"})]})}function ui(){return Oe.jsxs("svg",{width:"185",height:"36",viewBox:"0 0 185 36",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[Oe.jsxs("g",{className:"logo-x",children:[Oe.jsx("path",{d:"M66.0486 23.1506L62.7473 26.4362L57.5698 21.2833L52.3923 26.4362L49.091 23.1506L54.2685 17.9976L49.091 12.8447L52.3923 9.55903L57.5698 14.712L62.7473 9.55903L66.0486 12.8447L60.8711 17.9976L66.0486 23.1506ZM39.4817 36H75.6531V0H39.4817V36Z",fill:"#222222"}),Oe.jsx("path",{d:"M66.0499 23.1506L62.7486 26.4363L57.5711 21.2833L52.3936 26.4363L49.0923 23.1506L54.2698 17.9977L49.0923 12.8447L52.3936 9.56378L57.5711 14.7168L62.7486 9.56378L66.0499 12.8447L60.8724 17.9977L66.0499 23.1506Z",fill:"#FFFFFF"})]}),Oe.jsx("path",{className:"letters",d:"M3.35827 18.111C3.35827 19.9217 4.55527 21.1697 6.28903 21.1697C8.02279 21.1697 9.2198 19.9169 9.2198 18.111C9.2198 16.3051 8.02279 15.0523 6.28903 15.0523C4.55527 15.0523 3.35827 16.3004 3.35827 18.111ZM12.5686 18.111C12.5686 21.6425 9.9608 24.2473 6.28429 24.2473C2.60777 24.2473 0 21.6425 0 18.111C0 14.5796 2.60777 11.9794 6.28429 11.9794C9.9608 11.9747 12.5686 14.5796 12.5686 18.111Z",fill:"white"}),Oe.jsx("path",{className:"letters",d:"M28.1621 24.0252H25.0176L20.1203 17.3736V24.0252H16.895V12.197H20.0348L24.9368 18.8438V12.197H28.1621V24.0252Z",fill:"white"}),Oe.jsx("path",{className:"letters",d:"M99.143 18.1205C99.143 21.6614 96.5305 24.271 92.8444 24.271C89.1584 24.271 86.5459 21.6614 86.5459 18.1205C86.5459 14.5796 89.1584 11.9747 92.8444 11.9747C96.5305 11.9747 99.143 14.5843 99.143 18.1205ZM89.9089 18.1205C89.9089 19.9311 91.1107 21.1886 92.8444 21.1886C94.5782 21.1886 95.78 19.9359 95.78 18.1205C95.78 16.3099 94.5782 15.0571 92.8444 15.0571C91.1107 15.0571 89.9089 16.3099 89.9089 18.1205Z",fill:"white"}),Oe.jsx("path",{className:"letters",d:"M112.106 19.7421H106.539V24.0535H103.304V12.197H112.528V15.0571H106.539V16.8772H112.106V19.7421Z",fill:"white"}),Oe.jsx("path",{className:"letters",d:"M125.752 19.7421H120.185V24.0535H116.95V12.197H126.174V15.0571H120.185V16.8772H125.752V19.7421Z",fill:"white"}),Oe.jsx("path",{className:"letters",d:"M140.91 24.0015L138.041 19.4111C139.466 18.8249 140.226 17.6714 140.226 16.1397C140.226 13.7523 138.635 12.1922 135.604 12.1922H130.293V24.0488H133.528V19.8413C133.528 19.8413 134.635 19.8413 134.887 19.8413L137.433 24.0015H140.91ZM133.528 15.0807H135.571C136.369 15.0807 136.958 15.4211 136.958 16.1397C136.958 16.8583 136.369 17.1892 135.571 17.1892H133.528V15.0807Z",fill:"white"}),Oe.jsx("path",{className:"letters",d:"M155.956 18.1205C155.956 21.6614 153.344 24.271 149.658 24.271C145.972 24.271 143.359 21.6614 143.359 18.1205C143.359 14.5796 145.972 11.9747 149.658 11.9747C153.344 11.9747 155.956 14.5843 155.956 18.1205ZM146.722 18.1205C146.722 19.9311 147.924 21.1886 149.658 21.1886C151.392 21.1886 152.593 19.9359 152.593 18.1205C152.593 16.3099 151.392 15.0571 149.658 15.0571C147.924 15.0571 146.722 16.3099 146.722 18.1205Z",fill:"white"}),Oe.jsx("path",{className:"letters",d:"M170.412 24.0488H166.982L166.189 21.789H161.738L160.954 24.0488H157.577L162.085 12.1922H165.899L170.412 24.0488ZM162.745 18.9194H165.187L163.971 15.4116L162.745 18.9194Z",fill:"white"}),Oe.jsx("path",{className:"letters",d:"M184.321 18.1205C184.321 21.6945 181.87 24.0488 178.146 24.0488H172.887V12.1922H178.146C181.87 12.1922 184.321 14.5465 184.321 18.1205ZM176.122 15.1516V21.0988H178.06C180.017 21.0988 180.962 19.8366 180.962 18.1252C180.962 16.3902 180.017 15.1516 178.06 15.1516H176.122V15.1516Z",fill:"white"})]})}function di(){return Oe.jsxs("svg",{width:"245",height:"36",viewBox:"0 0 245 36",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[Oe.jsxs("g",{className:"logo-x",children:[Oe.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M39.2886 36H75.2886V0H39.2886V36Z",fill:"#087AFF"}),Oe.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M65.5384 23.039L62.3272 26.2502L57.2887 21.2115L52.2498 26.2502L49.0386 23.039L54.0771 18.0002L49.0386 12.961L52.2498 9.75024L57.2887 14.7885L62.3272 9.75024L65.5384 12.961L60.4999 18.0002L65.5384 23.039Z",fill:"white"})]}),Oe.jsx("path",{className:"letters",d:"M6.2356 11.9526C2.59816 11.9526 0 14.551 0 18.0944C0 21.6377 2.59816 24.2361 6.2356 24.2361C9.873 24.2361 12.4712 21.6377 12.4712 18.0944C12.5184 14.551 9.92023 11.9526 6.2356 11.9526ZM6.2356 21.1652C4.53496 21.1652 3.30675 19.9369 3.30675 18.0944C3.30675 16.2991 4.48772 15.0235 6.2356 15.0235C7.98343 15.0235 9.16441 16.2519 9.16441 18.0944C9.16441 19.8896 7.98343 21.1652 6.2356 21.1652ZM24.8006 18.8503L19.935 12.1889H16.8172V23.9999H20.0295V17.3857L24.8951 24.0471H28.0129V12.2361H24.8006V18.8503ZM95.6596 18.0471C96.6042 17.5747 97.2183 16.6771 97.2183 15.5432C97.2183 13.4645 95.8014 12.1416 92.6363 12.1416H87.2982V23.9999H92.9196C96.0375 23.9999 97.4545 22.677 97.4545 20.5983C97.4545 19.4644 96.6514 18.4251 95.6596 18.0471ZM90.5105 14.7873H92.5416C93.4391 14.7873 93.8642 15.118 93.8642 15.7794C93.8642 16.4408 93.3919 16.7715 92.5416 16.7715H90.5105V14.7873ZM92.7306 21.4014H90.5105V19.37H92.7306C93.6756 19.37 94.1479 19.7007 94.1479 20.4093C94.1479 21.0707 93.6756 21.4014 92.7306 21.4014ZM105.013 12.1416L100.525 23.9999H103.879L104.682 21.7322H109.123L109.926 23.9999H113.327L108.839 12.1416H105.013ZM105.674 18.8975L106.902 15.4015L108.131 18.8975H105.674ZM122.113 15.0235C123.247 15.0235 124.145 15.5432 124.712 16.5353L127.546 14.9763C126.507 13.0865 124.475 11.9526 122.113 11.9526C118.429 11.9526 115.878 14.5038 115.878 18.0944C115.878 21.6849 118.476 24.2361 122.113 24.2361C124.475 24.2361 126.271 23.1967 127.404 21.4959L124.759 19.6534C124.097 20.6456 123.2 21.1652 122.066 21.1652C120.602 21.1652 119.185 20.1259 119.185 18.0944C119.232 16.2519 120.46 15.0235 122.113 15.0235ZM142.899 12.1416H138.978L136.002 16.5826H135.057V12.1416H131.845V23.9999H135.057V19.4644H135.955L139.308 23.9999H143.277L138.6 17.9526L142.899 12.1416ZM151.921 15.0235C153.055 15.0235 153.953 15.5432 154.52 16.5353L157.354 14.9763C156.315 13.0865 154.283 11.9526 151.921 11.9526C148.237 11.9526 145.686 14.5038 145.686 18.0944C145.686 21.6849 148.284 24.2361 151.921 24.2361C154.283 24.2361 156.078 23.1967 157.212 21.4959L154.567 19.6534C153.905 20.6456 153.008 21.1652 151.874 21.1652C150.41 21.1652 148.992 20.1259 148.992 18.0944C149.04 16.2519 150.268 15.0235 151.921 15.0235ZM167.085 11.9526C163.401 11.9526 160.802 14.551 160.802 18.0944C160.802 21.6377 163.401 24.2361 167.085 24.2361C170.77 24.2361 173.368 21.6377 173.368 18.0944C173.368 14.551 170.77 11.9526 167.085 11.9526ZM167.085 21.1652C165.338 21.1652 164.156 19.8896 164.156 18.0944C164.156 16.2991 165.338 15.0235 167.085 15.0235C168.833 15.0235 170.014 16.2991 170.014 18.0944C170.014 19.8896 168.833 21.1652 167.085 21.1652ZM184.847 19.0865C184.847 20.4566 184.091 21.1652 182.816 21.1652C181.54 21.1652 180.785 20.4566 180.785 19.0865V12.1416H177.572V19.181C177.572 22.3936 179.415 24.2361 182.816 24.2361C186.217 24.2361 188.06 22.3936 188.06 19.181V12.1416H184.847V19.0865ZM200.767 18.803L195.901 12.1416H192.736V23.9999H195.948V17.3385L200.814 23.9999H203.932V12.1416H200.767V18.803ZM207.617 15.118H210.97V23.9999H214.183V15.118H217.537V12.1416H207.569V15.118H207.617ZM231.047 16.1101C231.047 13.7007 229.441 12.1416 226.465 12.1416H221.174V23.9999H224.387V19.7952H224.576L227.41 23.9999H231.189L227.977 19.6534C229.961 19.2282 231.047 17.9054 231.047 16.1101ZM226.418 17.1495H224.387V15.0235H226.418C227.221 15.0235 227.788 15.3542 227.788 16.0629C227.788 16.8188 227.221 17.1495 226.418 17.1495ZM240.967 12.1416L238.558 16.6298L236.149 12.1416H232.464L236.952 19.5589V23.9999H240.164V19.5117L244.558 12.1416H240.967Z",fill:"white"})]})}function pi(){return Oe.jsxs("svg",{viewBox:"0 0 80 34",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[Oe.jsx("path",{className:"letters",fillRule:"evenodd",clipRule:"evenodd",d:"M22.5615 22.25H25.4371V11.25H22.4842V17.4337L17.9998 11.25H15.1246V22.25H18.0776V16.0667L22.5615 22.25ZM5.50416 19.4905C3.98677 19.4905 2.93915 18.3714 2.93915 16.7479C2.93915 15.1244 3.98677 14.0053 5.50416 14.0053C7.02154 14.0053 8.06916 15.1286 8.06916 16.7479C8.06916 18.3671 7.02154 19.4905 5.50416 19.4905ZM5.5 22.25C8.71769 22.25 11 19.9144 11 16.7479C11 13.5814 8.71769 11.2458 5.5 11.25C2.28231 11.25 0 13.5814 0 16.7479C0 19.9144 2.28231 22.25 5.5 22.25Z",fill:"white"}),Oe.jsxs("g",{className:"logo-x",children:[Oe.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M36 33.25H69V0.25H36V33.25Z",fill:"white"}),Oe.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M60.0645 21.3688L57.1209 24.3125L52.5022 19.6937L47.883 24.3125L44.9395 21.3688L49.5581 16.75L44.9395 12.1307L47.883 9.1875L52.5022 13.8059L57.1209 9.1875L60.0645 12.1307L55.4458 16.75L60.0645 21.3688Z",fill:"black"})]})]})}function mi({brand:t}){const e=se(t).logoColor;return Oe.jsxs("svg",{width:"41",height:"40",viewBox:"0 0 41 40",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[Oe.jsxs("g",{clipPath:"url(#clip0_675_7248)",children:[Oe.jsx("path",{d:"M0.262451 8.75C0.262451 3.91751 4.17996 0 9.01245 0H31.5125C36.3449 0 40.2625 3.91751 40.2625 8.75V31.25C40.2625 36.0825 36.3449 40 31.5125 40H9.01245C4.17996 40 0.262451 36.0825 0.262451 31.25V8.75Z",fill:e}),Oe.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M29.1528 25.6393L25.6954 29.1621L20.2704 23.6346L14.8449 29.1621L11.3875 25.6393L16.8124 20.1118L11.3875 14.5838L14.8449 11.0615L20.2704 16.5885L25.6954 11.0615L29.1528 14.5838L23.7278 20.1118L29.1528 25.6393Z",fill:"white"})]}),Oe.jsx("defs",{children:Oe.jsx("clipPath",{id:"clip0_675_7248",children:Oe.jsx("rect",{width:"40",height:"40",fill:"white",transform:"translate(0.262451)"})})})]})}function fi({brand:t}){switch(t){case"hunt":return Oe.jsx(hi,{});case"offroad":return Oe.jsx(ui,{});case"backcountry":return Oe.jsx(di,{});default:return Oe.jsx(pi,{})}}const gi=Ft.a`
  position: absolute;
  display: inline-block;
  top: 1rem;
  left: 50%;
  transform: translateX(-50%);
  z-index: 1;

  svg {
    height: 1.5rem;
    filter: drop-shadow(3px 0px 3px rgb(0 0 0 / 0.6));
  }
  @media screen and (max-width: 480px) {
    svg {
      height: 1rem;
    }
  }
`;function yi({brand:t}){const{controller:i}=Ue(),[r,n]=(0,e.useState)("https://www.onxmaps.com"),a=t||i.brand;return(0,e.useEffect)((()=>{const t=t=>{n(le(i).toString()||"https://www.onxmaps.com")};return i.events.subscribe("map-x-idle",t),()=>{i.events.unsubscribe("map-x-idle",t)}}),[]),Oe.jsx(gi,{href:r,title:"Get onX",target:"_blank",children:Oe.jsx(fi,{brand:a})})}function _i({brand:t,style:i}){const{controller:r}=Ue(),[n,a]=(0,e.useState)(!1),o=t||r.brand;return Oe.jsxs("div",{style:{position:"absolute",height:"100%",width:"100%",top:"0",left:"0",pointerEvents:"none"},children:[Oe.jsx("div",{style:{position:"absolute",bottom:0,right:0,pointerEvents:"all",...i},children:Oe.jsx(Fi,{brand:o,onClick:()=>a(!0)})}),Oe.jsx(Pi,{brand:o,isActive:n,onClose:()=>a(!1)})]})}const vi=(t,e)=>{const i=t[e];return i?"function"==typeof i?i():Promise.resolve(i):new Promise(((t,i)=>{("function"==typeof queueMicrotask?queueMicrotask:setTimeout)(i.bind(null,new Error("Unknown variable dynamic import: "+e)))}))},bi=Ft.div`
  position: absolute;
  top: 0;
  left: 0;
  z-index: 5;

  display: flex;
  justify-content: flex-end;

  height: 100%;
  width: 100%;
  background-color: rgba(34, 34, 34, 0.65);
  overflow: hidden;
  opacity: 0;
  pointer-events: ${({active:t})=>t?"all":"none"};
  transition: opacity 0.3s ease-in-out;

  ${({active:t})=>t&&"\n    opacity: 1;\n  "};
`,xi=Ft.div`
  position: absolute;
  top: 2rem;
  right: 2rem;
  z-index: 4;

  cursor: pointer;

  svg {
    height: 24px;
    width: 24px;
  }
`,wi=Ft.div`
  position: absolute;
  top: 0;
  left: 0;
  z-index: 1;

  height: 100%;
  width: 100%;

  background-color: #fff;
  clip-path: polygon(30% 0, 100% 0%, 100% 100%, 0 100%);

  @media (max-width: 920px) {
    clip-path: polygon(15% 0, 100% 0%, 100% 100%, 0 100%);
  }
  @media (max-width: 695px) {
    clip-path: polygon(0 0, 100% 0%, 100% 100%, 0 100%);
  }
`,Si=Ft.div`
  position: relative;
  z-index: 2;

  display: flex;
  justify-content: flex-end;

  transform: ${({active:t})=>t?"translateX(0)":"translateX(100%)"};
  transition: all 0.75s ease-in-out;

  height: 100%;
  width: 69%;
  max-width: 990px;

  @media (max-width: 920px) {
    width: 75%;
  }

  @media (max-width: 695px) {
    width: 100%;
  }
`,ki=Ft.div`
  position: relative;
  z-index: 3;

  display: flex;
  justify-content: center;
  align-items: center;

  width: 70%;
  height: 100%;

  @media (max-width: 695px) {
    width: 100%;
  }
`,Ci=Ft.a`
  display: flex;
  justify-content: center;
  align-items: center;
  flex-direction: column;
  font-family: "Roboto", "Open Sans", sans-serif;
  margin: 0 2rem;

  max-width: 801px;
  color: #333 !important;
  &:hover {
    color: #555 !important;
  }
`,Ai=Ft.div`
  height: 147px;
  width: 147px;
  margin-bottom: 1rem;
  cursor: pointer;
`,Ti=Ft.div`
  margin: 1rem 0;
  padding: 1rem 2rem;
  font-weight: bold;
  border-radius: 10px;
  display: inline-block;
  background-color: #111;
  color: #fff;
  &:hover {
    background-color: #333;
  }
`,Ei=Ft.p`
  font-weight: 400;
  font-size: 1rem;
  line-height: 160%;
  text-align: center;

  max-width: 487px;
`,Mi=Ft.h1`
  margin-bottom: 1rem;
  font-size: 2.5rem;
  font-weight: 900;
  line-height: 48px;
  text-align: center;
`,Ii=Ft.div`
  position: absolute;
  left: 0;
  top: 101%; // Had to be 101 because of a weird gap at bottom. bottom: 0 doesn't align bottom for some reason
  z-index: 4;

  transform: ${({active:t})=>t?"translate(-50%, -100%)":"translate(100%, -100%)"};
  opacity: ${({active:t})=>t?"1":"0"};
  transition: transform 0.75s ease-in-out, opacity 0.75s ease-in-out;

  img {
    height: 100%;
    max-height: 85vh;
    width: auto;

    @media (max-width: 695px) {
      display: none;
    }
  }
`,zi=t=>{switch(t){case"hunt":return{header:"The #1 Hunting GPS App",link:se("hunt").link,body:"Join the millions of hunters who trust onX Hunt to find more game, discover new access, and hunt smarter. Get started today by scanning the QR Code."};case"offroad":return{header:"Go farther with confidence",link:se("offroad").link,body:"Use the most trusted off-roading and snowmobiling app, onX Offroad, to discover nearby trails, plan and track your trips, and get home safely. Get started today by scanning the QR Code."};case"backcountry":return{header:"Find Your Next Adventure",link:se("backcountry").link,body:"With guidebook-quality trail and ski tour descriptions, elevation profiles, and the ability to easily share information with your friends, identify your next experience. Get started today by scanning the QR Code to download the app on your device."};default:return{header:"Apps for Outdoor Adventures",link:se("onx").link,body:"Our mission is to awaken the adventurer inside everyone. Get started today by scanning the QR Code."}}};function Pi({isActive:t,onClose:i,brand:r="onx",image:a=null,header:o=null,link:s=null,body:l=null,showQRCode:c=!0,button:h=null}){const{controller:u}=Ue(),[d,p]=(0,e.useState)(),[m,f]=(0,e.useState)(),[g,y]=(0,e.useState)(),[_]=(0,e.useState)({header:o||zi(r).header,link:s||zi(r).link.toString(),body:l||zi(r).body}),v=async t=>{const e=await(0,Re.toString)(t,{errorCorrectionLevel:"M",quality:.92,type:"svg",margin:2,color:{dark:"#000",light:"#fff"}});if(e){const t=unescape(encodeURIComponent(e)),i=`data:image/svg+xml;base64,${window.btoa(t)}`;f(i)}};return(0,e.useEffect)((()=>{if(d||!u.loaded)return;const t="bwo-drawer-cta-click";if(s){const e=new URL(s);ce(e),e.searchParams.set("utm_campaign",t),p(e.toString())}else{const e=le(u);e.searchParams.set("utm_campaign",t),p(e.toString())}}),[null==u?void 0:u.loaded]),(0,e.useEffect)((()=>{if(!u.loaded||!c||m)return;const t="bwo-qr-code";if(s){const e=new URL(s);ce(e),e.searchParams.set("utm_campaign",t),v(e.toString())}else{const e=le(u);e.searchParams.set("utm_campaign",t),v(e.toString())}}),[null==u?void 0:u.loaded,c]),(0,e.useEffect)((()=>{t&&(window.dataLayer=window.dataLayer||[],window.dataLayer.push({event:"cta_viewed"}))}),[t]),(0,e.useEffect)((()=>{(async()=>{if(a)y(a);else{const t=await vi(Object.assign({"./assets/backcountry-phone.png":()=>n.e(60720).then(n.bind(n,60720)),"./assets/hunt-phone.png":()=>n.e(45315).then(n.bind(n,45315)),"./assets/offroad-phone.png":()=>n.e(57340).then(n.bind(n,79720))}),`./assets/${r}-phone.png`);y(t.default)}})()}),[a,r]),Oe.jsx(bi,{active:t,children:Oe.jsxs(Si,{active:t,children:[Oe.jsx(xi,{tabIndex:0,onClick:()=>{"function"==typeof i&&i()},role:"button","aria-label":"Close",children:Oe.jsx($e,{name:"times"})}),Oe.jsx(wi,{}),Oe.jsx(ki,{children:Oe.jsxs(Ci,{href:d,target:"_blank",title:_.header,children:[c&&Oe.jsx(Ai,{children:Oe.jsx("img",{src:m,alt:"Scan the QR code to open the app.",height:"150px",width:"150px"})}),Oe.jsx(Mi,{children:_.header}),Oe.jsx(Ei,{children:_.body}),h&&Oe.jsx(Ti,{children:h})]})}),g&&"string"==typeof g&&Oe.jsx(Ii,{active:t,children:Oe.jsx("img",{src:g,alt:"App"})})]})})}const Li=Ft.div.attrs({className:"cta-button"})`
  margin: 1rem;
  display: flex;
  align-items: center;
  padding: 0.25rem;
  width: 100%;
  max-width: 211px;
  background-color: #fff;
  box-shadow: 0px 12px 28px rgba(0, 0, 0, 0.32);
  border-radius: 8px;
  font-family: "Roboto", "Open Sans", sans-serif;
  cursor: pointer;
  transition: background-color 0.3s ease-in-out;

  &:hover {
    background-color: #efefef;
  }
`,Di=Ft.div`
  margin: 0 0.5rem;
`,Ri=Ft.div`
  font-size: 0.75rem;
  line-height: 19.2px;
  font-weight: 700;
  color: #333333;
`,Bi=Ft.p`
  font-size: 0.5rem;
  font-weight: 400;
  line-height: 9.6px;
  margin: 0;
  color: #8b8b8b;
`;function Fi({brand:t,onClick:e,header:i="See More In The App",body:r="Click to sign in or create a free account.",link:n=null}){return Oe.jsxs(Li,{className:"cta-button",onClick:()=>{"function"==typeof e&&e()},children:[Oe.jsx(mi,{brand:t}),Oe.jsxs(Di,{children:[Oe.jsx(Ri,{children:i}),Oe.jsx(Bi,{children:r})]}),Oe.jsx($e,{name:"chevron-right",style:{color:se(t).color}})]})}const Oi=Ft.div`
  position: relative;
  display: block;
  height: 5px;
  width: 100%;
  min-width: 175px;
  background-color: ${({color:t})=>t||"#FFF"};
  border-radius: 5px;
  cursor: pointer;
`,$i=Ft.div`
  position: absolute;
  top: 0;
  left: 0;
  height: 100%;
  width: ${({percent:t})=>t||0}%;
  background-color: ${({color:t})=>t||"#087AFF"};
  border-radius: 5px;
  transition: width 1000ms ease-in-out;
`;function Vi({percent:t,color:e,scrubColor:i}){return Number.isNaN(t)?null:Oe.jsx(Oi,{color:i,children:Oe.jsx($i,{percent:100*t,color:e})})}const Ni=Bt`
  100% {
    opacity: 0;
    pointer-events: none;
    background: rgba(22,22,22,0);
    justify-content: flex-end;
    align-items: flex-end;
  }
`,ji=Bt`
  100% {
    transform: rotateY(180deg);
  }
`,Ui=Ft.div`
  position: absolute;
  display: flex;
  justify-content: center;
  align-items: center;
  box-sizing: border-box;
  top: 0;
  left: 0;
  z-index: 3;

  padding: 0.5rem 1rem;
  height: 100%;
  width: 100%;

  background: #222;
  transition: all 1s ease-in-out;
  transition-delay: 1s;
  color: #ffffff;
  overflow: hidden;
  opacity: 1;

  svg {
    position: relative;
    height: 2rem;
    width: auto;

    .letters {
      opacity: ${({progress:t})=>t>=1?"1":"0"};
      transition: opacity 0.25s ease-in;
      transition-delay: 1.25s;
    }

    .logo-x {
      perspective: 1000px;
      transform-box: fill-box;
      transform-style: preserve-3d;
      transform-origin: 50% 50%;
      transition-delay: 1s;
      ${({progress:t})=>t<1&&xt`
          animation: ${ji} 2s ease infinite;
        `};
    }
  }
  ${({loaded:t})=>t&&xt`
      animation: ${Ni} 2s linear forwards;
      svg {
        display: none;
      }
    `};
`,Zi=Ft.div`
  position: relative;
  z-index: 5;
  width: 100%;
  transition: all 1s ease-in-out;
  transition-delay: 1s;
  transform: ${({progress:t})=>t>=1?"translateX(0)":"translateX(calc(50% - 50px))"};
`,Hi=Ft.div`
  position: absolute;
  display: block;
  width: 100%;
  height: 100%;
  max-height: 100%;
  top: 0;
  left: 0;

  img {
    height: 100%;
    min-height: 100%;
    margin: 0;
    width: 100%;
    object-fit: cover;
    object-position: 50% 50%;
  }
`,qi=Ft.div`
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
`,Gi=Ft.div`
  margin-top: 1rem;
  width: 100%;
  transition: opacity 0.5s ease-in-out;
  transition-delay: 1s;
  opacity: ${({loaded:t})=>t?0:"1"};
`,Wi=Ft.a`
  position: relative;
  pointer-events: all;
  transition: opacity 1500ms ease-in-out;
  opacity: ${({isOnScreen:t})=>t?1:0};
`,Xi=(t="onx")=>{switch(t){case"hunt":return"hunt";case"offroad":return"offroad";case"backcountry":return"backcountry";default:return"onx"}},Ki=(t="onx")=>{switch(t){case"hunt":return{color:se("hunt").color,scrubColor:"#ffbaa8",link:se("hunt").link};case"offroad":return{color:se("offroad").color,scrubColor:"#ffdca8",link:se("offroad").link};case"backcountry":return{color:se("backcountry").color,scrubColor:"#A6CFFF",link:se("backcountry").link};default:return{color:"#ffffff",scrubColor:"#CECECE",link:se("onx").link}}};function Ji(t){const{controller:i}=Ue(),[r,a]=(0,e.useState)(t.brand||i.brand),[o,s]=(0,e.useState)(t.progress||i.progress),[l,c]=(0,e.useState)(!1),[h,u]=(0,e.useState)();return(0,e.useEffect)((()=>{o>=1?setTimeout((()=>{c(!0)}),2500):c(!1)}),[o]),(0,e.useEffect)((()=>{const t=t=>{s(t.detail.progress),a(t.detail.brand)};return i.events.subscribe("map-x-state-changed",t),()=>i.events.unsubscribe("map-x-state-changed",t)}),[]),(0,e.useEffect)((()=>{(async()=>{const t=await vi(Object.assign({"./assets/backcountry-topo.jpg":()=>n.e(33936).then(n.bind(n,33936)),"./assets/hunt-topo.jpg":()=>n.e(49088).then(n.bind(n,49088)),"./assets/offroad-topo.jpg":()=>n.e(20568).then(n.bind(n,20568)),"./assets/onx-topo.jpg":()=>n.e(78232).then(n.bind(n,78232))}),`./assets/${Xi(r)}-topo.jpg`);t.default&&u(t.default)})()}),[r]),Oe.jsx(Oe.Fragment,{children:Oe.jsxs(Ui,{loaded:l,progress:o,children:[!l&&h&&Oe.jsx(Hi,{children:Oe.jsx("img",{src:h,alt:"topo background"})}),Oe.jsxs(qi,{children:[Oe.jsx(Wi,{href:le(i).toString(),title:"Get onX",target:"_blank",isOnScreen:o>0,children:Oe.jsx(Zi,{progress:o,children:Oe.jsx(fi,{brand:r})})}),Oe.jsx(Gi,{loaded:o>=1,children:Oe.jsx(Vi,{percent:o>1?1:o,color:Ki(r).color,scrubColor:Ki(r).scrubColor})})]})]})})}const Yi=Bt`
  0% {
    opacity: 0.25;
    bottom: -2rem;
  }
  100% {
    opacity: 1;
    bottom: 1rem;
  }
`;Ft.div`
  position: absolute;
  display: ${({isClosed:t})=>t?"none":"flex"};
  flex-direction: column;
  left: 1rem;
  bottom: ${({isClosing:t})=>t?"-2rem":"1rem"};
  opacity: ${({isClosing:t})=>t?.25:1};
  width: 375px;
  max-width: calc(100% - 2rem);
  height: 0px;
  font-family: "Roboto", "Open Sans", sans-serif;
  background-color: rgba(255, 255, 255, 1);
  border-radius: 10px;
  overflow: hidden;
  box-shadow: 0px 4px 5px rgba(0, 0, 0, 0.2), 0px 7px 10px rgba(0, 0, 0, 0.14),
    0px 2px 16px rgba(0, 0, 0, 0.12);
  height: calc(100% - 2rem);
  max-height: calc(100% - 2rem);
  z-index: 2;
  transition: all 250ms ease-in-out;
  animation: ${Yi} 250ms ease;
`,Ft.div`
  cursor: pointer;
  top: 0;
  right: 0;
  padding: 1rem 0.5rem 0.5rem;
  margin-right: 0.5rem;
  display: inline-flex;
  justify-content: center;
  align-items: center;
  svg {
    height: 1rem;
    width: auto;
  }
`,Ft.div`
  cursor: pointer;
  top: 0;
  right: 0;
  padding: 1rem 0.5rem 0.5rem;
  display: inline-flex;
  justify-content: center;
  align-items: center;
  svg {
    height: 1rem;
    width: auto;
  }
  @media screen and (min-width: 681px) {
    display: none;
  }
`,Ft.div`
  overflow-y: auto;
`,Ft.div`
  display: flex;
  justify-content: space-between;
`;Ft.div`
  display: flex;
  flex-direction: column;
  padding: 1rem;
  border-bottom: 1px solid #d4d4d4;
  &:last-child {
    border-bottom: none;
  }
`,Ft.div`
  strong {
    font-weight: 900;
  }
  font-size: 1rem;
  font-weight: 500;
`,Ft.div`
  font-size: 0.8rem;
`;Ft.div`
  display: flex;
  flex-direction: column;
  padding: 0rem 1rem 0.5rem;
`,Ft.div`
  font-weight: 900;
  color: #222;
  font-size: 24px;
  font-size: 1.5rem;
  line-height: 1.25;
  letter-spacing: -0.02em;
`,Ft.div`
  font-size: 11px;
  font-size: 0.6875rem;
  line-height: 1.4545454545;
  font-weight: 500;
`;Ft.div``,Ft.div`
  display: flex;
  flex-direction: row;
  padding: 0 1rem;
  border-bottom: 1px solid #e2e2e2;
`,Ft.div`
  display: inline-block;
  padding: 0.5rem 0 1rem;
  border-bottom: 3px solid
    ${({borderColor:t,isActive:e})=>e?t||"#222":"none"};
  font-weight: 700;

  color: ${({isActive:t})=>t?"#222":"#8b8b8b"};
  cursor: pointer;

  & + * {
    margin-left: 1rem;
  }
`,Ft.div`
  display: ${({isActive:t})=>t?"block":"none"};
  margin-top: 0.5rem;
  margin-bottom: 0.5rem;
  overflow-y: auto;
`;Ft.div`
  font-family: "Roboto", "Open Sans", sans-serif;
  border: none;
  position: absolute;
  bottom: 0px;
  right: 0px;
  height: 20px;
  font-size: 11px;
  background-color: #e2e2e2;
  color: #333;
  display: flex;
  flex-direction: row;
  align-items: center;
  justify-content: center;
`,Ft.div`
  box-sizing: border-box;
  padding: 0px 5px;
  &:last-child {
    padding-right: 10px;
  }
`;function Qi({children:t}){return Oe.jsx("div",{style:{height:"100%",width:"100%",maxHeight:"100%",maxWidth:"100%",boxSizing:"border-box",overflow:"hidden",position:"relative",display:"block"},children:t})}var tr=n(24300);function er(t){var e,i,r,n;if(!t.properties)return;const a={title:void 0,attributes:[]},o=function(t){return t&&t.properties&&t.properties.presentation?"string"==typeof t.properties.presentation?JSON.parse(t.properties.presentation):"object"!=typeof t.properties.presentation||Array.isArray(t.properties.presentation)?{}:t.properties.presentation:{}}(t),s=(null==o?void 0:o.title)||(null==(e=t.properties)?void 0:e.title)||void 0;return s&&(a.title=s),null!=o&&o.content&&null!=(i=o.content)&&i[0]&&(null==(n=null==(r=null==o?void 0:o.content)?void 0:r[0])||n.forEach((t=>{!t||"object"!=typeof t||Object.entries(t).forEach((t=>{const[e,i]=t;if("string"!=typeof i)return;let r="content";i.includes("https://")&&(r="link"),a.attributes.push({key:e,type:r,title:e,value:i})}))}))),a}function ir(t){switch(t){case"hunt":return{color:"#ff3300",darkColor:"#AD2300",logoColor:"#ff3300",waypointColor:"default",link:new URL("https://webmap.onxmaps.com/hunt/login")};case"offroad":return{color:"#FF9F0E",darkColor:"#AD6C0A",logoColor:"#333333",waypointColor:"yorange",link:new URL("https://webmap.onxmaps.com/offroad/login")};case"backcountry":return{color:"#087AFF",darkColor:"#0553AD",logoColor:"#087AFF",waypointColor:"blue",link:new URL("https://webmap.onxmaps.com/backcountry/login")};default:return{color:"#333333",darkColor:"#222222",logoColor:"#333333",waypointColor:"black",link:new URL("https://webmap.onxmaps.com/hunt/login")}}}function rr(t){const e=ir(t.brand).link,[i,r]=t.center,n=t.zoom,a="onx"===t.brand?"hunt":t.brand;return e.pathname=`/${a}/map/query/${r},${i},${n}`,function(t){const e="bwo",i="embed",r=function(){var t;try{let e=document.referrer;return e||(e=null==(t=null==window?void 0:window.location)?void 0:t.host),e}catch{return""}}(),n="bwo-map-viewer";t.searchParams.set("utm_id",e),t.searchParams.set("utm_source",r),t.searchParams.set("utm_campaign",n),t.searchParams.set("utm_medium",i)}(e),e}const nr=Ft.div`
  display: flex;
  flex-direction: column;
  padding: 1rem 0;
`,ar=Ft.div`
  strong {
    font-weight: 900;
  }
  font-size: 1rem;
  font-weight: 500;
`,or=Ft.div`
    font-size: 1rem;
    font-weight: 500;
  strong {
    font-weight: 900;
  }
  a, a {
    text-decoration: none;
  }
`,sr=Ft.div`
  font-size: 1rem;
  line-height: 1.6em;
`;function lr({item:{type:t,title:e,value:i}}){return"link"===t&&function(t){try{new URL(t)}catch(t){return!1}return!0}(i)?React.createElement(nr,null,React.createElement(or,null,React.createElement("a",{target:"_top",href:i,rel:"noreferrer",style:{textDecoration:"none"}},e))):React.createElement(nr,null,React.createElement(ar,null,React.createElement("strong",null,e)),React.createElement(sr,null,i))}function cr({color:t="#222"}){return React.createElement("svg",{width:"88",height:"23",viewBox:"0 0 88 23",fill:"none",xmlns:"http://www.w3.org/2000/svg"},React.createElement("g",{className:"logo-x"},React.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M23.8691 23H46.8257V0H23.8691V23Z",fill:"#FF3300"}),React.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M40.6096 14.7192L38.5619 16.7709L35.3489 13.5517L32.1356 16.7709L30.0879 14.7192L33.3009 11.5L30.0879 8.28054L32.1356 6.22919L35.3489 9.44807L38.5619 6.22919L40.6096 8.28054L37.3966 11.5L40.6096 14.7192Z",fill:"white"})),React.createElement("path",{className:"letters",fillRule:"evenodd",clipRule:"evenodd",d:"M17.6954 15.3334H15.695L12.5757 11.0239V15.3334H10.5215V7.66675H12.5216L15.6412 11.9766V7.66675H17.6954V15.3334ZM57.7927 10.5034H55.0787V7.66675H53.0879V15.3334H55.0787V12.4145H57.7927V15.3334H59.7835V7.66675H57.7927V10.5034ZM66.4784 15.3334C68.6493 15.3334 69.8265 14.1718 69.8265 12.1235V7.66675H67.7692V12.0642C67.7692 12.9301 67.2726 13.3762 66.4784 13.3762C65.6848 13.3762 65.1879 12.9301 65.1879 12.0642V7.66675H63.1309V12.1235C63.1309 14.1718 64.308 15.3334 66.4784 15.3334ZM79.8692 15.3334H77.8688L74.7495 11.0239V15.3334H72.6953V7.66675H74.6954L77.815 11.9766V7.66675H79.8692V15.3334ZM85.8964 9.58341H88.0006V7.66675H81.7832V9.58341H83.8874V15.3334H85.8964V9.58341ZM3.82898 13.4101C2.77341 13.4101 2.04463 12.6301 2.04463 11.4986C2.04463 10.3671 2.77341 9.58711 3.82898 9.58711C4.88455 9.58711 5.61333 10.37 5.61333 11.4986C5.61333 12.6272 4.88455 13.4101 3.82898 13.4101ZM3.82609 15.3334C6.06448 15.3334 7.65217 13.7055 7.65217 11.4986C7.65217 9.29167 6.06448 7.6638 3.82609 7.66675C1.5877 7.66675 0 9.29167 0 11.4986C0 13.7055 1.5877 15.3334 3.82609 15.3334Z",fill:t}))}function hr({color:t="#222"}){return React.createElement("svg",{width:"185",height:"36",viewBox:"0 0 185 36",fill:"none",xmlns:"http://www.w3.org/2000/svg"},React.createElement("g",{className:"logo-x"},React.createElement("path",{d:"M66.0486 23.1506L62.7473 26.4362L57.5698 21.2833L52.3923 26.4362L49.091 23.1506L54.2685 17.9976L49.091 12.8447L52.3923 9.55903L57.5698 14.712L62.7473 9.55903L66.0486 12.8447L60.8711 17.9976L66.0486 23.1506ZM39.4817 36H75.6531V0H39.4817V36Z",fill:"#222222"}),React.createElement("path",{d:"M66.0499 23.1506L62.7486 26.4363L57.5711 21.2833L52.3936 26.4363L49.0923 23.1506L54.2698 17.9977L49.0923 12.8447L52.3936 9.56378L57.5711 14.7168L62.7486 9.56378L66.0499 12.8447L60.8724 17.9977L66.0499 23.1506Z",fill:"#FFFFFF"})),React.createElement("path",{className:"letters",d:"M3.35827 18.111C3.35827 19.9217 4.55527 21.1697 6.28903 21.1697C8.02279 21.1697 9.2198 19.9169 9.2198 18.111C9.2198 16.3051 8.02279 15.0523 6.28903 15.0523C4.55527 15.0523 3.35827 16.3004 3.35827 18.111ZM12.5686 18.111C12.5686 21.6425 9.9608 24.2473 6.28429 24.2473C2.60777 24.2473 0 21.6425 0 18.111C0 14.5796 2.60777 11.9794 6.28429 11.9794C9.9608 11.9747 12.5686 14.5796 12.5686 18.111Z",fill:t}),React.createElement("path",{className:"letters",d:"M28.1621 24.0252H25.0176L20.1203 17.3736V24.0252H16.895V12.197H20.0348L24.9368 18.8438V12.197H28.1621V24.0252Z",fill:t}),React.createElement("path",{className:"letters",d:"M99.143 18.1205C99.143 21.6614 96.5305 24.271 92.8444 24.271C89.1584 24.271 86.5459 21.6614 86.5459 18.1205C86.5459 14.5796 89.1584 11.9747 92.8444 11.9747C96.5305 11.9747 99.143 14.5843 99.143 18.1205ZM89.9089 18.1205C89.9089 19.9311 91.1107 21.1886 92.8444 21.1886C94.5782 21.1886 95.78 19.9359 95.78 18.1205C95.78 16.3099 94.5782 15.0571 92.8444 15.0571C91.1107 15.0571 89.9089 16.3099 89.9089 18.1205Z",fill:t}),React.createElement("path",{className:"letters",d:"M112.106 19.7421H106.539V24.0535H103.304V12.197H112.528V15.0571H106.539V16.8772H112.106V19.7421Z",fill:t}),React.createElement("path",{className:"letters",d:"M125.752 19.7421H120.185V24.0535H116.95V12.197H126.174V15.0571H120.185V16.8772H125.752V19.7421Z",fill:t}),React.createElement("path",{className:"letters",d:"M140.91 24.0015L138.041 19.4111C139.466 18.8249 140.226 17.6714 140.226 16.1397C140.226 13.7523 138.635 12.1922 135.604 12.1922H130.293V24.0488H133.528V19.8413C133.528 19.8413 134.635 19.8413 134.887 19.8413L137.433 24.0015H140.91ZM133.528 15.0807H135.571C136.369 15.0807 136.958 15.4211 136.958 16.1397C136.958 16.8583 136.369 17.1892 135.571 17.1892H133.528V15.0807Z",fill:t}),React.createElement("path",{className:"letters",d:"M155.956 18.1205C155.956 21.6614 153.344 24.271 149.658 24.271C145.972 24.271 143.359 21.6614 143.359 18.1205C143.359 14.5796 145.972 11.9747 149.658 11.9747C153.344 11.9747 155.956 14.5843 155.956 18.1205ZM146.722 18.1205C146.722 19.9311 147.924 21.1886 149.658 21.1886C151.392 21.1886 152.593 19.9359 152.593 18.1205C152.593 16.3099 151.392 15.0571 149.658 15.0571C147.924 15.0571 146.722 16.3099 146.722 18.1205Z",fill:t}),React.createElement("path",{className:"letters",d:"M170.412 24.0488H166.982L166.189 21.789H161.738L160.954 24.0488H157.577L162.085 12.1922H165.899L170.412 24.0488ZM162.745 18.9194H165.187L163.971 15.4116L162.745 18.9194Z",fill:t}),React.createElement("path",{className:"letters",d:"M184.321 18.1205C184.321 21.6945 181.87 24.0488 178.146 24.0488H172.887V12.1922H178.146C181.87 12.1922 184.321 14.5465 184.321 18.1205ZM176.122 15.1516V21.0988H178.06C180.017 21.0988 180.962 19.8366 180.962 18.1252C180.962 16.3902 180.017 15.1516 178.06 15.1516H176.122V15.1516Z",fill:t}))}function ur({color:t="#222"}){return React.createElement("svg",{width:"245",height:"36",viewBox:"0 0 245 36",fill:"none",xmlns:"http://www.w3.org/2000/svg"},React.createElement("g",{className:"logo-x"},React.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M39.2886 36H75.2886V0H39.2886V36Z",fill:"#087AFF"}),React.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M65.5384 23.039L62.3272 26.2502L57.2887 21.2115L52.2498 26.2502L49.0386 23.039L54.0771 18.0002L49.0386 12.961L52.2498 9.75024L57.2887 14.7885L62.3272 9.75024L65.5384 12.961L60.4999 18.0002L65.5384 23.039Z",fill:"white"})),React.createElement("path",{className:"letters",d:"M6.2356 11.9526C2.59816 11.9526 0 14.551 0 18.0944C0 21.6377 2.59816 24.2361 6.2356 24.2361C9.873 24.2361 12.4712 21.6377 12.4712 18.0944C12.5184 14.551 9.92023 11.9526 6.2356 11.9526ZM6.2356 21.1652C4.53496 21.1652 3.30675 19.9369 3.30675 18.0944C3.30675 16.2991 4.48772 15.0235 6.2356 15.0235C7.98343 15.0235 9.16441 16.2519 9.16441 18.0944C9.16441 19.8896 7.98343 21.1652 6.2356 21.1652ZM24.8006 18.8503L19.935 12.1889H16.8172V23.9999H20.0295V17.3857L24.8951 24.0471H28.0129V12.2361H24.8006V18.8503ZM95.6596 18.0471C96.6042 17.5747 97.2183 16.6771 97.2183 15.5432C97.2183 13.4645 95.8014 12.1416 92.6363 12.1416H87.2982V23.9999H92.9196C96.0375 23.9999 97.4545 22.677 97.4545 20.5983C97.4545 19.4644 96.6514 18.4251 95.6596 18.0471ZM90.5105 14.7873H92.5416C93.4391 14.7873 93.8642 15.118 93.8642 15.7794C93.8642 16.4408 93.3919 16.7715 92.5416 16.7715H90.5105V14.7873ZM92.7306 21.4014H90.5105V19.37H92.7306C93.6756 19.37 94.1479 19.7007 94.1479 20.4093C94.1479 21.0707 93.6756 21.4014 92.7306 21.4014ZM105.013 12.1416L100.525 23.9999H103.879L104.682 21.7322H109.123L109.926 23.9999H113.327L108.839 12.1416H105.013ZM105.674 18.8975L106.902 15.4015L108.131 18.8975H105.674ZM122.113 15.0235C123.247 15.0235 124.145 15.5432 124.712 16.5353L127.546 14.9763C126.507 13.0865 124.475 11.9526 122.113 11.9526C118.429 11.9526 115.878 14.5038 115.878 18.0944C115.878 21.6849 118.476 24.2361 122.113 24.2361C124.475 24.2361 126.271 23.1967 127.404 21.4959L124.759 19.6534C124.097 20.6456 123.2 21.1652 122.066 21.1652C120.602 21.1652 119.185 20.1259 119.185 18.0944C119.232 16.2519 120.46 15.0235 122.113 15.0235ZM142.899 12.1416H138.978L136.002 16.5826H135.057V12.1416H131.845V23.9999H135.057V19.4644H135.955L139.308 23.9999H143.277L138.6 17.9526L142.899 12.1416ZM151.921 15.0235C153.055 15.0235 153.953 15.5432 154.52 16.5353L157.354 14.9763C156.315 13.0865 154.283 11.9526 151.921 11.9526C148.237 11.9526 145.686 14.5038 145.686 18.0944C145.686 21.6849 148.284 24.2361 151.921 24.2361C154.283 24.2361 156.078 23.1967 157.212 21.4959L154.567 19.6534C153.905 20.6456 153.008 21.1652 151.874 21.1652C150.41 21.1652 148.992 20.1259 148.992 18.0944C149.04 16.2519 150.268 15.0235 151.921 15.0235ZM167.085 11.9526C163.401 11.9526 160.802 14.551 160.802 18.0944C160.802 21.6377 163.401 24.2361 167.085 24.2361C170.77 24.2361 173.368 21.6377 173.368 18.0944C173.368 14.551 170.77 11.9526 167.085 11.9526ZM167.085 21.1652C165.338 21.1652 164.156 19.8896 164.156 18.0944C164.156 16.2991 165.338 15.0235 167.085 15.0235C168.833 15.0235 170.014 16.2991 170.014 18.0944C170.014 19.8896 168.833 21.1652 167.085 21.1652ZM184.847 19.0865C184.847 20.4566 184.091 21.1652 182.816 21.1652C181.54 21.1652 180.785 20.4566 180.785 19.0865V12.1416H177.572V19.181C177.572 22.3936 179.415 24.2361 182.816 24.2361C186.217 24.2361 188.06 22.3936 188.06 19.181V12.1416H184.847V19.0865ZM200.767 18.803L195.901 12.1416H192.736V23.9999H195.948V17.3385L200.814 23.9999H203.932V12.1416H200.767V18.803ZM207.617 15.118H210.97V23.9999H214.183V15.118H217.537V12.1416H207.569V15.118H207.617ZM231.047 16.1101C231.047 13.7007 229.441 12.1416 226.465 12.1416H221.174V23.9999H224.387V19.7952H224.576L227.41 23.9999H231.189L227.977 19.6534C229.961 19.2282 231.047 17.9054 231.047 16.1101ZM226.418 17.1495H224.387V15.0235H226.418C227.221 15.0235 227.788 15.3542 227.788 16.0629C227.788 16.8188 227.221 17.1495 226.418 17.1495ZM240.967 12.1416L238.558 16.6298L236.149 12.1416H232.464L236.952 19.5589V23.9999H240.164V19.5117L244.558 12.1416H240.967Z",fill:t}))}function dr({color:t="#222"}){return React.createElement("svg",{viewBox:"0 0 80 34",fill:"none",xmlns:"http://www.w3.org/2000/svg"},React.createElement("path",{className:"letters",fillRule:"evenodd",clipRule:"evenodd",d:"M22.5615 22.25H25.4371V11.25H22.4842V17.4337L17.9998 11.25H15.1246V22.25H18.0776V16.0667L22.5615 22.25ZM5.50416 19.4905C3.98677 19.4905 2.93915 18.3714 2.93915 16.7479C2.93915 15.1244 3.98677 14.0053 5.50416 14.0053C7.02154 14.0053 8.06916 15.1286 8.06916 16.7479C8.06916 18.3671 7.02154 19.4905 5.50416 19.4905ZM5.5 22.25C8.71769 22.25 11 19.9144 11 16.7479C11 13.5814 8.71769 11.2458 5.5 11.25C2.28231 11.25 0 13.5814 0 16.7479C0 19.9144 2.28231 22.25 5.5 22.25Z",fill:t}),React.createElement("g",{className:"logo-x"},React.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M36 33.25H69V0.25H36V33.25Z",fill:"white"}),React.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M60.0645 21.3688L57.1209 24.3125L52.5022 19.6937L47.883 24.3125L44.9395 21.3688L49.5581 16.75L44.9395 12.1307L47.883 9.1875L52.5022 13.8059L57.1209 9.1875L60.0645 12.1307L55.4458 16.75L60.0645 21.3688Z",fill:"black"})))}function pr({brand:t,color:e="#222"}){switch(t){case"hunt":return React.createElement(cr,{color:e});case"offroad":return React.createElement(hr,{color:e});case"backcountry":return React.createElement(ur,{color:e});default:return React.createElement(dr,{color:e})}}const mr={hunt:{color:"#ff3300",hoverColor:"#AD2300"},offroad:{color:"#FF9F0E",hoverColor:"#AD6C0A"},backcountry:{color:"#087AFF",hoverColor:"#0553AD"},unaffiliated:{color:"#333333",hoverColor:"#222222"}},fr=Ft.div`
    position: relative;
    display: flex;
    flex-direction: column;
    justify-content: center;

    box-sizing: border-box;
    padding: 1rem 1rem 0.5rem;
    display: block;
    box-shadow: 0px -2px 4px rgba(0, 0, 0, 0.16);
    background-color: #ffffff;

    @media screen and (max-width: 480px) {
        padding: 0.5rem;
    }
`,gr=Ft.div`
    text-align: center;
    padding: 0 0.5rem;
    line-height: 1.275rem;
    svg {
        height: 1.25rem;
        width: auto;
    }
`,yr=Ft.div`
    margin: 0.25rem 0;
    font-size: 1rem;
    @media screen and (max-width: 480px) {
        font-size: 0.9rem;
    }
    font-weight: bold;
`,_r=Ft.button`
    display: block;
    padding: 0.75rem;
    margin: 0.75rem 0 0.5rem;
    width: 100%;

    border-radius: 10px;
    background-color: ${({app:t})=>mr[t].color||"#087AFF"};
    cursor: pointer;
    transition: all 250ms ease-in-out;

    text-decoration: none;
    border: none;
    font-weight: bold;
    font-size: 0.9rem;
    text-align: center;
    color: ${({app:t})=>"offroad"===t?"#222":"#FFF"} !important;
    &:hover {
        background-color: ${({app:t})=>mr[t].hoverColor||"#0056BB"};
    }

    @media screen and (max-width: 480px) {
        font-size: 0.9rem;
        padding: 0.5rem;
    }
`;function vr({tagline:t="Use onX to Plan, Track, and Navigate Outdoors Pursuits.",button:e="Try for Free Today",onCTAClick:i=(()=>null)}){const{controller:r}=Ue(),n=r.brand||"unaffiliated";return React.createElement(fr,null,React.createElement(gr,null,React.createElement(pr,{brand:n}),React.createElement(yr,null,t)),React.createElement(_r,{"aria-label":"Open Promotion",app:n,onClick:()=>{if(function(){let t=!1;return(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|ipad|iris|kindle|Android|Silk|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(navigator.userAgent.substring(0,4)))&&(t=!0),t}()){const t=rr(r).toString();window.open(t,"_blank")}else i()}},e))}const br=Ft.div`
font-size: 1.75rem;
font-weight: 900;
padding: 1rem;
border-bottom: ${({showBorder:t})=>t?"1px solid #e2e2e2":"none"};
@media screen and (max-width: 680px) {
    font-size: 1.5rem;
}
`,xr=Ft.div`
  position: absolute;
  top: 0;
  left: 0;
  height: 100%;
  width: 375px;
  max-width: calc(100% - 1rem);
  pointer-events: none;
`,wr=Ft.div`
  pointer-events: all;
  position: absolute;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  left: ${t=>t.active?"0.5rem":"calc(0px - 100%)"};
  bottom: 0.5rem;
  width: 375px;
  max-width: calc(100% - 1rem);
  height: 0px;
  height: calc(100% - 1rem);
  max-height: calc(100% - 1rem);
  background-color: rgba(255,255,255, 1);
  border-radius: 10px;
  box-shadow: 0px 4px 5px rgba(0, 0, 0, 0.2), 0px 7px 10px rgba(0, 0, 0, 0.14), 0px 2px 16px rgba(0, 0, 0, 0.12);
  z-index: 2;
  transition: all 0.3s ease-in-out;
  a {
    text-decoration: underline;
  }
  @media screen and (max-width: 480px) {
    height: calc(50% - 1rem);
    width: calc(100% - 1rem);
  }
  ${t=>t.active?"":xt`
    &::before {
      content: "";
      z-index: 3;
      position: absolute;
      top: 0px;
      left: 0px;
      height: 100%;
      width: 100%;
      background-color: #ffffff;
      opacity: 0.9;
      border-radius: 10px;
    }
  `}
`,Sr=Ft.div`
  cursor: pointer;
  position: absolute;
  top: 0.45rem;
  right: 0;
  padding: 1rem;
  display: flex;
  justify-content: center;
  align-items: center;
  svg {
    height: 1.5rem;
    width: auto;
  }
`,kr=Ft.div`
  padding: 0 0 1rem;
  overflow-x: hidden;
  overflow-y: auto;
  flex-grow: 1;
`,Cr=Ft.div`
  padding: 0 1rem;
`;function Ar({onCTAClick:t}){const[r,n]=(0,e.useState)(!0),{controller:a}=Ue(),[o,s]=(0,e.useState)(a.feature),l=(0,e.useMemo)((()=>o?er(o):void 0),[o]);return(0,e.useEffect)((()=>{const t=t=>{s(t.detail),n(!0)};return a.events.subscribe("map-x-feature-changed",t),()=>a.events.unsubscribe("map-x-feature-changed",t)}),[]),o&&l&&l.title?i().createElement(xr,null,i().createElement(wr,{active:r},i().createElement(Sr,{"aria-label":"minimize panel",onClick:()=>n(!r)},i().createElement($e,{name:"close"})),i().createElement(br,{showBorder:!0},(0,tr.sanitize)(l.title)),i().createElement(kr,null,i().createElement(Cr,null,l.attributes.map((t=>t.title&&t.value?i().createElement(lr,{item:t}):null)))),i().createElement(vr,{onCTAClick:t}))):null}function Tr({name:t="gpx-export"}){const{controller:r}=Ue(),[n,a]=(0,e.useState)(r.stylesheet.getSourceData("custom")),o=t.replace(/ /g,"-").toLowerCase();return(0,e.useEffect)((()=>{const t=()=>{const t=r.stylesheet.getSourceData("custom");t&&t.features.length&&a(t)};return r.events.subscribe("map-x-style-updated",t),()=>r.events.unsubscribe("map-x-style-updated",t)}),[]),i().createElement(ai,{geoJson:n,exportFilename:o})}function Er({name:t,zoom:e,minZoom:r,maxZoom:n,center:a,bearing:o,pitch:s,bounds:l,maxBounds:c,brand:h,baseMap:u,layers:d,styleUrl:p,style:m}){const[f,g]=i().useState(!1),y={zoom:e,minZoom:r,maxZoom:n,center:a,bearing:o,pitch:s,bounds:l,maxBounds:c,brand:h,baseMap:u,layers:d,styleUrl:p??void 0,style:m??void 0};return i().createElement(Qi,null,i().createElement(je,{options:y},i().createElement(Ze,null),i().createElement(ci,null,i().createElement(Qe,null),i().createElement(oi,null),i().createElement(ti,null),i().createElement(si,null),i().createElement(Tr,{name:t}),i().createElement(ei,null)),i().createElement(Ar,{onCTAClick:()=>g(!0)}),"onx"!==y.brand&&i().createElement(_i,{brand:y.brand}),i().createElement(Ji,{brand:y.brand}),i().createElement(Pi,{brand:y.brand,isActive:f,onClose:()=>g(!1)}),i().createElement(yi,{brand:y.brand})))}document.addEventListener("DOMContentLoaded",(()=>{document.querySelectorAll(".bwo-template-basic").forEach((e=>{const i=e.getAttribute("app")||"onx",r=e.getAttribute("name")||"Built with onX map",n=e.getAttribute("zoom")||"0",a=e.getAttribute("pitch")||"0",o=e.getAttribute("bearing")||"0",s=e.getAttribute("center"),l=e.getAttribute("data_bounds"),c=e.getAttribute("layers"),h=e.getAttribute("baseMap")||"aerial",u=e.getAttribute("style_sheet_src"),d=u?new URL(u):void 0;(0,t.C)(e).render(React.createElement(Er,{brand:i,name:r,zoom:parseFloat(n),pitch:parseFloat(a),bearing:parseFloat(o),center:s?JSON.parse(s):void 0,bounds:l?JSON.parse(l):void 0,layers:c?JSON.parse(c):void 0,baseMap:h,styleUrl:d}))}))}))})()})();